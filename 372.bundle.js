"use strict";(self.webpackChunkgame_core=self.webpackChunkgame_core||[]).push([[372],{685:function(t,e,r){r.r(e);var n=r(23),a=r(4),u=r(20),i=r.n(u),o=r(40),s=r.n(o),c=r(72),p=r.n(c),d=r(115),l=r.n(d),h=r(71),f=r.n(h),m=r(666),v=r(230),y=r(689),b=r(690),w=GameCore.Configs,g=w.LeadersBoard,x=w.Tournament,k=g.LeaderboardId,T=g.Limit,I=x.YourMockTournamentCount,A=function(){function t(t){this.id=void 0,this.title=void 0,this.contextId=void 0,this.payload=void 0,this.endTime=void 0,this.initialScore=void 0,this.id=t,this.title=this.id+"'s Tournament",this.contextId="000-"+this.id,this.initialScore=0,this.payload=s()({playerId:"1213456",playerName:"Player",leaderboardId:k});var e=t>7?7:t;this.endTime=Math.round((Date.now()+864e5*e)/1e3)}var e=t.prototype;return e.getID=function(){return this.id},e.getTitle=function(){return this.title},e.getPayload=function(){return this.payload},e.getEndTime=function(){return this.endTime},e.getContextID=function(){return this.contextId},e.getInitialScore=function(){return this.initialScore},e.setCreatePayload=function(t){var e=t.initialScore,r=t.config,n=t.data;this.initialScore=e,r&&(this.title=r.tournamentTitle),n&&(this.payload=s()(n))},t}(),P=function(t){function e(){var e,r;(r=t.call(this)||this).tournaments=void 0,r.tournamentData=void 0;var n=new A(1);return r.tournaments=[n],r.tournamentData=((e={})[1..toString()]=n,e),r.createYourMockTournaments(),r}(0,a.A)(e,t);var r=e.prototype;return r.createAsync=function(){var t=(0,n.A)(i().mark((function t(e){var r=this;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new(p())((function(t){var n=r.tournaments.length+1,a=new A(n);a.setCreatePayload(e),r.tournaments.push(a),r.tournamentData[n]=a,t(a)})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),r.shareAsync=function(){var t=(0,n.A)(i().mark((function t(e){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new(p())((function(t){return t()})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),r.joinAsync=function(){var t=(0,n.A)(i().mark((function t(e){var r;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e in this.tournamentData){t.next=3;break}return t.abrupt("return",this.getPromiseRejectTournamentNotFound());case 3:if(r=this.tournamentData[e],r.getContextID()!==FBInstant.context.getID()){t.next=7;break}return t.abrupt("return",p().reject(new b.A(null)));case 7:return t.prev=7,t.next=10,this.validateTournament(r);case 10:return t.next=12,GameCore.Utils.Valid.isValueChangeAsync(window.__fbGameReady,!0);case 12:return t.next=14,FBInstant.context.switchAsync(e);case 14:t.next=19;break;case 16:return t.prev=16,t.t0=t.catch(7),t.abrupt("return",p().reject(t.t0));case 19:return t.abrupt("return",p().resolve());case 20:case"end":return t.stop()}}),t,this,[[7,16]])})));return function(e){return t.apply(this,arguments)}}(),r.validateTournament=function(){var t=(0,n.A)(i().mark((function t(e){var r,n,a,u,o,s;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.getPayload(),n=JSON.parse(r),a=n.leaderboardId,u=[],t.prev=3,t.next=6,(0,v.Kv)(a,{limit:T});case 6:u=t.sent,t.next=12;break;case 9:return t.prev=9,t.t0=t.catch(3),t.abrupt("return",p().reject(t.t0));case 12:if(0!==u.length){t.next=14;break}return t.abrupt("return",this.getPromiseRejectTournamentNotFound());case 14:if(o=window.game.player.getPlayerId(),l()(u).call(u,(function(t){return t.playerId===o}))){t.next=18;break}return t.abrupt("return",this.getPromiseRejectTournamentNotFound());case 18:return s=null,t.prev=19,t.next=22,(0,v.hJ)(o,a);case 22:s=t.sent,t.next=28;break;case 25:return t.prev=25,t.t1=t.catch(19),t.abrupt("return",p().reject(t.t1));case 28:if(s){t.next=30;break}return t.abrupt("return",this.getPromiseRejectTournamentNotFound());case 30:return t.abrupt("return",p().resolve());case 31:case"end":return t.stop()}}),t,this,[[3,9],[19,25]])})));return function(e){return t.apply(this,arguments)}}(),r.getPromiseRejectTournamentNotFound=function(){return p().reject(new y.A(null))},r.postScoreAsync=function(){var t=(0,n.A)(i().mark((function t(e){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",p().resolve());case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),r.getTournamentsAsync=function(){var t=(0,n.A)(i().mark((function t(){var e,r;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=f()(e=[]).call(e,this.tournaments),t.abrupt("return",r);case 2:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),r.createYourMockTournaments=function(){for(var t=window.game.player.getPlayer(),e=t.playerId,r=t.name,n=0;n<I;n++){var a=1+n+1,u=new A(a);u.setCreatePayload({initialScore:0,config:{tournamentTitle:r+" 's Tournament"},data:{playerId:e,playerName:r,leaderboardId:k}}),this.tournaments.push(u),this.tournamentData[a]=u}},e}(m.o);e.default=P}}]);