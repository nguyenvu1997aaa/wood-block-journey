(function(){var e={513:function(){HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(e,t,n){for(var i=atob(this.toDataURL(t,n).split(",")[1]),a=i.length,s=a>>2,r=new Uint8Array(a),o=new Uint32Array(r.buffer,0,s),c=0,l=0;c<s;c++)o[c]=i.charCodeAt(l++)|i.charCodeAt(l++)<<8|i.charCodeAt(l++)<<16|i.charCodeAt(l++)<<24;for(var h=3&a;h--;)r[l]=i.charCodeAt(l++);e(new Blob([r],{type:t||"image/png"}))}})},666:function(e,t,n){"use strict";n.d(t,{o:function(){return G},A:function(){return U}});var i=n(23),a=n(115),s=n.n(a),r=n(72),o=n.n(r),c=n(75),l=n.n(c),h=n(40),u=n.n(h),d=n(20),p=n.n(d),f=n(48),m=n(114),g=n.n(m),v=function(e){return function(t){t.preventDefault();var n=document.getElementById("popup-add-shortcut");null==n||n.remove(),e()}},y=function(e){var t=document.createElement("div");return t.innerHTML=g()(e).call(e),t.firstChild},A=function(){var e=(0,i.A)(p().mark((function e(t,n){var i,a,s;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=y('<div style="height: 50vh;width: 53vh;max-width: 95vw;position:absolute;background-color: rgba(31, 120, 136, 0.48);border-radius: 2vh;margin: auto;right: 0;left: 0;top: 0;bottom: 0;display: flex;flex-direction:column;justify-content:space-evenly;">\n            <p style="color:white;font-size:40px;text-align:center">Add shortcut for this game</p>\n            <p style="color:white;font-size:20px;text-align:center">This game wants to add a shortcut.</p>\n        </div>'),a=y('<button style="border: none;background-color: #1877f2;color: #fff;width: 90%;height: 50px;border-radius: 15px;margin-left: auto;margin-right: auto;font-size: 20px;cursor: pointer;">No</button>'),s=y('<button style="border: none;background-color: #1877f2;color: #fff;width: 90%;height: 50px;border-radius: 15px;margin-left: auto;margin-right: auto;font-size: 20px;cursor: pointer;">Yes</button>'),i&&a&&s||n({code:"CREATE_POPUP_ERROR",message:"Show popup failed"}),i.id="popup-add-shortcut",i.appendChild(a),i.appendChild(s),document.body.appendChild(i),a.addEventListener("click",v(n)),s.addEventListener("click",v(t));case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),E=function(){function e(){this.isFirstCall=!0}var t=e.prototype;return t.canCreateShortcutAsync=function(){var e=(0,i.A)(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isFirstCall){e.next=3;break}return this.isFirstCall=!1,e.abrupt("return",!0);case 3:return e.abrupt("return",!1);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.createShortcutAsync=function(){var e=(0,i.A)(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new(o())((function(e,t){A(e,t)})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e}(),T=E,S=function(e){return function(t){t.preventDefault();var n=document.getElementById("popup-subscribe-bots");null==n||n.remove(),e()}},b=function(e){var t=document.createElement("div");return t.innerHTML=g()(e).call(e),t.firstChild},P=function(){var e=(0,i.A)(p().mark((function e(t,n){var i,a,s;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=b('<div style="height: 50vh;width: 53vh;max-width: 95vw;position:absolute;background-color: rgba(31, 120, 136, 0.48);border-radius: 2vh;margin: auto;right: 0;left: 0;top: 0;bottom: 0;display: flex;flex-direction:column;justify-content:space-evenly;">\n            <p style="color:white;font-size:40px;text-align:center">Turn on messages from this game</p>\n            <p style="color:white;font-size:20px;text-align:center">This game wants to send messages, announcements and more.</p>\n        </div>'),a=b('<button style="border: none;background-color: #1877f2;color: #fff;width: 90%;height: 50px;border-radius: 15px;margin-left: auto;margin-right: auto;font-size: 20px;cursor: pointer;">Not Now</button>'),s=b('<button style="border: none;background-color: #1877f2;color: #fff;width: 90%;height: 50px;border-radius: 15px;margin-left: auto;margin-right: auto;font-size: 20px;cursor: pointer;">Turn On</button>'),i&&a&&s||n({code:"CREATE_POPUP_ERROR",message:"Show popup failed"}),i.id="popup-subscribe-bots",i.appendChild(a),i.appendChild(s),document.body.appendChild(i),a.addEventListener("click",S(n)),s.addEventListener("click",S(t));case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),C=function(){function e(){this.isFirstCall=!0}var t=e.prototype;return t.canSubscribeBotAsync=function(){var e=(0,i.A)(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isFirstCall){e.next=3;break}return this.isFirstCall=!1,e.abrupt("return",!0);case 3:return e.abrupt("return",!1);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.subscribeBotAsync=function(){var e=(0,i.A)(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new(o())((function(e,t){P(e,t)})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e}(),w=C,I=n(221),x=n(471),k=n(135),O=n(689),_=n(690),R=GameCore.Configs,D=R.Notification,M=R.AddShortcut,B=R.SubscribeBot,L=D.GameTitle,N=D.GameImage,G=function(){function e(){}var t=e.prototype;return t.createAsync=function(){var e=(0,i.A)(p().mark((function e(t){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,FBInstant.tournament.createAsync(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.shareAsync=function(){var e=(0,i.A)(p().mark((function e(t){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,FBInstant.tournament.shareAsync(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.joinAsync=function(){var e=(0,i.A)(p().mark((function e(t){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,FBInstant.tournament.joinAsync(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.postScoreAsync=function(){var e=(0,i.A)(p().mark((function e(t){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,FBInstant.tournament.postScoreAsync(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.getTournamentsAsync=function(){var e=(0,i.A)(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,FBInstant.tournament.getTournamentsAsync();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e}(),F=function(){function e(e){var t=this;this.facebook=void 0,this.supportedAPIs=[],this.mockSubscribeBot=void 0,this.mockAddShortcut=void 0,this.isCalledSubscribeBot=!1,this.isCalledCreateShortcut=!1,this.isCanPlayerMatch=null,this.isCanSubscribeBot=null,this.isCanCreateShortcut=null,this.checkSameContext=function(e){var t="SOLO"===e,n=FBInstant.context.getID();if(n===e)throw new _.A;if(t&&null===n)throw new _.A},this.switchAsync=function(){var e=(0,i.A)(p().mark((function e(n){var i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameCore.Utils.Valid.isValueChangeAsync(window.__fbGameReady,!0);case 2:return i="SOLO"===n,e.prev=3,t.checkSameContext(n),e.next=7,FBInstant.context.switchAsync(n,i);case 7:e.next=22;break;case 9:if(e.prev=9,e.t0=e.catch(3),!(e.t0 instanceof _.A)){e.next=13;break}return e.abrupt("return");case 13:if(e.t0 instanceof Object){e.next=15;break}return e.abrupt("return");case 15:if(GameCore.Utils.Object.hasOwn(e.t0,"code")){e.next=17;break}throw e.t0;case 17:if(!x.A.Device.isAndroid()||!i||"INVALID_PARAM"!==e.t0.code){e.next=20;break}return e.abrupt("return");case 20:if("SAME_CONTEXT"===e.t0.code){e.next=22;break}throw e.t0;case 22:case"end":return e.stop()}}),e,null,[[3,9]])})));return function(t){return e.apply(this,arguments)}}(),this.attemptToAddShortcut=(0,i.A)(p().mark((function e(){var n,i,a,s,r,o;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isCalledCreateShortcut){e.next=2;break}return e.abrupt("return",!1);case 2:if(e.prev=2,null===t.isCanCreateShortcut&&(M.UseMock?t.isCanCreateShortcut=!0:t.isCanCreateShortcut=t.isSupportedAPI("canCreateShortcutAsync")),t.isCanCreateShortcut){e.next=6;break}return e.abrupt("return",!1);case 6:return e.next=8,FBInstant.player.getDataAsync(["lastCallCreateShortcut"]);case 8:if(e.t0=e.sent,e.t0){e.next=11;break}e.t0={};case 11:if(n=e.t0,!(i=n.lastCallCreateShortcut||0)||!(0,k.eu)(+i)){e.next=15;break}return e.abrupt("return",!1);case 15:if(!M.UseMock){e.next=21;break}return e.next=18,t.mockAddShortcut.canCreateShortcutAsync();case 18:e.t1=e.sent,e.next=24;break;case 21:return e.next=23,FBInstant.canCreateShortcutAsync();case 23:e.t1=e.sent;case 24:if(a=e.t1,s=Date.now(),FBInstant.player.setDataAsync({lastCallCreateShortcut:s}),!a){e.next=49;break}return r=f.o.SHORTCUT_CREATE,o=f.o.SHORTCUT_CREATE_POPUP,t.isCalledCreateShortcut=!0,window.game.analytics.event(o),e.prev=31,e.next=34,GameCore.Utils.Valid.isValueChangeAsync(window.__fbGameReady,!0);case 34:if(!M.UseMock){e.next=39;break}return e.next=37,t.mockAddShortcut.createShortcutAsync();case 37:e.next=41;break;case 39:return e.next=41,FBInstant.createShortcutAsync();case 41:return window.game.analytics.event(r,{success:!0}),e.abrupt("return",!0);case 45:return e.prev=45,e.t2=e.catch(31),window.game.analytics.event(r,{success:!1}),e.abrupt("return",!1);case 49:return e.abrupt("return",!1);case 52:return e.prev=52,e.t3=e.catch(2),e.abrupt("return",!1);case 55:return e.prev=55,window.focus(),e.finish(55);case 58:case"end":return e.stop()}}),e,null,[[2,52,55,58],[31,45]])}))),this.attemptToSubscribeBot=(0,i.A)(p().mark((function e(){var n,i,a,s,r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isCalledSubscribeBot){e.next=2;break}return e.abrupt("return",!1);case 2:if(e.prev=2,null===t.isCanSubscribeBot&&(B.UseMock?t.isCanSubscribeBot=!0:t.isCanSubscribeBot=t.isSupportedAPI("player.canSubscribeBotAsync")),t.isCanSubscribeBot){e.next=6;break}return e.abrupt("return",!1);case 6:if(!B.UseMock){e.next=12;break}return e.next=9,t.mockSubscribeBot.canSubscribeBotAsync();case 9:e.t0=e.sent,e.next=15;break;case 12:return e.next=14,FBInstant.player.canSubscribeBotAsync();case 14:e.t0=e.sent;case 15:if(!e.t0){e.next=49;break}return e.next=19,FBInstant.player.getDataAsync(["lastCallSubscribeBot"]);case 19:if(e.t1=e.sent,e.t1){e.next=22;break}e.t1={};case 22:if(n=e.t1,!(i=n.lastCallSubscribeBot||0)||!(0,k.eu)(+i)){e.next=26;break}return e.abrupt("return",!1);case 26:return a=Date.now(),FBInstant.player.setDataAsync({lastCallSubscribeBot:a}),s=f.o.BOT_SUBSCRIBE,r=f.o.BOT_SUBSCRIBE_POPUP,t.isCalledSubscribeBot=!0,window.game.analytics.event(r),e.prev=31,e.next=34,GameCore.Utils.Valid.isValueChangeAsync(window.__fbGameReady,!0);case 34:if(!B.UseMock){e.next=39;break}return e.next=37,t.mockSubscribeBot.subscribeBotAsync();case 37:e.next=41;break;case 39:return e.next=41,FBInstant.player.subscribeBotAsync();case 41:return window.game.analytics.event(s,{success:!0}),e.abrupt("return",!0);case 45:return e.prev=45,e.t2=e.catch(31),window.game.analytics.event(s,{success:!1}),e.abrupt("return",!1);case 49:return e.abrupt("return",!1);case 52:return e.prev=52,e.t3=e.catch(2),e.abrupt("return",!1);case 55:return e.prev=55,window.focus(),e.finish(55);case 58:case"end":return e.stop()}}),e,null,[[2,52,55,58],[31,45]])}))),this.matchPlayerAsync=function(){var e=(0,i.A)(p().mark((function e(n,i,a){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,null===t.isCanPlayerMatch&&(t.isCanPlayerMatch=t.isSupportedAPI("checkCanPlayerMatchAsync")),t.isCanPlayerMatch){e.next=4;break}return e.abrupt("return",!1);case 4:return e.next=6,FBInstant.checkCanPlayerMatchAsync();case 6:if(e.sent){e.next=9;break}return e.abrupt("return",!1);case 9:return e.next=11,FBInstant.matchPlayerAsync(n,i,a);case 11:return e.abrupt("return",!0);case 14:return e.prev=14,e.t0=e.catch(0),e.abrupt("return",!1);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t,n,i){return e.apply(this,arguments)}}(),this.getTournamentAsync=(0,i.A)(p().mark((function e(){var n,i,a;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.facebook.tournament.getTournamentsAsync();case 2:if(n=e.sent,i=FBInstant.context.getID(),!(a=s()(n).call(n,(function(e){return e.getContextID()===i})))){e.next=7;break}return e.abrupt("return",o().resolve(a));case 7:return e.abrupt("return",o().reject(new O.A(null)));case 8:case"end":return e.stop()}}),e)}))),this.requestTournamentAsync=function(){var e=(0,i.A)(p().mark((function e(n){var i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.facebook.getTournamentAsync();case 3:return e.next=5,t.facebook.tournament.shareAsync({score:n});case 5:e.next=12;break;case 7:return e.prev=7,e.t0=e.catch(0),i=FBInstant.player.getName(),e.next=12,t.facebook.tournament.createAsync({initialScore:n,config:{tournamentTitle:i+"'s Tournament"}});case 12:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),this.isSupportedAPI=function(e){var n;return 0===t.supportedAPIs.length&&(t.supportedAPIs=FBInstant.getSupportedAPIs()),l()(n=t.supportedAPIs).call(n,e)},this.facebook=e,this.mockSubscribeBot=new w,this.mockAddShortcut=new T}var t=e.prototype;return t.chooseAsync=function(){var e=(0,i.A)(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,GameCore.Utils.Valid.isValueChangeAsync(window.__fbGameReady,!0);case 3:return e.next=5,FBInstant.context.chooseAsync({filters:["INCLUDE_EXISTING_CHALLENGES"],minSize:2,maxSize:2});case 5:case 15:return e.abrupt("return",FBInstant.context.getID());case 8:if(e.prev=8,e.t0=e.catch(0),!(e.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(e.t0,"code"))){e.next=16;break}e.t1=e.t0.code,e.next="USER_INPUT"===e.t1?14:"SAME_CONTEXT"===e.t1?15:16;break;case 14:return e.abrupt("return",!1);case 16:return e.abrupt("return",null);case 17:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),t.createAsync=function(){var e=(0,i.A)(p().mark((function e(t){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,GameCore.Utils.Valid.isValueChangeAsync(window.__fbGameReady,!0);case 3:return e.next=5,FBInstant.context.createAsync(""+t);case 5:case 15:return e.abrupt("return",FBInstant.context.getID());case 8:if(e.prev=8,e.t0=e.catch(0),!(e.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(e.t0,"code"))){e.next=16;break}e.t1=e.t0.code,e.next="USER_INPUT"===e.t1?14:"SAME_CONTEXT"===e.t1?15:16;break;case 14:return e.abrupt("return",!1);case 16:return e.abrupt("return",null);case 17:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),t.getPlayerToken=function(){var e=(0,i.A)(p().mark((function e(){var t;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,FBInstant.player.getSignedPlayerInfoAsync();case 2:return t=e.sent,e.abrupt("return",t.getSignature());case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t.getContextPlayers=function(){var e=(0,i.A)(p().mark((function e(t){var n,i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,FBInstant.context.getPlayersAsync();case 3:return n=e.sent,i=[],n.forEach((function(e){var n=e.getID();if(n!==t){var a=e.getName();if(a){var s=e.getPhoto();i.push(new I.A(n,a,s).toObject())}}})),e.abrupt("return",GameCore.Utils.Array.unique(i));case 9:return e.prev=9,e.t0=e.catch(0),console.warn("getPlayersAsync",{error:e.t0}),e.abrupt("return",[]);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),t.shareAsync=function(){var e=(0,i.A)(p().mark((function e(t){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,FBInstant.shareAsync(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.sendMessage=function(){var e=(0,i.A)(p().mark((function e(t){var n,i,a,s,r,o;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.data,i=t.image,a=t.template,s=t.cta,r=t.text,o={data:n,image:i,action:"CUSTOM",template:a,cta:s,text:r,strategy:"IMMEDIATE",notification:"PUSH"},e.next=4,FBInstant.updateAsync(o);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.inviteAsync=function(){var e=(0,i.A)(p().mark((function e(t){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,FBInstant.inviteAsync(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.postSessionScoreAsync=function(){var e=(0,i.A)(p().mark((function e(t){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,FBInstant.postSessionScoreAsync(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.getRewardedVideoAsync=function(){var e=(0,i.A)(p().mark((function e(t){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,FBInstant.getRewardedVideoAsync(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.getInterstitialAdAsync=function(){var e=(0,i.A)(p().mark((function e(t){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,FBInstant.getInterstitialAdAsync(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.getContextID=function(){return FBInstant.context.getID()},t.setLoadingProgress=function(e){FBInstant.setLoadingProgress(e)},t.injectTournament=function(){var e=(0,i.A)(p().mark((function e(){var t,i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!GameCore.Configs.Tournament.UseMock){e.next=11;break}return e.next=4,n.e(372).then(n.bind(n,685));case 4:t=e.sent.default,i=new t,this.facebook.tournament=i,FBInstant.getTournamentAsync=this.getTournamentAsync,FBInstant.tournament=i,e.next=12;break;case 11:this.facebook.tournament=new G;case 12:this.facebook.getTournamentAsync=function(){return FBInstant.getTournamentAsync()},this.facebook.requestTournamentAsync=this.requestTournamentAsync;case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.sendNotificationAsync=function(){var e=(0,i.A)(p().mark((function e(t){var n,i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("\ud83e\udd16 ? sendNotificationAsync",t),n=t.message,i=t.delayTime,e.next=5,FBInstant.graphApi.requestAsync("/me/notifications","POST",{message:u()({title:L,body:n,media_url:N}),schedule_interval:i});case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("\ud83e\udd16 ? sendNotificationAsync",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),e}(),U=F},668:function(e,t,n){"use strict";var i=n(23),a=n(4),s=n(20),r=n.n(s),o=n(48),c=n(485),l=GameCore.Utils.Object,h=GameCore.Ads,u=h.Types,d=h.Status,p=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).instance=void 0,i.placementId=void 0,i.instanceLoadFailedQueue=void 0,i.isHasTooManyInstancesError=void 0,i.instance=null,i.placementId=n,i.instanceLoadFailedQueue=[],i.isHasTooManyInstancesError=!1,i}(0,a.A)(t,e),t.setGame=function(e){self.game=e};var n=t.prototype;return n.loadAsync=function(){var e=(0,i.A)(r().mark((function e(){var t,n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.status===d.IDLE){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,this.status=d.LOADING,e.next=6,this.createInstanceByType(this.type);case 6:if(this.instance=e.sent,null!==this.instance){e.next=9;break}throw new GameCore.Ads.AdError("AD_INSTANCE_NOT_INITIATED","Ad instance didn't initiated.");case 9:return e.next=11,this.instance.loadAsync();case 11:this.status=d.FILLED,t=this.getSceneName(),this.type===u.INTERSTITIAL&&self.game.analytics.loadInterstitialAd(t),this.type===u.REWARDED&&self.game.analytics.loadRewardedVideoAd(t),e.next=25;break;case 17:throw e.prev=17,e.t0=e.catch(2),this.status=d.IDLE,this.instance&&this.instanceLoadFailedQueue.push(this.instance),this.instance=null,n=this.getSceneName(),self.game.analytics.loadAdFail(this.type,n,e.t0),e.t0;case 25:case"end":return e.stop()}}),e,this,[[2,17]])})));return function(){return e.apply(this,arguments)}}(),n.showAsync=function(){var e=(0,i.A)(r().mark((function e(){var t,n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=!1,e.prev=1,this.status===d.FILLED){e.next=4;break}throw new GameCore.Ads.AdError("AD_NOT_FILLED","Ads no fill.");case 4:if(this.status=d.SHOWING,null!==this.instance){e.next=7;break}throw new GameCore.Ads.AdError("AD_INSTANCE_NOT_INITIATED","Ad instance didn't initiated.");case 7:return this.isHasTooManyInstancesError&&self.game.analytics.event(o.o.MISSING_AD_SHOW,{ad_type:this.type}),e.next=10,this.instance.showAsync();case 10:t=!0,this.status=d.IDLE,this.instance=null,e.next=19;break;case 15:throw e.prev=15,e.t0=e.catch(1),e.t0 instanceof Object&&l.hasOwn(e.t0,"code")?("ADS_NOT_LOADED"===e.t0.code?this.status=d.FILLED:(this.status=d.IDLE,this.instance=null),"USER_INPUT"===e.t0.code&&(t=!0)):(this.status=d.IDLE,this.instance=null),e.t0;case 19:return e.prev=19,window.focus(),n=this.getSceneName(),t?(this.type===u.INTERSTITIAL&&self.game.analytics.showInterstitialAd(n),this.type===u.REWARDED&&self.game.analytics.showRewardedVideoAd(n)):self.game.analytics.showAdFail(this.type,n),e.finish(19);case 24:case"end":return e.stop()}}),e,this,[[1,15,19,24]])})));return function(){return e.apply(this,arguments)}}(),n.getStatus=function(){return this.status},n.createInstanceByType=function(){var e=(0,i.A)(r().mark((function e(t){var n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=self.game.facebook,e.prev=1,e.t0=t,e.next=e.t0===u.REWARDED?5:e.t0===u.INTERSTITIAL?8:11;break;case 5:return e.next=7,n.getRewardedVideoAsync(this.placementId);case 7:case 10:return e.abrupt("return",e.sent);case 8:return e.next=10,n.getInterstitialAdAsync(this.placementId);case 11:case 20:return e.abrupt("return",null);case 12:e.next=21;break;case 14:if(e.prev=14,e.t1=e.catch(1),!(e.t1 instanceof Object&&l.hasOwn(e.t1,"code"))){e.next=20;break}if("ADS_TOO_MANY_INSTANCES"!==e.t1.code){e.next=20;break}return this.isHasTooManyInstancesError=!0,e.abrupt("return",this.instanceLoadFailedQueue.shift()||null);case 21:case"end":return e.stop()}}),e,this,[[1,14]])})));return function(t){return e.apply(this,arguments)}}(),n.getSceneName=function(){try{var e=self.game.globalScene;return e instanceof c.A?e.getCurrentScene().scene.getSceneName():"unknown"}catch(t){return"unknown"}},t}(GameCore.Ads.AdInstance);t.A=p},136:function(e,t,n){"use strict";n.d(t,{J:function(){return T},b:function(){return S}});var i=n(57),a=n(23),s=n(20),r=n.n(s),o=n(40),c=n.n(o),l=n(4),h=n(30),u=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="BadRequest",i.message=t||"This request is bad",i.payload=n,i}return(0,l.A)(t,e),t}((0,h.A)(Error)),d=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="RequestTimeout",i.message=t||"This request is timeout",i.payload=n,i}return(0,l.A)(t,e),t}((0,h.A)(Error)),p=n(135),f=GameCore.Configs,m=f.AppId,g=f.Network,v=function(e){if(!e.ok)throw new u(null,{response:e})},y=function(){var e=window.game.auth.getToken();return{token:e,timeout:g.Timeout,headers:{Authorization:"Bearer "+e,"Content-Type":"application/json"}}},A=function(e,t,n,i){return(0,a.A)(r().mark((function a(){var s,o,l,h,p;return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,s=e+"/apps/"+m+"/"+t,o=new AbortController,n.signal=o.signal,l=setTimeout((function(){o.abort()}),n.timeout),GameCore.Utils.Valid.isObject(i)&&(n.body=c()(i)),a.next=8,fetch(s,n);case 8:return h=a.sent,clearTimeout(l),v(h),a.next=13,h.json();case 13:if(a.t0=a.sent,a.t0){a.next=16;break}a.t0={};case 16:return p=a.t0,a.abrupt("return",p);case 20:if(a.prev=20,a.t1=a.catch(0),!(a.t1 instanceof u)){a.next=24;break}return a.abrupt("return",null);case 24:if(!(a.t1 instanceof Object&&GameCore.Utils.Object.hasOwn(a.t1,"name"))){a.next=27;break}if("AbortError"!==a.t1.name){a.next=27;break}throw new d(null);case 27:throw a.t1;case 28:case"end":return a.stop()}}),a,null,[[0,20]])})))},E=function(){var e=(0,a.A)(r().mark((function e(t,n){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.abrupt("return",t());case 4:if(e.prev=4,e.t0=e.catch(0),!(e.t0 instanceof d&&n>0)){e.next=18;break}return e.prev=7,e.next=10,(0,p.QN)(600);case 10:return e.next=12,E(t,n-1);case 12:return e.abrupt("return",e.sent);case 15:return e.prev=15,e.t1=e.catch(7),e.abrupt("return",{});case 18:if(!(e.t0 instanceof d)){e.next=20;break}return e.abrupt("return",{});case 20:return console.warn(e.t0),e.abrupt("return",{});case 22:case"end":return e.stop()}}),e,null,[[0,4],[7,15]])})));return function(t,n){return e.apply(this,arguments)}}(),T=function(){var e=(0,a.A)(r().mark((function e(t,n,a,s){var o,c;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===n&&(n={}),void 0===s&&(s=g.Retries),e.prev=2,o=(0,i.A)({},y(),n,{method:"GET"}),c=A(a,t,o),e.next=7,E(c,s);case 7:return e.abrupt("return",e.sent);case 10:return e.prev=10,e.t0=e.catch(2),console.warn(e.t0),e.abrupt("return",{});case 14:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t,n,i,a){return e.apply(this,arguments)}}(),S=function(){var e=(0,a.A)(r().mark((function e(t,n,a,s,o){var c,l;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===a&&(a={}),void 0===o&&(o=g.Retries),e.prev=2,c=(0,i.A)({},y(),a,{method:"POST"}),l=A(s,t,c,n),e.next=7,E(l,o);case 7:return e.abrupt("return",e.sent);case 10:return e.prev=10,e.t0=e.catch(2),console.warn(e.t0),e.abrupt("return",{});case 14:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t,n,i,a,s){return e.apply(this,arguments)}}()},137:function(e,t,n){"use strict";n.d(t,{K6:function(){return r},N0:function(){return c},Y8:function(){return i},fD:function(){return o},ow:function(){return s},xn:function(){return a}});var i="CONTEXT_RECEIVED",a="CONTEXT_PROCESSED",s="CONTEXT_GAME_MODE_DETECTED",r="MESSAGES_SENT_UPDATE",o="MESSAGES_SENT_REMOVE",c="SCENE_KEY_UPDATE"},108:function(e,t,n){"use strict";n.d(t,{CS:function(){return o},ES:function(){return s},Hr:function(){return a},cD:function(){return i},xg:function(){return r}});var i="share_invite",a="journey_invite",s="tournament",r="challenge_friend_match",o="matching_group_match"},109:function(e,t,n){"use strict";n.d(t,{A:function(){return s}});var i=n(221),a=n(89),s=new i.A("10","Your Friend",a.A.AVATAR.FILE).toObject()},691:function(e,t,n){"use strict";var i=n(4),a=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidContextId",i.message=t||"This contextId is not valid",i.payload=n,i}return(0,i.A)(t,e),t}((0,n(30).A)(Error));t.A=a},690:function(e,t,n){"use strict";var i=n(4),a=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="SameContext",i.message=t||"The game attempted to perform a context switch into the current context.",i.code="SAME_CONTEXT",i.payload=n,i}return(0,i.A)(t,e),t}((0,n(30).A)(Error));t.A=a},689:function(e,t,n){"use strict";var i=n(4),a=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="TournamentNotFound",i.message=t||"A Tournament with current context was not found",i.payload=n,i.code="TOURNAMENT_NOT_FOUND",i}return(0,i.A)(t,e),t}((0,n(30).A)(Error));t.A=a},231:function(e,t,n){"use strict";var i=n(4),a=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="WideFrameRenderFail",i.message=t||"Wide frame render fail",i.payload=n,i}return(0,i.A)(t,e),t}((0,n(30).A)(Error));t.A=a},49:function(e,t,n){"use strict";var i=n(134),a=function(){function e(e,t){if(this.scene=void 0,this.config=void 0,this.isStarted=void 0,this.tween=void 0,!(t.targets.length<1)){this.buildConfig(e,t);var n=this.config.targets[0].scene;n&&(this.scene=n,this.isStarted=!1,this.tween=n.tweens.create(this.config))}}var t=e.prototype;return t.buildConfig=function(e,t){this.config=(0,i.h1)(e,t)},t.play=function(){this.tween&&(this.isStarted&&this.tween.hasStarted?this.restart():(this.tween.play(),this.isStarted=!0))},t.restart=function(){var e;null==(e=this.tween)||e.restart()},t.stop=function(){var e;null==(e=this.tween)||e.stop()},t.remove=function(){var e;null==(e=this.tween)||e.remove()},t.next=function(e){return this.tween?(this.tween.off(Phaser.Tweens.Events.TWEEN_COMPLETE,e),this.tween.once(Phaser.Tweens.Events.TWEEN_COMPLETE,e),this.tween):null},e}();t.A=a},495:function(e,t,n){"use strict";var i=n(4),a=n(49),s={targets:[],duration:600,ease:Phaser.Math.Easing.Linear,props:{angle:{from:0,to:360}}},r=function(e){function t(t){return e.call(this,s,t)||this}return(0,i.A)(t,e),t}(a.A);t.A=r},493:function(e,t,n){"use strict";var i=n(4),a=n(49),s={targets:[],duration:400,ease:n(141).A,props:{scale:"-=0.1"}},r=function(e){function t(t){return e.call(this,s,t)||this}return(0,i.A)(t,e),t}(a.A);t.A=r},669:function(e,t,n){"use strict";var i=n(4),a=n(49),s={targets:[],duration:400,ease:n(141).A,props:{scale:"+=0.1"}},r=function(e){function t(t){return e.call(this,s,t)||this}return(0,i.A)(t,e),t}(a.A);t.A=r},141:function(e,t,n){"use strict";var i=n(212),a=n.n(i)()(.48,1.57,.6,.83);t.A=a},486:function(e,t,n){"use strict";var i=n(4),a=n(49),s={targets:[],duration:600,ease:Phaser.Math.Easing.Cubic.Out,props:{alpha:{start:0,from:0,to:1}}},r=function(e){function t(t){return e.call(this,s,t)||this}return(0,i.A)(t,e),t}(a.A);t.A=r},670:function(e,t,n){"use strict";var i=n(4),a=n(49),s={targets:[],duration:600,ease:Phaser.Math.Easing.Back.Out,props:{y:{from:500,to:0}}},r=function(e){function t(t){return e.call(this,s,t)||this}return(0,i.A)(t,e),t}(a.A);t.A=r},487:function(e,t,n){"use strict";var i=n(4),a=n(49),s={targets:[],duration:600,ease:Phaser.Math.Easing.Quadratic.Out,props:{alpha:{start:1,from:1,to:0}}},r=function(e){function t(t){return e.call(this,s,t)||this}return(0,i.A)(t,e),t}(a.A);t.A=r},491:function(e,t,n){"use strict";var i=n(4),a=n(49),s={targets:[],duration:300,ease:n(141).A,props:{scale:{from:1.2,to:1}}},r=function(e){function t(t){return e.call(this,s,t)||this}return(0,i.A)(t,e),t}(a.A);t.A=r},492:function(e,t,n){"use strict";var i=n(4),a=n(49),s={targets:[],duration:600,ease:Phaser.Math.Easing.Back.Out,props:{y:{from:250,to:0},scale:{from:.9,to:1},alpha:{start:0,from:0,to:1}}},r=function(e){function t(t){return e.call(this,s,t)||this}return(0,i.A)(t,e),t}(a.A);t.A=r},224:function(e,t,n){"use strict";var i=n(107),a=n(50),s=n(4),r=n(48),o=n(493),c=n(140),l=n(142),h=n(47),u=function(e){function t(t,n,i,s,r,h){var u;return void 0===h&&(h=!1),(u=e.call(this,t)||this).useSound=!0,u.isClicked=!1,u.scaleUp=-1,u.scaleDown=-1,u.button=void 0,u.upAnimation=void 0,u.downAnimation=void 0,u.isUsePixelPerfect=!1,u.hitArea=void 0,u.hitZone=void 0,u.scaleDownPress=void 0,u.parentName=void 0,u.handelObjectDestroy=function(){u.scene&&u.scene.events.off(Phaser.Scenes.Events.SLEEP,u.handleSceneSleep)},u.handleSceneSleep=function(){u.scene&&u.scene.tweens.killTweensOf((0,a.A)(u))},u.handlePointerDown=function(){var e;u.isClicked||null!=(e=u.upAnimation)&&null!=(e=e.tween)&&e.isPlaying()||(u.isClicked=!0,u.runDownAnimation())},u.handleOnClick=function(e){return function(){var t,n;u.isClicked&&(null!=(t=u.upAnimation)&&null!=(t=t.tween)&&t.isPlaying()||(u.isClicked=!1,u.runUpAnimation(),null==(n=u.upAnimation)||null==(n=n.tween)||n.once(Phaser.Tweens.Events.TWEEN_COMPLETE,(function(){u.logButtonEvent(),u.addDebugData(),u.processCallback(e)}))))}},u.handlePointerOut=function(){var e;u.isClicked&&(null!=(e=u.upAnimation)&&null!=(e=e.tween)&&e.isPlaying()||(u.isClicked=!1,u.runUpAnimation()))},u.runDownAnimation=function(){var e;-1===u.scaleDown&&(u.scaleUp=u.scale,u.scaleDown=u.scaleDownPress),u.useSound&&u.scene.audio.playSound(l.A.BUTTON_CLICK),null==(e=u.downAnimation)||e.remove(),u.downAnimation=new o.A({targets:[(0,a.A)(u)],duration:150,props:{scale:u.scaleDown},onUpdate:function(){u.hitZone.scale=1/u.scale}}),u.downAnimation.play()},u.runUpAnimation=function(){var e;-1!==u.scaleUp&&(null==(e=u.upAnimation)||e.remove(),u.upAnimation=new o.A({targets:[(0,a.A)(u)],duration:150,props:{scale:u.scaleUp},onUpdate:function(){u.hitZone.scale=1/u.scale}}),u.upAnimation.play())},u.isUsePixelPerfect=h,u.setDepth(c.A.BUTTON),u.createButton(n,i,s,r),u.updateSize(),u.listenEvents(),u.scene.add.existing((0,a.A)(u)),u}(0,s.A)(t,e);var n=t.prototype;return n.listenEvents=function(){this.scene.events.on(Phaser.Scenes.Events.SLEEP,this.handleSceneSleep),this.once(Phaser.GameObjects.Events.DESTROY,this.handelObjectDestroy)},n.processCallback=function(e){var t,n,i;null==(t=this.upAnimation)||t.stop(),null==(n=this.downAnimation)||n.stop(),null==(i=this.scene)||i.tweens.killTweensOf(this),-1!==this.scaleUp&&this.setScale(this.scaleUp),e()},n.setDisabled=function(e){var t,n;e?(this.setAlpha(.5),null==(t=this.hitArea)||t.disableInteractive()):(this.setAlpha(1),null==(n=this.hitArea)||n.setInteractive())},n.createButton=function(e,t,n,i){this.button=this.scene.add.image(0,0,e,t),n&&i&&this.button.setWorldSize(n,i),this.scaleDownPress=this.scale-.1;var a=this.button,s=a.displayWidth,r=a.displayHeight;this.hitZone=this.scene.make.zone({displayWidth:s,displayHeight:r}),this.add([this.button,this.hitZone])},n.updateSize=function(){var e=this.button,t=e.width,n=e.height,i=t/100*10,a=n/100*10,s=i<10?i:10,r=a<10?a:10;this.setSize(t+s,n+r),this.hitZone.setSize(t+s,n+r)},n.addDebugData=function(){var e=this.getParentName(),t=this.name;(0,h.SJ)("ui-click",e+":"+t)},n.logButtonEvent=function(){var e=this.getParentName(),t=this.name;this.scene.analytics.event(r.o.BUTTON_CLICK,{button_name:t,screen_name:e})},n.getParentName=function(){if(this.parentName)return this.parentName;for(var e=this.parentContainer;e;){if(e instanceof GameCore.Screen){var t=e;return this.parentName=t.getScreenName(),this.parentName}e=e.parentContainer}return this.parentName=this.scene.getSceneName(),this.parentName},(0,i.A)(t,[{key:"onClick",set:function(e){this.isUsePixelPerfect?(this.hitArea=this.button,this.hitArea.setInteractive({useHandCursor:!0,pixelPerfect:!0})):(this.hitArea=this.hitZone,this.updateSize(),this.hitArea.setInteractive({useHandCursor:!0})),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.handlePointerDown),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,this.handleOnClick(e)),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,this.handlePointerOut)}},{key:"isUsePixelPerFect",get:function(){return this.isUsePixelPerfect}}]),t}(Phaser.GameObjects.Container);t.A=u},225:function(e,t,n){"use strict";var i=n(50),a=n(4),s=n(90),r=n(495),o=s.A.DEFAULT,c=o.KEY,l=o.FRAME,h=function(e){function t(t){var n;return(n=e.call(this,t,0,0,c,l.PRELOADER)||this).anim=void 0,n.runAnimation(),n.setWorldSize(80,80),n.scene.add.existing((0,i.A)(n)),n}(0,a.A)(t,e);var n=t.prototype;return n.runAnimation=function(){var e;null==(e=this.anim)||e.remove(),this.anim=new r.A({targets:[this],repeat:-1,duration:1200}),this.anim.play()},n.setVisible=function(t){return e.prototype.setVisible.call(this,t),t?this.runAnimation():this.anim.stop(),this},t}(Phaser.GameObjects.Image);t.A=h},494:function(e,t,n){"use strict";var i=n(50),a=n(4),s=n(90).A.GAMEPLAY,r=s.KEY,o=s.FRAME,c={settings:{top_left:o.SETTINGS_TOP_LEFT,top_middle:o.SETTINGS_TOP_MIDDLE,top_right:o.SETTINGS_TOP_RIGHT,middle_left:o.SETTINGS_MIDDLE_LEFT,middle_right:o.SETTINGS_MIDDLE_RIGHT,bottom_left:o.SETTINGS_BOTTOM_LEFT,bottom_middle:o.SETTINGS_BOTTOM_MIDDLE,bottom_right:o.SETTINGS_BOTTOM_RIGHT},panel:{top_left:o.PANEL_TOP_LEFT,top_middle:o.PANEL_TOP_MIDDLE,top_right:o.PANEL_TOP_RIGHT,middle_left:o.PANEL_MIDDLE_LEFT,middle_right:o.PANEL_MIDDLE_RIGHT,bottom_left:o.PANEL_BOTTOM_LEFT,bottom_middle:o.PANEL_BOTTOM_MIDDLE,bottom_right:o.PANEL_BOTTOM_RIGHT},board:{top_left:o.BOARD_TOP_LEFT,top_middle:o.BOARD_TOP_MIDDLE,top_right:o.BOARD_TOP_RIGHT,middle_left:o.BOARD_MIDDLE_LEFT,middle_right:o.BOARD_MIDDLE_RIGHT,bottom_left:o.BOARD_BOTTOM_LEFT,bottom_middle:o.BOARD_BOTTOM_MIDDLE,bottom_right:o.BOARD_BOTTOM_RIGHT}},l=function(e){function t(t,n,a,s,r,o){var c;return(c=e.call(this,t,n,a)||this).topLeft=void 0,c.topMiddle=void 0,c.topRight=void 0,c.middleLeft=void 0,c.middleMiddle=void 0,c.middleRight=void 0,c.bottomLeft=void 0,c.bottomMiddle=void 0,c.bottomRight=void 0,c._type=void 0,c._type=o,c.setSize(s,r),c.createPopup(),c.scene.add.existing((0,i.A)(c)),c}(0,a.A)(t,e);var n=t.prototype;return n.createPopup=function(){this.createPopupImages(),this.updatePopupSize(),this.alignPopupImages()},n.createPopupImages=function(){var e=o.PANEL_MIDDLE_MIDDLE,t=c[this._type],n=t.top_left,i=t.top_middle,a=t.top_right,s=t.bottom_left,l=t.bottom_middle,h=t.bottom_right,u=t.middle_left,d=t.middle_right;this.topLeft=this.scene.add.image(0,0,r,n),this.topMiddle=this.scene.add.image(0,0,r,i),this.topRight=this.scene.add.image(0,0,r,a),this.bottomLeft=this.scene.add.image(0,0,r,s),this.bottomMiddle=this.scene.add.image(0,0,r,l),this.bottomRight=this.scene.add.image(0,0,r,h),this.middleLeft=this.scene.add.image(0,0,r,u),this.middleMiddle=this.scene.add.image(0,0,r,e),this.middleRight=this.scene.add.image(0,0,r,d),this.add([this.topLeft,this.topMiddle,this.topRight]),this.add([this.bottomLeft,this.bottomMiddle,this.bottomRight]),this.add([this.middleLeft,this.middleMiddle,this.middleRight])},n.updatePopupSize=function(){this.topLeft.setWorldSize(47,25),this.topRight.setWorldSize(48,25),this.topMiddle.setWorldSize(this.width-this.topLeft.displayWidth-this.topRight.displayWidth,25),this.bottomLeft.setWorldSize(47,26),this.bottomRight.setWorldSize(48,26),this.bottomMiddle.setWorldSize(this.width-this.bottomLeft.displayWidth-this.bottomRight.displayWidth,26);var e=this.height-this.topLeft.displayHeight-this.bottomLeft.displayHeight;this.middleLeft.setWorldSize(47,e),this.middleRight.setWorldSize(48,e),this.middleMiddle.setWorldSize(this.width-this.middleLeft.displayWidth-this.middleRight.displayWidth,e)},n.alignPopupImages=function(){Phaser.Display.Align.In.Center(this.topLeft,this,-this.topMiddle.displayWidth/2-this.topLeft.displayWidth/2,-this.middleLeft.displayHeight/2-this.topLeft.displayHeight/2),Phaser.Display.Align.In.Center(this.topRight,this,this.topMiddle.displayWidth/2+this.topRight.displayWidth/2,-this.middleLeft.displayHeight/2-this.topLeft.displayHeight/2),Phaser.Display.Align.In.Center(this.topMiddle,this,0,-this.middleLeft.displayHeight/2-this.topLeft.displayHeight/2),Phaser.Display.Align.In.Center(this.bottomLeft,this,-this.bottomMiddle.displayWidth/2-this.bottomLeft.displayWidth/2,this.middleLeft.displayHeight/2+this.bottomLeft.displayHeight/2),Phaser.Display.Align.In.Center(this.bottomRight,this,this.bottomMiddle.displayWidth/2+this.bottomRight.displayWidth/2,this.middleLeft.displayHeight/2+this.bottomLeft.displayHeight/2),Phaser.Display.Align.In.Center(this.bottomMiddle,this,0,this.middleLeft.displayHeight/2+this.bottomLeft.displayHeight/2),Phaser.Display.Align.In.Center(this.middleLeft,this,-this.middleMiddle.displayWidth/2-this.middleLeft.displayWidth/2),Phaser.Display.Align.In.Center(this.middleMiddle,this),Phaser.Display.Align.In.Center(this.middleRight,this,this.middleMiddle.displayWidth/2+this.middleRight.displayWidth/2)},t}(Phaser.GameObjects.Container);t.A=l},674:function(e,t,n){"use strict";var i=n(57),a=n(107),s=n(50),r=n(4),o=n(73),c=n.n(o),l=n(148),h=n.n(l),u=n(74),d=n.n(u),p=n(91),f=n.n(p),m=n(51),g=n.n(m),v=n(112),y=n.n(v),A=n(93),E=n.n(A),T=n(145),S=n.n(T),b=n(140),P=n(472);function C(e,t){var n="undefined"!==typeof E()&&S()(e)||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){var n;if(!e)return;if("string"===typeof e)return w(e,t);var i=g()(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return y()(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return w(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var I=function(e){function t(t,n){var a,r;(r=e.call(this,t)||this).config=void 0,r.isEnable=void 0,r.minValue=void 0,r.maxValue=void 0,r.isScrolling=void 0,r.boundTop=void 0,r.boundBottom=void 0,r.maskGraphics=void 0,r.objects=void 0,r._value=0,r.velocity=0,r.isScrollingSmooth=void 0,r.lastScrollY=void 0,r.isScrollingBack=void 0,r.scrollingBackTo=void 0,r.lastScrollYCount=0,r.hitArea=void 0,r.onScrollEvents=[],r.updateObjectVisible=(0,P.s)((function(){for(var e=r.objects.getChildren(),t=0;t<e.length;t++){var n=e[t];n.y+n.height<-r.height||n.y-n.height>r.height?n.setVisible(!1):n.active&&n.setVisible(!0)}}),100,{maxWait:100}),r.update=function(e,t){r.isScrollingSmooth&&r.velocity&&r.scrollingSmooth(t),r.isScrollingBack&&r.scrollingBack(t)},r.checkReachBound=function(){return r.isReachTop()||r.isReachBottom()},r.onMouseScroll=(0,P.s)((function(e,t,n){if(r.isEnable){var i;if(r.isScrolling=!0,r.checkReachBound())return r.lastScrollY=c()(i=r.lastScrollY).call(i,(function(){return 0})),void(r.isScrolling=!1);r.stopScrollingBack(),r.startScrollSmooth(-n*r.scrollSmooth/15)}}),100,{isImmediate:!0,maxWait:100}),r.onTouchScroll=function(e){if(r.isEnable){r.velocity&&r.stopScrollSmooth(),r.stopScrollingBack(),r.isScrolling=!0;var t=r.scene.game.world.getZoomRatio(),n=e.position,i=e.prevPosition,a=(n.y-i.y)/t,s=r.height*r.maxScrollOver,o=1;if(r.lastScrollY[++r.lastScrollYCount%r.lastScrollY.length]=a,r.isReachTop()&&a>=0){var c=(s+(-r.minValue-r.value))/s;o=Math.min(o,c)}if(r.isReachBottom()&&a<=0){var l=(s-(-r.maxValue-r.value))/s;o=Math.min(o,l)}var h=a*o,u=r.maxScrollOver*r.height;r.value+h>-r.minValue+u?r.value=-r.minValue+u:r.value+h<-r.maxValue-u?r.value=-r.maxValue-u:r.value+=h,r.callOnScrollEvents(r.value,h)}},r.onTouchDown=function(){r.isEnable&&(r.velocity&&r.stopScrollSmooth(),r.stopScrollingBack())},r.onTouchEnd=function(){var e,t;if(r.input.enabled&&(r.isReachTop()&&(r.startScrollingBack(-r.minValue),r.stopScrollSmooth()),r.isReachBottom()&&(r.startScrollingBack(-r.maxValue),r.stopScrollSmooth()),r.isScrolling)){var n=h()(e=r.lastScrollY).call(e,(function(e,t){return e+t}))/r.lastScrollY.length;r.startScrollSmooth(n*r.scrollSmooth),r.lastScrollY=c()(t=r.lastScrollY).call(t,(function(){return 0}))}},r.config=(0,i.A)({marginTop:0,marginBottom:0,maxScrollOver:.15,acceleration:.05,scrollSmooth:45,scrollingBackRate:5},n);var o=n.width,l=n.height;return r.isEnable=!1,r.minValue=-r.config.marginTop,r.maxValue=r.minValue,r.lastScrollY=d()(a=new Array(3)).call(a,0),r.setSize(o,l),r.createGroup(),r.createInput(),r.createEvents(),r.scene.add.existing((0,s.A)(r)),r}(0,r.A)(t,e);var n=t.prototype;return n.onScroll=function(e){this.onScrollEvents.push(e)},n.gotoTop=function(){this.value=this.config.marginTop},n.reset=function(){this.minValue=-this.config.marginTop,this.maxValue=this.minValue,this.isScrolling=!1,this.isScrollingBack=!1,this.isScrollingSmooth=!1,this.gotoTop(),this.setEnable(!1)},n.createDebug=function(){var e=this.drawDebugBox(16711680,.8);console.log(null==e?void 0:e.x,null==e?void 0:e.y,null==e?void 0:e.displayWidth,null==e?void 0:e.displayHeight)},n.setEnable=function(e){this.isEnable=e,e?this.setInteractive({draggable:!0,useHandCursor:!0}):this.disableInteractive()},n.addItem=function(e){this.addAt(e),this.objects.add(e);var t=e.y,n=e.height,i=t-n/2-this.marginTop+this.height/2,a=t+n/2+this.marginBottom-this.height/2;this.minValue=Math.min(this.minValue,i,0),this.maxValue=Math.max(this.maxValue,a,0),this.updateObjectVisible()},n.addItems=function(e){var t=this;this.addAt(e),this.objects.addMultiple(e);var n=c()(e).call(e,(function(e){return e.y-e.height/2-t.marginBottom+t.height/2})),i=c()(e).call(e,(function(e){return e.y+e.height/2+t.marginBottom-t.height/2}));this.minValue=Math.min(this.minValue,Math.max.apply(Math,n),0),this.maxValue=Math.max(this.maxValue,Math.max.apply(Math,i),0),this.updateObjectVisible()},n.clearItem=function(){this.objects.clear(!0,!0),this.reset()},n.getChildren=function(){var e;return f()(e=this.objects.getChildren()).call(e,(function(e){return e.active}))},n.createBound=function(e,t,n,i){this.boundTop=this.scene.make.image({key:e,frame:t}),this.boundBottom=this.scene.make.image({key:e,frame:t}),this.boundTop.setTint(i),this.boundBottom.setTint(i),this.boundTop.setAlpha(1,1,0,0),this.boundBottom.setAlpha(0,0,1,1),this.boundTop.setDepth(b.A.PRIORITY),this.boundBottom.setDepth(b.A.PRIORITY);var a=this.width,s=n,r=this.getWorldPosition(),o=r.x,c=r.y;this.boundTop.setDisplaySize(a,s),this.boundBottom.setDisplaySize(a,s),this.boundTop.setY(-this.displayHeight/2+s/2+c-this.y-1),this.boundBottom.setY(this.displayHeight/2-s/2+c-this.y+1),this.boundTop.setX(o-this.x),this.boundBottom.setX(o-this.x),this.add([this.boundTop,this.boundBottom])},n.createMask=function(){var e;null==(e=this.maskGraphics)||e.destroy(),this.maskGraphics=this.scene.make.graphics({fillStyle:{color:255,alpha:1},visible:!0}),this.maskGraphics.setName("MaskGraphics");var t=this.width,n=this.height;this.maskGraphics.fillRoundedRect(0-t/2,0-n/2,t,n,0),this.setMask(this.maskGraphics.createGeometryMask()),this.scene.events.off(Phaser.Scenes.Events.UPDATE,this.updateMask,this),this.scene.events.on(Phaser.Scenes.Events.UPDATE,this.updateMask,this)},n.updateMask=function(){var e=this.getWorldPosition(),t=e.x,n=e.y;this.maskGraphics.setPosition(t,n)},n.createGroup=function(){this.objects=this.scene.make.group({})},n.updateObject=function(e){this.objects.incY(e),this.updateObjectVisible()},n.createInput=function(){this.setInteractive({draggable:!0,useHandCursor:!0}),this.on(Phaser.Input.Events.POINTER_WHEEL,this.onMouseScroll),this.on(Phaser.Input.Events.GAMEOBJECT_DRAG,this.onTouchScroll),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.onTouchDown),this.scene.input.on(Phaser.Input.Events.POINTER_UP,this.onTouchEnd,this)},n.createEvents=function(){this.scene.events.on(Phaser.Scenes.Events.UPDATE,this.update)},n.callOnScrollEvents=function(e,t){for(var n,i=C(this.onScrollEvents);!(n=i()).done;){(0,n.value)(this,e,t)}},n.scrollingBack=function(e){var t=(this.scrollingBackTo-this.value)*e*this.scrollingBackRate/1e3;this.value+=t,Math.abs(this.scrollingBackTo-this.value)<.5&&(this.value=this.scrollingBackTo,this.stopScrollingBack()),this.callOnScrollEvents(this.value,t)},n.startScrollingBack=function(e){this.isScrollingBack=!0,this.scrollingBackTo=e},n.stopScrollingBack=function(){this.isScrollingBack=!1},n.scrollingSmooth=function(e){var t=this.velocity*e/1e3;this.value+=t;var n=Math.abs(this.velocity)/this.velocity;this.isReachTop()&&(this.startScrollingBack(-this.minValue),this.stopScrollSmooth()),this.isReachBottom()&&(this.startScrollingBack(-this.maxValue),this.stopScrollSmooth()),this.callOnScrollEvents(this.value,t),Math.abs(this.velocity)<1?this.stopScrollSmooth():this.velocity-=Math.abs(this.velocity)*this.acceleration*n},n.startScrollSmooth=function(e){this.isScrollingSmooth=!0,e&&(e*this.velocity>0?this.velocity+=e:this.velocity=e)},n.stopScrollSmooth=function(){this.isScrollingSmooth=!1,this.isScrolling=!1,this.velocity=0,this.callOnScrollEvents(this.value,0)},n.isReachTop=function(){return this.value>-this.minValue},n.isReachBottom=function(){return-this.value>this.maxValue},(0,a.A)(t,[{key:"marginTop",get:function(){return this.config.marginTop}},{key:"marginBottom",get:function(){return this.config.marginBottom}},{key:"acceleration",get:function(){return this.config.acceleration}},{key:"maxScrollOver",get:function(){return this.config.maxScrollOver}},{key:"scrollSmooth",get:function(){return this.config.scrollSmooth}},{key:"scrollingBackRate",get:function(){return this.config.scrollingBackRate}},{key:"value",get:function(){return this._value},set:function(e){var t=e-this._value;this._value=e,this.updateObject(t)}}]),t}(Phaser.GameObjects.Container);t.A=I},140:function(e,t){"use strict";t.A={BACKGROUND:1,FIREWORKS:5,ITEM:10,LOGO:15,BUTTON:20,TILE:25,TEXT:30,ENCOURAGING:31,EFFECT:32,MESSAGE:33,POPUP:999,PRIORITY:80,DEBUG:90,DICE:99,PIECE:99,ON_TOP:1e4}},223:function(e,t){"use strict";t.A={FONT_TEXT_WHITE:{KEY:"font-text-white"},FONT_FAMILY:"MikadoBold",FONT_FAMILY_ARIAL:"Arial",FONT_NUMBER:{KEY:"font-number",TEXTURE:"./assets/fonts/number.png",DATA:"./assets/fonts/number.xml"},MIKADO:{KEY:"font-mikado"},MIKADO_RED_STROKE:{KEY:"font-mikado-red-stroke"},MIKADO_GREEN_STROKE:{KEY:"font-mikado-green-stroke"},MIKADO_DARK_GRAY:{KEY:"font-mikado-dark-gray"},MIKADO_BLUE_STROKE:{KEY:"font-mikado-blue-stroke"},MIKADO_YELLOW:{KEY:"font-mikado-yellow"},MIKADO_YELLOW_BIG_NUMBER:{KEY:"font-mikado-yellow-big-number"},MIKADO_WHITE_MEDIUM_NUMBER:{KEY:"font-mikado-medium-number"},MIKADO_WHITE:{KEY:"font-mikado-white"}}},89:function(e,t,n){"use strict";var i=(0,n(475).K)(),a={AVATAR:{KEY:"avatar",FILE:"./assets/images/others/avatar.png",CONFIG:{}},AVATAR_ADD:{KEY:"avatar-add",FILE:"./assets/images/others/avatar-add.png",CONFIG:{}},ICON_EARTH:{KEY:"icon-earth",FILE:"./assets/images/others/icon-earth.png",CONFIG:{}},ICON_RANDOM:{KEY:"icon-random",FILE:"./assets/images/others/icon-random.png",CONFIG:{}},ICON_CROWN:{KEY:"icon-crown",FILE:"./assets/images/others/crown-icon.png",CONFIG:{}},BACKGROUND:{KEY:"background",KEY_LANDSCAPE:"background-landscape",KEY_PORTRAIT:"background-portrait",FILE_LANDSCAPE:"./assets/images/"+i+"x/background-landscape.jpg",FILE_PORTRAIT:"./assets/images/"+i+"x/background-portrait.jpg",CONFIG:{}},BACKGROUND_DARK:{KEY:"background-dark",KEY_LANDSCAPE:"background-dark-landscape",KEY_PORTRAIT:"background-dark-portrait",FILE_LANDSCAPE:"./assets/images/"+i+"x/background-dark-landscape.jpg",FILE_PORTRAIT:"./assets/images/"+i+"x/background-dark-portrait.jpg",CONFIG:{}},BACKGROUND_TAB:{KEY:"background-tab",FILE:"./assets/images/background.jpg",CONFIG:{}},IMAGES:{KEY:["image-1","image-2","image-3","image-4","image-5"],FILE:["./assets/images/others/images/image-1.png","./assets/images/others/images/image-2.png","./assets/images/others/images/image-3.png","./assets/images/others/images/image-4.png","./assets/images/others/images/image-5.png"]}};t.A=a},90:function(e,t,n){"use strict";var i=n(57),a=(0,n(475).K)(),s={TUTORIAL:{KEY:"tutorial-resources",TEXTURE:"./assets/textures/"+a+"x/tutorial-resources.png",JSON:"./assets/textures/"+a+"x/tutorial-resources.json",FRAME:{HAND:"hand",BLANK:"blank",BUTTON_BROWN:"brown"}},DEFAULT:{KEY:"default-resources",TEXTURE_32BIT:["./assets/textures/"+a+"x/default-resources-32bit-0.png"],JSON:"./assets/textures/"+a+"x/default-resources.json",URL:"./assets/textures/"+a+"x/",FRAME:{BLANK:"blank",LOGO:"logo",GLARE:"glare",BG_CIRCLE_BLACK:"circle-black",BG_CIRCLE_YELLOW:"circle-yellow",BG_FOOTER:"bg-footer",CORAL_LEFT:"coral-left",CORAL_RIGHT:"coral-right",PRELOADER:"preloader/dual-ring",AVATAR_BORDER:"avatar/border",AVATAR_BORDER_2:"avatar/avatar-border",AVATAR_BACKGROUND:"avatar/background",AVATAR:"avatar/avatar",BORDER_AVATAR:"avatar/border-avatar",ICON_ADS:"icons/icon-ads",ICON_DASH:"icons/dash",ICON_NEXT:"icons/icon-next",ICON_PAUSE:"icons/icon-pause",ICON_RESTART:"icons/icon-restart",ICON_CUP:"icons/icon-cup",ICON_SETTINGS_MUSIC:"icons/icon-settings-music",ICON_SETTINGS_SOUND:"icons/icon-settings-sound",ICON_SETTINGS_VIBRATE:"icons/icon-settings-vibrate",ICON_SHARE:"icons/icon-share",ICON_TOURNAMENT_OFF:"icons/icon-tournament-deactive",ICON_TOURNAMENT_ON:"icons/icon-tournament-activepng",ICON_HOME_OFF:"icons/icon-home-deactive",ICON_HOME_ON:"icons/icon-home-active",ICON_JOURNEY_OFF:"icons/icon-journey-deactive",ICON_JOURNEY_ON:"icons/icon-journey-active",ICON_CLOCK:"icons/clock",ICON_SETTINGS:"icons/settings",CIRCLE_PASSED:"icons/circle-passed",CIRCLE_READY:"icons/circle-ready",CIRCLE_WAITING:"icons/circle-waiting",BUTTON_CLOSE:"icons/icon-close",BUTTON_SETTING:"buttons/button-setting",BUTTON_GREEN_LONG_RECTANGLE:"buttons/button-green-long-rectangle",BUTTON_RED_RECTANGLE:"buttons/button-red-rectangle",BUTTON_RED_SQUARE:"buttons/button-red-square",BUTTON_BLUE_SQUARE:"buttons/button-blue-square",BUTTON_GREEN:"buttons/button-green",BUTTON_RED:"buttons/button-red",BUTTON_YES:"buttons/button-yes",BUTTON_NO:"buttons/button-no",BUTTON_TOURNAMENT:"buttons/button-tournament",BUTTON_TAB:"buttons/button-tab",BUTTON_SETTINGS:"buttons/button-settings",BUTTON_CONTINUE:"buttons/button-continue",TEXT_NO_THANK:"texts/no-thanks",TEXT_SECOND_CHANGE:"texts/second-chance",TEXT_CONTINUE:"texts/continue",TEXT_OUT_OF_MOVES:"texts/out-of-moves",TEXT_JOURNEY:"texts/journey",TEXT_PLAY:"texts/play",TEXT_HOME_ON:"texts/home-on",TEXT_HOME_OFF:"texts/home-off",TEXT_JOURNEY_ON:"texts/journey-on",TEXT_JOURNEY_OFF:"texts/journey-off",TEXT_TOURNAMENTS_ON:"texts/tournaments-on",TEXT_TOURNAMENTS_OFF:"texts/tournaments-off",TEXT_TOURNAMENTS:"texts/tournaments",TEXT_WELL_DONE:"texts/well-done",PANEL_LEVEL:"panel/level",PANEL_MISSION:"panel/mission",PANEL_MISSION_TARGET:"panel/mission-target",SETTINGS_TOP_LEFT:"settings/top-left",SETTINGS_TOP_MIDDLE:"settings/top-middle",SETTINGS_TOP_RIGHT:"settings/top-right",SETTINGS_MIDDLE_LEFT:"settings/middle-left",SETTINGS_MIDDLE_MIDDLE:"settings/middle-middle",SETTINGS_MIDDLE_RIGHT:"settings/middle-right",SETTINGS_BOTTOM_LEFT:"settings/bottom-left",SETTINGS_BOTTOM_MIDDLE:"settings/bottom-middle",SETTINGS_BOTTOM_RIGHT:"settings/bottom-right",BOARD_TOP_LEFT:"board/top-left",BOARD_TOP_MIDDLE:"board/top-middle",BOARD_TOP_RIGHT:"board/top-right",BOARD_MIDDLE_LEFT:"board/middle-left",BOARD_MIDDLE_MIDDLE:"board/middle-middle",BOARD_MIDDLE_RIGHT:"board/middle-right",BOARD_BOTTOM_LEFT:"board/bottom-left",BOARD_BOTTOM_MIDDLE:"board/bottom-middle",BOARD_BOTTOM_RIGHT:"board/bottom-right",RANK_1:"tournament/1",RANK_2:"tournament/2",RANK_3:"tournament/3",LINE:"tournament/line",TAB:"tournament/tab",TIME_PANEL:"tournament/time-panel",TOP_PANEL:"top-panel",PROGRESS_BOT_LEFT:"road/progress-bot-left",PROGRESS_BOT_RIGHT:"road/progress-bot-right",PROGRESS_HORIZONTAL:"road/progress-horizontal",PROGRESS_TOP_LEFT:"road/progress-top-left",PROGRESS_TOP_RIGHT:"road/progress-top-right",PROGRESS_VERTICAL:"road/progress-vertical",ROAD_BOT_LEFT:"road/road-bot-left",ROAD_BOT_RIGHT:"road/road-bot-right",ROAD_HORIZONTAL:"road/road-horizontal",ROAD_TOP_LEFT:"road/road-top-left",ROAD_TOP_RIGHT:"road/road-top-right",ROAD_VERTICAL:"road/road-vertical",ROAD_BG_IMAGE:"road/bg-image",POPUP_TOP:"popup/top",POPUP_MID:"popup/middle",POPUP_BOTTOM:"popup/bottom",TOUR_ICON_CREATE:"icons/icon-create",TOUR_ICON_PLAYER:"icons/icon-player",TOUR_BTN_CREATE:"tournament/button-create",TOUR_BTN_JOIN:"tournament/button-join",TOUR_CUP:"tournament/cup",TOUR_INFO_BG:"tournament/info-bg",TOUR_PLAYER_INFO_BG:"tournament/player-info-bg",TOUR_BLOCK_BOTTOM:"tournament/tour-block-bottom",TOUR_BLOCK_TOP:"tournament/tour-block-top",TOUR_BLOCK_MIDDLE_LEFT:"tournament/tour-block-middle-left",TOUR_BLOCK_MIDDLE_RIGHT:"tournament/tour-block-middle-right",TOUR_RESULT_BTN_GREEN:"tournament-result/button-green",TOUR_RESULT_BTN_RED:"tournament-result/button-red",TOUR_RESULT_BTN_BLUE:"tournament-result/button-blue",TOUR_RESULT_LEADER_BAR:"tournament-result/leader-bar",TOUR_RESULT_LEADER_BAR_HIGHLIGHT:"tournament-result/leader-bar-highlight",TOUR_RESULT_GOLD:"tournament-result/gold",TOUR_RESULT_SILVER:"tournament-result/silver",TOUR_RESULT_BRONZE:"tournament-result/bronze",TOUR_RESULT_CUP_SMALL:"tournament-result/cup-small",TOUR_RESULT_TITLE_PANEL:"tournament-result/title-panel",TOUR_RESULT_CONGRATULATIONS:"tournament-result/congratulations",TOUR_RESULT_AVATAR_BORDER:"tournament-result/avatar-border",SETTINGS_BLUE_BTN:"setting-screen/button-blue",SETTINGS_RED_LONG_BTN:"setting-screen/button-red-long"}},EFFECTS:{KEY:"effects-resources",PATH:"./assets/textures/"+a+"x/effects-resources.png",JSON:"./assets/textures/"+a+"x/effects-resources.json",FRAME:{BLANK:"blank",GLOW_CIRCLE:"glow-circle",GLARE_CROSS:"glare-cross",DUST:"dust",SMOKE:"smoke",DUST_YELLOW:"dust-yellow",FX_STAR:"star",FX_ROCK:"rock",FX_ROCK_1:"rock-1",FX_ROCK_2:"rock-2",FX_ROCK_3:"rock-3",FX_ROCK_4:"rock-4",FX_ROCK_5:"rock-5",FX_STAR_YELLOW:"star-yellow",PREFIX_RED:"rocks/red-",PREFIX_BLUE:"rocks/blue-",PREFIX_GREEN:"rocks/green-",PREFIX_PINK:"rocks/pink-",PREFIX_VIOLET:"rocks/violet-",PREFIX_YELLOW:"rocks/yellow-",FX_CONFETTI_SMALL_1:"confetti/small-1",FX_CONFETTI_SMALL_2:"confetti/small-2",FX_CONFETTI_SMALL_3:"confetti/small-3",FX_CONFETTI_SMALL_4:"confetti/small-4",FX_CONFETTI_SMALL_5:"confetti/small-5",FX_CONFETTI_HEXAGON:"confetti/hexagon-",FX_CONFETTI_RIBBON:"ribbon",TEXT_COOL:"text/text-cool",TEXT_PERFECT:"text/text-perfect",TEXT_EXCELLENT:"text/text-excellent",TEXT_UNBELIEVABLE:"text/text-unbelievable",FX_COMET:"comet",FX_SPARK:"spark",FX_CIRCLE:"circle",FX_CIRCLE_LIGHT:"circle-light",FX_GLOW_LIGHT:"glow-light",FX_GLOW_SMALL:"glow-small",FX_STAR_WHITE:"star-white",FX_FIREWORKS_SMALL:"fireworks/small",FX_FIREWORKS_BIG_0:"fireworks/big-explosive-0",FX_FIREWORKS_BIG_1:"fireworks/big-explosive-1",FX_FIREWORKS_SOAR_LINE:"fireworks/soar-line",FX_FIREWORKS_SOAR_CIRCLE:"fireworks/soar-circle",PREFIX_ANIMATION_RIBBON_CONFETTI_A:"ribbon/falling-confetti/confetti-a/confetti-a-",PREFIX_ANIMATION_RIBBON_CONFETTI_B:"ribbon/falling-confetti/confetti-b/confetti-b-",PREFIX_ANIMATION_RIBBON_CONFETTI_C:"ribbon/falling-confetti/confetti-c/confetti-c-",PREFIX_ANIMATION_RIBBON_CONFETTI_D:"ribbon/falling-confetti/confetti-d/confetti-d-",ANIMATION_STAR_X:"star-x/star-",ANIMATION_STAR_Y:"star-y/star-",BUBBLE_WATER:"bubble-water"}},ANIMATION_SCENE:{KEY:"effects-resources",PATH:"./assets/textures/"+a+"x/",JSON:"./assets/textures/"+a+"x/animation-scene-resources.json",FRAME:{BLANK:"blank",COIN:"coins/coin",COIN_SMALL:"coins/coin-small",COIN_SMALL_GREY:"coins/coin-small-grey",FX_SPARK_YELLOW:"yellow-spark",FX_CONFETTI_RIBBON:"ribbon/ribbon"}},GAMEPLAY:{KEY:"gameplay-resources",TEXTURE_32BIT:["./assets/textures/"+a+"x/gameplay-resources-32-0.png"],JSON:"./assets/textures/"+a+"x/gameplay-resources.json",URL:"./assets/textures/"+a+"x/",FRAME:{BLANK:"blank",MASK:"mask",DUST:"dust",CUP_GLARE:"cup-glare",HAND:"hand",AVATAR:"avatars/avatar",AVATAR_BORDER:"avatars/border",AVATAR_BACKGROUND:"avatars/avatar-bg",AVATAR_FRAME:"avatars/avatar-frame",ICON_ADD_FRIEND:"icons/icon-add-friend",ICON_CROWN:"icons/icon-crown",ICON_CUP:"icons/icon-cup",ICON_GLOBAL:"icons/icon-global",ICON_NEXT:"icons/icon-next",ICON_PLUS:"icons/icon-plus",ICON_RESTART:"icons/icon-restart",ICON_SHARE:"icons/icon-share",ICON_TILTED_CROWN:"icons/icon-tilted-crown",ICON_CHECK:"icons/check",ICON_JOURNEY:"icons/journey",TEXT_GAME_OVER:"text/game-over",TEXT_WAITING:"text/waiting",TEXT_YOU_WIN:"text/you-win",TEXT_YOU_DRAW:"text/you-draw",TEXT_YOU_LOSE:"text/you-lose",TEXT_SCORE:"text/score",TEXT_BEST:"text/best",TEXT_VS:"text/vs",TEXT_NEW_GAME:"text/new-game",TEXT_RETRY:"text/retry",TEXT_CONTINUE:"text/continue",TEXT_FAILED:"text/failed",TEXT_LEVEL:"text/level",TEXT_COMPLETED:"text/completed",BUTTON_BLACK:"buttons/button-black",BUTTON_GREEN_LONG_RECTANGLE:"buttons/button-green-long-rectangle",BUTTON_RED_LONG_RECTANGLE:"buttons/button-red-long-rectangle",BUTTON_BLUE_SQUARE:"buttons/button-blue-square",BUTTON_GREEN_SQUARE:"buttons/button-green-square",BUTTON_GREEN_RECTANGLE:"buttons/button-green-rectangle",BUTTON_PINK_RECTANGLE:"buttons/button-pink-rectangle",BUTTON_RED_RECTANGLE:"buttons/button-red-rectangle",BUTTON_BLUE_SMALL:"buttons/button-blue-small",BUTTON_RED_SMALL:"buttons/button-red-small",CELL:"board/cell",PANEL_TOP:"panel-top",PANEL_BOTTOM:"panel-bottom",PANEL_SCORE:"panel-score",PANEL_YOUR_SCORE:"panel-your-score",PANEL_BEST_SCORE:"panel-best-score",PANEL_TOP_LEFT:"panel/top-left",PANEL_TOP_MIDDLE:"panel/top-middle",PANEL_TOP_RIGHT:"panel/top-right",PANEL_MIDDLE_LEFT:"panel/middle-left",PANEL_MIDDLE_MIDDLE:"panel/middle-middle",PANEL_MIDDLE_RIGHT:"panel/middle-right",PANEL_BOTTOM_LEFT:"panel/bottom-left",PANEL_BOTTOM_MIDDLE:"panel/bottom-middle",PANEL_BOTTOM_RIGHT:"panel/bottom-right",SETTINGS_TOP_LEFT:"settings/top-left",SETTINGS_TOP_MIDDLE:"settings/top-middle",SETTINGS_TOP_RIGHT:"settings/top-right",SETTINGS_MIDDLE_LEFT:"settings/middle-left",SETTINGS_MIDDLE_MIDDLE:"settings/middle-middle",SETTINGS_MIDDLE_RIGHT:"settings/middle-right",SETTINGS_BOTTOM_LEFT:"settings/bottom-left",SETTINGS_BOTTOM_MIDDLE:"settings/bottom-middle",SETTINGS_BOTTOM_RIGHT:"settings/bottom-right",BOARD_TOP_LEFT:"board/top-left",BOARD_TOP_MIDDLE:"board/top-middle",BOARD_TOP_RIGHT:"board/top-right",BOARD_MIDDLE_LEFT:"board/middle-left",BOARD_MIDDLE_MIDDLE:"board/middle-middle",BOARD_MIDDLE_RIGHT:"board/middle-right",BOARD_BOTTOM_LEFT:"board/bottom-left",BOARD_BOTTOM_MIDDLE:"board/bottom-middle",BOARD_BOTTOM_RIGHT:"board/bottom-right"}},GAMEPLAY_32:{KEY:"gameplay-32-resources",TEXTURE:"./assets/textures/"+a+"x/gameplay-32-resources.png",JSON:"./assets/textures/"+a+"x/gameplay-32-resources.json",FRAME:{CELL:"gem/block",GEM:"gem/gem",GEM_TRANSPARENT:"gem/gem_transparent",GEM_HIGHT_LIGHT:"gem/highlight",GEM_BLUE:"gem/diamond/gem-blue",GEM_GREEN:"gem/diamond/gem-green",GEM_ORANGE:"gem/diamond/gem-orange",GEM_PINK:"gem/diamond/gem-pink",GEM_RED:"gem/diamond/gem-red",GEM_VIOLET:"gem/diamond/gem-violet",GEM_DISABLE:"gem/diamond/gem-disable",GEM_BLUE_TARGET:"gem/diamond/gem-blue-target",GEM_GREEN_TARGET:"gem/diamond/gem-green-target",GEM_ORANGE_TARGET:"gem/diamond/gem-orange-target",GEM_PINK_TARGET:"gem/diamond/gem-pink-target",GEM_RED_TARGET:"gem/diamond/gem-red-target",GEM_VIOLET_TARGET:"gem/diamond/gem-violet-target",GEM_GREEN_SMALL:"gem/diamond/gem-green-small",GEM_ORANGE_SMALL:"gem/diamond/gem-orange-small",GEM_PINK_SMALL:"gem/diamond/gem-pink-small",GEM_RED_SMALL:"gem/diamond/gem-red-small",GEM_VIOLET_SMALL:"gem/diamond/gem-violet-small",GEM_BLUE_SMALL:"gem/diamond/gem-blue-small",GEM_DISABLE_SMALL:"gem/diamond/gem-disable-small",DIAMOND_BLUE:"gem/diamond/diamond-blue",DIAMOND_PURPLE:"gem/diamond/diamond-purple",DIAMOND_RED:"gem/diamond/diamond-red",DIAMOND_YELLOW:"gem/diamond/diamond-yellow",BUBBLE_GREEN:"gem/bubbles/green",BUBBLE_ORANGE:"gem/bubbles/orange",BUBBLE_PINK:"gem/bubbles/pink",BUBBLE_VIOLET:"gem/bubbles/violet",BUBBLE_BLUE:"gem/bubbles/blue",BUBBLE_YELLOW:"gem/bubbles/yellow"}},DEMO_SPINE:{KEY:"demo-spine",jsonPATH:"./assets/spines/demo/demo.json",atlasPATH:"./assets/spines/demo/demo.atlas"},EDITOR:{KEY:"editor",TEXTURE:"./assets/textures/8bit/"+a+"x/editor.png",JSON:"./assets/textures/8bit/"+a+"x/editor.json",FRAME:{BLANK:"blank",BACKGROUND:"Background",BUBBLE_TRANSPARENT:"bubble-transparent",BUBBLE_HOVER:"bubble-hover",BUBBLE_SELECTED:"bubble-selected",GENERATE_BUTTON:"main_panel/generate_button",ADD_BUTTON:"small_button_add",REMOVE_BUTTON:"small_button_remove",EDIT_BUTTON:"small_button_edit",FILL_BUTTON:"small_button_fill",POPUP:"items_popover_back",BUTTON_NEXT_LEVEL:"main_panel/button_next_level",BUTTON_PREV_LEVEL:"main_panel/button_prev_level",EXIT_ICON:"main_panel/exit_icon",PLAY_ICON:"main_panel/play_icon",SAVE_ICON:"main_panel/save_icon",CREATE_ICON:"main_panel/create_icon_2",REMOVE_ICON:"main_panel/remove_icon",SWAP_ICON:"main_panel/swap_button",PANEL_SEPARATOR:"main_panel/panel_separator"}},DEFAULT_TOOL:{KEY:"default-resources-tool",TEXTURE:"./assets/textures/tool/"+a+"x/default-resources.png",JSON:"./assets/textures/tool/"+a+"x/default-resources.json",URL:"./assets/textures/tool/"+a+"x/",FRAME:{BLANK:"blank",LOGO:"logo",TEXT_LOADING:"loading",BORDER_BOTTOM_PANEL:"border-bottom-panel",BOTTOM_PANEL:"bottom-panel",BOTTOM_LINE:"bottom-line",GLARE:"glare",TITLE_YOUR_SCORE:"title-your-score",BG_YOUR_SCORE:"bg-your-score",LEAF:"leaf",BEST_SCORE_FRAME:"best-score-frame",BEST_SCORE_FRAME_LONG:"best-score-frame-long",FOOTER:"footer",SCORE_PANEL:"score-panel",SCORE_PANEL_DARK:"score-panel-dark",BG_PROGRESS_CIRCLE:"bg-progress-circle",BG_TEXT_TARGET_PANEL:"text-target-panel",WOOD_PANEL:"wood-panel",BORDER_DAILY:"border-daily",BG_STREAK:"bg-streak",BG_COMBO:"bg-combo",LEVEL_PLAYED:"bg/level-played",LEVEL_PLAYING:"bg/level-playing",LEVEL_LOCKED:"bg/level-locked",BG_DARK:"bg/bg-dark",BG_TOP:"bg/bg-top",BG_MIDDLE:"bg/bg-middle",BG_BOTTOM:"bg/bg-bottom",PRELOADER:"preloader/dual-ring",LEADERBOARD_TAB_ON:"leaderboards/tab-on",LEADERBOARD_TAB_OFF:"leaderboards/tab-off",LEADERBOARD_BG_TOP:"leaderboards/bg-top",LEADERBOARD_BG_MIDDLE:"leaderboards/bg-middle",LEADERBOARD_BG_BOTTOM:"leaderboards/bg-bottom",LEADERBOARD_BG_ITEM:"leaderboards/bg-item",LEADERBOARD_BORDER_LEFT:"leaderboards/border-left",LEADERBOARD_BORDER_RIGHT:"leaderboards/border-right",PREFIX_LEADERBOARD_BG_ITEM:"leaderboards/bg-item-",PREFIX_LEADERBOARD_BG_ITEM_0:"leaderboards/bg-item-0",AVATAR_BORDER:"avatar/border",AVATAR_BORDER_BIG:"avatar/border-big",AVATAR_BORDER_CHALLENGE:"avatar/border-challenge",AVATAR_BACKGROUND:"avatar/background",POPUP_TOP:"popup/top",POPUP_TOP_DARK:"popup/top-dark",POPUP_MID:"popup/middle",POPUP_BOTTOM:"popup/bottom",POPUP_CONTENT_BACKGROUND:"popup/background",POPUP_SCORE_PANEL:"popup/score-panel",POPUP_TOP_2:"popup/top-2",POPUP_MID_2:"popup/middle-2",POPUP_BOTTOM_2:"popup/bottom-2",ICON_ADS:"icons/flat-ad",ICON_CUP_GOLD:"icons/cup-gold",ICON_CUP_SILVER:"icons/cup-silver",ICON_CUP_COPPER:"icons/cup-bronze",ICON_SOUND:"icons/sound",ICON_VIBRATE:"icons/vibrate",ICON_MUSIC:"icons/music",ICON_RANK:"icons/rank",ICON_PLAY:"icons/play",ICON_I_PLAY:"icons/i-play",ICON_PLAY_GREEN:"icons/play-green",ICON_SHARE:"icons/share",ICON_INVITE:"icons/invite",ICON_FLAG:"icons/milestone",ICON_BROWN_JOURNEY:"icons/brown-journey",ICON_WHITE_JOURNEY:"icons/white-journey",ICON_SWORD:"icons/sword",ICON_SWORD_BLUE:"icons/sword-blue",ICON_SETTING:"icons/setting",ICON_REPLAY:"icons/replay",ICON_RETRY:"icons/retry",ICON_HOME:"icons/home",ICON_BACK:"icons/back",ICON_BATTLE:"icons/battle",ICON_CUP:"icons/cup",ICON_SHARE_BLUE:"icons/share-blue",ICON_CROWN:"icons/crown",ICON_CROWN_BIG:"icons/crown-big",ICON_CLOCK:"icons/clock",ICON_DAILY:"icons/icon-daily",ICON_JOURNEY:"icons/icon-journey",ICON_JOURNEY_2:"icon-journey",ICON_DOT_RED:"icons/dot",ICON_STAR:"icons/star",ICON_PLUS:"icons/plus",ICON_CHECK:"icons/check",ICON_DOWNLOAD:"icons/download",ICON_TEST:"icons/test",ICON_CLEAN:"icons/clean",ICON_TARGET:"icons/target",ICON_DOWNWARD_ARROW:"icons/downward-arrow",BUTTON_CLOSE:"buttons/close",BUTTON_CLOSE_2:"buttons/close-2",BUTTON_RED:"buttons/red",BUTTON_BLUE:"buttons/blue",BUTTON_BLUE_SMALL:"buttons/blue-small",BUTTON_BLUE_MEDIUM:"buttons/blue-medium",BUTTON_GREEN:"buttons/green",BUTTON_GREEN_BIG:"buttons/green-big",BUTTON_DARK_BLUE:"buttons/dark-blue",BUTTON_DARK_BLUE_BIG:"buttons/dark-blue-big",BUTTON_BROWN:"buttons/brown",BUTTON_GREEN_LARGE:"buttons/green-large",BUTTON_PLAY:"buttons/play",BUTTON_RANDOM:"buttons/random",BUTTON_CHALLENGE_LIGHT:"buttons/challenge_light",BUTTON_SHARE_DARK:"buttons/share",BUTTON_MINOR:"buttons/minor",BUTTON_CIRCLE:"buttons/circle-button",BUTTON_TOGGLE_OFF:"buttons/toggle-off",BUTTON_TOGGLE_ON:"buttons/toggle-On",BUTTON_DARK_BLUE_SMALL:"buttons/dark-blue-small",BUTTON_DOT_BLUE:"buttons/dot-blue",BUTTON_DOT_GREEN:"buttons/dot-green",CHANGE_BUTTON:"buttons/change-button",DAILY_BORDER:"daily-challenge/border",DAILY_BACKGROUND:"daily-challenge/bg",DAILY_TITLE_PANEL:"daily-challenge/title-panel",DAILY_BORDER_TOP:"daily-challenge/top-panel",DAILY_BORDER_MIDDLE:"daily-challenge/middle-panel",DAILY_BORDER_BOTTOM:"daily-challenge/bottom-panel",DAILY_BG_ITEM_LIGHT:"daily-challenge/bg-item-light",DAILY_BG_ITEM_DARK:"daily-challenge/bg-item-dark",DAILY_BG_TIME:"daily-challenge/time-panel",NO_THANK_TEXT:"texts/no-thank",TEXT_SECOND_CHANGE:"texts/second-chance",TEXT_VS:"texts/vs",TEXT_LOSE:"texts/lose",TEXT_WIN:"texts/win",TEXT_DRAW:"texts/draw",TEXT_CONTINUE:"texts/continue",TEXT_LEADER_BOARD:"texts/leader-board",TEXT_WORLD:"texts/world",TEXT_WORLD_DISABLE:"texts/world-disable",TEXT_FRIENDS:"texts/friends",TEXT_FRIENDS_DISABLE:"texts/friends-disable",TEXT_PLAY_WITH:"texts/play-with",TEXT_PLAY_WITH_BLUE:"texts/play-with-blue",TEXT_JOURNEY:"texts/text-journey",TEXT_SETTING:"texts/setting",TEXT_OFF:"texts/off",TEXT_ON:"texts/on",TEXT_REPLAY:"texts/replay",TEXT_YOUR_SCORE:"texts/your-score",TEXT_WAITING_OPPONENT:"texts/waiting-for-opponent",TEXT_SINGLE:"texts/play-single",TEXT_RETRY:"texts/text-retry",TEXT_LEVEL_FAIL:"texts/level-failed",TEXT_CONGRATULATION:"texts/congratulations",TEXT_NEXT_LEVEL:"texts/text-next-level",TEXT_START_OVER:"texts/start-over",TEXT_SHARE_BLUE:"texts/text-share",TEXT_PLAY:"texts/play",TEXT_MISSION:"texts/mission",TEXT_NEXT_MILESTONE:"texts/next-milestone",TEXT_FIRST_MILESTONE:"texts/first-milestone",TEXT_COLLECT:"texts/collect",TEXT_YES:"texts/yes",TEXT_NO:"texts/no",TEXT_TUTORIAL:"texts/text-tutorial",TEXT_DAILY_CHALLENGE:"texts/daily-challenge",TEXT_START:"texts/start",TEXT_RESULT:"texts/result",TEXT_RANKING:"texts/text-ranking",TEXT_NEW_BEST:"texts/new-best",TEXT_INVITE_FRIENDS:"texts/invite-friends",TEXT_KEEP_PLAYING:"texts/keep-playing",TEXT_OUT_OF_LIVE:"texts/out-of-live",TEXT_REFILL_LIVES:"texts/refill-lives",LIVES_HEART:"lives/heart",LIVES_TIME_BLOCK:"lives/time-block",LIVES_TIME_BLOCK_2:"lives/time-block-2"}},GAMEPLAY_TOOL:{KEY:"gameplay-resources-tool",TEXTURE:"./assets/textures/tool/"+a+"x/gameplay-resources.png",JSON:"./assets/textures/tool/"+a+"x/gameplay-resources.json",FRAME:{BLANK:"blank",BG_SCORE:"bg-score",BG_MAIN_SCORE:"bg-main-score",BOARD:"board",VIOLET_GLOW:"violet-glow",MASK:"mask",FLAG:"flag",DUST:"dust",CUP_GLARE:"cup-glare",HAND:"hand",AVATAR_BORDER:"avatars/border",AVATAR_BACKGROUND:"avatars/background",ICON_SETTING:"icons/setting",ICON_CUP:"icons/cup",ICON_CHECK:"icons/check",ICON_STAR:"icons/star",ICON_STAR_1:"icons/star-1",ICON_HOME:"icons/home",ICON_ADD_FRIEND:"icons/add-friends",ICON_BATTLE:"icons/battle",TEXT_NEXT_LEVEL:"text/next-level",BUTTON_WOOD_SMALL:"buttons/wood-small",BUTTON_SKIP:"buttons/button-skip",PROGRESS_BG_LEFT:"progress/bg-left",PROGRESS_BG_MID:"progress/bg-mid",PROGRESS_BG_RIGHT:"progress/bg-right",PROGRESS_BAR_LEFT:"progress/bar-left",PROGRESS_BAR_MID:"progress/bar-mid",PROGRESS_BAR_RIGHT:"progress/bar-right",PROGRESS_BAR_RIGHT_WHITE:"progress/bar-right-white"}},EFFECTS_TOOL:{KEY:"effects-resources-tool",PATH:"./assets/textures/tool/"+a+"x/effects-resources.png",JSON:"./assets/textures/tool/"+a+"x/effects-resources.json",FRAME:{BLANK:"blank",GLOW_CIRCLE:"glow-circle",GLARE_CROSS:"glare-cross",DUST:"dust",DUST_YELLOW:"dust-yellow",FX_STAR:"star",FX_STAR_YELLOW:"star-yellow",FX_CONFETTI_SMALL_1:"confetti/small-1",FX_CONFETTI_SMALL_2:"confetti/small-2",FX_CONFETTI_SMALL_3:"confetti/small-3",FX_CONFETTI_SMALL_4:"confetti/small-4",FX_CONFETTI_HEXAGON:"confetti/hexagon-",FX_CONFETTI_RIBBON:"ribbon",TEXT_COOL:"text/text_cool",TEXT_EXCELLENT:"text/text_excellent",TEXT_GOOD:"text/text_good",FX_COMET:"comet",FX_SPARK:"spark",FX_CIRCLE:"circle",FX_CIRCLE_LIGHT:"circle-light",FX_GLOW_LIGHT:"glow-light",FX_GLOW_SMALL:"glow-small",FX_STAR_WHITE:"star-white",FX_FIREWORKS_SMALL:"fireworks/small",FX_FIREWORKS_BIG_0:"fireworks/big-explosive-0",FX_FIREWORKS_BIG_1:"fireworks/big-explosive-1",FX_FIREWORKS_SOAR_LINE:"fireworks/soar-line",FX_FIREWORKS_SOAR_CIRCLE:"fireworks/soar-circle",PREFIX_ANIMATION_RIBBON_CONFETTI_A:"ribbon/falling-confetti/confetti-a/confetti-a-",PREFIX_ANIMATION_RIBBON_CONFETTI_B:"ribbon/falling-confetti/confetti-b/confetti-b-",PREFIX_ANIMATION_RIBBON_CONFETTI_C:"ribbon/falling-confetti/confetti-c/confetti-c-",PREFIX_ANIMATION_RIBBON_CONFETTI_D:"ribbon/falling-confetti/confetti-d/confetti-d-",ANIMATION_STAR_X:"star-x/star-",ANIMATION_STAR_Y:"star-y/star-"}}};GameCore.Utils.Valid.isDebugger()&&(s.EFFECTS.FRAME=(0,i.A)({},s.ANIMATION_SCENE.FRAME,s.EFFECTS.FRAME)),t.A=s},222:function(e,t,n){"use strict";n.d(t,{F7:function(){return s},yh:function(){return r}});var i=n(93),a=n.n(i),s={BOOT_SCENE:"BOOT_SCENE",LOAD_SCENE:"LOAD_SCENE",GAME_SCENE:"GAME_SCENE",GLOBAL_SCENE:"GLOBAL_SCENE",DASHBOARD_SCENE:"DASHBOARD_SCENE",GAME_OVER_SCENE:"GAME_OVER_SCENE",LEADERBOARD_SCENE:"LEADERBOARD_SCENE",JOURNEY_SCENE:"JOURNEY_SCENE",LEVEL_SCENE:"LEVEL_SCENE",LEVEL_EDITOR_SCENE:"LEVEL_EDITOR_SCENE",TEST_SCENE:"TEST_SCENE",ANIMATIONS_SCENE:"ANIMATIONS_SCENE"},r={SWITCH:a()("SWITCH"),LAUNCH:a()("LAUNCH"),RUN:a()("RUN")};!function(e){e[e.SCENE=0]="SCENE",e[e.POPUP=1]="POPUP"}({})},70:function(e,t,n){"use strict";n.d(t,{Ae:function(){return a},R8:function(){return i}});var i={ALERT_SCREEN:"ALERT_SCREEN",NOTIFY_SCREEN:"NOTIFY_SCREEN",REWARD_SCREEN:"REWARD_SCREEN",RESCUE_SCREEN:"RESCUE_SCREEN",SETTINGS_SCREEN:"SETTINGS_SCREEN",RESULT_SCREEN:"RESULT_SCREEN",DAILY_REWARD_SCREEN:"DAILY_REWARD_SCREEN",DAILY_MISSIONS_SCREEN:"DAILY_MISSIONS_SCREEN",LEADER_BOARD_SCREEN:"LEADER_BOARD_SCREEN",MINI_JOURNEY_SCREEN:"MINI_JOURNEY_SCREEN",LEVEL_SCREEN:"LEVEL_SCREEN",LUCKY_REWARD_SCREEN:"LUCKY_REWARD_SCREEN",DAILY_CHALLENGE_SCREEN:"DAILY_CHALLENGE_SCREEN",START_OVER_SCREEN:"START_OVER_SCREEN",TOURNAMENT_RESULT_SCREEN:"TOURNAMENT_RESULT_SCREEN",COLLECTION_COMPLETED_SCREEN:"COLLECTION_COMPLETED_SCREEN",COLLECTION_ITEMS_SCREEN:"COLLECTION_ITEMS_SCREEN",SETTINGS_SCREEN_JOURNEY:"SETTINGS_SCREEN_JOURNEY",MISSION_COMPLETED_SCREEN:"MISSION_COMPLETED_SCREEN",MISSION_FAIL_SCREEN:"MISSION_FAIL_SCREEN",PICK_GEM_SCREEN:"PICK_GEM_SCREEN",PICK_PIECES_SCREEN:"PICK_PIECES_SCREEN",CUSTOM_PIECE_SCREEN:"CUSTOM_PIECE_SCREEN",TARGET_GEM_SCREEN:"TARGET_GEM_SCREEN",CHANGE_PIECE_SCREEN:"CHANGE_PIECE_SCREEN"},a={SCREEN:200,POPUP:300,PRIORITY:999}},142:function(e,t){"use strict";t.A={BOARD_GAME_OVER:"board_end",BUTTON_CLICK:"button_click",CONGRATULATION:"congratulation",COOL:"cool",DAILY_REWARD:"daily_reward",DRAW:"draw",EAT_BLOCK:"eat_block",EXCELLENT:"excellent",GAME_OVER_SCENE:"game_over_scene",GOOD:"good",LOSE:"lose",PIECE_DROP:"piece_drop",PIECE_INVALID_MOVE:"piece_invalid_move",PIECE_PICK:"piece_pick",POPUP_OFF:"popup_off",POPUP_SHOW:"popup_show",TARGET_REACHED:"reach_goal",SCORE_REACHED:"reach_score",RESCUE_TIME:"rescue_timer",SCORE_COUNT:"score_count",WAIT_OPPONENT:"wait_opponent",WIN:"win",FIREWORKS_BIG:"fireworks_big",FIREWORKS_SOAR:"fireworks_soar",FIREWORKS_SMALL:"fireworks_small",BUBBLE_IN_THE_HOLE:"bubble_in_the_hole",START_GAME:"start_game",WELL_DONE:"well_done",TARGET_REACHED_2:"reach_goal_2",STAR_PROGRESS_1:"star_progress_1",STAR_PROGRESS_2:"star_progress_2",STAR_PROGRESS_3:"star_progress_3",YOU_WIN:"you_win",UNLOCK_LEVEL:"unlock_level",BIG_BUBBLE_1:"big_bubble_1",MAGIC_POTION_BUBBLE:"magic_potion_bubble"}},671:function(e,t,n){"use strict";var i=n(50),a=n(4),s=n(90),r=n(134),o=s.A.EFFECTS,c=o.KEY,l=o.FRAME,h=function(e){function t(t,n){var a;return(a=e.call(this,t,c,l.BLANK)||this).config=void 0,a.emitter=void 0,a.config=n||{},a.scene.add.existing((0,i.A)(a)),a}(0,a.A)(t,e);var n=t.prototype;return n.createEmitters=function(){var e=l.FX_CONFETTI_SMALL_1,t=l.FX_CONFETTI_SMALL_2,n=l.FX_CONFETTI_SMALL_3,i=l.FX_CONFETTI_SMALL_4,a=l.FX_CONFETTI_SMALL_5,s=1/GameCore.Utils.Image.getImageScale(),o={on:!1,particleBringToTop:!0,frame:[e,t,n,i,a],timeScale:1,frequency:300,maxParticles:120,gravityY:-10,speedX:{min:-100,max:100},speedY:{min:80,max:250},alpha:{start:1,end:.8},rotate:{start:0,end:1080},scale:{min:.8*s,max:2*s},angle:{min:20,max:160},lifespan:{min:8e3,max:12e3}},c=(0,r.h1)(o,this.config);this.emitter=this.createEmitter(c)},n.run=function(e,t,n){this.stop(),this.emitter.setQuantity(e),this.emitter.setPosition(t,n),this.emitter.start()},n.explode=function(e,t,n){this.emitter||this.createEmitters(),this.emitter.explode(e,t,n)},n.stop=function(){var e,t,n;null==(e=this.emitter)||e.killAll(),null==(t=this.emitter)||t.stop(),null==(n=this.emitter)||n.remove(),this.createEmitters()},t}(Phaser.GameObjects.Particles.ParticleEmitterManager);t.A=h},507:function(e,t){"use strict";for(var n=[{key:"level-0",mapJson:"./assets/json/levels/level-0.json"}],i=1;i<=50;i++)n.push({key:"level-"+i,mapJson:"./assets/json/levels/level-"+i+".json"});t.A=n},226:function(e,t){"use strict";t.A={START_GAME:"start-game",REPLAY:"replay",RESCUE:"rescue",RECEIVE_DIAMONDS:"receive-diamonds",GAME_OVER:"game-over",START_JOURNEY_ANIM:"start-journey-anim",EMIT_JOURNEY_BUBBLE_ANIM:"emit-journey-bubble-anim",UPDATE_STATUS_CURRENT_LEVEL:"update-status-current-level",END_JOURNEY_ANIM:"end-journey-anim",UPDATE_SCROLLER_DATA:"update-scroller-data"}},490:function(e,t){"use strict";t.A={LAYOUT_UPDATE:"layout-update"}},506:function(e,t,n){"use strict";var i=n(23),a=n(20),s=n.n(a),r=function(){function e(){this.payload=void 0,this.playerBestTourScore=0}var t=e.prototype;return t.getData=function(){var e=(0,i.A)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.payload){e.next=2;break}return e.abrupt("return",this.payload);case 2:return e.next=4,this.getFacebookTournamentData();case 4:return this.payload=e.sent,console.log("CurrentTournamentManager payload",this.payload),e.abrupt("return",this.payload);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.setData=function(e){this.payload=e},t.clearData=function(){this.payload=void 0},t.getFacebookTournamentData=function(){var e=(0,i.A)(s().mark((function e(){var t,n,i,a,r,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.game.facebook.getTournamentAsync();case 2:if(t=e.sent,n=t.getPayload()){e.next=6;break}return e.abrupt("return",void 0);case 6:i=null;try{i=JSON.parse(n)}catch(s){console.warn("Tournament payload parse error",s)}if(i){e.next=10;break}return e.abrupt("return",void 0);case 10:if(r=(a=i).playerName,a.leaderboardId){e.next=13;break}return e.abrupt("return",void 0);case 13:return o={id:t.getID(),title:t.getTitle()||r+"'s Tournament",payload:i,type:"you",endTime:t.getEndTime(),contextID:t.getContextID()},e.abrupt("return",o);case 15:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t.setCurrentTourPlayerScore=function(e){this.playerBestTourScore=e},t.getCurrentTourPlayerScore=function(){return this.playerBestTourScore},e}(),o=new r;t.A=o},489:function(e,t,n){"use strict";n.d(t,{A:function(){return l}});var i=n(4),a=n(48),s=function(e){function t(t,n,i){var a;return(a=e.call(this,t,0,0,n,i)||this).setOrigin(0,0),a}return(0,i.A)(t,e),t}(Phaser.GameObjects.Zone),r=n(476),o=n(89),c=n(490),l=function(e){(0,i.A)(n,e);var t=n.prototype;function n(){var t;return(t=e.call(this,{visible:!1})||this).unsubscribeList=void 0,t.gameZone=void 0,t.background=void 0,t.handleOpenScene=function(){t.logPageviewOnOpen(),t.logEventOpen()},t.handleResize=function(){var e=t.world.getResizeEventData(),n=e.width,i=e.height;t.gameZone&&t.gameZone.setSize(n,i),t.background&&(t.background.setPosition(n/2,i/2),t.background.setDisplaySize(n,i),t.updateBackgroundImage(),t.updateBackgroundDarkImage()),t.time.delayedCall(0,(function(){t.events.emit(c.A.LAYOUT_UPDATE)}))},t.removeStateChange=function(){t.unsubscribeList.forEach((function(e){return e()}))},t}return t.updateBackgroundImage=function(){var e=this,t=o.A.BACKGROUND.KEY_PORTRAIT,n=o.A.BACKGROUND.FILE_PORTRAIT;if(this.world.isLandscape()&&(t=o.A.BACKGROUND.KEY_LANDSCAPE,n=o.A.BACKGROUND.FILE_LANDSCAPE),console.log("updateBackgroundImage",t),this.textures.exists(t))this.handleLoadCompleteBackground(t);else{this.load.image(t,n),this.load.start();this.textures.on(Phaser.Textures.Events.ADD,(function n(i){t==i&&(e.handleLoadCompleteBackground(i),e.textures.off(Phaser.Textures.Events.ADD,n))}))}},t.updateBackgroundDarkImage=function(){var e=this,t=o.A.BACKGROUND_DARK.KEY_PORTRAIT,n=o.A.BACKGROUND_DARK.FILE_PORTRAIT;if(this.world.isLandscape()&&(t=o.A.BACKGROUND_DARK.KEY_LANDSCAPE,n=o.A.BACKGROUND_DARK.FILE_LANDSCAPE),console.log("updateBackgroundDarkImage",t),this.textures.exists(t))this.handleLoadCompleteBackgroundDark(t);else{this.load.image(t,n),this.load.start();this.textures.on(Phaser.Textures.Events.ADD,(function n(i){t==i&&(e.handleLoadCompleteBackgroundDark(i),e.textures.off(Phaser.Textures.Events.ADD,n))}))}},t.handleLoadCompleteBackground=function(e){for(var t=this.textures.get(o.A.BACKGROUND.KEY),n=this.textures.get(e),i=0;i<t.source.length;i++)t.source[i].glTexture=n.source[0].glTexture,t.source[i].glIndex=n.source[0].glIndex,t.source[i].glIndexCounter=n.source[0].glIndexCounter},t.handleLoadCompleteBackgroundDark=function(e){for(var t=this.textures.get(o.A.BACKGROUND_DARK.KEY),n=this.textures.get(e),i=0;i<t.source.length;i++)t.source[i].glTexture=n.source[0].glTexture,t.source[i].glIndex=n.source[0].glIndex,t.source[i].glIndexCounter=n.source[0].glIndexCounter},t.create=function(){this.events.on("wake",this.handleOpenScene),this.events.on("resume",this.handleOpenScene),this.events.on("create",this.handleOpenScene),this.world.events.on(r.A.RESIZE,this.handleResize),this.scaleGame(),this.createGameZone()},t.scaleGame=function(){var e=this.getCamera("main"),t=this.world.getZoomRatio(),n=this.world.getWorldSize(),i=n.width,a=n.height;e.setZoom(t),e.centerOn(i/2,a/2)},t.createGameZone=function(){var e=this.world.getWorldSize(),t=e.width,n=e.height;this.gameZone=new s(this,t,n)},t.getCamera=function(e){return"main"===e?this.cameras.main:this.cameras.getCamera(e)},t.createMask=function(e){void 0===e&&(e=1),this.getCamera("main").setBackgroundColor("rgba(0, 0, 0, "+e+")")},t.fontSize=function(e){return e/2.4},t.createBackground=function(e,t,n,i){try{this.background?(this.background.setTexture(e),t&&this.background.setFrame(t)):this.background=this.make.image({key:e,frame:t}),this.background.setName(e);var a=this.gameZone,s=a.displayWidth,r=a.displayHeight;this.background.setDisplaySize(s,r),GameCore.Utils.Valid.isNumber(n)&&this.background.setAlpha(n),GameCore.Utils.Valid.isNumber(i)&&this.background.setTint(i),Phaser.Display.Align.In.Center(this.background,this.gameZone)}catch(o){console.log("Ex === ",o)}},t.handleStateChange=function(e){var t=this;this.unsubscribeList=[],e.forEach((function(e){var n=e.selector,i=e.callback,a=t.storage.watch(n,i);t.unsubscribeList.push(a)})),this.events.once("sleep",this.removeStateChange),this.events.once("destroy",this.removeStateChange),this.events.once("shutdown",this.removeStateChange)},t.logPageviewOnOpen=function(){this.analytics.pageview(this.scene.key)},t.logEventOpen=function(){this.analytics.event(a.o.SCREEN_OPEN,{screen_name:this.getSceneName()})},t.getSceneName=function(){return GameCore.Utils.String.toUpperCamelCase(this.scene.key.toLowerCase())},n}(Phaser.Scene)},672:function(e,t,n){"use strict";n.d(t,{A:function(){return H}});var i=n(23),a=n(50),s=n(4),r=n(20),o=n.n(r),c=n(90),l=n(72),h=n.n(l),u=function(e){function t(t,n,i,s,r,o,c,l){var h;return(h=e.call(this,t,n,i,s,r)||this).animDirection=void 0,h.setWorldSize(o,c),h.animDirection=l,h.scene.add.existing((0,a.A)(h)),h}(0,s.A)(t,e);var n=t.prototype;return n.playAnimation=function(){var e=(0,i.A)(o().mark((function e(){var t=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setCropRatio(0),e.abrupt("return",new(h())((function(e){t.scene.tweens.addCounter({from:0,to:1,duration:200,onUpdate:function(e){t.setCropRatio(e.getValue())},onComplete:function(){t.setCrop(),e()}})})));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.setCropRatio=function(e){var t=this.frame,n=t.width,i=t.height;switch(this.animDirection){case"left":var a=n*e,s=n-a;this.setCrop(s,0,a,i);break;case"right":this.setCrop(0,0,n*e,i);break;case"up":var r=i*e,o=i-r;this.setCrop(0,o,n,r)}},t}(Phaser.GameObjects.Image),d=n(224),p=n(223),f=n(70),m=n(142),g=n(507),v=n(496),y=n(110),A=n(139),E=c.A.DEFAULT,T=E.KEY,S=E.FRAME,b=function(e){function t(t){var n;return(n=e.call(this,t,T,S.CIRCLE_PASSED,75,75)||this).levelText=void 0,n.level=void 0,n.currentLevel=void 0,n.handlePlay=function(){var e=n.scene;n.scene.storage.dispatch((0,v.ST)({mode:y.Nu,status:A.Sr})),e.journeyGameplay.levelManager.setLevel(n.level),e.journeyGameplay.startGame(),e.showJourneyGameplay(),e.screen.close(f.R8.RESULT_SCREEN)},n.setSize(65,65),n.createLevelText(),n.onClick=n.handlePlay,n.scene.add.existing((0,a.A)(n)),n}(0,s.A)(t,e);var n=t.prototype;return n.createLevelText=function(){this.levelText=this.scene.make.bitmapText({font:p.A.MIKADO_YELLOW_BIG_NUMBER.KEY,size:27,origin:{x:.5,y:.5}}),this.add(this.levelText)},n.getHeight=function(){return this.button.displayHeight},n.setLevelText=function(e){this.level=e,this.levelText.setText(e.toString())},n.checkStatusLevel=function(){var e=(0,i.A)(o().mark((function e(t,n){var i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.currentLevel=t,i=g.A.length-1,this.level<t&&(this.setDisabled(!1),this.button.setFrame(S.CIRCLE_PASSED),this.levelText.setFont(p.A.MIKADO_WHITE_MEDIUM_NUMBER.KEY)),this.level!=t){e.next=10;break}if(this.setDisabled(!1),!n){e.next=8;break}return e.next=8,this.playLevelFrameAnimation(n);case 8:this.button.setFrame(S.CIRCLE_READY),this.levelText.setFont(p.A.MIKADO_YELLOW_BIG_NUMBER.KEY);case 10:this.level>t&&(this.setDisabled(!0),this.setAlpha(1),this.button.setFrame(S.CIRCLE_WAITING),this.levelText.setFont(p.A.MIKADO_YELLOW_BIG_NUMBER.KEY)),this.level>i?this.setVisible(!1):this.setVisible(!0);case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.playLevelFrameAnimation=function(e){var t=this,n=[this.button.scale,this.levelText.scale];return new(h())((function(i){t.scene.tweens.add({targets:[t.button,t.levelText],duration:300,props:{scale:{getStart:function(e,t,i,a){return n[a]},getEnd:function(e,t,i,a){return 1.1*n[a]},yoyo:!0,ease:Phaser.Math.Easing.Cubic.Out}},onYoyo:function(){e()},onComplete:function(){i(!0),t.scene.audio.playSound(m.A.BUBBLE_IN_THE_HOLE),t.scene.time.delayedCall(500,(function(){t.scene.audio.playSound(m.A.UNLOCK_LEVEL,{volume:.5})}))}})}))},t}(d.A),P=function(e){function t(t,n,i,s,r,o,c){var l;return(l=e.call(this,t,n,i,s,r)||this).setWorldSize(o,c),l.scene.add.existing((0,a.A)(l)),l}return(0,s.A)(t,e),t}(Phaser.GameObjects.Image),C=n(225),w=n(89),I=c.A.DEFAULT,x=I.KEY,k=I.FRAME,O=function(e){function t(t){var n;return(n=e.call(this,t)||this).background=void 0,n.image=void 0,n.loadingRing=void 0,n.handleLoadComplete=function(e){n.image.setTexture(e),n.image.clearTint(),n.image.setWorldSize(203,106),n.image.revive(),n.loadingRing.kill()},n.createImage(),n.createBackground(),n.createLoadingRing(),n.scene.add.existing((0,a.A)(n)),n}(0,s.A)(t,e);var n=t.prototype;return n.createBackground=function(){this.background=this.scene.make.image({key:x,frame:k.ROAD_BG_IMAGE}),this.background.setWorldSize(219,120),this.add(this.background)},n.createImage=function(){this.image=this.scene.make.image({key:x,frame:k.BLANK}),this.image.setWorldSize(203,106),this.image.setTintFill(3944520),this.add(this.image),Phaser.Display.Align.In.Center(this.image,this,-2,-2)},n.createLoadingRing=function(){this.loadingRing=new C.A(this.scene),this.add(this.loadingRing),this.loadingRing.kill()},n.setImageByIndex=function(e){var t=w.A.IMAGES,n=t.KEY,i=t.FILE,a=n[e],s=i[e],r=this.scene.textures.get(a);r&&r.key===a?this.handleLoadComplete(a):(this.loadingRing.revive(),this.loadPhoto(a,s))},n.loadPhoto=function(e,t){var n=this.scene.textures.get(e);console.log("loadPhoto",e,t),n&&n.key===e?this.handleLoadComplete(e):(this.scene.load.once("filecomplete-image-"+e,this.handleLoadComplete),this.scene.load.image(e,t),this.scene.load.start())},t}(Phaser.GameObjects.Container),_={MAX_LEVEL:4,POSITIONS:[{x:-142.5,y:103.5},{x:0,y:30.5},{x:142,y:-50},{x:-.5,y:-196}],IMAGES_ROAD:[0,1,2,3,4]},R=function(e){function t(t,n,i){var a;return(a=e.call(this,t)||this).setTexture(c.A.DEFAULT.KEY,c.A.DEFAULT.FRAME.PROGRESS_TOP_RIGHT),a.setStartAngle(2*Math.PI),a.setClockWise(!1),a.setWorldSize(n,i),a.setCrop(Math.PI/2),a}return(0,s.A)(t,e),t.prototype.playAnimation=function(){var e=(0,i.A)(o().mark((function e(){var t=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setCrop(0),e.abrupt("return",new(h())((function(e){t.scene.tweens.addCounter({from:0,to:Math.PI/2,duration:200,onUpdate:function(e){t.setCrop(e.getValue())},onComplete:function(){e()}})})));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(function(e){function t(t){var n;return(n=e.call(this,t,0,0)||this).startAngle=void 0,n.clockWise=void 0,n.cropAngle=void 0,n.startAngle=0,n.cropAngle=0,n.clockWise=!0,n.setOrtho(1,1),n.hideCCW=!1,t.add.existing((0,a.A)(n)),n}(0,s.A)(t,e);var n=t.prototype;return n.setTexture=function(t,n){return e.prototype.setTexture.call(this,t,n),this.setCrop(this.cropAngle),this},n.kill=function(){this.setVisible(!1),this.setActive(!1)},n.revive=function(){this.setVisible(!0),this.setActive(!0)},n.getWorldPosition=function(){var e=this.getWorldTransformMatrix().decomposeMatrix();return{x:e.translateX,y:e.translateY}},n.setWorldSize=function(e,t){this.setSize(e,t),this.setCrop(this.cropAngle)},n.setStartAngle=function(e){this.startAngle=e,this.setCrop(this.cropAngle)},n.setClockWise=function(e){this.clockWise=e,this.setCrop(this.cropAngle)},n.setCrop=function(e){this.cropAngle=e;var t=2*Math.PI-e,n=2*Math.PI,i=this.frame,a=i.u0,s=(i.v0,i.u1,a),r=i.v1,o=new Phaser.Geom.Mesh.Vertex(-.5,-.5,0,s,r),c=this.getIntersectionVertex(t),l=this.getIntersectionVertex(n),h=Math.floor((t+Math.PI/4)/(Math.PI/2))+1,u=Math.ceil((n+Math.PI/4)/(Math.PI/2))-1;this.faces=[];for(var d=c,p=h;p<=u;p++){var f=this.getIntersectionVertex(p*Math.PI/2-Math.PI/4);this.addFace(o,d,f),d=f}this.addFace(o,d,l)},n.addFace=function(e,t,n){var i=new Phaser.Geom.Mesh.Face(e,t,n);return i.transformCoordinatesLocal(this.transformMatrix,this.width,this.height,this.z),this.faces.push(i),this},n.getIntersectionVertex=function(e){var t=this.findIntersectionPoint(e),n=t.x,i=t.y,a=this.frame,s=a.u0,r=a.v0,o=s+(a.u1-s)*(.5+n),c=r+(a.v1-r)*(.5+i);return new Phaser.Geom.Mesh.Vertex(n,-i,0,o,c)},n.findIntersectionPoint=function(e){var t,n;return e!==Math.PI/2&&e!==3*Math.PI/2?(t=Math.min(1,Math.abs(1/Math.tan(e))),Math.cos(e)<0&&(t=-t),n=Math.tan(e)*t):(t=0,n=e===Math.PI/2?1:-1),{x:t-.5,y:n+.5}},n.normalizeAngle=function(e){var t=this.startAngle,n=this.startAngle+e,i=t-Math.floor(t/(2*Math.PI))*Math.PI*2,a=n-Math.floor(n/(2*Math.PI))*Math.PI*2,s=Math.abs(e)/(4*Math.PI);return s-Math.floor(s)>=.5!==this.clockWise?i>a?{angle1:a,angle2:i}:{angle1:a,angle2:i+2*Math.PI}:i<=a?{angle1:i,angle2:a}:{angle1:i,angle2:a+2*Math.PI}},t}(Phaser.GameObjects.Mesh)),D=R,M=function(e){function t(t,n,i){var a;return(a=e.call(this,t)||this).setTexture(c.A.DEFAULT.KEY,c.A.DEFAULT.FRAME.PROGRESS_BOT_LEFT),a.setStartAngle(Math.PI/2),a.setClockWise(!0),a.setWorldSize(n,i),a.setCrop(Math.PI/2),a}return(0,s.A)(t,e),t.prototype.playAnimation=function(){var e=(0,i.A)(o().mark((function e(){var t=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setCrop(0),e.abrupt("return",new(h())((function(e){t.scene.tweens.addCounter({from:0,to:Math.PI/2,duration:200,onUpdate:function(e){t.setCrop(e.getValue())},onComplete:function(){e()}})})));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(function(e){function t(t){var n;return(n=e.call(this,t,0,0)||this).startAngle=void 0,n.clockWise=void 0,n.cropAngle=void 0,n.startAngle=0,n.cropAngle=0,n.clockWise=!0,n.setOrtho(1,1),n.hideCCW=!1,t.add.existing((0,a.A)(n)),n}(0,s.A)(t,e);var n=t.prototype;return n.setTexture=function(t,n){return e.prototype.setTexture.call(this,t,n),this.setCrop(this.cropAngle),this},n.kill=function(){this.setVisible(!1),this.setActive(!1)},n.revive=function(){this.setVisible(!0),this.setActive(!0)},n.getWorldPosition=function(){var e=this.getWorldTransformMatrix().decomposeMatrix();return{x:e.translateX,y:e.translateY}},n.setWorldSize=function(e,t){this.setSize(e,t),this.setCrop(this.cropAngle)},n.setStartAngle=function(e){this.startAngle=e,this.setCrop(this.cropAngle)},n.setClockWise=function(e){this.clockWise=e,this.setCrop(this.cropAngle)},n.setCrop=function(e){this.cropAngle=e;var t=Math.PI/2,n=Math.PI/2+e,i=this.frame,a=(i.u0,i.v0),s=i.u1,r=(i.v1,s),o=a,c=new Phaser.Geom.Mesh.Vertex(.5,.5,0,r,o),l=this.getIntersectionVertex(t),h=this.getIntersectionVertex(n),u=Math.floor((t+Math.PI/4)/(Math.PI/2))+1,d=Math.ceil((n+Math.PI/4)/(Math.PI/2))-1;this.faces=[];for(var p=l,f=u;f<=d;f++){var m=this.getIntersectionVertex(f*Math.PI/2-Math.PI/4);this.addFace(c,p,m),p=m}this.addFace(c,p,h)},n.addFace=function(e,t,n){var i=new Phaser.Geom.Mesh.Face(e,t,n);return i.transformCoordinatesLocal(this.transformMatrix,this.width,this.height,this.z),this.faces.push(i),this},n.getIntersectionVertex=function(e){var t=this.findIntersectionPoint(e),n=t.x,i=t.y,a=this.frame,s=a.u0,r=a.v0,o=s+(a.u1-s)*(.5+n),c=r+(a.v1-r)*(.5+i);return new Phaser.Geom.Mesh.Vertex(n,-i,0,o,c)},n.findIntersectionPoint=function(e){var t,n;return e!==Math.PI/2&&e!==3*Math.PI/2?(t=Math.min(1,Math.abs(1/Math.tan(e))),Math.cos(e)<0&&(t=-t),n=Math.tan(e)*t):(t=0,n=e===Math.PI/2?1:-1),{x:t+.5,y:n-.5}},n.normalizeAngle=function(e){var t=this.startAngle,n=this.startAngle+e,i=t-Math.floor(t/(2*Math.PI))*Math.PI*2,a=n-Math.floor(n/(2*Math.PI))*Math.PI*2,s=Math.abs(e)/(4*Math.PI);return s-Math.floor(s)>=.5!==this.clockWise?i>a?{angle1:a,angle2:i}:{angle1:a,angle2:i+2*Math.PI}:i<=a?{angle1:i,angle2:a}:{angle1:i,angle2:a+2*Math.PI}},t}(Phaser.GameObjects.Mesh)),B=M,L=function(e){function t(t,n,i){var a;return(a=e.call(this,t)||this).setTexture(c.A.DEFAULT.KEY,c.A.DEFAULT.FRAME.PROGRESS_TOP_LEFT),a.setStartAngle(Math.PI),a.setClockWise(!0),a.setWorldSize(n,i),a.setCrop(Math.PI/2),a}return(0,s.A)(t,e),t.prototype.playAnimation=function(){var e=(0,i.A)(o().mark((function e(){var t=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setCrop(0),e.abrupt("return",new(h())((function(e){t.scene.tweens.addCounter({from:0,to:Math.PI/2,duration:200,onUpdate:function(e){t.setCrop(e.getValue())},onComplete:function(){e()}})})));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(function(e){function t(t){var n;return(n=e.call(this,t,0,0)||this).startAngle=void 0,n.clockWise=void 0,n.cropAngle=void 0,n.startAngle=0,n.cropAngle=0,n.clockWise=!0,n.setOrtho(1,1),n.hideCCW=!1,t.add.existing((0,a.A)(n)),n}(0,s.A)(t,e);var n=t.prototype;return n.setTexture=function(t,n){return e.prototype.setTexture.call(this,t,n),this.setCrop(this.cropAngle),this},n.kill=function(){this.setVisible(!1),this.setActive(!1)},n.revive=function(){this.setVisible(!0),this.setActive(!0)},n.getWorldPosition=function(){var e=this.getWorldTransformMatrix().decomposeMatrix();return{x:e.translateX,y:e.translateY}},n.setWorldSize=function(e,t){this.setSize(e,t),this.setCrop(this.cropAngle)},n.setStartAngle=function(e){this.startAngle=e,this.setCrop(this.cropAngle)},n.setClockWise=function(e){this.clockWise=e,this.setCrop(this.cropAngle)},n.setCrop=function(e){this.cropAngle=e;var t=Math.PI,n=Math.PI+e,i=this.frame,a=(i.u0,i.v0,i.u1),s=i.v1,r=new Phaser.Geom.Mesh.Vertex(.5,-.5,0,a,s),o=this.getIntersectionVertex(t),c=this.getIntersectionVertex(n),l=Math.floor((t+Math.PI/4)/(Math.PI/2))+1,h=Math.ceil((n+Math.PI/4)/(Math.PI/2))-1;this.faces=[];for(var u=o,d=l;d<=h;d++){var p=this.getIntersectionVertex(d*Math.PI/2-Math.PI/4);this.addFace(r,u,p),u=p}this.addFace(r,u,c)},n.addFace=function(e,t,n){var i=new Phaser.Geom.Mesh.Face(e,t,n);return i.transformCoordinatesLocal(this.transformMatrix,this.width,this.height,this.z),this.faces.push(i),this},n.getIntersectionVertex=function(e){var t=this.findIntersectionPoint(e),n=t.x,i=t.y,a=this.frame,s=a.u0,r=a.v0,o=s+(a.u1-s)*(.5+n),c=r+(a.v1-r)*(.5+i);return new Phaser.Geom.Mesh.Vertex(n,-i,0,o,c)},n.findIntersectionPoint=function(e){var t,n;return e!==Math.PI/2&&e!==3*Math.PI/2?(t=Math.min(1,Math.abs(1/Math.tan(e))),Math.cos(e)<0&&(t=-t),n=Math.tan(e)*t):(t=0,n=e===Math.PI/2?1:-1),{x:t+.5,y:n+.5}},n.normalizeAngle=function(e){var t=this.startAngle,n=this.startAngle+e,i=t-Math.floor(t/(2*Math.PI))*Math.PI*2,a=n-Math.floor(n/(2*Math.PI))*Math.PI*2,s=Math.abs(e)/(4*Math.PI);return s-Math.floor(s)>=.5!==this.clockWise?i>a?{angle1:a,angle2:i}:{angle1:a,angle2:i+2*Math.PI}:i<=a?{angle1:i,angle2:a}:{angle1:i,angle2:a+2*Math.PI}},t}(Phaser.GameObjects.Mesh)),N=L,G=function(e){function t(t,n,i){var a;return(a=e.call(this,t)||this).setTexture(c.A.DEFAULT.KEY,c.A.DEFAULT.FRAME.PROGRESS_BOT_RIGHT),a.setStartAngle(Math.PI/2),a.setClockWise(!1),a.setWorldSize(n,i),a.setCrop(Math.PI/2),a}return(0,s.A)(t,e),t.prototype.playAnimation=function(){var e=(0,i.A)(o().mark((function e(){var t=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setCrop(0),e.abrupt("return",new(h())((function(e){t.scene.tweens.addCounter({from:0,to:Math.PI/2,duration:200,onUpdate:function(e){t.setCrop(e.getValue())},onComplete:function(){e()}})})));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(n(673).A),F=G,U=n(144),j=n(226),V=c.A.DEFAULT,z=V.KEY,Y=V.FRAME,H=function(e){function t(t){var n;return(n=e.call(this,t)||this).road11=void 0,n.road12=void 0,n.road13=void 0,n.road14=void 0,n.road15=void 0,n.road21=void 0,n.road22=void 0,n.road23=void 0,n.road31=void 0,n.road32=void 0,n.road33=void 0,n.road41=void 0,n.road42=void 0,n.road43=void 0,n.road44=void 0,n.road45=void 0,n.index=void 0,n.currentLevel=void 0,n.progressRoad1=[],n.progressRoad2=[],n.progressRoad3=[],n.progressRoad4=[],n.progressRoads=[n.progressRoad1,n.progressRoad2,n.progressRoad3,n.progressRoad4],n.listRoadLevel=[],n.image1=void 0,n.image2=void 0,n.runAnimationJourney=!1,n.currentRoadLevel=void 0,n.particle=void 0,n.bubbleWaterEmitter=void 0,n.setSize(n.scene.gameZone.width,508.5),n.createRoad1(),n.createRoad2(),n.createRoad3(),n.createRoad4(),n.createImagesRoad(),n.createListRoadLevel(),n.listenEvents(),n.scene.add.existing((0,a.A)(n)),n}(0,s.A)(t,e);var n=t.prototype;return n.listenEvents=function(){var e=this;U.A.on(j.A.UPDATE_STATUS_CURRENT_LEVEL,(function(){e.currentRoadLevel&&(e.currentRoadLevel.checkStatusLevel(e.currentLevel),e.scene.audio.playSound(m.A.MAGIC_POTION_BUBBLE),e.scene.time.delayedCall(500,(function(){e.scene.audio.playSound(m.A.UNLOCK_LEVEL,{volume:.5})})),e.scene.input.enabled=!0,U.A.emit(j.A.END_JOURNEY_ANIM))})),U.A.on(j.A.EMIT_JOURNEY_BUBBLE_ANIM,(function(){e.currentRoadLevel&&(e.add(e.particle),e.currentRoadLevel&&e.bringToTop(e.currentRoadLevel),e.bubbleWaterEmitter.explode(40,e.currentRoadLevel.x,e.currentRoadLevel.y))}))},n.createRoad1=function(){this.road11=new P(this.scene,0,0,z,Y.ROAD_VERTICAL,60,60),this.road12=new P(this.scene,0,0,z,Y.ROAD_TOP_RIGHT,60,60),this.road13=new P(this.scene,0,0,z,Y.ROAD_HORIZONTAL,70,60),this.road14=new P(this.scene,0,0,z,Y.ROAD_BOT_LEFT,60,60),this.road15=new P(this.scene,0,0,z,Y.ROAD_VERTICAL,60,62.5);var e=new u(this.scene,0,0,z,Y.PROGRESS_VERTICAL,60,60,"up"),t=new D(this.scene,60,60),n=new u(this.scene,0,0,z,Y.PROGRESS_HORIZONTAL,70,60,"left"),i=new B(this.scene,60,60),a=new u(this.scene,0,0,z,Y.PROGRESS_VERTICAL,60,62.5,"up");Phaser.Display.Align.In.BottomCenter(this.road11,this),Phaser.Display.Align.To.TopCenter(this.road12,this.road11,.5),Phaser.Display.Align.To.LeftCenter(this.road13,this.road12,0),Phaser.Display.Align.To.LeftCenter(this.road14,this.road13,0,.5),Phaser.Display.Align.To.TopCenter(this.road15,this.road14),Phaser.Display.Align.In.Center(e,this.road11),t.setPosition(this.road12.x,this.road12.y),Phaser.Display.Align.In.Center(n,this.road13),i.setPosition(this.road14.x,this.road14.y),Phaser.Display.Align.In.Center(a,this.road15),this.add([this.road11,this.road12,e,t,this.road13,this.road14,this.road15,n,i,a]),this.progressRoad1.push(e,t,n,i,a)},n.createRoad2=function(){this.road21=new P(this.scene,0,0,z,Y.ROAD_VERTICAL,60,62.5),this.road22=new P(this.scene,0,0,z,Y.ROAD_TOP_LEFT,60,60),this.road23=new P(this.scene,0,0,z,Y.ROAD_HORIZONTAL,91,60);var e=new u(this.scene,0,0,z,Y.PROGRESS_VERTICAL,60,62.5,"up"),t=new N(this.scene,60,60),n=new u(this.scene,0,0,z,Y.PROGRESS_HORIZONTAL,91,60,"right");Phaser.Display.Align.To.TopCenter(this.road21,this.road15),Phaser.Display.Align.To.TopCenter(this.road22,this.road21),Phaser.Display.Align.To.RightCenter(this.road23,this.road22),Phaser.Display.Align.In.Center(e,this.road21),t.setPosition(this.road22.x,this.road22.y),Phaser.Display.Align.In.Center(n,this.road23,0,0),this.add([this.road21,e,this.road22,this.road23,t,n]),this.progressRoad2.push(e,t,n)},n.createRoad3=function(){this.road31=new P(this.scene,0,0,z,Y.ROAD_HORIZONTAL,91,60),this.road32=new P(this.scene,0,0,z,Y.ROAD_BOT_RIGHT,60,60),this.road33=new P(this.scene,0,0,z,Y.ROAD_VERTICAL,60,62.5);var e=new u(this.scene,0,0,z,Y.PROGRESS_HORIZONTAL,91,60,"right"),t=new F(this.scene,60,60),n=new u(this.scene,0,0,z,Y.PROGRESS_VERTICAL,60,62.5,"up");Phaser.Display.Align.To.RightCenter(this.road31,this.road23),Phaser.Display.Align.To.RightCenter(this.road32,this.road31,0,.5),Phaser.Display.Align.To.TopCenter(this.road33,this.road32,-.5),Phaser.Display.Align.In.Center(e,this.road31),t.setPosition(this.road32.x,this.road32.y),Phaser.Display.Align.In.Center(n,this.road33,0,0),this.add([this.road31,e,this.road32,this.road33,t,n]),this.progressRoad3.push(e,t,n)},n.createRoad4=function(){this.road41=new P(this.scene,0,0,z,Y.ROAD_VERTICAL,60,62.5),this.road42=new P(this.scene,0,0,z,Y.ROAD_TOP_RIGHT,60,60),this.road43=new P(this.scene,0,0,z,Y.ROAD_HORIZONTAL,52.5,60),this.road44=new P(this.scene,0,0,z,Y.ROAD_BOT_LEFT,60,60),this.road45=new P(this.scene,0,0,z,Y.ROAD_VERTICAL,60,20);var e=new u(this.scene,0,0,z,Y.PROGRESS_VERTICAL,60,62.5,"up"),t=new D(this.scene,60,60),n=new u(this.scene,0,0,z,Y.PROGRESS_HORIZONTAL,52.5,60,"left"),i=new B(this.scene,60,60),a=new u(this.scene,0,0,z,Y.PROGRESS_VERTICAL,60,20,"up");Phaser.Display.Align.To.TopCenter(this.road41,this.road33),Phaser.Display.Align.To.TopCenter(this.road42,this.road41,.5),Phaser.Display.Align.To.LeftCenter(this.road43,this.road42),Phaser.Display.Align.To.LeftCenter(this.road44,this.road43,0,.5),Phaser.Display.Align.To.TopCenter(this.road45,this.road44),Phaser.Display.Align.In.Center(e,this.road41),t.setPosition(this.road42.x,this.road42.y),Phaser.Display.Align.In.Center(n,this.road43,0,0),i.setPosition(this.road44.x,this.road44.y),Phaser.Display.Align.In.Center(a,this.road45),this.add([this.road41,this.road42,this.road43,this.road44,this.road45,e,t,n,i,a]),this.progressRoad4.push(e,t,n,i,a)},n.createListRoadLevel=function(){for(var e=[{x:this.road11.x,y:this.road11.y},{x:this.road15.x,y:(this.road15.y+this.road21.y)/2},{x:(this.road23.x+this.road31.x)/2,y:this.road23.y},{x:this.road33.x,y:(this.road33.y+this.road41.y)/2}],t=0;t<4;t++){var n=new b(this.scene),i=e[t],a=0;0==t&&(a=11),this.add(n),this.listRoadLevel.push(n),n.setPosition(i.x,i.y+a)}},n.updateInfo=function(e){this.index=e.index,this.currentLevel=e.currentLevel,this.runAnimationJourney=e.runAnimationJourney,this.currentRoadLevel=void 0,this.particle=e.roadLevelParticle,this.bubbleWaterEmitter=e.bubbleWaterEmitter,console.log("updateRoadByLevel",e);for(var t=this.listRoadLevel.length,n=0;n<t;n++){var i=this.listRoadLevel[n],a=(e.index+1)*t-(t-1-n);i.setLevelText(a),a==this.currentLevel&&1!=a&&this.runAnimationJourney||i.checkStatusLevel(e.currentLevel),this.checkProgressRoad(a,e.currentLevel,n),a==this.currentLevel&&(this.currentRoadLevel=i)}this.checkProgressRoad((e.index+1)*t+1,e.currentLevel,4);var s=Math.ceil(g.A.length/4)-1;if(e.index==s){this.road45.setWorldSize(60,210),Phaser.Display.Align.To.TopCenter(this.road45,this.road44);var r=this.progressRoad4[this.progressRoad4.length-1];r.setWorldSize(60,210),Phaser.Display.Align.In.Center(r,this.road45)}else{this.road45.setWorldSize(60,20),Phaser.Display.Align.To.TopCenter(this.road45,this.road44);var o=this.progressRoad4[this.progressRoad4.length-1];o.setWorldSize(60,20),Phaser.Display.Align.In.Center(o,this.road45)}},n.checkProgressRoad=function(){var e=(0,i.A)(o().mark((function e(t,n,i){var a,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n!=g.A.length||t!=g.A.length){e.next=14;break}if(this.runAnimationJourney){e.next=4;break}for(a=i;a<=this.progressRoads.length;a++)this.showProgressRoad(a);return e.abrupt("return");case 4:s=i;case 5:if(!(s<=this.progressRoads.length)){e.next=11;break}return e.next=8,this.showProgressRoadWithAnim(s);case 8:s++,e.next=5;break;case 11:return U.A.emit(j.A.UPDATE_SCROLLER_DATA),this.runAnimationJourney=!1,e.abrupt("return");case 14:if(n!=g.A.length){e.next=16;break}return e.abrupt("return");case 16:if(!(t<=n)){e.next=25;break}if(t!=n||!this.runAnimationJourney){e.next=22;break}return e.next=20,this.showProgressRoadWithAnim(i);case 20:return this.runAnimationJourney=!1,e.abrupt("return");case 22:this.showProgressRoad(i),e.next=26;break;case 25:this.hideProgressRoad(i);case 26:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.hideProgressRoad=function(e){0!==e&&(console.log("hideProgressRoad",e),this.progressRoads[e-1].forEach((function(e){e.kill()})))},n.showProgressRoad=function(e){0!==e&&(console.log("showProgressRoad",e),this.progressRoads[e-1].forEach((function(e){e.revive()})))},n.showProgressRoadWithAnim=function(){var e=(0,i.A)(o().mark((function e(t){var n,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t){e.next=2;break}return e.abrupt("return");case 2:console.log("showProgressRoadWithAnim",t),U.A.emit(j.A.START_JOURNEY_ANIM),this.scene.input.enabled=!1,this.progressRoads[t-1].forEach((function(e){e.kill()})),this.scene.audio.playSound(m.A.BIG_BUBBLE_1),n=0;case 8:if(!(n<this.progressRoads[t-1].length)){e.next=17;break}return(i=this.progressRoads[t-1][n]).revive(),n===this.progressRoads[t-1].length-1&&this.currentLevel!=g.A.length&&U.A.emit(j.A.EMIT_JOURNEY_BUBBLE_ANIM),e.next=14,i.playAnimation();case 14:n++,e.next=8;break;case 17:this.currentLevel!=g.A.length&&U.A.emit(j.A.UPDATE_SCROLLER_DATA),U.A.emit(j.A.UPDATE_STATUS_CURRENT_LEVEL);case 19:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.createImagesRoad=function(){this.image1=new O(this.scene),this.image2=new O(this.scene);var e=_.IMAGES_ROAD.shift();void 0!=e&&this.image1.setImageByIndex(e),0==_.IMAGES_ROAD.length&&(_.IMAGES_ROAD=[0,1,2,3,4]);var t=_.IMAGES_ROAD.shift();void 0!=t&&this.image2.setImageByIndex(t),0==_.IMAGES_ROAD.length&&(_.IMAGES_ROAD=[0,1,2,3,4]),this.add([this.image1,this.image2]),this.image1.setPosition(this.road15.x+151,(this.road15.y+this.road21.y)/2+9),this.image2.setPosition(this.road33.x-147,(this.road33.y+this.road41.y)/2-6)},t}(Phaser.GameObjects.Container)},673:function(e,t,n){"use strict";var i=n(50),a=n(4),s=function(e){function t(t){var n;return(n=e.call(this,t,0,0)||this).startAngle=void 0,n.clockWise=void 0,n.cropAngle=void 0,n.startAngle=0,n.cropAngle=0,n.clockWise=!0,n.setOrtho(1,1),n.hideCCW=!1,t.add.existing((0,i.A)(n)),n}(0,a.A)(t,e);var n=t.prototype;return n.setTexture=function(t,n){return e.prototype.setTexture.call(this,t,n),this.setCrop(this.cropAngle),this},n.kill=function(){this.setVisible(!1),this.setActive(!1)},n.revive=function(){this.setVisible(!0),this.setActive(!0)},n.getWorldPosition=function(){var e=this.getWorldTransformMatrix().decomposeMatrix();return{x:e.translateX,y:e.translateY}},n.setWorldSize=function(e,t){this.setSize(e,t),this.setCrop(this.cropAngle)},n.setStartAngle=function(e){this.startAngle=e,this.setCrop(this.cropAngle)},n.setClockWise=function(e){this.clockWise=e,this.setCrop(this.cropAngle)},n.setCrop=function(e){this.cropAngle=e;var t=Math.PI/2-e,n=Math.PI/2,i=this.frame,a=i.u0,s=i.v0,r=(i.u1,i.v1,a),o=s,c=new Phaser.Geom.Mesh.Vertex(-.5,.5,0,r,o),l=this.getIntersectionVertex(t),h=this.getIntersectionVertex(n),u=Math.floor((t+Math.PI/4)/(Math.PI/2))+1,d=Math.ceil((n+Math.PI/4)/(Math.PI/2))-1;this.faces=[];for(var p=l,f=u;f<=d;f++){var m=this.getIntersectionVertex(f*Math.PI/2-Math.PI/4);this.addFace(c,p,m),p=m}this.addFace(c,p,h)},n.addFace=function(e,t,n){var i=new Phaser.Geom.Mesh.Face(e,t,n);return i.transformCoordinatesLocal(this.transformMatrix,this.width,this.height,this.z),this.faces.push(i),this},n.getIntersectionVertex=function(e){var t=this.findIntersectionPoint(e),n=t.x,i=t.y,a=this.frame,s=a.u0,r=a.v0,o=s+(a.u1-s)*(.5+n),c=r+(a.v1-r)*(.5+i);return new Phaser.Geom.Mesh.Vertex(n,-i,0,o,c)},n.findIntersectionPoint=function(e){var t,n;return e!==Math.PI/2&&e!==3*Math.PI/2?(t=Math.min(1,Math.abs(1/Math.tan(e))),Math.cos(e)<0&&(t=-t),n=Math.tan(e)*t):(t=0,n=e===Math.PI/2?1:-1),{x:t-.5,y:n-.5}},n.normalizeAngle=function(e){var t=this.startAngle,n=this.startAngle+e,i=t-Math.floor(t/(2*Math.PI))*Math.PI*2,a=n-Math.floor(n/(2*Math.PI))*Math.PI*2,s=Math.abs(e)/(4*Math.PI);return s-Math.floor(s)>=.5!==this.clockWise?i>a?{angle1:a,angle2:i}:{angle1:a,angle2:i+2*Math.PI}:i<=a?{angle1:i,angle2:a}:{angle1:i,angle2:a+2*Math.PI}},t}(Phaser.GameObjects.Mesh);t.A=s},485:function(e,t,n){"use strict";n.d(t,{A:function(){return z}});var i=n(107),a=n(4),s=n(71),r=n.n(s),o=n(486),c=n(487),l=n(90),h=n(222),u=n(70),d=n(488),p=(0,n(58).Mz)([function(e){return e.scene.currentSceneKey}],(function(e){return e})),f=n(47),m=n(489),g=n(50),v=n(223),y=n(140),A=l.A.DEFAULT,E=A.KEY,T=A.FRAME,S=function(e){function t(t){var n;return(n=e.call(this,t,0,0)||this).fps=0,n.fpsString="FPS: %1",n.fpsText=void 0,n.background=void 0,n.lastUpdate=void 0,n.update=function(e){if(!(e-n.lastUpdate<800)){n.lastUpdate=e;var t=Math.floor(n.scene.game.loop.actualFps);n.setFps(t)}},n.createFps(),n.setDepth(y.A.DEBUG),n.scene.add.existing((0,g.A)(n)),n.scene.events.on(Phaser.Scenes.Events.UPDATE,n.update),n}(0,a.A)(t,e);var n=t.prototype;return n.setFps=function(e){this.fps=e;var t=Phaser.Utils.String.Format(this.fpsString,[e]);this.fpsText.setText(t)},n.createFps=function(){this.background=this.scene.make.image({key:E,frame:T.BLANK}),this.background.setName("BG"),this.background.setTint(13801480),this.background.setWorldSize(45,25),this.fpsText=this.scene.make.bitmapText({size:14,text:this.fpsString,font:v.A.MIKADO_WHITE.KEY,origin:{x:.5,y:.5}}),this.fpsText.setName("FPS Meter"),Phaser.Display.Align.In.Center(this.fpsText,this.background),this.add([this.background,this.fpsText]),this.setFps(0)},t}(Phaser.GameObjects.Container),b=S,P=function(e){function t(t){var n;if((n=e.call(this,t,0,0)||this).performance=void 0,n.memory=0,n.maxMemoryLimit=void 0,n.maxPercentThreshold=void 0,n.normalColor=3459162,n.warningColor=16768343,n.alarmColor=15812200,n.memoryString="Memory: %1MB / %2MB",n.memoryText=void 0,n.lastUpdate=void 0,n.update=function(e){if(!(e-n.lastUpdate<1e3)){n.lastUpdate=e;var t=n.performance.memory.usedJSHeapSize,i=1048576*n.maxMemoryLimit,a=Math.round(t/1048576);n.setMemory(a),n.memoryText.setTint(n.normalColor),t>n.maxPercentThreshold/100*i&&n.memoryText.setTint(n.warningColor),t>i&&n.memoryText.setTint(n.alarmColor)}},n.performance=window.performance,n.createMemory(),n.setDepth(y.A.DEBUG),n.scene.add.existing((0,g.A)(n)),!n.isSupport())return n.memoryText.setText("Memory: not supported!"),(0,g.A)(n);var i=n.performance.memory.jsHeapSizeLimit;return n.maxPercentThreshold=90,n.setMaxMemory(i/1048576),n.scene.events.on(Phaser.Scenes.Events.UPDATE,n.update),n}(0,a.A)(t,e);var n=t.prototype;return n.isSupport=function(){var e;return this.performance&&!(null==(e=this.performance)||!e.memory)},n.setMaxMemory=function(e){this.maxMemoryLimit=Math.round(e)},n.setMemory=function(e){this.memory=e;var t=Phaser.Utils.String.Format(this.memoryString,[e,this.maxMemoryLimit]);this.memoryText.setText(t)},n.createMemory=function(){this.memoryText=this.scene.make.bitmapText({size:this.scene.fontSize(14),text:this.memoryString,font:v.A.FONT_TEXT_WHITE.KEY,depth:2e3}),this.memoryText.setName("Memory Meter"),this.add(this.memoryText),this.setMemory(0)},t}(Phaser.GameObjects.Container),C=P,w=n(491),I=n(492),x=n(224),k=n(494),O=n(142),_=l.A.DEFAULT,R=_.KEY,D=_.FRAME,M=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).popup=void 0,s.contents=void 0,s.buttonNo=void 0,s.buttonYes=void 0,s.messageText=void 0,s.popupShowUpAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.onHandleYes=void 0,s.open=function(t){e.prototype.open.call((0,g.A)(s),t),s.setVisible(!0);var n=s.getData(["message","onHandleYes"]),i=n[0],a=void 0===i?"":i,r=n[1];s.setTextMessage(a),s.onHandleYes=r,s.runOpenAnimation()},s.handleClosePopup=function(){s.runCloseAnimation(),s.popupFadeOutAnimation.next((function(){s.scene.screen.close(s.name)}))},s.handleNo=function(){s.close()},s.handleYes=function(){s.onHandleYes&&s.onHandleYes(),s.close()},s.setVisible(!1),s.setDepth(u.Ae.POPUP),s.createPopup(),s.createPopupContent(),s.background.setAlpha(.5),s}(0,a.A)(t,e);var n=t.prototype;return n.runAnim=function(){this.messageText.setScale(0).setAlpha(0)},n.createPopup=function(){this.popup=new k.A(this.scene,0,0,325,230,"settings"),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone)},n.createPopupContent=function(){this.createCloseBtn(),this.createMessage(),this.createButtonNo(),this.createButtonYes(),this.contents=this.scene.make.group({}),this.contents.addMultiple([this.messageText,this.buttonNo,this.buttonYes])},n.createCloseBtn=function(){var e=new x.A(this.scene,R,D.BUTTON_CLOSE,39,56);e.onClick=this.handleClosePopup,e.setName("Close"),Phaser.Display.Align.In.TopRight(e,this.popup,20,30),this.popup.add(e)},n.createButtonNo=function(){this.buttonNo=new x.A(this.scene,R,D.BUTTON_NO,88,79),this.buttonNo.setName("No");var e=this.scene.make.bitmapText({font:v.A.MIKADO_RED_STROKE.KEY,size:21,origin:{x:.5,y:.5},text:"NO"});this.buttonNo.add(e),Phaser.Display.Align.In.Center(e,this.buttonNo),this.popup.add(this.buttonNo),Phaser.Display.Align.In.Center(this.buttonNo,this.popup,80,40),this.buttonNo.onClick=this.handleNo},n.createButtonYes=function(){this.buttonYes=new x.A(this.scene,R,D.BUTTON_YES,88,79),this.buttonYes.setName("Yes");var e=this.scene.make.bitmapText({font:v.A.MIKADO_GREEN_STROKE.KEY,size:21,origin:{x:.5,y:.5},text:"YES"});this.buttonYes.add(e),Phaser.Display.Align.In.Center(e,this.buttonYes),this.popup.add(this.buttonYes),Phaser.Display.Align.In.Center(this.buttonYes,this.popup,-80,40),this.buttonYes.onClick=this.handleYes},n.createMessage=function(){this.messageText=this.scene.make.bitmapText({font:v.A.MIKADO_WHITE.KEY,size:this.scene.fontSize(45),origin:{x:.5,y:.5}}),this.messageText.align=1,this.popup.add(this.messageText),Phaser.Display.Align.In.Center(this.messageText,this.popup,0,-40),this.messageText.setScale(0).setAlpha(0)},n.runCloseAnimation=function(){this.runPopupExitsAnimation(0,200)},n.runPopupExitsAnimation=function(e,t){var n,i=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new c.A({targets:[this.popup],delay:e,duration:t,props:{scale:0},onComplete:function(){i.popup.setY(0)}})),null==(n=this.popupFadeOutAnimation)||n.play()},n.setTextMessage=function(e){this.messageText.setText(""+e)},n.runOpenAnimation=function(){this.scene.audio.playSound(O.A.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runPopupContentEntrancesAnimation(200,300)},n.runPopupEntrancesAnimation=function(e,t){if(!this.popupShowUpAnimation){var n=this.popup,i=(n.y,n.scale);this.popupShowUpAnimation=new I.A({targets:[this.popup],delay:e,duration:t,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:i}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(e,t){this.contentShowUpAnimation||(this.contentShowUpAnimation=new w.A({targets:this.contents.getChildren(),duration:t,delay:this.scene.tweens.stagger(80,{start:e}),props:{alpha:{start:0,from:0,to:1}}})),this.contentShowUpAnimation.play()},t}(GameCore.Screen),B=M,L=n(225),N=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).loadingIcon=void 0,s.messageText=void 0,s.openAnimation=void 0,s.closeTimerEvent=void 0,s.addLoadingIcon(),s.addMessageText(),s.setDepth(u.Ae.PRIORITY),s.background.setAlpha(.75),s}(0,a.A)(t,e);var n=t.prototype;return n.open=function(t){var n,i=this;e.prototype.open.call(this,t);var a=this.getData(["message","duration","loading"]),s=a[0],r=void 0===s?"":s,o=a[1],c=void 0===o?0:o,l=a[2],h=void 0!==l&&l;this.setMessage(r),this.showLoading(h),null==(n=this.closeTimerEvent)||n.remove(),c>0&&(this.closeTimerEvent=this.scene.time.addEvent({delay:c,callback:function(){i.visible&&i.scene.screen.close(i.name)}})),this.runOpenAnimation()},n.addLoadingIcon=function(){this.loadingIcon=new L.A(this.scene),this.add(this.loadingIcon),Phaser.Display.Align.In.Center(this.loadingIcon,this.zone)},n.addMessageText=function(){this.messageText=this.scene.make.bitmapText({size:20,font:v.A.MIKADO.KEY,origin:{x:.5,y:.5}}),this.messageText.setCenterAlign(),this.add(this.messageText)},n.setMessage=function(e){this.messageText.setText(e)},n.showLoading=function(e){this.loadingIcon.setVisible(e);var t=!1===e?20:80;Phaser.Display.Align.In.Center(this.messageText,this.zone,0,t)},n.runOpenAnimation=function(){var e,t;null==(e=this.openAnimation)||e.stop(),null==(t=this.openAnimation)||t.remove(),this.messageText.setScale(1),this.openAnimation=new w.A({targets:[this.messageText,this.loadingIcon],props:{scale:{getStart:function(e){return e.scale-.3},getEnd:function(e){return e.scale}}}}),this.openAnimation.play()},n.logPageviewOnOpen=function(){},n.logPageviewOnClose=function(){},t}(GameCore.Screen),G=N,F=l.A.DEFAULT,U=F.KEY,j=F.FRAME,V=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=e.call.apply(e,r()(t=[this]).call(t,a))||this).mask=void 0,n.fadeInAnim=void 0,n.fadeOutAnim=void 0,n.fpsMeter=void 0,n.memoryMeter=void 0,n.switchScene=function(e){n.currentScene.key!==e&&n.currentScene.switch(e)},n.runScene=function(e){n.currentScene.run(e)},n.emitGameEventStartScene=function(e){var t=e.scene.key;console.info("%cScene start","color: #D27D2D",t),n.updateSceneState(),n.runMaskFadeOutAnimation(),n.updateActiveSceneKey(t),n.game.events.emit(Phaser.Scenes.Events.START,t),(0,f.SJ)("scene","Start scene: "+t)},n.emitGameEventSleepScene=function(e){var t=e.scene.scene.key;console.info("%cScene sleep","color: #D27D2D",t),t!==h.F7.LOAD_SCENE&&(n.runMaskFadeInAnimation(),n.game.events.emit(Phaser.Scenes.Events.SLEEP,t))},n.emitGameEventWakeScene=function(e){var t=e.scene.scene.key;console.info("%cScene wake","color: #D27D2D",t),t!==h.F7.LOAD_SCENE&&(n.updateSceneState(),n.runMaskFadeOutAnimation(),n.updateActiveSceneKey(t),n.game.events.emit(Phaser.Scenes.Events.WAKE,t))},n.emitGameEventPauseScene=function(e){var t=e.scene.scene.key;console.info("%cScene pause","color: #D27D2D",t),n.game.events.emit(Phaser.Scenes.Events.PAUSE,t)},n.emitGameEventResumeScene=function(e){var t=e.scene.key;console.info("%cScene resume","color: #D27D2D",t),n.game.events.emit(Phaser.Scenes.Events.RESUME,t)},n.emitGameEventShutdownScene=function(e){var t=e.scene.scene.key;console.info("%cScene shutdown","color: #D27D2D",t),n.game.events.emit(Phaser.Scenes.Events.SHUTDOWN,t)},n}(0,a.A)(t,e);var n=t.prototype;return n.init=function(){this.listenScenesEvents(),this.game.globalScene=this},n.setup=function(){this.scaleGame(),this.addMask(),this.addNotifyScreen(),this.addAlertScreen(),this.addFPS(),this.addMemory()},n.addNotifyScreen=function(){var e=this.screen.add(u.R8.NOTIFY_SCREEN,G);Phaser.Display.Align.In.Center(e,this.gameZone)},n.addAlertScreen=function(){var e=this.screen.add(u.R8.ALERT_SCREEN,B);Phaser.Display.Align.In.Center(e,this.gameZone)},n.addMask=function(){this.mask=this.make.image({key:U,frame:j.BLANK});var e=this.gameZone,t=e.width,n=e.height;this.mask.setAlpha(0),this.mask.setOrigin(0,0),this.mask.setTint(0),this.mask.setWorldSize(t,n)},n.addFPS=function(){GameCore.Configs.Statistics.ShowFPSInGame&&(this.fpsMeter=new b(this),Phaser.Display.Align.In.TopLeft(this.fpsMeter,this.gameZone,-20,-10))},n.addMemory=function(){GameCore.Configs.Statistics.ShowMemoryInGame&&(this.memoryMeter=new C(this),Phaser.Display.Align.In.TopLeft(this.memoryMeter,this.gameZone,-45,-3))},n.updateSceneState=function(){this.setGlobalSceneOnTop()},n.setGlobalSceneOnTop=function(){this.scene.bringToTop(this)},n.runMaskFadeInAnimation=function(){var e,t;this.mask&&GameCore.Configs.EnableEffectSceneTransition&&(null==(e=this.fadeInAnim)||e.remove(),null==(t=this.fadeOutAnim)||t.remove(),this.fadeInAnim=new o.A({targets:[this.mask],duration:400,ease:Phaser.Math.Easing.Cubic.In,props:{alpha:{start:0,from:0,to:.6}}}),this.mask.setAlpha(0),this.fadeInAnim.play())},n.runMaskFadeOutAnimation=function(){var e,t;this.mask&&GameCore.Configs.EnableEffectSceneTransition&&(null==(e=this.fadeInAnim)||e.remove(),null==(t=this.fadeOutAnim)||t.remove(),this.fadeOutAnim=new c.A({targets:[this.mask],duration:400,ease:Phaser.Math.Easing.Cubic.Out,props:{alpha:{start:.6,from:.6,to:0}}}),this.mask.setAlpha(1),this.fadeOutAnim.play())},n.listenScenesEvents=function(){var e=this;this.scene.manager.getScenes(!1).forEach((function(t){t.events.on(Phaser.Scenes.Events.CREATE,e.emitGameEventStartScene),t.events.on(Phaser.Scenes.Events.SLEEP,e.emitGameEventSleepScene),t.events.on(Phaser.Scenes.Events.WAKE,e.emitGameEventWakeScene),t.events.on(Phaser.Scenes.Events.PAUSE,e.emitGameEventPauseScene),t.events.on(Phaser.Scenes.Events.RESUME,e.emitGameEventResumeScene),t.events.on(Phaser.Scenes.Events.SHUTDOWN,e.emitGameEventShutdownScene)})),this.events.on(h.yh.SWITCH,this.switchScene),this.events.on(h.yh.RUN,this.runScene)},n.getActiveScene=function(){return this.scene.manager.getScenes(!0)[0]},n.getCurrentScene=function(){return this.currentScene},n.updateActiveSceneKey=function(e){e!==h.F7.GLOBAL_SCENE&&this.storage.dispatch((0,d.T)(e))},n.logEventOpen=function(){},n.logPageviewOnOpen=function(){},(0,i.A)(t,[{key:"currentScene",get:function(){var e=this.storage.getState(),t=p(e);return(t?this.scene.manager.getScene(t):this.getActiveScene()).scene}}]),t}(m.A),z=V},562:function(e,t,n){"use strict";var i=n(471),a=n(57),s=n(134),r={ENV:"production",Notification:{Enable:!0},LeadersBoard:{Prefix:"leaderboards"},Debugger:{ShowInspector:!0,ShowMonitoring:!1,ShowConsole:!1},Statistics:{Enable:!1,ShowFPSInGame:!1,ShowMemoryInGame:!1},ParticleEditor:{Enable:!1},Game:{DisableLandscape:!1,FullSizeOnLandscape:!0}},o={ENV:"production",Notification:{Enable:!0},LeadersBoard:{Prefix:"leaderboards"},Debugger:{ShowInspector:!1,ShowMonitoring:!1,ShowConsole:!1},Statistics:{Enable:!1,ShowFPSInGame:!1,ShowMemoryInGame:!1},ParticleEditor:{Enable:!1}},c={ENV:"development",AppId:"498720425588109",ApiHost:"https://fbig-singleplay-apps-dev.sunstudio.io",OtherHost:"https://leaderboards-dev.sunstudio.io",SyncProfileFromAPI:!0,ProfilerPlugin:{Enable:!1},Notification:{Enable:!1,DisableSendNotification:!0,ApiUrl:"https://notifications.sunstudio.io",GameTitle:"Sun Studio",GameImage:"https://sunstudio.io/images/logo.png"},AddShortcut:{UseMock:!1},SubscribeBot:{UseMock:!1},PlayerMock:{id:"",signature:""},OpponentMock:{id:"",signature:""},MatchMockFailRate:5,Gameplay:{StartLevel:1,StartScore:0,StartDiamonds:0,LevelDifficultRate:{FromUnder30:1.07,FromUnder35:1.05,FromUnder45:1.05,FromUnder200:1.1},StartAdAtLevel:2,GiftTime:10800,AwardDiamonds:100,FreeItems:!1,DelayStart:2e3,DelayLevelUp:1800,DelayFinishGame:500,EnableVibrate:!0,VibrateValue:[0,0,199,299,399,499,599],Progress:{BonusScore:5e3,Milestone:3},MaxGemInPiece:1,RatePieceContainGem:10},Tutorial:{ForceUseTutorial:!1,NumberOfTutorial:{FirstMove:3,TargetScore:1,CurrentScore:1,ColorfulGem:1,ItemPaint:1,ItemHammer:1,ItemShuffle:1}},PlayerDataStore:"playerData",Game:{AutoResize:!0,PortraitRatio:450/667,PortraitWidth:375,PortraitHeight:667,LandscapeRatio:375/667,LandscapeWidth:375,LandscapeHeight:667,ForcePixelRatio:0,DisableLandscape:!1,FullSizeOnLandscape:!0},Debugger:{ShowInspector:!0,ShowMonitoring:!1,ShowConsole:!1,Expanded:!0,AutoRefresh:!0,InspectorAutoUpdate:!0,Opacity:.8},Statistics:{Enable:!1,DisplayMode:0,FPS:!0,MS:!0,MB:!0,Opacity:.8,ShowFPSInGame:!0,ShowMemoryInGame:!1},ParticleEditor:{Enable:!1,Opacity:.8,Expanded:!0},CanvasRecorder:{Enable:!1,Options:{Type:"png",Quality:.85,RecordFps:60,SyncFps:!0}},Match:{MaxRescueCount:1,RescueGamePopupTimeout:15,DelayNoThank:1e3,ContinueSingleMatchEnabled:!1,SingleMatchStore:"singleMatch",JourneyMatchStore:"journeyMatch",LivesStore:"lives",LocalSingleMatchDefault:{_id:"12345678890",status:"open",playerId:"",score:0,level:1,startedAt:0,updateAt:0,finishAt:0,data:{}},Levels:[100,500,1e3,1500,2e3,3e3,4e3,5e3,6e3,7500,9e3,11500,13e3,15e3,17e3,19e3,21e3,23e3,25e3,1e5],PieceRandoms:{maxPiece:200,measureError:.5}},DailyRewards:{MaxDays:6,MockTime:0,CheckInterrupt:!0},DailyTasks:{Duration:86400},Tournament:{UseMock:!1,ForcePlay:!1,UseLeaderboard:!0,TournamentContextIds:[],YourMockTournamentCount:1},LeadersBoard:{UseMock:!1,Prefix:"leaderboards",LeaderboardId:"62ff4b32b2198c615726a9a2",Limit:50,MockOptions:{PlayerEntryIndex:-1}},LanguageSupport:{en:"en"},EnableEffectSceneTransition:!0,DefaultTheme:"default",ThemeSupport:{default:"default"},Ads:{Enabled:!0,InterstitialPlacementId:"",VideoRewardsPlacementId:"",BannerPlacementId:"",BannerReloadPeriod:60,BannerHeight:{Desktop:70,Mobile:50},Mockup:{Enable:!0,ErrorRate:5,GiphyApiKey:"VmjHIRsfrwCAssDS4mDo9DoImxJm1lLM"},InterstitialAdOptions:{secondsFirstTime:90,secondsBetweenAds:180}},Network:{MaximumRequest:6,Timeout:15e3,Retries:3},Analytics:{GameAnalytics:{key:"",secret:"",consoleLog:!1},GoogleAnalytics:{consoleLog:!1},FacebookAnalytics:{prefix:"fba",consoleLog:!1}},MagnetItem:{key:"magnet-item",scoreForOnePercent:4,maxMagnetPerMatch:5},Board:{cols:8,rows:8},Sentry:{errorCodes:{accepted:[],ignored:["USER_INPUT","NETWORK_FAILURE"]},errorMessages:{accepted:[],ignored:["Load image failed"]}},DailyChallenge:{Prefix:"leaderboards",LeaderBoardId:"61e00146f28777ad0e328f2c"},Lives:{bonusDurationMins:5,bonusLife:1,livesCapacity:10},Rollbar:{Enable:!1,UseMockup:!1,FilterError:{Codes:{accepted:[],ignored:["USER_INPUT","NETWORK_FAILURE"]},Messages:{accepted:[],ignored:["Load image failed"]}},ListPlayerDevIds:[]},Performance:{Enable:!1,trackingSceneKeys:["DASHBOARD_SCENE","GAME_SCENE"],minQuality:1,maxQuality:2,fpsThreshold:48,checkInterval:2e3,qualityAdjustStep:.1,autoUpgradeQuality:!0,onlyUpdateWhenSwitchScene:!0},Loader:{LazyTexture32Bit:!0}};c=(0,s.h1)((0,a.A)({},c),o);var l=c=(0,s.h1)((0,a.A)({},c),r),h=function(e){return function(t){try{var n=window.game,i=t.module;if(n.scene.getScenes(!0)[0].scene.key!==e)return;var a=i.default;n.scene.remove(e),n.scene.add(e,a,!0),n.scene.bringToTop(n.globalScene),console.log("%c HotScene: ","font-size:12px;background-color: #465975;color:#fff;",e)}catch(r){var s;null==(s=void 0)||s.invalidate()}}},u=n(616),d=n.n(u),p=n(91),f=n.n(p),m=n(59),g=n.n(m),v=n(618),y=n.n(v),A=n(620),E=n.n(A),T=n(472),S=!1,b=function e(t,n,i){n.forEach((function(n){if(n.name){var a=null;if(a=i?i.getByName(n.name):t.children.getByName(n.name),S&&console.log("%c Checking object: ","font-size:12px;background-color: #465975;color:#fff;",n.name,n.type),a){if("Container"===n.type){var s=a,r=n.getAll();if(e(t,r,s),!s.hotContainer)return;console.log("%c Update container: ","font-size:12px;background-color: #33A5FF;color:#fff;",s.name)}var o=d()(n),c=["_events","_sysEvents","input","localTransform","list","displayList"],l=f()(o).call(o,(function(e){if("string"!==typeof e)return!1;if(g()(c).call(c,e)>=0)return!1;if(!a)return!1;var t=y()(n,e);return!(t instanceof Function)&&(!(t instanceof Phaser.Scene)&&(!(t instanceof Phaser.GameObjects.Group)&&(!(t instanceof Phaser.GameObjects.GameObject)&&t===y()(a,e))))}));l.length<1||(S&&console.log("%c HotObject: ","font-size:12px;background-color: #2EAFB0;color:#fff;",n.name,l),l.forEach((function(e){if(a){var t=y()(n,e),i=y()(a,e),s=E()(a,e,t);S&&console.log("%c Update property: ","font-size:12px;background-color: #B03734;color:#fff;",s,e,{oldValue:i,newValue:t})}})))}}}))},P=function(e,t){return void 0===t&&(t=S),function(n){try{var i=window.game,a=n.module,s=i.scene.getScenes(!0)[0];if(s.scene.key!==e)return;S=t;var r=a.default,o=e+"-draft";i.scene.remove(o);var c=i.scene.add(o,r);console.log("%c HotSceneObjects: ","font-size:12px;background-color: #465975;color:#fff;",e),s=i.scene.getScene(e),c.events.once(Phaser.Scenes.Events.RENDER,(0,T.s)((function(){var e=c.children.getAll();b(s,e),i.scene.remove(o)})),50),i.scene.run(o),i.scene.bringToTop(s),i.scene.bringToTop(i.globalScene)}catch(l){console.warn(l)}}},C={Scene:h,SceneObjects:P},w={Configs:l,Utils:i.A,LiveUpdate:C};window.GameCore=w;console.warn("production",{Configs:l,isDebugger:i.A.Valid.isDebugger()});var I=w,x=n(47),k=n(473),O=n(23),_=n(4),R=n(20),D=n.n(R),M=n(71),B=n.n(M),L=n(72),N=n.n(L),G=n(666),F=function(){function e(e){this.game=void 0,this.game=e}var t=e.prototype;return t.addKillRevive=function(){var e=this;[Phaser.GameObjects.RenderTexture,Phaser.GameObjects.Container,Phaser.GameObjects.Image,Phaser.GameObjects.Sprite,Phaser.GameObjects.Graphics,Phaser.GameObjects.Shape,Phaser.GameObjects.Text,Phaser.GameObjects.BitmapText,Phaser.GameObjects.Particles.ParticleEmitter,Phaser.GameObjects.Particles.ParticleEmitterManager].forEach((function(t){t.prototype.kill=e.kill,t.prototype.revive=e.revive}))},t.addKillReviveGroup=function(){Phaser.GameObjects.Group.prototype.killGroup=this.killGroup,Phaser.GameObjects.Group.prototype.reviveGroup=this.reviveGroup},t.addSetWorldSize=function(){var e=this;[Phaser.GameObjects.RenderTexture,Phaser.GameObjects.Image,Phaser.GameObjects.Sprite].forEach((function(t){t.prototype.setWorldSize=e.setWorldSize}))},t.addSetWorldSizeForContainer=function(){var e=this;[Phaser.GameObjects.Container].forEach((function(t){t.prototype.setWorldSize=e.setWorldSizeForContainer}))},t.addGetWorldPosition=function(){var e=this;[Phaser.GameObjects.RenderTexture,Phaser.GameObjects.Container,Phaser.GameObjects.Image,Phaser.GameObjects.Sprite,Phaser.GameObjects.Graphics,Phaser.GameObjects.Shape,Phaser.GameObjects.Text,Phaser.GameObjects.BitmapText].forEach((function(t){t.prototype.getWorldPosition=e.getWorldPosition}))},t.addDrawDebugBox=function(){var e=this;[Phaser.GameObjects.RenderTexture,Phaser.GameObjects.Container,Phaser.GameObjects.Image,Phaser.GameObjects.Sprite,Phaser.GameObjects.Graphics,Phaser.GameObjects.Shape,Phaser.GameObjects.Text,Phaser.GameObjects.BitmapText,Phaser.GameObjects.Zone].forEach((function(t){t.prototype.drawDebugBox=e.drawDebugBox}))},t.addHighQuality=function(){var e=this;[Phaser.GameObjects.Text].forEach((function(t){t.prototype.setHighQuality=e.setHighQuality}))},t.addSetLineHeightForBitmapText=function(){Phaser.GameObjects.BitmapText.prototype.setLineHeight=function(e){this.lineHeight=e,this.updateDisplayOrigin()}},t.kill=function(){this.setActive(!1),this.setVisible(!1)},t.revive=function(){this.setActive(!0),this.setVisible(!0)},t.killGroup=function(){this.getChildren().forEach((function(e){e.setActive(!1),e.setVisible(!1)}))},t.reviveGroup=function(){this.getChildren().forEach((function(e){e.setActive(!0),e.setVisible(!0)}))},t.setWorldSize=function(e,t){this.setSize(e,t),this.setDisplaySize(e,t)},t.setWorldSizeForContainer=function(e,t,n){void 0===n&&(n=2),this.setSize(e*n,t*n),this.setDisplaySize(e,t)},t.getWorldPosition=function(){var e=this.getWorldTransformMatrix().decomposeMatrix();return{x:e.translateX,y:e.translateY}},t.drawDebugBox=function(e,t){var n=this.x,i=this.y,a=this.width,s=this.height,r=this.depth,o=this.originX,c=this.originY,l=this.scene.add.rectangle(n,i,a,s,e,t);l.setName("Debug Box"),l.setDepth(r);var h=GameCore.Utils.Valid.isNumber;return h(o)&&h(c)&&l.setOrigin(o,c),l},t.setHighQuality=function(){return this.renderer instanceof Phaser.Renderer.WebGL.WebGLRenderer?this.setResolution(2*this.scene.game.world.getZoomRatio()):this},e}(),U=F,j=GameCore.Configs.Ads,V=j.Mockup,z=j.BannerHeight,Y=V.GiphyApiKey,H=z.Desktop,K=z.Mobile,W=function(){function e(){}return e.loadBannerAdAsync=function(){var e=(0,O.A)(D().mark((function e(){var t,n,i,a,s,r;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getAdContentAsync();case 2:if(t=e.sent,!(n=document.getElementById("mock-banner-ads"))){e.next=11;break}if((i=n.getElementsByTagName("img"))&&!(i.length<=0)){e.next=8;break}return e.abrupt("return");case 8:i[0].src=t,e.next=28;break;case 11:a=GameCore.Utils.Device.isDesktop(),(s=document.createElement("div")).id="mock-banner-ads",s.style.width="100%",s.style.height=a?H+"px":K+"px",s.style.bottom="var(--sab)",s.style.position="fixed",s.style.background="#fff url("+t+") center center/auto no-repeat",s.style.outline="2px solid #ffffff40",s.style.outlineOffset="-2px",r=document.createElement("style"),(document.head||document.getElementsByTagName("head")[0]).appendChild(r),"@keyframes fake-gif {\n                0%,10% {\n                    background-position-y: top\n                }\n                60% {\n                    background-position-y: center\n                }\n                100% {\n                    background-position-y: bottom\n                }\n            }",r.appendChild(document.createTextNode("@keyframes fake-gif {\n                0%,10% {\n                    background-position-y: top\n                }\n                60% {\n                    background-position-y: center\n                }\n                100% {\n                    background-position-y: bottom\n                }\n            }")),s.style.animation="fake-gif 6s ease-in-out 0s infinite alternate both",document.body.appendChild(s);case 28:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),e.getAdContentAsync=function(){var e=(0,O.A)(D().mark((function e(){var t,n,i,a,s;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="https://api.giphy.com/v1/gifs/trending?api_key="+Y+"&rate=pg&bundle=low_bandwidth",e.next=3,fetch(t,{method:"GET"});case 3:return n=e.sent,e.next=6,n.json();case 6:if(i=e.sent,GameCore.Utils.Valid.isObject(i)){e.next=9;break}return e.abrupt("return","");case 9:return a=i.data,s=Math.floor(Math.random()*a.length),e.abrupt("return",a[s].images.downsized.url);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e.hideBannerAdAsync=function(){var e=(0,O.A)(D().mark((function e(){var t;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=document.getElementById("mock-banner-ads")){e.next=3;break}return e.abrupt("return");case 3:t.remove();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e}(),Z={LOADED:"loaded",DISPLAYED:"displayed"},X=function(e){return e.IDLE="idle",e.LOADING="loading",e.FILLED="filled",e.SHOWING="showing",e}(X||{}),J=X,q=function(e){return e.REWARDED="rewarded",e.INTERSTITIAL="interstitial",e}(q||{}),Q=q,$=n(30),ee=function(e){function t(t,n){var i;return(i=e.call(this,n)||this).code=void 0,i.code=t,i.message=n,i}return(0,_.A)(t,e),t}((0,$.A)(Error)),te=function(e){this.type=void 0,this.status=void 0,this.type=e,this.status=J.IDLE};GameCore.Ads={Types:Q,Status:J,Events:Z,AdError:ee,AdInstance:te};var ne=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=e.call.apply(e,B()(t=[this]).call(t,a))||this).events=void 0,n.enabled=void 0,n.config=void 0,n.lastAdShownTime=void 0,n.intervalBannerAd=void 0,n.interstitial=void 0,n.rewardedVideo=void 0,n.safeAreaBottom=void 0,n.loadBannerAdAsync=(0,O.A)(D().mark((function e(){var t;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n.enabled){e.next=3;break}return e.abrupt("return");case 3:if(!GameCore.Configs.Ads.Mockup.Enable){e.next=8;break}return e.next=7,W.loadBannerAdAsync();case 7:return e.abrupt("return");case 8:return t=n.config.bannerPID,e.next=11,FBInstant.loadBannerAdAsync(t);case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.log(e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])}))),n}(0,_.A)(t,e);var n=t.prototype;return n.init=function(){this.events=new Phaser.Events.EventEmitter,this.lastAdShownTime=0,this.calculateSafeAreaBottom()},n.calculateSafeAreaBottom=function(){try{this.safeAreaBottom=parseInt(getComputedStyle(document.documentElement).getPropertyValue("--sab")),isNaN(this.safeAreaBottom)&&(this.safeAreaBottom=0)}catch(e){this.safeAreaBottom=0}},n.configure=function(e,t){this.enabled=t.enabled,this.config=t,this.setAdInstance(e)},n.setAdInstance=function(e){var t=this.config,n=t.interstitialPID,i=t.rewardedVideoPID;this.interstitial=new e(Q.INTERSTITIAL,n),this.rewardedVideo=new e(Q.REWARDED,i)},n.preloadInterstitialAdAsync=function(){var e=(0,O.A)(D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.preloadAdAsync(Q.INTERSTITIAL);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.showInterstitialAdAsync=function(){var e=(0,O.A)(D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.canbeShowInterstitialAd()){e.next=2;break}throw new ee("INTERSTITIAL_AD_CAN_NOT_SHOW","Can't show interstitial ad");case 2:return e.next=4,this.showAdAsync(Q.INTERSTITIAL);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.preloadRewardedVideoAsync=function(){var e=(0,O.A)(D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.preloadAdAsync(Q.REWARDED);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.showRewardedVideoAsync=function(){var e=(0,O.A)(D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.showAdAsync(Q.REWARDED);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.preloadAdAsync=function(){var e=(0,O.A)(D().mark((function e(t){var n;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.enabled){e.next=2;break}throw new ee("ADS_NOT_ENABLED","Ads is't enabled");case 2:if(null!==(n=this.getAdInstanceByType(t))){e.next=5;break}throw new ee("AD_INSTANCE_NOT_INITIATED","The instance ads not yet initiated");case 5:return e.next=7,n.loadAsync();case 7:this.events.emit(Z.LOADED,t);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.showAdAsync=function(){var e=(0,O.A)(D().mark((function e(t){var n;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.enabled){e.next=2;break}throw new ee("ADS_NOT_ENABLED","Ads is't enabled");case 2:if(null!==(n=this.getAdInstanceByType(t))){e.next=5;break}throw new ee("AD_INSTANCE_NOT_INITIATED","The instance ads not yet initiated");case 5:return this.lastAdShownTime=window.performance.now()/1e3,e.next=8,n.showAsync();case 8:this.events.emit(Z.DISPLAYED,t);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.getAdStatus=function(e){var t=this.getAdInstanceByType(e);return t?t.getStatus():null},n.getAdInstanceByType=function(e){switch(e){case Q.INTERSTITIAL:return this.interstitial;case Q.REWARDED:return this.rewardedVideo;default:return null}},n.canbeShowInterstitialAd=function(){return this.canbeShowInterstitialAdByTime()},n.canbeShowInterstitialAdByTime=function(){var e=window.performance.now()/1e3,t=this.config.interstitialAdOptions,n=t.secondsFirstTime,i=t.secondsBetweenAds,a=e-this.lastAdShownTime;return this.lastAdShownTime>0?a>i:a>n},n.showBannerAdAsync=function(){var e=(0,O.A)(D().mark((function e(t){var n;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t=!0),this.enabled){e.next=3;break}return e.abrupt("return");case 3:if(GameCore.Configs.Ads.Mockup.Enable||this.game.facebook.isSupportedAPI("loadBannerAdAsync")){e.next=6;break}return e.abrupt("return");case 6:return n=this.config.bannerReloadPeriod,this.intervalBannerAd&&clearInterval(this.intervalBannerAd),e.next=10,this.loadBannerAdAsync();case 10:t&&(this.intervalBannerAd=setInterval(this.loadBannerAdAsync,1e3*n));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.hideBannerAdAsync=function(){var e=(0,O.A)(D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,this.enabled){e.next=3;break}return e.abrupt("return");case 3:if(!GameCore.Configs.Ads.Mockup.Enable){e.next=8;break}return e.next=7,W.hideBannerAdAsync();case 7:return e.abrupt("return");case 8:return e.next=10,FBInstant.hideBannerAdAsync();case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0);case 15:return e.prev=15,this.intervalBannerAd&&clearInterval(this.intervalBannerAd),this.intervalBannerAd=null,e.finish(15);case 19:case"end":return e.stop()}}),e,this,[[0,12,15,19]])})));return function(){return e.apply(this,arguments)}}(),n.getBannerHeight=function(){if(!this.enabled)return 0;var e,t=this.safeAreaBottom,n=GameCore.Configs.Ads.BannerHeight;if(e=GameCore.Utils.Device.isDesktop()?n.Desktop:n.Mobile,this.game.world){var i=this.game.world,a=i.getZoomRatio(),s=i.getPixelRatio();return this.game.world.getPhysicPixels(e+t,s/a)}return e+t},t}(Phaser.Plugins.BasePlugin),ie=ne,ae=function(){function e(e,t,n){this.name=void 0,this.color=void 0,this.selfLog=void 0,this.options=void 0,this.name=e,this.color=n||"#FFF",this.options=t,this.selfLog=!0,console.info("%c"+this.name+": init","color: "+this.color,this.options)}var t=e.prototype;return t.event=function(e,t,n){this.processEvent(e,t,n),this.selfLog&&console.info("%c"+this.name+": event","color: "+this.color,{name:e,value:n,payload:t})},t.pageview=function(e){var t=this.getPageByKey(e);this.processPageView(t),this.selfLog&&console.info("%c"+this.name+": pageview","color: "+this.color,{page:t})},t.levelStart=function(e,t,n){this.processLevelStart(e,t,n),this.selfLog&&console.info("%c"+this.name+": level start","color: "+this.color,{level:e,score:t,levelName:n})},t.levelFail=function(e,t,n){this.processLevelFail(e,t,n),this.selfLog&&console.info("%c"+this.name+": level fail","color: "+this.color,{level:e,score:t,levelName:n})},t.levelRescue=function(e,t,n){this.processLevelRescue(e,t,n),this.selfLog&&console.info("%c"+this.name+": level rescue","color: "+this.color,{level:e,score:t,levelName:n})},t.levelComplete=function(e,t,n){this.processLevelComplete(e,t,n),this.selfLog&&console.info("%c"+this.name+": level complete","color: "+this.color,{level:e,score:t,levelName:n})},t.loadInterstitialAd=function(e){this.processLoadInterstitialAd(e),this.selfLog&&console.info("%c"+this.name+": load interstitial ad","color: "+this.color,{placement:e})},t.showInterstitialAd=function(e){this.processShowInterstitialAd(e),this.selfLog&&console.info("%c"+this.name+": show interstitial ad","color: "+this.color,{placement:e})},t.loadRewardedVideoAd=function(e){this.processLoadRewardedVideoAd(e),this.selfLog&&console.info("%c"+this.name+": load rewarded video ad","color: "+this.color,{placement:e})},t.showRewardedVideoAd=function(e){this.processShowRewardedVideoAd(e),this.selfLog&&console.info("%c"+this.name+": show rewarded video ad","color: "+this.color,{placement:e})},t.receiveReward=function(e){this.processReceiveReward(e),this.selfLog&&console.info("%c"+this.name+": receive reward","color: "+this.color,{placement:e})},t.loadAdFail=function(e,t,n){this.processLoadAdFail(e,t,n),this.selfLog&&console.info("%c"+this.name+": load ad fail","color: "+this.color,{type:e,placement:t,reason:n})},t.showAdFail=function(e,t,n){this.processShowAdFail(e,t,n),this.selfLog&&console.info("%c"+this.name+": show ad fail","color: "+this.color,{type:e,placement:t,reason:n})},t.getPageByKey=function(e){var t=e.replace(/_/g,"-");return t=t.toLowerCase()},t.processLevelStart=function(e,t,n){},t.processLevelFail=function(e,t,n){},t.processLevelRescue=function(e,t,n){},t.processLevelComplete=function(e,t,n){},t.processLoadInterstitialAd=function(e){},t.processShowInterstitialAd=function(e){},t.processLoadRewardedVideoAd=function(e){},t.processShowRewardedVideoAd=function(e){},t.processReceiveReward=function(e){},t.processLoadAdFail=function(e,t,n){},t.processShowAdFail=function(e,t,n){},e}();GameCore.Analytics={BaseAnalytics:ae};var se=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=e.call.apply(e,B()(t=[this]).call(t,a))||this).analytics=void 0,n.pageview=function(e){n.isActive()&&n.analytics.forEach((function(t){t.pageview(e)}))},n}(0,_.A)(t,e);var n=t.prototype;return n.init=function(){this.analytics=[]},n.add=function(e){this.analytics.push(e)},n.event=function(e,t,n){this.isActive()&&this.analytics.forEach((function(i){i.event(e,t,n)}))},n.levelStart=function(e,t,n){this.isActive()&&this.analytics.forEach((function(i){i.levelStart(e,t,n)}))},n.levelRescue=function(e,t,n){this.isActive()&&this.analytics.forEach((function(i){i.levelRescue(e,t,n)}))},n.levelFail=function(e,t,n){this.isActive()&&this.analytics.forEach((function(i){i.levelFail(e,t,n)}))},n.levelComplete=function(e,t,n){this.isActive()&&this.analytics.forEach((function(i){i.levelComplete(e,t,n)}))},n.loadInterstitialAd=function(e){this.isActive()&&this.analytics.forEach((function(t){t.loadInterstitialAd(e)}))},n.showInterstitialAd=function(e){this.isActive()&&this.analytics.forEach((function(t){t.showInterstitialAd(e)}))},n.loadRewardedVideoAd=function(e){this.isActive()&&this.analytics.forEach((function(t){t.loadRewardedVideoAd(e)}))},n.showRewardedVideoAd=function(e){this.isActive()&&this.analytics.forEach((function(t){t.showRewardedVideoAd(e)}))},n.receiveReward=function(e){this.isActive()&&this.analytics.forEach((function(t){t.receiveReward(e)}))},n.loadAdFail=function(e,t,n){this.isActive()&&this.analytics.forEach((function(i){i.loadAdFail(e,t,n)}))},n.showAdFail=function(e,t,n){this.isActive()&&this.analytics.forEach((function(i){i.showAdFail(e,t,n)}))},n.isActive=function(){return this.analytics.length>=1},t}(Phaser.Plugins.BasePlugin),re=se,oe=n(508),ce=n.n(oe),le=n(92),he=n.n(le),ue=function(){function e(e){var t=this;this.game=void 0,this.audios=void 0,this.volume=void 0,this.soundKeys=void 0,this.isMusicEnabled=function(){return!!t.game.player.getPlayerSetting("music")},this.isSoundEnabled=function(){return!!t.game.player.getPlayerSetting("sound")},this.game=e,this.audios=new(ce()),this.soundKeys=new(ce())}var t=e.prototype;return t.addSoundKeys=function(e){var t=this;he()(e).forEach((function(n){var i=e[n];"string"===typeof i&&t.soundKeys.set(n,i)}))},t.clearSoundKeys=function(){this.soundKeys.clear()},t.play=function(e,t){var n=this,i=(0,a.A)({volume:this.volume},t||{});i.volume!==this.volume&&(i.volume*=this.volume);var s=this.audios.get(e);if(!s&&this.game.cache.audio.exists(e)){var r=this.game.sound.add(e);this.audios.set(e,r),s=r}if(s)s.play(void 0,i);else{var o=this.soundKeys.get(e);if(!o)return console.log(this.soundKeys.get(e),e),void console.warn(e+" not found. Use importSoundEffectKeys from audio plugin to add it.");try{console.log(e,o,"load_sound_plugin"),this.game.globalScene.load.audio(e,o),this.game.globalScene.load.on(Phaser.Loader.Events.FILE_KEY_COMPLETE+"audio-"+e,(function(){console.log(e,o,"finish");var t=n.game.sound.add(e);n.audios.set(e,t),t.play(void 0,i)})),this.game.globalScene.load.start()}catch(c){console.warn(c)}}},t.pauseAll=function(){this.audios.forEach((function(e){e.pause()}))},t.resumeAll=function(){this.audios.forEach((function(e){e.resume()}))},t.stopAll=function(){this.audios.forEach((function(e){e.stop()}))},t.pause=function(e){var t=this.audios.get(e);t&&t.pause()},t.stop=function(e){var t=this.audios.get(e);t&&t.stop()},t.setVolume=function(e){this.volume=e},e}(),de=ue,pe=function(){function e(e,t){var n=this;this.name=void 0,this.game=void 0,this.isSprite=void 0,this.audio=void 0,this.markers=void 0,this.volume=void 0,this.isMusicEnabled=function(){return!!n.game.player.getPlayerSetting("music")},this.isSoundEnabled=function(){return!!n.game.player.getPlayerSetting("sound")},this.name=t,this.game=e,this.markers={},this.isSprite=!1,this.isSprite||(this.audio=this.game.sound.add(this.name))}var t=e.prototype;return t.play=function(e,t){var n,i,s,r=(0,a.A)({volume:this.volume},t||{});if(r.volume!==this.volume&&(r.volume*=this.volume),!this.isSprite)return(null==(i=this.audio)?void 0:i.seek)>0?void this.audio.resume():void(null==(s=this.audio)||s.play(e,r));this.createMaker(e),null==(n=this.markers[e])||n.play(e,r)},t.pause=function(e){var t,n;this.isSprite?null==(t=this.markers[e])||t.pause():null==(n=this.audio)||n.pause()},t.stop=function(e){var t,n;this.isSprite?null==(t=this.markers[e])||t.stop():null==(n=this.audio)||n.stop()},t.setVolume=function(e){this.volume=e,this.audio.setVolume(e)},t.getVolume=function(){return this.volume},t.createMaker=function(e){if(!this.markers[e])try{this.markers[e]=this.game.sound.addAudioSprite(this.name)}catch(t){console.warn("createMaker",t)}},e}(),fe=pe,me=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=e.call.apply(e,B()(t=[this]).call(t,a))||this).soundManager=void 0,n.musicManager=void 0,n.isMuteAll=void 0,n.initMusic=function(e){n.musicManager=new fe(n.game,e),n.setMusicVolume(1)},n.initSound=function(){n.soundManager=new de(n.game),n.setSoundVolume(1)},n}(0,_.A)(t,e);var n=t.prototype;return n.importSoundEffectKeys=function(e){this.soundManager.addSoundKeys(e)},n.playSound=function(e,t){try{if(!this.soundManager||this.isMuteAll||!this.game.visibility.isGameVisible())return;if(!this.soundManager.isSoundEnabled())return;this.soundManager.play(e,t)}catch(n){}},n.stopSound=function(e){try{this.soundManager.stop(e)}catch(t){}},n.playMusic=function(e){void 0===e&&(e={});try{if(!this.musicManager||this.isMuteAll||!this.game.visibility.isGameVisible())return;if(!this.musicManager.isMusicEnabled())return;this.musicManager.play("",(0,a.A)({loop:!0,volume:.2},e))}catch(t){}},n.pauseMusic=function(){try{if(!this.musicManager)return;this.musicManager.pause("")}catch(e){}},n.stopMusic=function(){try{if(!this.musicManager)return;this.musicManager.stop("")}catch(e){}},n.pauseAllSounds=function(){try{if(!this.soundManager)return;this.soundManager.pauseAll()}catch(e){}},n.resumeAllSounds=function(){try{if(!this.soundManager)return;this.soundManager.resumeAll()}catch(e){}},n.setSoundVolume=function(e){try{if(!this.soundManager)return;this.soundManager.setVolume(e)}catch(t){console.warn("setSoundVolume",t)}},n.getMusicVolume=function(){var e;return(null==(e=this.musicManager)?void 0:e.getVolume())||.2},n.setMusicVolume=function(e){try{if(!this.musicManager)return;this.musicManager.setVolume(e)}catch(t){console.warn("setMusicVolume",t)}},n.muteAll=function(){this.isMuteAll=!0,this.game.sound.mute=!0},n.unmuteAll=function(){this.isMuteAll=!1,this.game.sound.mute=!1},t}(Phaser.Plugins.BasePlugin),ge=me,ve=n(107),ye="AUTH_TOKEN_REQUEST",Ae="AUTH_TOKEN_RECEIVED",Ee=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).payload=void 0,i.name="RequestTokenFail",i.message=t||"Request token fail",i.payload=n||{},i}return(0,_.A)(t,e),t}((0,$.A)(Error)),Te=n(58),Se="auth",be=(0,Te.Mz)([function(e){return e[Se].token}],(function(e){return e})),Pe=(0,Te.Mz)([function(e){return e[Se].isRequesting}],(function(e){return e})),Ce=function(e){return{type:Ae,payload:{token:e}}},we=function(e){function t(){return e.apply(this,arguments)||this}(0,_.A)(t,e);var n=t.prototype;return n.requestToken=function(){var e=(0,O.A)(D().mark((function e(){var t;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.game.storage,e.next=3,t.dispatch(function(){var e=(0,O.A)(D().mark((function e(t,n){var i,a,s,r;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,i=window.game.facebook,a=n(),s=be(a),!Pe(a)&&""===s){e.next=7;break}return e.abrupt("return");case 7:return t({type:ye,payload:{}}),e.next=10,i.getPlayerToken();case 10:r=e.sent,t(Ce(r)),e.next=25;break;case 14:if(e.prev=14,e.t0=e.catch(0),!(e.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(e.t0,"code"))){e.next=19;break}if("PENDING_REQUEST"!==e.t0.code){e.next=19;break}return e.abrupt("return");case 19:if(t(Ce("")),!(e.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(e.t0,"message"))){e.next=24;break}if("string"!==typeof e.t0.message){e.next=24;break}return(0,x.a0)(new Error(e.t0.message)),e.abrupt("return");case 24:(0,x.a0)(new Ee);case 25:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t,n){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.getToken=function(){return be(this.state)},(0,ve.A)(t,[{key:"state",get:function(){return this.game.storage.getState()}}]),t}(Phaser.Plugins.BasePlugin),Ie=we,xe=function(e,t){void 0===t&&(t=1);var n=new Image;n.onload=function(){var n,i,a=(n=this.width*t,i=this.height*t,{string:"+",style:"font-size: 1px; padding: "+Math.floor(i/2)+"px "+Math.floor(n/2)+"px;"});console.info("%c "+a.string,a.style+" background: transparent url("+e+") no-repeat center center; background-size: "+this.width*t+"px "+this.height*t+"px;")},n.src=e},ke=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=e.call.apply(e,B()(t=[this]).call(t,a))||this).width=void 0,n.height=void 0,n.renderOptions=void 0,n.canvas=void 0,n}(0,_.A)(t,e);var n=t.prototype;return n.preload=function(e){var t=this,n=he()(e);n.length<1||(n.forEach((function(n){t.scene.load.image(n,e[n])})),this.scene.load.start())},n.capture=function(){var e=(0,O.A)(D().mark((function e(t){var n,i,a;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.width,i=t.height,a=t.renderOptions,this.width=n,this.height=i,this.renderOptions=a,this.createCanvas(),e.next=7,this.loadImages();case 7:return this.drawObjects(),e.abrupt("return",this.snapshotFrame());case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.createCanvas=function(){this.canvas||(this.canvas=this.game.textures.createCanvas("FrameCaptureCanvas")),this.canvas.clear(),this.canvas.setSize(this.width,this.height)},n.loadImages=function(){var e=[];for(var t in this.renderOptions){var n=this.renderOptions[t],i=n.name,a=n.image,s=n.fallbackWithImage;if(a)if(this.scene.textures.get(i).key!==i&&""!==i){var r=this.loadImage(i,a,s);e.push(r)}}return this.scene.load.start(),N().all(e)},n.loadImage=function(e,t,n){var i=this;return this.scene.load.image(e,t),new(N())((function(t,a){var s=Phaser.Loader.Events.FILE_KEY_COMPLETE+"image-"+e,r=Phaser.Loader.Events.FILE_LOAD_ERROR,o=function e(n){i.scene.load.off(s,e),i.scene.load.off(r,c),t()},c=function c(l){if(l.key===e)if(i.scene.load.off(s,o),i.scene.load.off(r,c),n)t();else{var h=new Error("Load image failed");a(h)}};i.scene.load.on(s,o),i.scene.load.on(r,c)}))},n.drawObjects=function(){for(var e in this.renderOptions){var t=this.renderOptions[e];switch(t.type){case"text":this.drawText(t);break;case"image":this.drawImage(t)}}},n.drawText=function(e){var t=this.canvas.context,n=e.x,i=e.y,a=e.font,s=e.text,r=e.fillStyle,o=e.lineWidth,c=e.textAlign;t.font=a+' nunito,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",sans-serif',t.fillStyle=r||"#ffffff",o&&(t.lineWidth=o),c&&(t.textAlign=c),t.fillText(s,n,i)},n.drawImage=function(e){var t=this.canvas.context,n=e.x,i=e.y,a=e.name,s=e.frame,r=e.width,o=e.height,c=e.fallbackWithImage,l=this.scene.textures.get(a),h=l.getSourceImage(s);"__MISSING"===l.key&&c&&(h=(l=this.scene.textures.get(c)).getSourceImage()),t.drawImage(h,n,i,r,o)},n.snapshotFrame=function(){var e=this.canvas.getCanvas().toDataURL("image/jpeg",.85);return GameCore.Utils.Valid.isDebugger()&&xe(e),e},t}(Phaser.Plugins.ScenePlugin),Oe=ke,_e=n(115),Re=n.n(_e),De={sound:!0,music:!0,vibrate:!0,language:"en",theme:GameCore.Configs.DefaultTheme},Me=n(73),Be=n.n(Me),Le=n(509),Ne=n.n(Le),Ge=De.sound,Fe=De.music,Ue=De.vibrate,je=De.language,Ve=De.theme,ze=function(){function e(e){this.sound=void 0,this.music=void 0,this.vibrate=void 0,this.language=void 0,this.theme=void 0;var t=e||{},n=t.sound,i=t.music,a=t.vibrate,s=t.language,r=t.theme;this.sound=GameCore.Utils.Valid.isBoolean(n)?n:Ge,this.music=GameCore.Utils.Valid.isBoolean(i)?i:Fe,this.vibrate=GameCore.Utils.Valid.isBoolean(a)?a:Ue,this.language=GameCore.Utils.Valid.isString(s)?s:je,this.theme=GameCore.Utils.Valid.isString(r)?r:Ve}return e.prototype.toObject=function(){return{sound:this.sound,music:this.music,vibrate:this.vibrate,language:this.language,theme:this.theme}},e}(),Ye=ze,He=GameCore.Utils,Ke=He.Valid,We=He.Object,Ze=function(){function e(e){this.score=void 0,this.settings=void 0,this.gameData=void 0,this.userGuideDisplays=void 0,this.timeAddShortcut=void 0,this.setupDefaultData(),this.updateScore(e),this.updateSettings(e),this.updateGameData(e),this.updateUserGuideDisplays(e),this.updateTimeAddShortcut(e)}var t=e.prototype;return t.setupDefaultData=function(){this.score=0,this.settings=(0,a.A)({},De),this.gameData={coins:0,diamond:0,lastReceiveGift:0,dailyRewarded:{lastRewarded:0,logDays:[]},dailyTasks:{startedTime:0,logTasks:{}},completedJourneySeasons:{},levelOfSeasons:{}},this.userGuideDisplays=0,this.timeAddShortcut=0},t.updateScore=function(e){var t=e.score;!1!==Ke.isNumber(t)&&(this.score=t)},t.updateSettings=function(e){var t=e.settings;if(!1!==Ke.isObject(t)){var n=new Ye(t).toObject();this.settings=n}},t.updateGameData=function(e){var t=e.gameData;if(!1!==Ke.isObject(t)){if(We.hasOwn(t,"coins")&&Ke.isNumber(t.coins)&&(this.gameData.coins=t.coins),We.hasOwn(t,"diamond")&&Ke.isNumber(t.diamond)&&(this.gameData.diamond=t.diamond),We.hasOwn(t,"lastReceiveGift")&&Ke.isNumber(t.lastReceiveGift)&&(this.gameData.lastReceiveGift=t.lastReceiveGift),We.hasOwn(t,"dailyRewarded")&&Ke.isObject(t.dailyRewarded)){var n=t.dailyRewarded;We.hasOwn(n,"lastRewarded")&&Ke.isNumber(n.lastRewarded)&&(this.gameData.dailyRewarded.lastRewarded=n.lastRewarded),We.hasOwn(n,"logDays")&&Array.isArray(n.logDays)&&(this.gameData.dailyRewarded.logDays=n.logDays)}if(We.hasOwn(t,"dailyTasks")&&Ke.isObject(t.dailyTasks)){var i=t.dailyTasks;We.hasOwn(i,"startedTime")&&Ke.isNumber(i.startedTime)&&(this.gameData.dailyTasks.startedTime=i.startedTime),We.hasOwn(i,"logTasks")&&Ke.isObject(i.logTasks)&&(this.gameData.dailyTasks.logTasks=i.logTasks)}this.isValidCompletedJourneySeasonsData(t.completedJourneySeasons)&&(this.gameData.completedJourneySeasons=t.completedJourneySeasons),Ke.isObject(t.levelOfSeasons)&&(this.gameData.levelOfSeasons=t.levelOfSeasons)}},t.isValidCompletedJourneySeasonsData=function(e){if(!Ke.isObject(e))return!1;for(var t=0,n=Ne()(e);t<n.length;t++){var i=n[t];if(!Ke.isObject(i))return!1;for(var a=0,s=Ne()(i);a<s.length;a++){var r=s[a];if(!Ke.isBoolean(r))return!1}}return!0},t.updateUserGuideDisplays=function(e){var t=e.userGuideDisplays;!1!==Ke.isNumber(t)&&(this.userGuideDisplays=t)},t.updateTimeAddShortcut=function(e){var t=e.timeAddShortcut;!1!==Ke.isNumber(t)&&(this.timeAddShortcut=t)},t.toObject=function(){return{score:this.score,settings:this.settings,gameData:this.gameData,userGuideDisplays:this.userGuideDisplays,timeAddShortcut:this.timeAddShortcut}},t.convertToPlayerData=function(){var e=this.gameData,t=e.coins,n=e.diamond,i=e.dailyTasks,a=e.dailyRewarded,s=e.lastReceiveGift,r=e.completedJourneySeasons,o=e.levelOfSeasons;return{score:this.score,settings:this.settings,customFields:{coins:t,diamond:n,dailyTasks:i,dailyRewarded:a,lastReceiveGift:s,completedJourneySeasons:r,levelOfSeasons:o},userGuideDisplays:this.userGuideDisplays,timeAddShortcut:this.timeAddShortcut}},t.convertToFacebookData=function(e){var t=e.score,n=e.settings,i=e.customFields,a=e.userGuideDisplays,s=e.timeAddShortcut;return this.updateScore({score:t}),this.updateSettings({settings:n}),this.updateGameData({gameData:i}),this.updateUserGuideDisplays({userGuideDisplays:a}),this.updateTimeAddShortcut({timeAddShortcut:s}),this.toObject()},e}(),Xe=Ze,Je=n(136),qe=GameCore.Configs.ApiHost,Qe=(function(){var e=(0,O.A)(D().mark((function e(t){var n,i;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=GameCore.Utils.String.params(t),e.next=3,(0,Je.J)("players?"+n,{},qe);case 3:return i=e.sent,e.abrupt("return",(null==i?void 0:i.data)||[]);case 5:case"end":return e.stop()}}),e)})))}(),function(){var e=(0,O.A)(D().mark((function e(t){var n;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,Je.b)("players",t,{},qe,10);case 2:return n=e.sent,e.abrupt("return",(null==n?void 0:n.data)||{});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),$e=function(){var e=(0,O.A)(D().mark((function e(t){var n;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,Je.b)("players/"+t+"/user-guide-displays/inc",{},{},qe);case 2:return n=e.sent,e.abrupt("return",(null==n?void 0:n.data)||{});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),et="PLAYER_RECEIVED",tt="PLAYER_DATA_UPDATE",nt="PLAYER_SCORE_UPDATE",it="PLAYER_PROFILE_UPDATE",at="PLAYER_SETTING_UPDATE",st="PLAYER_CONNECTED_PLAYERS_UPDATE",rt=n(221),ot=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).payload=void 0,i.name="PlayerDataNameNotSupport",i.message=t||"The name of player data is not supported",i.payload=n||{},i}return(0,_.A)(t,e),t}((0,$.A)(Error)),ct=n(51),lt=n.n(ct),ht="player",ut=(0,Te.Mz)([function(e){return e[ht]}],(function(e){return e})),dt=(0,Te.Mz)([ut],(function(e){return e.playerId})),pt=(0,Te.Mz)([ut],(function(e){return e.ASID})),ft=(0,Te.Mz)([function(e){return e[ht].data}],(function(e){return e})),mt=((0,Te.Mz)([ft],(function(e){return e.settings})),(0,Te.Mz)([function(e){return e[ht].connectedPlayers}],(function(e){return e}))),gt=(0,Te.Mz)([mt,function(e,t){return t.limit},function(e,t){return t.offset}],(function(e,t,n){if("number"!==typeof t)return[];if("number"!==typeof n)return[];var i=he()(e);return lt()(i).call(i,n,t+n)||[]})),vt=(0,Te.Mz)([ft],(function(e){return e.score})),yt=(0,Te.Mz)([ft],(function(e){return e.customFields})),At=((0,Te.Mz)([yt],(function(e){return null==e?void 0:e.diamond})),(0,Te.Mz)([yt],(function(e){return void 0===(null==e?void 0:e.tournaments)?[]:Array.isArray(e.tournaments)?e.tournaments:[]}))),Et=GameCore.Configs,Tt=Et.AppId,St=Et.Tutorial,bt=function(e,t){return function(n){var i=e.playerId,a=e.name,s=e.photo,r=e.locale;n({type:et,payload:{playerId:i,name:a,photo:s,locale:r,data:t||{}}})}},Pt=function(e){return{type:st,payload:{connectedPlayers:e}}},Ct=function(e,t){return function(){var n=(0,O.A)(D().mark((function n(i,a){var s,r,o;return D().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,i({type:at,payload:{name:e,value:t}});case 3:s=a(),r=ft(s),o=new Xe({}).convertToFacebookData(r),FBInstant.player.setDataAsync(o),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(0),(0,x.a0)(n.t0);case 12:case"end":return n.stop()}}),n,null,[[0,9]])})));return function(e,t){return n.apply(this,arguments)}}()},wt=function(e,t){return function(){var n=(0,O.A)(D().mark((function n(i,a){var s,r,o,c,l;return D().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,r={customFields:(s={},s[e]=t,s)},n.next=4,i(kt(r));case 4:o=a(),c=ft(o),l=new Xe({}).convertToFacebookData(c),FBInstant.player.setDataAsync(l),n.next=15;break;case 10:if(n.prev=10,n.t0=n.catch(0),!(n.t0 instanceof ot)){n.next=14;break}return n.abrupt("return");case 14:(0,x.a0)(n.t0);case 15:case"end":return n.stop()}}),n,null,[[0,10]])})));return function(e,t){return n.apply(this,arguments)}}()},It=function(e){return function(){var t=(0,O.A)(D().mark((function t(n,i){var a,s,r,o;return D().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a={customFields:e},t.next=4,n(kt(a));case 4:s=i(),r=ft(s),o=new Xe({}).convertToFacebookData(r),FBInstant.player.setDataAsync(o),t.next=16;break;case 10:if(t.prev=10,t.t0=t.catch(0),console.log("\ud83e\udd16 ? error",t.t0),!(t.t0 instanceof ot)){t.next=15;break}return t.abrupt("return");case 15:(0,x.a0)(t.t0);case 16:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e,n){return t.apply(this,arguments)}}()},xt=function(e){return function(){var t=(0,O.A)(D().mark((function t(n,i){var a,s,r;return D().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a={customFields:e},t.next=4,n(kt(a));case 4:s=i(),r=ft(s),Qe(r),t.next=14;break;case 9:if(t.prev=9,t.t0=t.catch(0),!(t.t0 instanceof ot)){t.next=13;break}return t.abrupt("return");case 13:(0,x.a0)(t.t0);case 14:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e,n){return t.apply(this,arguments)}}()},kt=function(e){return{type:tt,payload:{data:e}}},Ot=function(e){return function(){var t=(0,O.A)(D().mark((function t(n,i){var a,s,r;return D().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n({type:nt,payload:{score:e}});case 3:Qe({score:e}),a=i(),s=ft(a),r=new Xe({}).convertToFacebookData(s),FBInstant.player.setDataAsync(r),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),(0,x.a0)(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e,n){return t.apply(this,arguments)}}()},_t=function(e){return function(){var t=(0,O.A)(D().mark((function t(n,i){var a,s,r;return D().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n(kt({timeAddShortcut:e}));case 3:a=i(),s=ft(a),r=new Xe({}).convertToFacebookData(s),FBInstant.player.setDataAsync(r),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),(0,x.a0)(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e,n){return t.apply(this,arguments)}}()},Rt=function(e){function t(){return e.apply(this,arguments)||this}(0,_.A)(t,e);var n=t.prototype;return n.incUserGuideDisplays=function(){var e=(0,O.A)(D().mark((function e(){var t;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.game.storage,e.next=3,t.dispatch(function(){var e=(0,O.A)(D().mark((function e(t,n){var i,a,s,r;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!St.ForceUseTutorial){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,t(kt({userGuideDisplays:1}));case 5:i=n(),a=dt(i),s=ft(i),r=new Xe({}).convertToFacebookData(s),FBInstant.player.setDataAsync(r),$e(a),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),(0,x.a0)(e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t,n){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.receiveData=function(){var e=(0,O.A)(D().mark((function e(t,n){var i;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.game.storage,e.next=3,i.dispatch(bt(t,n));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.updateData=function(){var e=(0,O.A)(D().mark((function e(){var t;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.game.storage,e.next=3,t.dispatch(function(){var e=(0,O.A)(D().mark((function e(t,n){var i,a,s,r,o,c,l,h;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=n(),a=ut(i),s=a.playerId,r=a.name,o=a.photo,c=a.locale,e.next=6,FBInstant.player.getASIDAsync();case 6:return l=e.sent,h={appId:Tt,playerId:s,name:r,photo:o,locale:c,ASID:l},e.next=10,t({type:it,payload:{profile:h}});case 10:return e.next=12,Qe(h);case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),(0,x.a0)(e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t,n){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.setBestScore=function(){var e=(0,O.A)(D().mark((function e(t){var n;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.game.storage,e.next=3,n.dispatch(Ot(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.setTimeAddShortcut=function(){var e=(0,O.A)(D().mark((function e(t){var n;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.game.storage,e.next=3,n.dispatch(_t(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.setSetting=function(){var e=(0,O.A)(D().mark((function e(t,n){var i;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.game.storage,e.next=3,i.dispatch(Ct(t,n));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.setCustomData=function(){var e=(0,O.A)(D().mark((function e(t,n){var i;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.game.storage,e.next=3,i.dispatch(wt(t,n));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.setMultiCustomData=function(){var e=(0,O.A)(D().mark((function e(t){var n;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.game.storage,e.next=3,n.dispatch(It(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.requestConnectedPlayers=function(){var e=(0,O.A)(D().mark((function e(){var t;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.game.storage,e.next=3,t.dispatch(function(){var e=(0,O.A)(D().mark((function e(t){var n,i,a,s;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,FBInstant.player.getConnectedPlayersAsync();case 3:if(i=e.sent,a=function(e){return!!e},s=f()(n=Be()(i).call(i,(function(e){var t=e.getID(),n=e.getName(),i=e.getPhoto();return t&&n&&i?new rt.A(t,n,i).toObject():null}))).call(n,a),!(s.length<1)){e.next=8;break}return e.abrupt("return");case 8:t(Pt(s)),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),(0,x.a0)(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateConnectedPlayers=function(){var e=(0,O.A)(D().mark((function e(t){var n;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.game.storage,e.next=3,n.dispatch(Pt(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.getPlayer=function(){return ut(this.state)},n.getPlayerId=function(){return this.getPlayer().playerId},n.getPlayerASID=function(){return pt(this.state)},n.getPlayerData=function(){return this.getPlayer().data},n.getPlayerSetting=function(e){var t=this.getPlayerSettings();return"string"!==typeof e?null:GameCore.Utils.Object.hasOwn(t,e)?t[e]:GameCore.Utils.Object.hasOwn(De,e)?De[e]:null},n.getPlayerSettings=function(){return this.getPlayerData().settings},n.getPlayerIsNew=function(){return this.getPlayer().isUserNew},n.getDiamond=function(){var e=this.getCustomData("diamond");return GameCore.Utils.Valid.isNumber(e)?e:0},n.getBestScore=function(){return vt(this.state)},n.getCustomData=function(e){var t=yt(this.state);return GameCore.Utils.Valid.isObject(t)&&GameCore.Utils.Object.hasOwn(t,e)?t[e]:null},n.getConnectedPlayers=function(){return mt(this.state)},n.getConnectedPlayerIds=function(e,t){return gt(this.state,{limit:e,offset:t})},n.joinTournament=function(){var e=(0,O.A)(D().mark((function e(t){var n,i,a;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.getTournaments(),!Re()(i).call(i,(function(e){return e.leaderboardId===t.leaderboardId}))){e.next=3;break}return e.abrupt("return");case 3:return a=B()(n=[]).call(n,i,[t]),e.next=6,this.updateCustomFields({tournaments:a});case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.getTournaments=function(){return At(this.state)},n.updateCustomFields=function(){var e=(0,O.A)(D().mark((function e(t){var n;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.game.storage,e.next=3,n.dispatch(xt(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),(0,ve.A)(t,[{key:"state",get:function(){return this.game.storage.getState()}}]),t}(Phaser.Plugins.BasePlugin),Dt=Rt,Mt=GameCore.Configs.ApiHost,Bt=function(){var e=(0,O.A)(D().mark((function e(t){var n,i;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=GameCore.Utils.String.params(t),e.next=3,(0,Je.J)("players?"+n,{},Mt);case 3:return i=e.sent,e.abrupt("return",(null==i?void 0:i.data)||[]);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Lt="PROFILES_DATA_UPDATE",Nt="profile",Gt=(0,Te.Mz)([function(e){return e[Nt].data}],(function(e){return e})),Ft=(0,Te.Mz)([function(e){return e[Nt].profileIds}],(function(e){return e})),Ut=function(e){return function(){var t=(0,O.A)(D().mark((function t(n,i){var a,s,r,o;return D().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,a=i(),s=Ft(a),!((r=GameCore.Utils.Array.difference(e,s)).length<1)){t.next=6;break}return t.abrupt("return");case 6:return t.next=8,Bt({playerIds:r});case 8:o=t.sent,n({type:Lt,payload:{data:o}}),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),(0,x.a0)(t.t0);case 15:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e,n){return t.apply(this,arguments)}}()},jt=function(e){function t(){return e.apply(this,arguments)||this}(0,_.A)(t,e);var n=t.prototype;return n.requestProfiles=function(){var e=(0,O.A)(D().mark((function e(t){var n;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.game.storage,e.next=3,n.dispatch(Ut(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.getProfiles=function(){return Gt(this.state)},(0,ve.A)(t,[{key:"state",get:function(){return this.game.storage.getState()}}]),t}(Phaser.Plugins.BasePlugin),Vt=jt,zt=n(40),Yt=n.n(zt),Ht=n(75),Kt=n.n(Ht),Wt=n(239),Zt=n.n(Wt),Xt=["player","match"],Jt="null",qt=GameCore.Configs.Rollbar,Qt=qt.UseMockup,$t=qt.FilterError,en=qt.ListPlayerDevIds,tn=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=e.call.apply(e,B()(t=[this]).call(t,a))||this).enable=void 0,n.rollbar=void 0,n.events=[],n.beforeSend=function(e,t,i){Qt&&n.showPopupError(i)},n.checkIgnore=function(e,t,i){try{return!!n.isErrorIgnore(t)&&(console.warn(t),!0)}catch(a){return!1}},n.showPopupError=function(e){var t,i,a,s=null==e||null==(t=e.body)||null==(t=t.trace)?void 0:t.exception;s&&n.events.push(s);var r=(null==e||null==(i=e.body)||null==(i=i.trace)?void 0:i.frames)||[];(a=n.events).push.apply(a,r);var o=document.getElementById("popup-error");o||((o=document.createElement("div")).id="popup-error",document.body.appendChild(o)),o.innerHTML='<div style="color: #fff; display: flex; flex-flow: column; align-items: center; ">\n      <pre id="json" style="overflow: auto; background-color: rgb(195 112 97 / 80%); padding: 10px; max-height: 80vh; max-width: 90vw; border: 5px solid #545454;">'+Yt()(n.events,null,2)+'</pre>\n      <button id="close" style="cursor: pointer; padding: 10px 20px; border-radius: 100px;">Close</button>\n      </div>',o.style="top: 0px; z-index: 10000; width: 100vw; max-height: 100vh; position: absolute; display: flex; align-items: center; justify-content: center;";var c=document.getElementById("close");c&&(c.onclick=n.closePopup)},n.closePopup=function(){n.events=[{}];var e=document.getElementById("popup-error");null==e||e.remove()},n.isNoneErrorEvent=function(e){if(!e||0===e.length)return!1;if(!e[0].message)return!1;return"Non-Error promise rejection captured with keys: code, message"===e[0].message},n.isErrorIgnore=function(e){if(!e||0===e.length)return!1;var t=!1,i=e[0];return i instanceof Object&&(t=n.isIgnoreByCode(i)||n.isIgnoreByMessage(i)),t},n.isIgnoreByCode=function(e){if(GameCore.Utils.Object.hasOwn(e,"code")){var t=e.code,n=$t.Codes,i=n.accepted,a=n.ignored;if("string"===typeof t){if(g()(i).call(i,t)>=0)return!1;if(g()(a).call(a,t)>=0)return!0}}else if(GameCore.Utils.Object.hasOwn(e,"name")){var s=e.name,r=$t.Codes,o=r.accepted,c=r.ignored;if("string"===typeof s){if(g()(o).call(o,s)>=0)return!1;if(g()(c).call(c,s)>=0)return!0}}return!1},n.isIgnoreByMessage=function(e){if(GameCore.Utils.Object.hasOwn(e,"message")){var t=e.message,n=$t.Messages,i=n.accepted,a=n.ignored;if("string"===typeof t){if(g()(i).call(i,t)>=0)return!1;if(g()(a).call(a,t)>=0)return!0}}return!1},n.addExtraState=function(){try{if(!GameCore.Utils.Object.hasOwn(window,"game"))return;if(!GameCore.Utils.Object.hasOwn(window.game,"storage"))return;if(!GameCore.Utils.Object.hasOwn(window.game.storage,"getState"))return;var e=(0,window.game.storage.getState)()||{},t=e.player,i=e.match,a=(0,k.A)(e,Xt);n.rollbar.configure({payload:{player:t,match:i,other:a}})}catch(s){console.warn("%c addExtraState: ","font-size:12px;background-color: #42b983;color:#fff;",s)}},n}(0,_.A)(t,e);var n=t.prototype;return n.setup=function(){this.rollbar=new(Zt())({accessToken:Jt,checkIgnore:this.checkIgnore,onSendCallback:this.beforeSend,captureUncaught:!0,scrubTelemetryInputs:!0,captureUnhandledRejections:!0,autoInstrument:{dom:!1,navigation:!1},payload:{environment:"production",client:{javascript:{code_version:"12"}},server:{root:"webpack:///./",branch:"master"}}}),this.enable=!0,this.sendTestException()},n.configure=function(e){this.rollbar&&this.rollbar.configure(e)},n.sendTestException=function(){var e=this.game.facebook.getPlayerID();Kt()(en).call(en,e)&&this.rollbar.debug(new Error("Test rollbar"),{playerID:e})},n.sendException=function(e,t){e&&(this.enable?this.rollbar&&(this.addExtraState(),this.rollbar.error(e,t)):console.error(e))},t}(Phaser.Plugins.BasePlugin),nn=tn,an=function(e){function t(){return e.apply(this,arguments)||this}return(0,_.A)(t,e),t.prototype.emit=function(t,n){return e.prototype.emit.call(this,t,n)},t}(Phaser.Events.EventEmitter),sn=an,rn=n(48),on=n(476),cn=function(e){function t(t,n,i,a){var s;(s=e.call(this,t)||this).zone=void 0,s.background=void 0,s.setName(n),s.setVisible(!1);var r=s.scene.world.getWorldSize(),o=r.width,c=r.height;return s.setSize(i||o,a||c),s.addZone(),s.addBackground(),s.registerEvents(),s}(0,_.A)(t,e);var n=t.prototype;return n.open=function(e){GameCore.Utils.Valid.isObject(e)&&(this.setDataEnabled(),this.setData(e)),this.setBlockInputOutsideEnabled(!0),this.scene.screen.bringToTop(this.name),this.visible||(this.setVisible(!0),this.logPageviewOnOpen(),this.logEventOpen(),this.handleResize())},n.close=function(){this.setBlockInputOutsideEnabled(!1),this.visible&&(this.setVisible(!1),this.logPageviewOnClose())},n.incY=function(e){this.y+=e,this.background.y-=e},n.incX=function(e){this.x+=e,this.background.x-=e},n.incScale=function(e){this.scale+=e,this.background.scale-=e^e*(100/e)},n.setBlockInputOutsideEnabled=function(e){this.scene.input.setTopOnly(e)},n.addZone=function(){this.zone=this.scene.add.zone(0,0,this.width,this.height),this.zone.setInteractive({}),this.add(this.zone)},n.addBackground=function(){var e="screen-background";if(!this.scene.textures.exists(e)){var t=this.width+2,n=this.height+2,i=this.scene.add.graphics();i.fillStyle(0,1),i.fillRect(0,0,t,n),i.generateTexture(e,t,n),i.destroy()}this.background=this.scene.add.image(0,0,e),this.add(this.background)},n.registerEvents=function(){this.scene.world.events.on(on.A.RESIZE,this.handleResize,this)},n.handleResize=function(){var e=this.scene.world.getWorldSize(),t=e.width,n=e.height;this.setSize(t,n).setPosition(t/2,n/2),this.zone.setSize(this.width,this.height),this.background.setDisplaySize(this.width,this.height)},n.logPageviewOnOpen=function(){this.scene.analytics.pageview(this.name)},n.logPageviewOnClose=function(){this.scene.analytics.pageview(this.scene.scene.key)},n.logEventOpen=function(){this.scene.analytics.event(rn.o.SCREEN_OPEN,{screen_name:this.getScreenName()})},n.getScreenName=function(){return GameCore.Utils.String.toUpperCamelCase(this.name.toLowerCase())},t}(Phaser.GameObjects.Container),ln=cn,hn={OPEN:"open",CLOSE:"close",CREATED:"created"};GameCore.Screen=ln,GameCore.Screens={Events:hn};var un=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=e.call.apply(e,B()(t=[this]).call(t,a))||this).events=void 0,n.screens=[],n}(0,_.A)(t,e);var n=t.prototype;return n.boot=function(){this.events=new sn,this.registryScreenFactory()},n.get=function(e){var t=this.scene.children.getByName(e);return null===t?null:t},n.add=function(e,t,n,i){var a=this.get(e);return a||(a=this.scene.add.screen(e,t,n,i),this.screens.push(a),this.events.emit(GameCore.Screens.Events.CREATED,a),a)},n.open=function(e,t){var n=this.get(e);return!!n&&(n.open(t),n.emit(GameCore.Screens.Events.OPEN,n),this.events.emit(GameCore.Screens.Events.OPEN,n),console.log("Screen open",e,t),!0)},n.close=function(e){var t=this.get(e);return!!t&&(t.close(),t.emit(GameCore.Screens.Events.CLOSE,t),this.events.emit(GameCore.Screens.Events.CLOSE,t),console.log("Screen close",e),!0)},n.bringToTop=function(e){var t=this.scene.children.getByName(e);t&&this.scene.children.bringToTop(t)},n.registryScreenFactory=function(){Phaser.GameObjects.GameObjectFactory.register("screen",this.createScreen)},n.createScreen=function(e,t,n,i){var a=new t(this.scene,e,n,i);return Phaser.Display.Align.In.Center(a,this.scene.gameZone),this.existing(a),a},n.closeAllScreens=function(){var e=this;this.screens.forEach((function(t){t.visible&&e.close(t.name)}))},t}(Phaser.Plugins.ScenePlugin),dn=un,pn=n(437),fn=n.n(pn),mn=n(479),gn=n(137),vn=n(477),yn={currentSceneKey:"",prevSceneKey:""};(0,vn.rF)();var An,En,Tn,Sn,bn,Pn,Cn,wn,In,xn,kn,On={processed:!1,contextId:"",contextType:"SOLO",entryPointData:{},currentGameMode:""},_n=On,Rn={data:{}},Dn={token:"",isRequesting:!1},Mn=(An={},An[Se]=function(e,t){return void 0===e&&(e=Dn),(0,vn.Ay)(e,(function(e){var n=t.payload;if(n){var i=n.token;switch(t.type){case ye:e.isRequesting=!0;break;case Ae:e.token=i,e.isRequesting=!1}}}))},An),Bn={ASID:"",playerId:"",name:"",photo:"",locale:"",connectedPlayers:{},data:{score:0,settings:De,userGuideDisplays:0,customFields:{},timeAddShortcut:0},isUserNew:!0},Ln=(En={},En[ht]=function(e,t){return void 0===e&&(e=Bn),(0,vn.Ay)(e,(function(n){var i=t.payload;if(i){var a=i.name,r=i.value,o=i.data,c=void 0===o?{}:o,l=i.score,h=i.connectedPlayers,u=void 0===h?[]:h,d=i.profile;switch(t.type){case et:var p=i.playerId,f=i.name,m=i.photo,g=i.locale,v=i.data;if(n.playerId=p,n.name=f,n.photo=m,n.locale=g,GameCore.Utils.Valid.isObject(v)){var y=v;n.data=(0,s.h1)(e.data,y)}v.userGuideDisplays>0&&(n.isUserNew=!1);break;case it:var A=d.playerId,E=d.name,T=d.photo,S=d.locale,b=d.ASID;n.ASID=b,n.playerId=A,n.name=E,n.photo=T,n.locale=S;break;case nt:n.data.score=l;break;case at:if(!GameCore.Utils.Object.hasOwn(n.data.settings,a))break;n.data.settings[a]=r;break;case tt:n.data=(0,s.h1)(e.data,c),c.userGuideDisplays>0&&(n.isUserNew=!1);break;case st:if(u.length<=0)break;var P=GameCore.Utils.Object.keyBy(u,"playerId");n.connectedPlayers=(0,s.h1)(e.connectedPlayers,P)}}}))},En),Nn=n(647),Gn=n.n(Nn),Fn={data:{},profileIds:[]},Un=(Tn={},Tn[Nt]=function(e,t){return void 0===e&&(e=Fn),(0,vn.Ay)(e,(function(n){var i=t.payload;if(i){var r=i.data,o=void 0===r?[]:r;if(t.type===Lt){var c,l,h=GameCore.Utils.Object.keyBy(o,"playerId"),u=he()(h);n.data=(0,s.h1)((0,a.A)({},e.data),h),n.profileIds=B()(c=[]).call(c,new(Gn())(B()(l=[]).call(l,e.profileIds,u)))}}}))},Tn),jn=n(478),Vn=n(138),zn=n(139),Yn={mode:"",status:zn.Sr,rescued:0,startAt:0,finishAt:0,showMiniJourney:null},Hn={single:{_id:"",data:{fen:""},playerId:"",status:zn.Sr},group:{status:zn.Sr,opponentInfo:{playerId:"",name:"",photo:""}},challenge:{_id:"",status:zn.Sr,whitePlayerId:"",blackPlayerId:"",opponentInfo:{playerId:"",name:"",photo:""}},online:{_id:"",status:zn.Sr,players:{}},journey:{_id:"",data:{fen:""},playerId:"",status:zn.Sr,challengeMode:!1},updateAt:0,isRequesting:!1},Kn={current:{updateAt:0},data:{updateAt:0},isRequesting:!1},Wn=(Sn={},Sn[jn.L]=(0,mn.HY)({gameplay:function(e,t){return void 0===e&&(e=Yn),(0,vn.Ay)(e,(function(n){var i=t.payload;if(i){var a=i.mode,s=i.status,r=i.stateShowMiniJourney,o=i.rescued;switch(t.type){case Vn.uf:n.status=zn.Sr,n.mode=Yn.mode,n.rescued=Yn.rescued,n.startAt=Yn.startAt,n.finishAt=Yn.finishAt,n.opponentInfo=Yn.opponentInfo;break;case Vn.M9:n.mode=a,n.status=zn.yS,n.rescued=o,n.startAt=Date.now();break;case Vn.RK:n.mode="string"===typeof a?a:e.mode,n.status=s||e.status;break;case Vn.N5:n.status=zn.Ux,n.finishAt=Date.now();break;case Vn.Pt:n.rescued+=1;break;case Vn.ad:n.showMiniJourney=r;break;case Vn.pQ:n.rescued=0}}}))},match:function(e,t){return void 0===e&&(e=Hn),(0,vn.Ay)(e,(function(n){var i=t.payload;if(i){var s=i.match,r=i.opponentInfo,o=i.players,c=i.score,l=i.level;switch(t.type){case Vn._p:case Vn.vw:case Vn.nA:case Vn.KG:case Vn.pf:case Vn.QT:n.isRequesting=!0;break;case Vn.lM:n.single=(0,a.A)({},e.single,s),n.updateAt=Date.now();break;case Vn.p3:n.journey=(0,a.A)({},e.journey,s),n.updateAt=Date.now();break;case Vn.q3:n.journey.challengeMode=!0;break;case Vn.tH:n.journey.challengeMode=!1;break;case Vn.cC:n.isRequesting=!1,n.single=s||Hn.single;break;case Vn.sh:n.isRequesting=!1,n.journey=s||Hn.journey;break;case Vn.Mk:n.journey.score=c;break;case Vn.oo:n.journey.level=l;break;case Vn.it:n.isRequesting=!1,n.single=Hn.single;break;case Vn.Zh:n.isRequesting=!1,n.single.data.fen=Hn.single.data.fen;break;case Vn.iw:n.isRequesting=!1,n.journey=Hn.journey;break;case Vn.Li:case Vn.KV:n.isRequesting=!0,n.challenge.opponentInfo=r;break;case Vn.nb:n.isRequesting=!1,n.challenge=(0,a.A)({},s||Hn.challenge),n.challenge.opponentInfo=e.challenge.opponentInfo;break;case Vn.TI:n.isRequesting=!1,n.challenge=Hn.challenge;break;case Vn.XJ:n.group.status=zn.yS,r&&(n.group.opponentInfo=r);break;case Vn.YA:n.group.status=zn.Ux;break;case Vn.X:n.online.status=Hn.online.status,n.online.players=Hn.online.players;break;case Vn.Bi:n.online.status=zn.yS,n.online.players=o;break;case Vn.aY:n.online.status=zn.Ux}}}))},stats:function(e,t){return void 0===e&&(e=Kn),(0,vn.Ay)(e,(function(n){var i=t.payload;if(i){var r=i.playerId,o=i.stats,c=i.match,l=i.current,h=i.players,u=i.leaders;switch(t.type){case Vn.T9:delete n.data[r],n.current=Kn.current;break;case Vn.SA:n.data=Kn.data,n.isRequesting=!0;break;case Vn.Yz:n.data=o,n.isRequesting=!1;break;case Vn.RM:n.data[r]=o;break;case Vn.oR:n.current=(0,s.h1)((0,a.A)({},e.current),o);break;case Vn.Bi:he()(h).forEach((function(e){n.data[e]={score:0}}));break;case Vn._m:u.forEach((function(e){var t=e.playerId,i=e.score,a=e.rank;n.data[t]={score:i,rank:a}}));break;case Vn.nb:var d=c||{},p=d.blackPlayerId,f=d.blackPlayerScore,m=d.whitePlayerId,g=d.whitePlayerScore,v=d.whitePlayerLevel,y=d.blackPlayerLevel;if(!p||!m)break;l&&(n.current=l),n.data[p]={score:f,level:y},n.data[m]={score:g,level:v}}}}))}}),Sn),Zn=n(480),Xn=n(481),Jn={active:!1,tournamentId:null,leaderboardId:null,bestSessionScore:0,isRequesting:!1},qn=(bn={},bn[Zn.L]=function(e,t){return void 0===e&&(e=Jn),(0,vn.Ay)(e,(function(n){var i=t.payload;if(i){var a=i.score,s=void 0===a?0:a,r=i.tournamentId,o=i.leaderboardId;switch(t.type){case Xn.fX:n.active=!0,n.tournamentId=r,n.leaderboardId=o;break;case Xn.gJ:n.isRequesting=!0;break;case Xn.ii:n.isRequesting=!1,s>e.bestSessionScore&&(n.bestSessionScore=s)}}}))},bn),Qn="leaderboards",$n=n(116),ei=n.n($n),ti="LEADERBOARD_DATA_REQUEST",ni="LEADERBOARD_DATA_UPDATE",ii={leaderboardId:"",type:"",limit:0,offset:0,leaders:{},isRequesting:!1},ai=(Pn={},Pn[Qn]=function(e,t){return void 0===e&&(e=ii),(0,vn.Ay)(e,(function(n){var i=t.payload;if(i){var s=i.leaderboardId,r=i.type,o=i.limit,c=i.offset,l=i.leaders;switch(t.type){case ti:e.type!==r&&0===c&&(n.leaders=ii.leaders),n.isRequesting=!0,n.leaderboardId=s,n.type=r,n.limit=o,n.offset=c;break;case ni:if(n.isRequesting=!1,e.type!==r)break;var h=GameCore.Utils.Json.clone((0,a.A)({},e.leaders,l)),u=Ne()(h),d=f()(u).call(u,(function(e){return!!e.name&&!!e.photo}));ei()(d).call(d,(function(e,t){return+t.score-+e.score})),d.forEach((function(t,i){t.rank=i+1,e.leaders[t.playerId]||(n.leaders[t.playerId]=t)}));break;case"LEADERBOARD_DATA_CLEAR":n.isRequesting=!1,n.type=ii.type,n.limit=ii.limit,n.offset=ii.offset,n.leaders=ii.leaders,n.leaderboardId=ii.leaderboardId}}}))},Pn),si="missions",ri="MISSIONS_DATA_REQUEST",oi="MISSIONS_DATA_RECEIVE",ci="MISSION_UPDATE",li="MISSION_COMPLETED",hi={mission:null,missions:null,isRequesting:!1},ui=(Cn={},Cn[si]=function(e,t){return void 0===e&&(e=hi),(0,vn.Ay)(e,(function(n){var i,a,s=t.payload;if(s){var r=s.name,o=s.type,c=s.value,l=s.missions;switch(t.type){case ri:n.isRequesting=!0;break;case oi:if(n.isRequesting=!1,l.length<1)return;n.missions={},l.forEach((function(e){n.missions[e.name]=e}));break;case"MISSION_START":if(null===e.missions)break;var h=e.missions[r];n.mission={name:r,process:{},require:h.require,reward:h.reward},he()(h.require).forEach((function(e){n.mission.process[e]=0}));break;case ci:if((null==(i=e.mission)?void 0:i.name)!==r)break;n.mission.process[o]+=c;break;case li:if((null==(a=e.mission)?void 0:a.name)!==r)break;n.mission=null}}}))},Cn),di="dailyTasks",pi="DAILY_TASKS_DATA_REQUEST",fi="DAILY_TASKS_DATA_RECEIVE",mi="DAILY_TASKS_PROCESS_UPDATE",gi="DAILY_TASK_VALUE_ADD",vi="DAILY_TASK_FINISHED",yi={tasks:[],process:[],isRequesting:!1,isNotice:!1},Ai=(wn={},wn[di]=function(e,t){return void 0===e&&(e=yi),(0,vn.Ay)(e,(function(n){var i=t.payload;if(i){var a=i.id,s=i.type,r=i.value,o=i.tasks,c=i.process;switch(t.type){case pi:n.isRequesting=!0;break;case fi:n.isRequesting=!1,n.tasks=o;break;case mi:n.process=c;break;case gi:if(!e.process[a])break;n.process[a][s]+=r;break;case"DAILY_TASK_REWARDED":if(!e.process[a])break;n.process[a].rewarded=!0;break;case"DAILY_TASKS_SEEN":n.isNotice=!1;break;case vi:n.isNotice=!0}}}))},wn),Ei={rewards:[],isRequesting:!1},Ti=(In={},In.dailyRewards=function(e,t){return void 0===e&&(e=Ei),(0,vn.Ay)(e,(function(e){var n=t.payload;if(n){var i=n.rewards;switch(t.type){case"DAILY_REWARDS_REQUEST":e.isRequesting=!0;break;case"DAILY_REWARDS_RECEIVE":e.isRequesting=!1,e.rewards=i}}}))},In),Si={leaders:{},isRequesting:!1,time:0},bi=(xn={},xn.dailyChallenge=function(e,t){return void 0===e&&(e=Si),(0,vn.Ay)(e,(function(e){var n=t.payload;if(n){var i=n.leaders,a=n.time;switch(t.type){case"DAILY_CHALLENGE_REQUEST":e.isRequesting=!0;break;case"DAILY_CHALLENGE_UPDATE":e.isRequesting=!1,e.leaders=i;break;case"DAILY_CHALLENGE_TIME_PLAY_UPDATE":e.time=a}}}))},xn),Pi="lives",Ci="LIVES_UPDATED",wi={isRequesting:!1,lives:0,lastBonusLifeTime:0,countDownStartAt:0},Ii=(kn={},kn[Pi]=function(e,t){return void 0===e&&(e=wi),(0,vn.Ay)(e,(function(e){var n=t.payload;if(n){var i=n.data;switch(t.type){case"LIVES_REQUEST":e.isRequesting=!0;break;case Ci:e.isRequesting=!1,e.lives=i.lives,e.lastBonusLifeTime=i.lastBonusLifeTime;break;case"LIVES_RESET":e.isRequesting=!1,e.lives=wi.lives,e.lastBonusLifeTime=wi.lastBonusLifeTime,e.countDownStartAt=0;break;case"LIVES_COUNT_DOWN_START":e.countDownStartAt=(new Date).getTime()}}}))},kn),xi=(0,mn.HY)((0,a.A)({scene:function(e,t){return void 0===e&&(e=yn),(0,vn.Ay)(e,(function(n){var i=t.payload;if(i){var a=i.sceneKey;if(t.type===gn.N0)n.currentSceneKey=a,n.prevSceneKey=e.currentSceneKey}}))},context:function(e,t){return void 0===e&&(e=On),(0,vn.Ay)(e,(function(e){var n=t.payload;if(n){var i=n.gameMode,a=n.contextId,s=n.contextType,r=n.entryPointData;switch(t.type){case gn.Y8:e.contextId=a,e.contextType=s,e.entryPointData=r;break;case gn.xn:e.contextId=a,e.contextType=s,e.processed=!0;break;case gn.ow:e.currentGameMode=i}}}))},messages:function(e,t){return void 0===e&&(e=Rn),(0,vn.Ay)(e,(function(n){var i=t.payload;if(i){var a=i.opponentId;if("string"===typeof a)switch(t.type){case gn.K6:e.data[a]?n.data[a].sent=!0:n.data[a]={sent:!0};break;case gn.fD:e.data[a]?n.data[a].sent=!1:n.data[a]={sent:!1}}}}))}},Mn,Ln,Un,Wn,qn,ai,ui,Ai,Ti,bi,Ii)),ki=xi,Oi=n(667),_i=function(e){return(0,Oi.U1)({reducer:ki,preloadedState:e,devTools:!0})},Ri=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=e.call.apply(e,B()(t=[this]).call(t,a))||this).store=void 0,n.initiator=void 0,n.dispatch=function(e){return n.store.dispatch(e)},n.getState=function(){return n.store.getState()},n.subscribe=function(e){return n.store.subscribe(e)},n.watch=function(e,t){var i=fn()((function(){var t=n.getState();return e(t)}));return n.subscribe(i((function(e){t(e)})))},n}(0,_.A)(t,e);var n=t.prototype;return n.init=function(){this.store=_i({})},n.setInitiator=function(e){this.initiator=e},n.syncStore=function(){var e=(0,O.A)(D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.initiator.initContext(),e.next=3,this.initiator.initPlayer();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(Phaser.Plugins.BasePlugin),Di=Ri,Mi=n(650),Bi=n.n(Mi),Li=function(e){function t(t,n){var i;return(i=e.call(this,t,{type:"webfont",key:n.type})||this).payload=void 0,i.payload=n,i}(0,_.A)(t,e);var n=t.prototype;return n.load=function(){var e;switch(this.payload.type){case"google":e=this.getGoogleFontConfig(this.payload);break;case"local":e=this.getLocalFontConfig(this.payload)}Bi().load(e)},n.getGoogleFontConfig=function(e){var t=this,n=e.character,i=e.fontName,a=e.fontWeight;return{google:{families:[i+":"+(void 0===a?400:a)],text:n},active:function(){t.loader.nextFile(t,!0)},timeout:15e3}},n.getLocalFontConfig=function(e){var t=this,n=e.fontName,i=e.fontType,a=document.createElement("style");document.head.appendChild(a);var s=a.sheet;if(s){var r='@font-face { font-family: "'+n+'"; src: url("assets/fonts/'+n+("opentype"===i?".otf":".ttf")+'") format("'+i+'"); }';s.insertRule(r,0)}return{custom:{families:[n]},active:function(){t.loader.nextFile(t,!0)},timeout:15e3}},t}(Phaser.Loader.File),Ni=Li,Gi=function(e){function t(){return e.apply(this,arguments)||this}return(0,_.A)(t,e),t.prototype.addFont=function(e){var t=new Ni(this.scene.load,e);this.scene.load.addFile(t)},t}(Phaser.Plugins.ScenePlugin),Fi=Gi,Ui=function(e){function t(){return e.apply(this,arguments)||this}return(0,_.A)(t,e),t.prototype.emit=function(t){return e.prototype.emit.call(this,t)},t}(Phaser.Events.EventEmitter),ji=Ui,Vi=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=e.call.apply(e,B()(t=[this]).call(t,a))||this).events=void 0,n.previousLayout=void 0,n.resizeEventData=void 0,n.portraitRatio=void 0,n.portraitWidth=void 0,n.portraitHeight=void 0,n.landscapeRatio=void 0,n.landscapeWidth=void 0,n.landscapeHeight=void 0,n.worldWidth=void 0,n.worldHeight=void 0,n.worldRatio=void 0,n.autoResize=void 0,n.disableLandscape=void 0,n.fullSizeOnLandscape=void 0,n.currentLayout=void 0,n.forcePixelRatio=void 0,n.handleResize=(0,T.s)((function(){n.previousLayout=""+n.currentLayout,n.initWorldSize(),n.resize()}),300),n}(0,_.A)(t,e);var n=t.prototype;return n.configure=function(e){this.events=new ji;var t=e.autoResize,n=e.portraitRatio,i=e.portraitWidth,a=e.portraitHeight,s=e.landscapeWidth,r=e.landscapeHeight,o=e.landscapeRatio,c=e.disableLandscape,l=e.fullSizeOnLandscape;this.autoResize=t,this.disableLandscape=c,this.fullSizeOnLandscape=l,this.portraitRatio=n,this.portraitWidth=i,this.portraitHeight=a,this.landscapeRatio=o,this.landscapeWidth=s,this.landscapeHeight=r,this.initWorldSize(),this.addEventResize()},n.resize=function(e){var t=this;e&&e>0&&(this.forcePixelRatio=e);var n=this.getCanvasSizeFixedRatio(this.worldRatio),i=n.width,a=n.height;this.resizeCanvas(i,a),this.game.scene.scenes.forEach((function(e){var n=e.cameras.main;if(n){var i=t.getZoomRatio(),a=t.getWorldSize(),s=a.width,r=a.height;n.setZoom(i),n.centerOn(s/2,r/2)}}));var s={width:this.worldWidth,height:this.worldHeight,isLayoutChanged:!1,newLayout:this.currentLayout};this.previousLayout!==this.currentLayout&&(s.isLayoutChanged=!0,s.newLayout=this.currentLayout),this.resizeEventData=s,this.events.emit(on.A.RESIZE,s)},n.getResizeEventData=function(){return this.resizeEventData},n.resizeCanvas=function(e,t){this.game.canvas.width=e,this.game.canvas.height=t,this.game.scale.resize(e,t)},n.getWorldSize=function(){return{width:this.worldWidth,height:this.worldHeight}},n.initWorldSize=function(){if(this.worldWidth=this.portraitWidth,this.worldHeight=this.portraitHeight,this.isScreenSmallerRatio(this.portraitRatio))this.worldHeight=this.worldWidth/this.getScreenRatio(),this.currentLayout="portrait";else if(!this.disableLandscape&&(this.worldWidth=this.landscapeWidth,this.worldHeight=this.landscapeHeight,this.currentLayout="landscape",this.fullSizeOnLandscape)){this.worldRatio=this.worldWidth/this.worldHeight,this.landscapeRatio=this.getScreenRatio();var e=this.getCanvasSizeFixedRatio(this.landscapeRatio),t=e.width,n=e.height,i=this.getZoomRatio();this.worldWidth=t/i,this.worldHeight=n/i}this.worldRatio=this.worldWidth/this.worldHeight,console.info("\ud83d\ude80 > this.worldRatio",this.worldRatio)},n.getZoomRatio=function(){var e=this.getWorldSize().width;return this.getCanvasSizeFixedRatio(this.worldRatio).width/e},n.getPixelRatio=function(){if(this.forcePixelRatio>0)return this.forcePixelRatio;if(GameCore.Utils.Device.isDesktop())return 2;var e=GameCore.Utils.Device.pixelRatio();return e>2&&(e=2),e},n.getPhysicPixels=function(e,t){return e*t},n.getCanvasSizeFixedRatio=function(e){var t=this.getPixelRatio(),n=this.getScreenWidth()*t,i=this.getScreenHeight()*t;return this.isScreenSmallerRatio(e)?i=n/e:n=i*e,{width:n,height:i}},n.getScreenRatio=function(){return this.getScreenWidth()/this.getScreenHeight()},n.getScreenHeight=function(){var e=document,t=e.body,n=e.documentElement,i=t.clientHeight,a=n.clientHeight;return Math.max(a,i)||0},n.getScreenWidth=function(){var e=document,t=e.body,n=e.documentElement,i=t.clientWidth,a=n.clientWidth;return Math.max(a,i)||0},n.isScreenSmallerRatio=function(e){return this.getScreenRatio()<e},n.addEventResize=function(){this.autoResize&&window.addEventListener("resize",this.handleResize)},n.isLandscape=function(){return!this.disableLandscape&&this.worldRatio>this.portraitRatio},t}(Phaser.Plugins.BasePlugin),zi=Vi,Yi=function(){function e(e,t,n){this.contextId=void 0,this.contextType=void 0,this.entryPointData=void 0,this.contextId=e||_n.contextId,this.contextType=t||_n.contextType,this.entryPointData=n||_n.entryPointData}return e.prototype.toObject=function(){return{contextId:this.contextId,contextType:this.contextType,entryPointData:this.entryPointData}},e}(),Hi=Yi,Ki=n(482),Wi={score:0,settings:(0,a.A)({},De),userGuideDisplays:0,timeAddShortcut:0,levelOfSeasons:{},customFields:{diamond:300,lastReceiveGift:0,completedJourneySeasons:{}}},Zi=Wi,Xi=Zi.userGuideDisplays,Ji=Zi.customFields,qi=Zi.settings,Qi=Zi.timeAddShortcut,$i=Zi.levelOfSeasons,ea=function(){function e(e){this.data=void 0;var t=e.settings,n=e.score,i=e.customFields,a=e.userGuideDisplays,s=e.timeAddShortcut,r=e.levelOfSeasons,o=GameCore.Utils.Valid.isNumber(n)&&n>0?n:0,c=GameCore.Utils.Valid.isNumber(a)?a:Xi,l=GameCore.Utils.Valid.isObject(i)?i:Ji,h=GameCore.Utils.Valid.isNumber(s)?s:Qi,u=GameCore.Utils.Valid.isObject(r)?r:$i,d=qi;GameCore.Utils.Valid.isObject(t)&&(d=new Ye(t).toObject()),this.data={score:o,userGuideDisplays:c,settings:d,customFields:l,timeAddShortcut:h,levelOfSeasons:u}}return e.prototype.toObject=function(){return this.data},e}(),ta=ea,na=n(483),ia={score:"score",settings:"settings",gameData:"gameData",userGuideDisplays:"userGuideDisplays",timeAddShortcut:"timeAddShortcut"},aa=GameCore.Configs,sa=aa.AppId,ra=aa.SyncProfileFromAPI,oa=function(e){var t=this;this.game=void 0,this.initContext=function(){var e=window.FBInstant.context.getID(),n=window.FBInstant.context.getType(),i=window.FBInstant.getEntryPointData(),a=new Hi(e,n,i).toObject(),s=a.contextId,r=a.contextType,o=a.entryPointData;t.game.storage.dispatch((0,na.hP)(s,r,o))},this.initPlayer=(0,O.A)(D().mark((function e(){var n,i,a,s,r;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.game.player,i=t.getPlayerInfo(),a=Ne()(ia),e.next=5,FBInstant.player.getDataAsync(a);case 5:return s=e.sent,console.info("\ud83d\ude80 > rawData",s),r=new Xe(s),console.info("\ud83d\ude80 > playerData",r),e.next=11,t.syncDataFromAPI(r);case 11:return r=e.sent,!0===r.toObject().settings.music&&window.game.audio.playMusic(),e.next=16,n.receiveData(i,r.convertToPlayerData());case 16:case"end":return e.stop()}}),e)}))),this.syncDataFromAPI=function(){var e=(0,O.A)(D().mark((function e(n){var i,s,r,o,c,l;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,ra){e.next=3;break}return e.abrupt("return",n);case 3:return e.next=5,FBInstant.player.getDataAsync(["isSynced"]);case 5:if(e.t0=e.sent,e.t0){e.next=8;break}e.t0={};case 8:if(i=e.t0,!0!==(i.isSynced||!1)){e.next=12;break}return e.abrupt("return",n);case 12:if(s=t.getPlayerInfo(),r=window.FBInstant.player.getID(),s.playerId===r){e.next=16;break}return e.abrupt("return",n);case 16:return e.next=18,Qe({appId:sa,playerId:r,name:s.name,photo:s.photo,locale:s.locale});case 18:return o=e.sent,c=new ta(o).toObject(),l=new Xe({}).convertToFacebookData(c),FBInstant.player.setDataAsync((0,a.A)({},l,{isSynced:!0})),e.abrupt("return",new Xe(l));case 25:return e.prev=25,e.t1=e.catch(0),console.warn(e.t1),e.abrupt("return",n);case 29:case"end":return e.stop()}}),e,null,[[0,25]])})));return function(t){return e.apply(this,arguments)}}(),this.getPlayerInfo=function(){try{var e=window.FBInstant.player.getID(),t=window.FBInstant.player.getName(),n=window.FBInstant.player.getPhoto(),i=window.FBInstant.getLocale();if(!GameCore.Utils.Valid.isString(e))throw new Ki.A(null,{playerId:e});return GameCore.Utils.Valid.isString(t)||(t="You"),new rt.A(e,t,n,i).toObject()}catch(a){return new rt.A("123","You").toObject()}},this.game=e},ca=n(222),la=GameCore.Ads.Types,ha=[rn.o.BUTTON_CLICK,rn.o.SCREEN_OPEN],ua=function(e){function t(t,n,i){var a;return(a=e.call(this,"FacebookAnalytics",{prefix:n},"#0F52BA")||this).game=void 0,a.game=t,a.selfLog=!!i,a}(0,_.A)(t,e);var n=t.prototype;return n.processEvent=function(e,t,n){var i;if(!(g()(ha).call(ha,e)>=0)){var a=this.getEventName(e),s={};Be()(i=he()(t||{})).call(i,(function(e){t&&"string"===typeof t[e]&&(s[e]=t[e])})),FBInstant.logEvent(a,n,s)}},n.processPageView=function(e){},n.processLevelStart=function(e,t,n){this.processEvent(rn.o.LEVEL_START,{level:e,score:t,level_name:n})},n.processLevelRescue=function(e,t,n){this.processEvent(rn.o.LEVEL_RESCUE,{level:e,score:t,level_name:n})},n.processLevelFail=function(e,t,n){this.processEvent(rn.o.LEVEL_END,{level:e,score:t,level_name:n,success:!1})},n.processLevelComplete=function(e,t,n){this.processEvent(rn.o.LEVEL_END,{level:e,score:t,level_name:n,success:!0})},n.processLoadInterstitialAd=function(e){var t=this.getEdaType(la.INTERSTITIAL);this.processEvent(rn.o.AD_LOAD,{ad_type:t,screen_name:""+e})},n.processShowInterstitialAd=function(e){var t=this.getEdaType(la.INTERSTITIAL);this.processEvent(rn.o.AD_SHOW,{ad_type:t,screen_name:""+e})},n.processLoadRewardedVideoAd=function(e){var t=this.getEdaType(la.REWARDED);this.processEvent(rn.o.AD_LOAD,{ad_type:t,screen_name:""+e})},n.processShowRewardedVideoAd=function(e){var t=this.getEdaType(la.REWARDED);this.processEvent(rn.o.AD_SHOW,{ad_type:t,screen_name:""+e})},n.processLoadAdFail=function(e,t){var n=this.getEdaType(e);this.processEvent(rn.o.AD_LOAD_FAILED,{ad_type:n,screen_name:""+t})},n.processShowAdFail=function(e,t){var n=this.getEdaType(e);this.processEvent(rn.o.AD_SHOW_FAILED,{ad_type:n,screen_name:""+t})},n.getEventName=function(e){return this.options.prefix+"_"+e},n.getEdaType=function(e){return e===la.REWARDED?"rewarded_video":"interstitial"},t}(GameCore.Analytics.BaseAnalytics),da=ua,pa=n(484),fa=GameCore.Ads.Types,ma=[rn.o.SCREEN_OPEN],ga=(function(e){function t(t,n){var i;(i=e.call(this,"GoogleAnalytics",(0,a.A)({},n),"#E35335")||this).game=void 0,i.trackingId=void 0,i.currentPath="/";var s=n.trackingId;i.game=t;var r=(GameCore.Configs.Analytics.GoogleAnalytics||{}).consoleLog;return i.selfLog=!!r,i.trackingId=s,i}(0,_.A)(t,e);var n=t.prototype;n.processEvent=function(e,t,n){if(!(g()(ma).call(ma,e)>=0)){var i=this.formatEventName(e),s=t?(0,a.A)({},t):{};s=n?(0,a.A)({},s,{value:n}):s,s=(0,a.A)({},s,{page_path:this.currentPath,send_to:"GA"}),gtag("event",i,s)}},n.processLevelStart=function(e,t,n){this.processEvent(rn.o.LEVEL_START,{level:e,score:t,level_name:n})},n.processLevelRescue=function(e,t,n){this.processEvent(rn.o.LEVEL_RESCUE,{level:e,score:t,level_name:n})},n.processLevelFail=function(e,t,n){this.processEvent(rn.o.LEVEL_END,{level:e,score:t,level_name:n,success:!1})},n.processLevelComplete=function(e,t,n){this.processEvent(rn.o.LEVEL_END,{level:e,score:t,level_name:n,success:!0})},n.processLoadInterstitialAd=function(e){var t=this.getEdaType(fa.INTERSTITIAL);this.processEvent(rn.o.AD_LOAD,{ad_type:t,screen_name:""+e})},n.processShowInterstitialAd=function(e){var t=this.getEdaType(fa.INTERSTITIAL);this.processEvent(rn.o.AD_SHOW,{ad_type:t,screen_name:""+e}),this.processEvent(rn.o.AD_IMPRESSION,{ad_format:"Interstitial"})},n.processLoadRewardedVideoAd=function(e){var t=this.getEdaType(fa.REWARDED);this.processEvent(rn.o.AD_LOAD,{ad_type:t,screen_name:""+e})},n.processShowRewardedVideoAd=function(e){var t=this.getEdaType(fa.REWARDED);this.processEvent(rn.o.AD_SHOW,{ad_type:t,screen_name:""+e}),this.processEvent(rn.o.AD_IMPRESSION,{ad_format:"Rewarded"})},n.processLoadAdFail=function(e,t){var n=this.getEdaType(e);this.processEvent(rn.o.AD_LOAD_FAILED,{ad_type:n,screen_name:""+t})},n.processShowAdFail=function(e,t,n){var i=(null==n?void 0:n.code)||"unknown",a=this.getEdaType(e);this.processEvent(rn.o.AD_SHOW_FAILED,{ad_type:a,screen_name:""+t,code:i})},n.processPageView=function(e){var t=this.getGameplayMode(),n="/"+t+"/"+e;this.currentPath=n,document.title=this.formatPageTitle(t,e),gtag("event","page_view",{page_path:this.currentPath,send_to:["GA",this.trackingId]})},n.getGameplayMode=function(){var e=this.game.storage.getState();return(0,pa.BC)(e)},n.formatEventName=function(e){return e.toLowerCase().replace(/:/g,"_")},n.formatPageTitle=function(e,t){return this.toUpperCamelCaseWithSpace(e)+"::"+this.toUpperCamelCaseWithSpace(t)},n.toUpperCamelCaseWithSpace=function(e){var t=e.replace(/[-_\s.]+(.)?/g,(function(e,t){return t?" "+t.toUpperCase():""}));return t.substr(0,1).toUpperCase()+t.substr(1)},n.getEdaType=function(e){return e===fa.REWARDED?"rewarded_video":"interstitial"}}(GameCore.Analytics.BaseAnalytics),function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=e.call.apply(e,B()(t=[this]).call(t,a))||this).startGame=(0,O.A)(D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.auth.requestToken();case 3:return e.next=5,n.storage.syncStore();case 5:return n.configureSentry(),n.configureRollbar(),e.next=9,n.detectGameMode();case 9:n.initGoogleAnalytics(),n.initFacebookAnalytics(),n.analytics.event(rn.o.LOAD_START),n.scene.launch(ca.F7.GLOBAL_SCENE),n.scene.start(ca.F7.LOAD_SCENE),n.analytics.pageview(ca.F7.LOAD_SCENE),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),(0,x.a0)(e.t0);case 20:return e.prev=20,n.facebook.progressLoading.finishLoadingProgressFbBootScene(),n.scene.sleep(ca.F7.BOOT_SCENE),e.finish(20);case 24:case"end":return e.stop()}}),e,null,[[0,17,20,24]])}))),n}(0,_.A)(t,e);var n=t.prototype;return n.create=function(){this.facebook.progressLoading.loadingProgressFbBootScene(),this.startGame()},n.configureSentry=function(){var e=this.player.getPlayer();(0,x.Tm)({id:e.playerId,username:e.name})},n.configureRollbar=function(){if(this.rollbar){var e=this.player.getPlayer();this.rollbar.configure({payload:{person:{id:e.playerId,name:e.name}}})}},n.detectGameMode=function(){var e=(0,O.A)(D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.storage.dispatch((0,na.vM)());case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.initGoogleAnalytics=function(){},n.initFacebookAnalytics=function(){var e=GameCore.Configs.Analytics.FacebookAnalytics||{},t=e.prefix,n=e.consoleLog;"string"===typeof t?this.analytics.add(new da(this.game,t,n)):console.error("FacebookAnalytics: prefix is not defined")},t}(Phaser.Scene)),va=ga,ya=function(e){function t(t,n,i){var a;return(a=e.call(this)||this).game=void 0,a.options=void 0,a.performance=void 0,a.isRunning=!1,a.checkTimer=void 0,a.fpsHistory=void 0,a.start=function(){if(!a.isRunning){a.isRunning=!0;var e=a.options.checkInterval;a.checkTimer=e,a.fpsHistory=[],a.game.events.on(Phaser.Core.Events.POST_STEP,a.onPostStep)}},a.stop=function(){a.isRunning&&(a.isRunning=!1,a.game.events.off(Phaser.Core.Events.POST_STEP,a.onPostStep),a.options.onlyUpdateWhenSwitchScene&&a.checkFps())},a.onPostStep=function(e,t){if(a.checkTimer-=t,!(a.checkTimer>0)){var n=a.options,i=n.checkInterval,s=n.onlyUpdateWhenSwitchScene;a.checkTimer+=i,a.fpsHistory.push(a.game.loop.actualFps),!1===s&&a.fpsHistory.length>=5&&a.checkFps()}},a.game=t,a.options=i,a.performance=n,a}(0,_.A)(t,e);var n=t.prototype;return n.checkFps=function(){if(0!==this.fpsHistory.length){var e=this.options.autoUpgradeQuality,t=!1;this.isLowFps()?t=this.performance.downgradeGraphicsQuality():e&&this.isHighFps()&&(t=this.performance.upgradeGraphicsQuality()),t&&(this.fpsHistory=[])}},n.getFpsMedian=function(){return Phaser.Math.Median(this.fpsHistory)},n.isLowFps=function(){return this.getFpsMedian()<this.options.fpsThreshold},n.isHighFps=function(){return this.getFpsMedian()>1.2*this.options.fpsThreshold},t}(Phaser.Events.EventEmitter),Aa=ya,Ea=["pixelRatio","minQuality","maxQuality","qualityAdjustStep","trackingSceneKeys"],Ta=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=e.call.apply(e,B()(t=[this]).call(t,a))||this).fpsTracker=void 0,n.pixelRatio=void 0,n.minQuality=void 0,n.maxQuality=void 0,n.qualityAdjustStep=void 0,n.trackingSceneKeys=[],n.trackingScene=function(e){var t;if(Kt()(t=n.trackingSceneKeys).call(t,e)){var i=n.game.scene.getScene(e);i.events.once(Phaser.Scenes.Events.UPDATE,n.fpsTracker.start),i.events.once(Phaser.Scenes.Events.SLEEP,n.fpsTracker.stop)}},n}(0,_.A)(t,e);var n=t.prototype;return n.configure=function(e){var t=e.pixelRatio,n=e.minQuality,i=e.maxQuality,a=e.qualityAdjustStep,s=e.trackingSceneKeys,r=(0,k.A)(e,Ea);this.pixelRatio=t,this.minQuality=n,this.maxQuality=i,this.qualityAdjustStep=a,this.trackingSceneKeys=s,this.fpsTracker=new Aa(this.game,this,r)},n.active=function(){this.game.events.on(Phaser.Scenes.Events.WAKE,this.trackingScene),this.game.events.on(Phaser.Scenes.Events.START,this.trackingScene)},n.downgradeGraphicsQuality=function(){var e=this.pixelRatio;if(e<=this.minQuality)return!1;var t=+(e-this.qualityAdjustStep).toFixed(2);return!(t<this.minQuality)&&(this.pixelRatio=t,this.game.world.resize(this.pixelRatio),console.warn("\ud83d\udcab Graphics quality was downgraded! ("+e+" -> "+t+")"),!0)},n.upgradeGraphicsQuality=function(){var e=this.pixelRatio;if(e>=this.maxQuality)return!1;var t=+(e+this.qualityAdjustStep).toFixed(2);return!(t>this.maxQuality)&&(this.pixelRatio=t,this.game.world.resize(this.pixelRatio),console.warn("\ud83d\ude80 Graphics quality was upgraded! ("+e+" -> "+t+")"),!0)},t}(Phaser.Plugins.BasePlugin),Sa=Ta,ba=Sa,Pa=n(668),Ca=0,wa=0,Ia=function(){function e(e){this.game=void 0,this.progressFbTimeEvent=void 0,this.game=e}var t=e.prototype;return t.loadingProgressFbBootScene=function(){var e=this,t=100;wa=30;!function n(){t<=0?clearTimeout(e.progressFbTimeEvent):e.progressFbTimeEvent=setTimeout((function(){e.game.facebook.setLoadingProgress(Math.round(wa)),wa+=30/t,t--,n()}),50)}()},t.finishLoadingProgressFbBootScene=function(){clearTimeout(this.progressFbTimeEvent)},t.loadingProgressFbLoadScene=function(){var e=this;(!wa||wa<30)&&(wa=60),Ca=wa;!function t(){e.progressFbTimeEvent=setTimeout((function(){e.game.facebook.setLoadingProgress(Math.round(wa)),wa+=.1,t()}),50)}()},t.onProgress=function(e){var t=100-wa,n=Math.round(e*t+wa);n>Ca&&clearTimeout(this.progressFbTimeEvent),this.game.facebook.setLoadingProgress(n)},e}(),xa=Ia,ka=n(50),Oa=n(113),_a=n.n(Oa),Ra=n(74),Da=n.n(Ra),Ma=n(511),Ba=n.n(Ma),La="handle_state_change",Na=n(140),Ga=n(89),Fa=n(90),Ua=n(70),ja=n(142),Va=n(224),za=n(223),Ya={STATUS:{READY:"ready",RUNNING:"running",STOPPED:"stopped"}},Ha={STATUS:{READY:"ready",RUNNING:"running",STOPPED:"stopped"}},Ka=Ha.STATUS,Wa=function(){function e(e){this.state=void 0,this.scene=void 0,this.scene=e}var t=e.prototype;return t.init=function(){this.setState(Ka.READY)},t.start=function(){this.isRunning()||this.setState(Ka.RUNNING)},t.stop=function(){this.isRunning()&&this.setState(Ka.STOPPED)},t.setState=function(e){this.state=e},t.isReady=function(){return this.state===Ka.READY},t.isRunning=function(){return this.state===Ka.RUNNING},t.isStopped=function(){return this.state===Ka.STOPPED},e}(),Za=Wa,Xa=[{minCol:0,minRow:0,cols:4,rows:4},{minCol:4,minRow:0,cols:4,rows:4},{minCol:0,minRow:4,cols:4,rows:4},{minCol:4,minRow:4,cols:4,rows:4}],Ja=[{minCol:0,minRow:0,cols:5,rows:5},{minCol:3,minRow:0,cols:5,rows:5},{minCol:0,minRow:3,cols:5,rows:5},{minCol:3,minRow:3,cols:5,rows:5}],qa=[{minCol:0,minRow:0,cols:5,rows:5},{minCol:3,minRow:0,cols:5,rows:5},{minCol:0,minRow:3,cols:5,rows:5},{minCol:3,minRow:3,cols:5,rows:5}],Qa="vertical",$a="horizontal",es="left",ts="right",ns="top",is="bottom",as="vertical_left",ss="vertical_right",rs="horizontal_left",os="horizontal_right",cs="gem/gem",ls="gem/bubbles/green",hs="gem/bubbles/orange",us="gem/bubbles/pink",ds="gem/bubbles/violet",ps="gem/bubbles/blue",fs="gem/bubbles/yellow",ms="gem/diamond/gem-green",gs="gem/diamond/gem-orange",vs="gem/diamond/gem-pink",ys="gem/diamond/gem-red",As="gem/diamond/gem-violet",Es="gem/diamond/gem-blue",Ts=[{level:1,frames:[],width:480,height:189},{level:2,frames:[Fa.A.EFFECTS.FRAME.TEXT_COOL],width:480,height:189},{level:3,frames:[Fa.A.EFFECTS.FRAME.TEXT_PERFECT],width:579,height:189},{level:4,frames:[Fa.A.EFFECTS.FRAME.TEXT_EXCELLENT],width:906,height:189},{level:5,frames:[Fa.A.EFFECTS.FRAME.TEXT_EXCELLENT],width:906,height:189},{level:6,frames:[Fa.A.EFFECTS.FRAME.TEXT_UNBELIEVABLE],width:906,height:189}],Ss=[{level:1,scale:.5,speed:.5,quantity:.5},{level:2,scale:.6,speed:.6,quantity:.6},{level:3,scale:.7,speed:.7,quantity:.7},{level:4,scale:.8,speed:.8,quantity:.8},{level:5,scale:.9,speed:.9,quantity:.9},{level:6,scale:1,speed:1,quantity:1}],bs="l",Ps="l_1",Cs="l_3",ws="line_2",Is="line_3",xs="line_4",ks="line_5",Os="square_1",_s="square_2",Rs="square_3",Ds="trapezoid",Ms="triangle",Bs="t_piece",Ls="plus_piece",Ns="cross_piece_2",Gs="cross_piece_3",Fs="cross_piece_4",Us="cross_piece_5",js="u_piece",Vs=[Ps,Cs,ws,Is,xs,ks,Os,_s,Rs],zs=[{type:Ps,rate:4},{type:Cs,rate:4},{type:ws,rate:4},{type:Is,rate:4},{type:xs,rate:4},{type:ks,rate:4},{type:Os,rate:4},{type:_s,rate:4},{type:Rs,rate:4}],Ys=[[1,0],[1,0],[1,1]],Hs=[[0,1],[0,1],[1,1]],Ks=[[1,0],[1,1]],Ws=[[1,0,0],[1,0,0],[1,1,1]],Zs=[[1,1,1],[1,0,0]],Xs=[[1,1,1],[0,0,1]],Js=[[1,1],[1,0]],qs=[[1,1,1],[1,0,0],[1,0,0]],Qs=[[1,1],[0,1],[0,1]],$s=[[1,1],[1,0],[1,0]],er=[[1,1],[0,1]],tr=[[1,1,1],[0,0,1],[0,0,1]],nr=[[0,0,1],[1,1,1]],ir=[[1,0,0],[1,1,1]],ar=[[0,1],[1,1]],sr=[[0,0,1],[0,0,1],[1,1,1]],rr=[[1],[1]],or=[[1,1]],cr=[[1],[1],[1]],lr=[[1,1,1]],hr=[[1],[1],[1],[1]],ur=[[1,1,1,1]],dr=[[1],[1],[1],[1],[1]],pr=[[1,1,1,1,1]],fr=[[1]],mr=[[1,1],[1,1]],gr=[[1,1,1],[1,1,1],[1,1,1]],vr=[[1,0],[1,1],[0,1]],yr=[[0,1],[1,1],[1,0]],Ar=[[1,1,0],[0,1,1]],Er=[[0,1,1],[1,1,0]],Tr=[[0,1],[1,1],[0,1]],Sr=[[1,0],[1,1],[1,0]],br=[[0,1,0],[1,1,1]],Pr=[[1,1,1],[0,1,0]],Cr=[[0,0,1],[1,1,1],[0,0,1]],wr=[[1,0,0],[1,1,1],[1,0,0]],Ir=[[0,1,0],[0,1,0],[1,1,1]],xr=[[1,1,1],[0,1,0],[0,1,0]],kr=[[0,1,0],[1,1,1],[0,1,0]],Or=[[1,0],[0,1]],_r=[[0,1],[1,0]],Rr=[[1,0,0],[0,1,0],[0,0,1]],Dr=[[0,0,1],[0,1,0],[1,0,0]],Mr=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],Br=[[0,0,0,1],[0,0,1,0],[0,1,0,0],[1,0,0,0]],Lr=[[1,0,0,0,0],[0,1,0,0,0],[0,0,1,0,0],[0,0,0,1,0],[0,0,0,0,1]],Nr=[[0,0,0,0,1],[0,0,0,1,0],[0,0,1,0,0],[0,1,0,0,0],[1,0,0,0,0]],Gr=[[1,1],[0,1],[1,1]],Fr=[[1,0],[1,1],[1,0]],Ur=[[1,0,1],[1,1,1]],jr=[[1,1,1],[1,0,1]],Vr=n(490),zr=function(){function e(e){var t=this;this.scene=void 0,this.manager=void 0,this.tweenHand=void 0,this.dataInit={fen:"4uu2/4uu2/4uu2/5u2/uuuu1uuu/uuuu3u/4uu2/4uu2/4uu2/4uu2 l l3-dt,b",piece:Rs,position:{x:4,y:3}},this.alignComponents=function(){t.createTweenHand()},this.scene=e.scene,this.manager=e}var t=e.prototype;return t.start=function(){this.initBoardData(),this.handleHighlight(),this.createTweenHand(),this.scene.events.on(Vr.A.LAYOUT_UPDATE,this.alignComponents)},t.initBoardData=function(){this.manager.handleGuidePlayStep(this.dataInit.fen)},t.createTweenHand=function(){var e,t,n=this.scene.main.board,i=n.dataBoard,a=n.cellSize,s=this.scene.footer.pieces,r=s.allPieces,o=s.piecesActive,c=r[o[0].position].getWorldPosition().x+35,l=r[o[0].position].getWorldPosition().y+35,h=i[5][4].cell.getWorldPosition().x+a/2,u=i[5][4].cell.getWorldPosition().y+a/2;this.manager.handFrame.setVisible(!0),this.manager.handFrame.setPosition(c,l),null==(e=this.tweenHand)||e.stop(),null==(t=this.tweenHand)||t.remove(),this.tweenHand=this.scene.add.tween({repeatDelay:500,targets:this.manager.handFrame,repeat:-1,x:{from:c,to:h},y:{from:l,to:u},duration:1500,ease:Phaser.Math.Easing.Sine.InOut})},t.handleHighlight=function(){for(var e=[{x:4,y:3},{x:4,y:4},{x:4,y:5},{x:5,y:5},{x:6,y:5}],t=0;t<e.length;t++){var n=e[t],i=n.x,a=n.y;this.scene.main.board.dataBoard[a][i].cell.setFrame(Fa.A.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0).stopAnimShaking()}},t.dragStart=function(){this.tweenHand.stop(),this.manager.handFrame.setVisible(!1)},t.invalidMove=function(){this.manager.handFrame.setVisible(!0),this.tweenHand.play(),this.handleHighlight()},t.nextLevel=function(){this.scene.events.off(Vr.A.LAYOUT_UPDATE,this.alignComponents),this.tweenHand.stop().remove()},e}(),Yr=zr,Hr=function(){function e(e){var t=this;this.scene=void 0,this.manager=void 0,this.tweenHand=void 0,this.dataInit={fen:"x/x/x/uuu2uuu/uuu2uuu/x/x/x/x l s2,b",piece:_s,position:{x:3,y:3}},this.alignComponents=function(){t.createTweenHand()},this.scene=e.scene,this.manager=e}var t=e.prototype;return t.start=function(){this.initBoardData(),this.handleHighlight(),this.createTweenHand(),this.scene.events.on(Vr.A.LAYOUT_UPDATE,this.alignComponents)},t.initBoardData=function(){this.manager.handleGuidePlayStep(this.dataInit.fen)},t.createTweenHand=function(){var e,t,n=this.scene.main.board.dataBoard,i=this.scene.footer.pieces,a=i.allPieces,s=i.piecesActive,r=a[s[0].position].getWorldPosition().x+30,o=a[s[0].position].getWorldPosition().y+30,c=n[4][4].cell.getWorldPosition().x,l=n[4][4].cell.getWorldPosition().y+5;this.manager.handFrame.setVisible(!0),this.manager.handFrame.setPosition(r,o),null==(e=this.tweenHand)||e.stop(),null==(t=this.tweenHand)||t.remove(),this.tweenHand=this.scene.add.tween({repeatDelay:500,targets:this.manager.handFrame,repeat:-1,x:{from:r,to:c},y:{from:o,to:l},duration:1500,ease:Phaser.Math.Easing.Sine.InOut})},t.handleHighlight=function(){for(var e=this.dataInit.position,t=e.x,n=e.y,i=0;i<2;i++)for(var a=0;a<2;a++)this.scene.main.board.dataBoard[n+i][t+a].cell.setFrame(Fa.A.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0).stopAnimShaking()},t.dragStart=function(){this.tweenHand.stop(),this.manager.handFrame.setVisible(!1)},t.invalidMove=function(){this.manager.handFrame.setVisible(!0),this.tweenHand.play(),this.handleHighlight()},t.nextLevel=function(){this.scene.events.off(Vr.A.LAYOUT_UPDATE,this.alignComponents),this.tweenHand.stop().remove()},e}(),Kr=Hr,Wr=function(){function e(e){var t=this;this.scene=void 0,this.manager=void 0,this.tweenHand=void 0,this.dataInit={fen:"3uu3/3uu3/3uu3/3uu3/4u3/x/3uu3/3uu3/3uu3/3uu3 l l1-dt,b",piece:Ks,position:{x:3,y:4}},this.alignComponents=function(){t.createTweenHand()},this.scene=e.scene,this.manager=e}var t=e.prototype;return t.start=function(){this.initBoardData(),this.handleHighlight(),this.createTweenHand(),this.scene.events.on(Vr.A.LAYOUT_UPDATE,this.alignComponents)},t.initBoardData=function(){this.manager.handleGuidePlayStep(this.dataInit.fen)},t.createTweenHand=function(){var e,t,n=this.scene.main.board,i=n.dataBoard,a=n.cellSize,s=this.scene.footer.pieces,r=s.allPieces,o=s.piecesActive,c=r[o[0].position].getWorldPosition().x+30,l=r[o[0].position].getWorldPosition().y+30,h=i[5][3].cell.getWorldPosition().x+a/2,u=i[5][3].cell.getWorldPosition().y+a/2;this.manager.handFrame.setVisible(!0),this.manager.handFrame.setPosition(c,l),null==(e=this.tweenHand)||e.stop(),null==(t=this.tweenHand)||t.remove(),this.tweenHand=this.scene.add.tween({repeatDelay:500,targets:this.manager.handFrame,repeat:-1,x:{from:c,to:h},y:{from:l,to:u},duration:1500,ease:Phaser.Math.Easing.Sine.InOut})},t.handleHighlight=function(){for(var e=this.dataInit.position,t=e.x,n=e.y,i=0;i<2;i++)for(var a=0;a<1;a++)this.scene.main.board.dataBoard[n+i][t+a].cell.setFrame(Fa.A.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0).stopAnimShaking();this.scene.main.board.dataBoard[5][4].cell.setFrame(Fa.A.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0).stopAnimShaking()},t.dragStart=function(){this.tweenHand.stop(),this.manager.handFrame.setVisible(!1)},t.invalidMove=function(){this.manager.handFrame.setVisible(!0),this.tweenHand.play(),this.handleHighlight()},t.nextLevel=function(){this.scene.events.off(Vr.A.LAYOUT_UPDATE,this.alignComponents),this.tweenHand.stop().remove()},e}(),Zr=Wr,Xr=function(){function e(e){var t=this;this.scene=void 0,this.manager=void 0,this.tweenHand=void 0,this.dataInit={fen:"2u/2u/2u/2u/x/x/x/2u/2u/2u l e3-v,r",piece:Is,position:{x:2,y:4}},this.alignComponents=function(){t.createTweenHand()},this.scene=e.scene,this.manager=e}var t=e.prototype;return t.start=function(){this.initBoardData(),this.handleHighlight(),this.createTweenHand(),this.scene.events.on(Vr.A.LAYOUT_UPDATE,this.alignComponents)},t.initBoardData=function(){this.manager.handleGuidePlayStep(this.dataInit.fen)},t.createTweenHand=function(){var e,t,n=this.scene.main.board,i=n.dataBoard,a=n.cellSize,s=this.scene.footer.pieces,r=s.allPieces,o=s.piecesActive,c=r[o[0].position].getWorldPosition().x+22,l=r[o[0].position].getWorldPosition().y+37,h=i[5][2].cell.getWorldPosition().x+a/2,u=i[5][2].cell.getWorldPosition().y+a/2;this.manager.handFrame.setVisible(!0),this.manager.handFrame.setPosition(c,l),null==(e=this.tweenHand)||e.stop(),null==(t=this.tweenHand)||t.remove(),this.tweenHand=this.scene.add.tween({repeatDelay:500,targets:this.manager.handFrame,repeat:-1,x:{from:c,to:h},y:{from:l,to:u},duration:1500,ease:Phaser.Math.Easing.Sine.InOut})},t.handleHighlight=function(){for(var e=this.dataInit.position,t=e.x,n=e.y,i=0;i<3;i++)for(var a=0;a<1;a++)this.scene.main.board.dataBoard[n+i][t+a].cell.setFrame(Fa.A.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0).stopAnimShaking()},t.dragStart=function(){this.tweenHand.stop(),this.manager.handFrame.setVisible(!1)},t.invalidMove=function(){this.manager.handFrame.setVisible(!0),this.tweenHand.play(),this.handleHighlight()},t.nextLevel=function(){this.scene.events.off(Vr.A.LAYOUT_UPDATE,this.alignComponents),this.tweenHand.stop().remove()},e}(),Jr=Xr,qr=Ya.STATUS,Qr=Fa.A.DEFAULT,$r=Qr.KEY,eo=Qr.FRAME,to=Fa.A.GAMEPLAY,no=to.KEY,io=to.FRAME,ao=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.currentLevel=1,n.tutorialId=void 0,n.inputType=void 0,n.handFrame=void 0,n.headerContainer=void 0,n.background=void 0,n.textTutorial=void 0,n.maskGraphics=void 0,n.skipButton=void 0,n.stepOne=void 0,n.stepTwo=void 0,n.stepThree=void 0,n.stepFour=void 0,n.showTutorialWhenStart=function(){switch(n.scene.analytics.event(rn.o.TUTORIAL_STEP,{tutorial_step:n.currentLevel}),n.currentLevel){case 1:n.resetHeader(),n.stepOne.start(),n.setTextTutorial("Place the block on the horizontal line\nand see what happens!");break;case 2:n.stepTwo.start(),n.setTextTutorial("Now see what happens\nwhen you make a vertical line.");break;case 3:n.stepThree.start(),n.setTextTutorial("You can also fill in the vertical line.\nGive it a try!");break;case 4:n.stepFour.start(),n.setTextTutorial("Arrange lines and squares\nto get combo points!");break;default:n.handleCompleteTutorial()}},n.nextTutorial=function(){switch(n.currentLevel){case 1:n.stepOne.nextLevel();break;case 2:n.stepTwo.nextLevel();break;case 3:n.stepThree.nextLevel();break;case 4:n.stepFour.nextLevel()}n.currentLevel++,n.showTutorialWhenStart()},n.validTargetPosition=function(e){var t={x:0,y:0};switch(n.currentLevel){case 0:return!1;case 1:t=n.stepOne.dataInit.position;break;case 2:t=n.stepTwo.dataInit.position;break;case 3:t=n.stepThree.dataInit.position;break;case 4:t=n.stepFour.dataInit.position}return t.x===e.x&&t.y===e.y},n.scene=t,n.createHand(),n.createHeader(),n.createSkipButton(),n.resetHeader(),n.initTutorialStep(),n}(0,_.A)(t,e);var n=t.prototype;return n.createHeader=function(){this.headerContainer=this.scene.add.container(),this.headerContainer.setVisible(!1),this.background=this.scene.make.image({key:$r,frame:eo.BLANK}),this.background.setTint(0),this.background.setAlpha(.5),this.headerContainer.add(this.background),this.textTutorial=this.scene.make.bitmapText({font:za.A.MIKADO_WHITE.KEY,size:this.scene.fontSize(40),origin:{x:.5,y:.5}}),this.textTutorial.setCenterAlign(),this.headerContainer.add(this.textTutorial)},n.createSkipButton=function(){this.skipButton=new Va.A(this.scene,$r,eo.BUTTON_RED_RECTANGLE,62,61),this.skipButton.setName("Skip");var e=this.scene.make.bitmapText({font:za.A.MIKADO_RED_STROKE.KEY,size:16,text:"Skip",origin:{x:.5,y:.5}});this.skipButton.add(e),this.headerContainer.add(this.skipButton),this.skipButton.onClick=this.handleSkip.bind(this),Phaser.Display.Align.In.Center(e,this.skipButton,0,0)},n.handleSkip=function(){this.scene.game.globalScene.screen.open(Ua.R8.ALERT_SCREEN,{message:"Are you sure you want\nto skip the tutorial?",onHandleYes:this.handleCompleteTutorial.bind(this)})},n.initTutorialStep=function(){this.stepOne=new Kr(this),this.stepTwo=new Jr(this),this.stepThree=new Zr(this),this.stepFour=new Yr(this)},n.start=function(){var e=this;this.isRunning()||(this.scene.analytics.pageview("tutorial-screen"),this.setState(qr.RUNNING),this.headerContainer.setVisible(!0),this.showTutorialWhenStart(),this.scene.events.on(Vr.A.LAYOUT_UPDATE,(function(){e.alignComponents()})))},n.alignComponents=function(){this.resetHeader()},n.setTextTutorial=function(e){var t=this,n=e.split(""),i="";this.scene.time.addEvent({repeat:n.length,delay:10,callback:function(){var e=n.shift()||"";i+=e,t.textTutorial.setText(i);var a=t.headerContainer,s=a.x,r=a.y;t.headerContainer.setPosition(0,0),Phaser.Display.Align.In.Center(t.textTutorial,t.headerContainer,0,-10),t.headerContainer.setPosition(s,r)}})},n.stop=function(){this.isRunning()&&(this.scene.tweens.killTweensOf([this.background]),this.background.setVisible(!1),this.maskGraphics.setVisible(!1),this.setState(qr.STOPPED))},n.resetHeader=function(){var e=this.scene.gameZone,t=e.width,n=e.height;this.background.setWorldSize(t,n<620?90:100),this.textTutorial.setFontSize(this.scene.fontSize(40)),this.headerContainer.setSize(this.background.displayWidth,this.background.displayHeight),Phaser.Display.Align.In.TopCenter(this.headerContainer,this.scene.gameZone);var i=this.headerContainer,a=i.x,s=i.y;this.headerContainer.setPosition(0,0),Phaser.Display.Align.In.BottomRight(this.skipButton,this.headerContainer,-5,10),this.headerContainer.setPosition(a,s)},n.handleCompleteTutorial=function(){this.stopCurrentTutorial(),this.scene.analytics.pageview("game-scene"),this.scene.analytics.event(rn.o.TUTORIAL_COMPLETE),this.setState(qr.STOPPED),this.scene.main.praise.tweenShowScoreText.stop().remove(),this.scene.checkAndAddShortcut(),this.scene.startGame(),this.handFrame.setVisible(!1),this.headerContainer.setVisible(!1)},n.createHand=function(){this.handFrame=this.scene.make.image({key:no,frame:io.HAND,origin:{x:.5,y:.5}}),this.handFrame.setVisible(!1).setDepth(Na.A.ON_TOP),this.handFrame.setWorldSize(64,55)},n.isValidForTutorial=function(){return this.scene.game.player.getPlayerIsNew()},n.stopCurrentTutorial=function(){switch(this.currentLevel){case 1:this.stepOne.nextLevel();break;case 2:this.stepTwo.nextLevel();break;case 3:this.stepThree.nextLevel();break;case 4:this.stepFour.nextLevel()}},n.dragStart=function(){switch(this.currentLevel){case 1:this.stepOne.dragStart();break;case 2:this.stepTwo.dragStart();break;case 3:this.stepThree.dragStart();break;case 4:this.stepFour.dragStart()}},n.skipTutorial=function(){this.isRunning()&&(this.handFrame.setVisible(!1),this.setState(qr.STOPPED))},n.invalidMove=function(){switch(this.currentLevel){case 1:this.stepOne.invalidMove();break;case 2:this.stepTwo.invalidMove();break;case 3:this.stepThree.invalidMove();break;case 4:this.stepFour.invalidMove()}},n.handleGuidePlayStep=function(e){try{this.scene.main.board.clearBoard(),this.scene.footer.pieces.clearPieces();var t=null,n=null;if(e){var i=this.scene.main.board.getBoardByFen(e);t=this.scene.handleDynamicFenSize(i),n=this.scene.footer.pieces.getPiecesByFen(e)}this.scene.main.board.startGame(t),this.scene.footer.pieces.showAvailablePieces(n)}catch(a){console.log(a)}},t}(Za),so=ao,ro=n(226),oo=n(496),co=n(504),lo=n(505),ho=n(110),uo=n(228),po=n(111),fo=n(143),mo=n(498),go=n(144),vo=n(489),yo={LOGO:{KEY:"spine-logo",JSON:"./assets/spine/logo/title-adventure.json",ATLAS:"./assets/spine/logo/title-adventure.atlas",ANIMATIONS:{START_GROW:"start",IDLE_GROW:"idle"}},BEST_SCORE:{KEY:"best-score",JSON:"./assets/spine/best-score/newbest-trim.json",ATLAS:"./assets/spine/best-score/newbest-trim.atlas",ANIMATIONS:{ANIM:"anim5"}}},Ao=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.bestScoreSpine=void 0,n.scene=t,t.add.existing((0,ka.A)(n)),n}(0,_.A)(t,e);var n=t.prototype;return n.createSpineEffect=function(){var e=this,t=this.scene.world.getPixelRatio(),n=this.scene.gameZone.height/2;this.bestScoreSpine=this.scene.add.spine(-187.5,n,yo.BEST_SCORE.KEY,yo.BEST_SCORE.ANIMATIONS.ANIM),this.bestScoreSpine.preMultipliedAlpha=!0,this.bestScoreSpine.scale=1/t,this.add(this.bestScoreSpine),this.bestScoreSpine.on("complete",(function(){e.bestScoreSpine.setVisible(!1)}))},n.playEffect=function(){this.bestScoreSpine?(this.bestScoreSpine.setVisible(!0),this.bestScoreSpine.play(yo.BEST_SCORE.ANIMATIONS.ANIM)):this.createSpineEffect()},t}(Phaser.GameObjects.Container),Eo=n(652),To=n.n(Eo),So=GameCore.Configs,bo=So.Gameplay,Po=So.Match.Levels,Co=function(){function e(e){this.scene=void 0,this.levelIndex=0,this.levels=Po,this.currentLevel=void 0,this.recentLevel=void 0,this.scene=e,this.init()}var t=e.prototype;return t.init=function(){var e=this.scene.storage.getState(),t=(0,po.IP)(e)||1;this.currentLevel=t},t.increaseLevel=function(){this.levelIndex++},t.getCurrentTargetScore=function(){return this.levels[this.levelIndex]},t.getNextTargetScoreLevel=function(){return this.levels[this.levelIndex+1]},t.getCurrentIndex=function(){return this.levelIndex},t.getLevel=function(){return this.currentLevel},t.updateCurrentLevelByScore=function(e){var t,n=To()(t=this.levels).call(t,(function(t){return t>e}));if(-1===n)return this.handleAutoGrantNewLevel(e);this.levelIndex=n;var i=this.levels[n-1];return i&&(this.recentLevel=i),this.levels[n]},t.restart=function(){this.levelIndex=0,this.recentLevel=0},t.handleAutoGrantNewLevel=function(e){var t=bo.Progress.BonusScore,n=this.levels[this.levels.length-1]+t;return this.levels.push(n),n<=e?this.handleAutoGrantNewLevel(e):(this.levelIndex=this.levels.length-1,this.recentLevel=this.levels[this.levelIndex],n)},e}(),wo=n(486),Io=Fa.A.DEFAULT,xo=Io.KEY,ko=Io.FRAME,Oo=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.background=void 0,n.textOutOfMoves=void 0,n.tweenMoveCenterScene=void 0,n.tweenMoveOutScene=void 0,n.tweenScaleDown=void 0,n.scale0=void 0,n.popupFadeInMaskAnimation=void 0,n.scene=t,n.init(),n.setPosition(n.scene.gameZone.width/2,0),n.registerEvents(),t.add.existing((0,ka.A)(n)),n}(0,_.A)(t,e);var n=t.prototype;return n.registerEvents=function(){this.scene.world.events.on(on.A.RESIZE,this.handleResize,this)},n.handleResize=function(){var e=this.scene.world.getWorldSize(),t=e.width,n=e.height;this.setPosition(this.scene.gameZone.width/2,0),this.background.setWorldSize(t,n)},n.init=function(){this.addBackground(),this.createTextOutOfMoves(),this.createTweenMoveCenterScene(),this.createTweenMoveOutScene(),this.createTweenScaleDown()},n.addBackground=function(){var e=this.scene.gameZone,t=e.width,n=e.height;this.background=this.scene.add.image(0,0,xo,ko.BLANK),this.background.setTint(0),this.background.setPosition(0,n/2),this.background.setWorldSize(t,n),this.background.setVisible(!1),this.add(this.background)},n.createTextOutOfMoves=function(){this.textOutOfMoves=this.scene.make.image({key:xo,frame:ko.TEXT_OUT_OF_MOVES}),this.textOutOfMoves.setVisible(!1),this.textOutOfMoves.setWorldSize(194,27),this.scale0=this.textOutOfMoves.scale,this.add(this.textOutOfMoves)},n.createTweenMoveCenterScene=function(){var e=this;this.tweenMoveCenterScene=this.scene.tweens.add({targets:[this.textOutOfMoves],paused:!0,duration:600,ease:Phaser.Math.Easing.Back.Out,scale:{from:0,to:this.scale0},completeDelay:2e3,onComplete:function(){e.tweenMoveOutScene.play()}})},n.createTweenScaleDown=function(){var e=this;this.tweenScaleDown=this.scene.tweens.add({targets:[this.textOutOfMoves],paused:!0,duration:300,ease:Phaser.Math.Easing.Back.In,scale:{from:this.scale0,to:0},completeDelay:250,onComplete:function(){e.scene.checkShowRescueScreen()}})},n.playTweenScaleDown=function(){this.tweenScaleDown.play()},n.createTweenMoveOutScene=function(){var e,t=this;null==(e=this.tweenMoveOutScene)||e.remove(),this.tweenMoveOutScene=this.scene.tweens.add({targets:[this.textOutOfMoves],paused:!0,duration:600,ease:Phaser.Math.Easing.Sine.Out,y:{start:this.scene.gameZone.height/2,from:this.scene.gameZone.height/2,to:-this.scene.gameZone.height},onComplete:function(){t.hideTextOutOfMoves()}})},n.playTweenMoveCenterScene=function(){var e=this.scene.journeyGameplay.main.y;this.textOutOfMoves.setY(e),this.textOutOfMoves.setScale(0),this.runFadeInMaskAnimation(0,300)},n.hideTextOutOfMoves=function(){this.textOutOfMoves.setVisible(!1),this.background.setVisible(!1)},n.runFadeInMaskAnimation=function(e,t){var n=this;this.background.setVisible(!0),this.popupFadeInMaskAnimation||(this.popupFadeInMaskAnimation=new wo.A({targets:[this.background],delay:e,duration:t,props:{alpha:{start:0,from:0,to:.75}},onComplete:function(){var e=n.scene.journeyGameplay.main.getWorldPosition().y;n.textOutOfMoves.setVisible(!0),n.textOutOfMoves.setY(e),n.tweenMoveCenterScene.play()}})),this.popupFadeInMaskAnimation.play()},t}(Phaser.GameObjects.Container),_o=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidMove",i.message=t||"Invalid move",i.payload=n,i}return(0,_.A)(t,e),t}((0,$.A)(Error)),Ro={min:18,max:60},Do=Math.sin,Mo=Math.cos,Bo=Fa.A.GAMEPLAY_32.FRAME,Lo=Fa.A.EFFECTS.FRAME,No=function(e){var t="",n=[];switch(e){case Bo.GEM_RED:t=Lo.PREFIX_RED;break;case Bo.GEM_BLUE:t=Lo.PREFIX_BLUE;break;case Bo.GEM_ORANGE:t=Lo.PREFIX_YELLOW;break;case Bo.GEM_PINK:t=Lo.PREFIX_PINK;break;case Bo.GEM_VIOLET:t=Lo.PREFIX_VIOLET;break;case Bo.GEM_GREEN:t=Lo.PREFIX_GREEN}for(var i=1;i<=6;i++)n.push(""+t+i);return n},Go={};Go[Bo.GEM_RED]=No(Bo.GEM_RED),Go[Bo.GEM_BLUE]=No(Bo.GEM_BLUE),Go[Bo.GEM_ORANGE]=No(Bo.GEM_ORANGE),Go[Bo.GEM_GREEN]=No(Bo.GEM_GREEN),Go[Bo.GEM_PINK]=No(Bo.GEM_PINK),Go[Bo.GEM_VIOLET]=No(Bo.GEM_VIOLET);var Fo=Fa.A.GAMEPLAY_32.FRAME,Uo=Fa.A.EFFECTS,jo=Uo.KEY,Vo=Uo.FRAME,zo=[4,4,4,4,4,4,4,5,5,5],Yo=[3,3,3,3,3,3,3,3,3,3],Ho=[50,50,50,50,50,50,50,50,50,50],Ko={x:0,y:0,angle:{min:0,max:360},scale:{min:.6,max:1},on:!1,lifespan:800,frequency:100},Wo={x:0,y:0,angle:{min:200,max:300},rotate:{start:0,end:360},on:!1,lifespan:1e3,frequency:50,gravityY:4e3},Zo=Fa.A.EFFECTS.FRAME,Xo=function(){function e(e,t,n){this.scene=void 0,this.x=void 0,this.y=void 0,this.width=void 0,this.height=void 0,this.particle=void 0,this.starEmitter=void 0,this.rockEmitter=void 0,this.smokeEmitter=void 0,this.scene=e,this.x=t,this.y=n,this.width=300,this.height=50,this.particle=this.scene.add.particles(jo,Vo.FX_STAR),this.particle.setDepth(Na.A.ON_TOP)}var t=e.prototype;return t.setSize=function(e,t){this.width=e,this.height=t},t.handleShowJewelEffect=function(e,t,n,i){var s=n%10,r=this.scene.world.getPixelRatio();this.starEmitter?(this.starEmitter.x.loadConfig({x:{min:e+5,max:e+this.width-5}}),this.starEmitter.y.loadConfig({y:{min:t+5,max:t+this.height-5}})):this.starEmitter=this.particle.createEmitter((0,a.A)({},Ko,{x:{min:e+5,max:e+this.width-5},y:{min:t+5,max:t+this.height-5},lifespan:{min:300,max:500},frame:Zo.FX_STAR,scale:{start:.4*r,end:0},speedX:{min:-30*r,max:30*r},speedY:{min:-60*r,max:-30*r},gravityY:500*r,on:!1})),this.rockEmitter?(this.rockEmitter.x.loadConfig({x:{min:e+5,max:e+this.width-5}}),this.rockEmitter.y.loadConfig({y:{min:t+5,max:t+this.height-5}})):this.rockEmitter=this.particle.createEmitter((0,a.A)({},Wo,{x:{min:e+5,max:e+this.width-5},y:{min:t+5,max:t+this.height-5},frequency:Ho[s],scale:{min:.1*r,max:.4*r},speedX:{min:-30*r,max:30*r},speedY:{min:-200*r,max:-170*r},gravityY:1200*r,lifespan:{min:1e3,max:2e3}})),this.smokeEmitter?(this.smokeEmitter.x.loadConfig({x:{min:e,max:e+this.width}}),this.smokeEmitter.y.loadConfig({y:{min:t,max:t+this.height}})):this.smokeEmitter=this.particle.createEmitter({x:{min:e,max:e+this.width},y:{min:t,max:t+this.height},scale:{min:.05*r,max:.1*r},speed:{min:10,max:30},lifespan:500,gravityY:80*r,alpha:{start:.8,end:0},frequency:2,on:!1}),this.starEmitter.setTint(this.getColorByGemFrame(i)),this.starEmitter.explode(zo[s]),this.rockEmitter.setFrame(this.getFrameRocksByGemFrame(i)),this.rockEmitter.explode(Yo[s]),this.smokeEmitter.setTint(this.getColorByGemFrame(i)),this.smokeEmitter.explode(12)},t.getColorByGemFrame=function(e){switch(e){case Fo.GEM_GREEN:return 5736201;case Fo.GEM_ORANGE:return 15634193;case Fo.GEM_PINK:return 181093535;case Fo.GEM_RED:return 13372428;case Fo.GEM_VIOLET:return 2978749;case Fo.GEM_BLUE:return 7393001}return 16777215},t.getFrameRocksByGemFrame=function(e){return Go[e]},e}(),Jo=Xo,qo=Fa.A.GAMEPLAY_32,Qo=qo.KEY,$o=qo.FRAME,ec=function(e){function t(t,n){var i;return(i=e.call(this,t,n.x+(n.padding||0),n.y+(n.padding||0),Qo,n.gemFrame||$o.GEM_DISABLE)||this).canCapture={direction:"bottom",angle:0},i.status=void 0,i.rateShaking=1,i.gemFrame=void 0,i.imageTargetItem=void 0,i.t0=0,i.x0=void 0,i.y0=void 0,i.v0=void 0,i.alpha0=void 0,i.scale0=void 0,i.maxScale0=void 0,i.scaleRate0=void 0,i.scaleImageTargetItem=void 0,i.alphaImageTargetItem=void 0,i.jewelEffect=void 0,i.imageBreak=void 0,i.imageGameOver=void 0,i.imageGameStart=void 0,i.tweenImageGameOver=void 0,i.imageHighlight=void 0,i.tweenImageHighlight=void 0,i.tweenScaleDown=void 0,i.tweenAlphaImageBreak=void 0,i.tweenStartMission=void 0,i.tweenScaleDownCell=void 0,i.setWorldSize(n.width,n.height),n.gemFrame&&(i.gemFrame=n.gemFrame),i.x0=n.x+(n.padding||0),i.y0=n.y+(n.padding||0),i.scale0=i.scale,i.alpha0=i.alpha,i.scene=t,i.createImageGameStart(),i.createImageBreak(),i.createImageGameOver(),i.createTweenImageGameOver(),i.createImageHighlight(),i.createTweenImageGHighlight(),i.createTweenScaleDown(),i.createTweenAlphaImageBreak(),i.createTweenStartMission(),i.createTweenScaleDownCell(),i.createJewelEffect(),i}(0,_.A)(t,e);var n=t.prototype;return n.createImageBreak=function(){this.imageBreak=this.scene.make.image({key:Qo,frame:$o.GEM_GREEN}),this.imageBreak.setVisible(!1),this.imageBreak.setScale(this.scale0),this.imageBreak.setPosition(this.x,this.y)},n.createImageGameStart=function(){this.imageGameStart=this.scene.make.image({key:Qo,frame:$o.GEM_BLUE}),this.imageGameStart.setDepth(this.depth+1),this.imageGameStart.setVisible(!1),this.imageGameStart.setScale(this.scale0),this.imageGameStart.setPosition(this.x,this.y)},n.createImageGameOver=function(){this.imageGameOver=this.scene.make.image({key:Qo,frame:$o.GEM_DISABLE}),this.imageGameOver.setDepth(this.depth+1),this.imageGameOver.setVisible(!1),this.imageGameOver.setScale(this.scale0),this.imageGameOver.setPosition(this.x,this.y)},n.createTweenImageGameOver=function(){this.tweenImageGameOver=this.scene.add.tween({targets:[this.imageGameOver],duration:66,ease:Phaser.Math.Easing.Quadratic.InOut,alpha:{from:0,to:1,start:0},paused:!0})},n.createImageHighlight=function(){this.imageHighlight=this.scene.make.image({key:Qo,frame:$o.GEM_DISABLE}),this.imageHighlight.setDepth(this.depth+1),this.imageHighlight.setVisible(!1),this.imageHighlight.setScale(this.scale0),this.imageHighlight.setPosition(this.x,this.y)},n.createTweenImageGHighlight=function(){this.tweenImageHighlight=this.scene.add.tween({targets:[this.imageHighlight],duration:100,ease:Phaser.Math.Easing.Quadratic.InOut,alpha:{from:0,to:1,start:0},paused:!0})},n.createTweenStartMission=function(){this.tweenStartMission=this.scene.add.tween({targets:[this.imageGameStart],duration:200,ease:Phaser.Math.Easing.Quadratic.InOut,scale:{from:0,to:this.scale0,start:0},alpha:{from:0,to:1,start:0},yoyo:!0,paused:!0})},n.createTweenScaleDown=function(){var e=this.imageBreak.scale;this.tweenScaleDown=this.scene.add.tween({delay:100,targets:[this.imageBreak],duration:600,ease:Phaser.Math.Easing.Quadratic.InOut,scale:{from:e,to:0,start:e},paused:!0})},n.createTweenAlphaImageBreak=function(){this.tweenAlphaImageBreak=this.scene.add.tween({targets:[this.imageBreak],duration:333,ease:Phaser.Math.Easing.Sine.InOut,alpha:{from:1,to:0},paused:!0})},n.showImageHighlight=function(e){this.imageHighlight.setFrame(e),this.imageHighlight.setVisible(!0).setAlpha(1),this.imageHighlight.setPosition(this.x,this.y)},n.hideImageHighlight=function(){this.imageHighlight.setVisible(!1)},n.isHighlight=function(){return this.imageHighlight.visible},n.isShaking=function(){return"SHAKING"===this.status},n.playAnimShaking=function(){this.status="SHAKING"},n.playTweenBreaking=function(){this.status="BREAKING"},n.setRateShaking=function(e){this.rateShaking=e},n.stopAnimShaking=function(){this.rotation=0,this.status=""},n.reset=function(){this.x=this.x0,this.y=this.y0,this.rotation=0,this.scale=this.scale0,this.alpha=1},n.resetGemFrame=function(){this.setFrame(this.gemFrame)},n.resetImageBreak=function(){this.imageBreak.x=this.x0,this.imageBreak.y=this.y0,this.imageBreak.rotation=0,this.imageBreak.scale=this.scale0,this.imageBreak.setVisible(!1)},n.resetImageGameOver=function(){this.imageGameOver.setPosition(this.x,this.y),this.imageGameOver.setScale(this.scale0),this.imageGameOver.setVisible(!1)},n.playAnimImageGameOver=function(){this.resetImageGameOver(),this.imageGameOver.setVisible(!0).setAlpha(0),this.tweenImageGameOver.play()},n.playTweenScaleDown=function(e){this.resetImageBreak(),this.imageBreak.setPosition(this.x,this.y),this.imageBreak.setFrame(e),this.imageBreak.setVisible(!0).setScale(this.scale0).setAlpha(0),this.tweenAlphaImageBreak.play()},n.playTweenStartMission=function(){this.imageGameStart.setVisible(!0).setAlpha(0),this.tweenStartMission.play()},n.createTweenScaleDownCell=function(){var e=this,t=this.x,n=this.y,i=this.scale;this.tweenScaleDownCell=this.scene.add.tween({targets:[this,this.imageGameOver],delay:100,duration:300,ease:Phaser.Math.Easing.Sine.InOut,scale:{from:this.scale,to:0},x:{from:this.x,to:0},y:{from:this.y,to:-84.5},paused:!0,onComplete:function(){e.scene.time.delayedCall(500,(function(){e.x=t,e.y=n,e.scale=i}))}})},n.playTweenScaleDownCell=function(){this.tweenScaleDownCell.play()},n.preUpdate=function(){if("SHAKING"===this.status)this.rotation+=.015*this.rateShaking,this.rotation>.1&&(this.rateShaking=-1),this.rotation<-.1&&(this.rateShaking=1)},n.handleTweenBreaking=function(){var e=this.alpha0<90?1:-1;this.t0+=3e3/1900;var t=.016*this.t0,n=function(e,t,n){return e*Mo(t)*n}(this.v0,this.alpha0,t),i=function(e,t,n,i){return void 0===i&&(i=10),e*Do(t)*n-.5*i*Math.pow(n,2)}(this.v0,this.alpha0,t);this.imageBreak.x=this.x0+n,this.imageBreak.y=this.y0-i,this.imageBreak.rotation+=.04*e,this.imageBreak.scale>.4?this.imageBreak.scale-=this.scale0:this.imageBreak.scale=.4;var a=this.scene.gameZone,s=a.width,r=a.height;(this.imageBreak.x-this.imageBreak.displayWidth/2<0||this.imageBreak.x+this.imageBreak.displayWidth/2>s||this.imageBreak.y-this.imageBreak.displayHeight/2>r)&&(this.status="")},n.createJewelEffect=function(){var e=this.scene;this.jewelEffect=new Jo(e,0,0),this.jewelEffect.setSize(this.width,this.height)},n.runJewelEffect=function(e,t){var n=this,i=this.getWorldPosition(),a=i.x,s=i.y;this.scene.time.delayedCall(100,(function(){n.jewelEffect.handleShowJewelEffect(a-n.displayWidth/2,s-n.displayHeight/2,e,t)}))},n.setTargetItem=function(e){},n.removeTargetItem=function(){},n.isGemHighlight=function(){return this.frame.name==$o.GEM_HIGHT_LIGHT},t}(Phaser.GameObjects.Image),tc=ec,nc=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).scene=void 0,i.scene=t,t.add.existing((0,ka.A)(i)),i}return(0,_.A)(t,e),t}(tc),ic=nc,ac=n(114),sc=n.n(ac),rc=GameCore.Configs.Board,oc=rc.cols,cc=void 0===oc?8:oc,lc=rc.rows,hc=void 0===lc?8:lc,uc=0,dc=function(){return uc},pc=function(e,t){uc=0;for(var n=[],i=e.length,a=e[0].length,s=[],r=[],o=function(t){for(var i=!0,r=0;r<a;r++)0===e[t][r].value&&(i=!1);if(i){s.push(t);for(var o=function(i){n.some((function(e){return e.x===i&&e.y===t}))||n.push({x:i,y:t,frame:e[t][i].frame})},c=0;c<a;c++)o(c)}},c=0;c<i;c++)o(c);for(var l=function(t){for(var a=!0,s=0;s<i;s++)0===e[s][t].value&&(a=!1);if(a){r.push(t);for(var o=function(i){n.some((function(e){return e.x===t&&e.y===i}))||n.push({x:t,y:i,frame:e[i][t].frame})},c=0;c<i;c++)o(c)}},h=0;h<a;h++)l(h);return uc+=s.length,uc+=r.length,n},fc=function(e){for(var t=e.length,n=e[0].length,i=[],a=0;a<t;a++){for(var s=!0,r=0;r<n;r++)0===e[a][r].value&&(s=!1);s&&i.push(a)}return i},mc=function(e){for(var t=e.length,n=e[0].length,i=[],a=0;a<n;a++){for(var s=!0,r=0;r<t;r++)0===e[r][a].value&&(s=!1);s&&i.push(a)}return i},gc=function(e,t){var n=e.length,i=e[0].length;if(0===t.length)return!1;for(var a=0;a<n;a++)for(var s=0;s<i;s++)for(var r=0;r<t.length;r++)if(vc(e,s,a,t[r]))return!1;return!0},vc=function(e,t,n,i){for(var a=!0,s=0;s<i.data.length;s++)for(var r=0;r<i.data[s].length;r++)i.data[s][r].texture&&(e[n+s]&&e[n+s][t+r]&&0===e[n+s][t+r].value||(a=!1));return a},yc=function(e,t){for(var n=e.length,i=e[0].length,a=0;a<n;a++)for(var s=0;s<i;s++)if(vc(e,s,a,t))return!0;return!1},Ac=function(e,t){for(var n=e.length,i=e[0].length,a=0,s=0,r=0,o=0;o<n;o++)for(var c=0;c<i;c++)if(vc(e,c,o,t)&&(s=c,r=o,++a>1))return null;if(0===a)return null;for(var l=[],h=0;h<t.data.length;h++)for(var u=0;u<t.data[h].length;u++)t.data[h][u].texture&&l.push({x:s+u,y:r+h});return l&&l.length>0?l:null},Ec=0,Tc=function(){Ec=0},Sc=function(){return Ec+1},bc=function(e){var t=e;switch(e){case cs:t="b";break;case ls:t="q";break;case hs:t="o";break;case us:t="p";break;case ds:t="c";break;case ps:t="d";break;case fs:t="g";break;case bs:t="l";break;case Ps:t="l1";break;case Cs:t="l3";break;case ws:t="e2";break;case Is:t="e3";break;case xs:t="e4";break;case ks:t="e5";break;case Os:t="s1";break;case _s:t="s2";break;case Rs:t="s3";break;case Ds:t="tz";break;case Ms:t="ta";break;case ns:t="dt";break;case es:t="dl";break;case ts:t="dr";break;case is:t="db";break;case Qa:t="v";break;case $a:t="h";break;case as:t="vl";break;case ss:t="vr";break;case rs:t="hl";break;case os:t="hr";break;case ms:t="w";break;case gs:t="u";break;case vs:t="i";break;case ys:t="n";break;case As:t="j";break;case Es:t="k"}return t},Pc=function(e){var t=e;switch(e){case"b":t=cs;break;case"q":t=ls;break;case"o":t=hs;break;case"p":t=us;break;case"c":t=ds;break;case"d":t=ps;break;case"g":t=fs;break;case"l":t=bs;break;case"l1":t=Ps;break;case"l3":t=Cs;break;case"e2":t=ws;break;case"e3":t=Is;break;case"e4":t=xs;break;case"e5":t=ks;break;case"s1":t=Os;break;case"s2":t=_s;break;case"s3":t=Rs;break;case"tz":t=Ds;break;case"ta":t=Ms;break;case"dt":t=ns;break;case"dl":t=es;break;case"dr":t=ts;break;case"db":t=is;break;case"v":t=Qa;break;case"h":t=$a;break;case"vl":t=as;break;case"vr":t=ss;break;case"hl":t=rs;break;case"hr":t=os;break;case"w":t=ms;break;case"u":t=gs;break;case"i":t=vs;break;case"n":t=ys;break;case"j":t=As;break;case"k":t=Es;break;case"dib":t="gem/diamond/diamond-blue";break;case"dip":t="gem/diamond/diamond-purple";break;case"dir":t="gem/diamond/diamond-red";break;case"diy":t="gem/diamond/diamond-yellow"}return t},Cc=function(e){for(var t=[],n="123456789x",i=e.split(""),a=0;a<i.length;a++)if(g()(n).call(n,i[a])>=0){var s="x"===i[a]?hc:Number(i[a]);s=s>cc?cc:s;for(var r=0;r<s;r++)t.push({value:0,frame:"gem/gem_transparent"})}else t.push({value:1,frame:Pc(i[a]),frameTarget:Pc(i[a])});return t},wc=function(e){var t=e.split(","),n=t[0].split("-");if(n.length<=0)throw new Error("Invalid piece");return{type:Pc(n[0]),direction:Pc(n[1])||null,isReverse:n[2]&&"r"===n[2]||!1,frame:Pc(t[1])}},Ic=Fa.A.GAMEPLAY_32.FRAME,xc={2:Ic.GEM_BLUE,3:Ic.GEM_GREEN,4:Ic.GEM_ORANGE,5:Ic.GEM_PINK,6:Ic.GEM_RED,7:Ic.GEM_VIOLET,11:Ic.BUBBLE_BLUE,12:Ic.BUBBLE_GREEN,13:Ic.BUBBLE_ORANGE,14:Ic.BUBBLE_PINK,15:Ic.BUBBLE_VIOLET,16:Ic.BUBBLE_YELLOW},kc={1:Ic.BUBBLE_BLUE,2:Ic.BUBBLE_GREEN,3:Ic.BUBBLE_ORANGE,4:Ic.BUBBLE_PINK,5:Ic.BUBBLE_VIOLET,6:Ic.BUBBLE_YELLOW},Oc=[Ic.GEM_BLUE,Ic.GEM_GREEN,Ic.GEM_ORANGE,Ic.GEM_PINK,Ic.GEM_RED,Ic.GEM_VIOLET],_c=[Ic.BUBBLE_BLUE,Ic.BUBBLE_GREEN,Ic.BUBBLE_ORANGE,Ic.BUBBLE_PINK,Ic.BUBBLE_VIOLET,Ic.BUBBLE_YELLOW],Rc={1:{type:Os,direction:null,isReverse:!1,data:fr},I2:{type:ws,direction:Qa,isReverse:!1,data:rr},I3:{type:Is,direction:Qa,isReverse:!1,data:cr},I4:{type:xs,direction:Qa,isReverse:!1,data:hr},I5:{type:ks,direction:Qa,isReverse:!1,data:dr},II2:{type:ws,direction:$a,isReverse:!1,data:or},II3:{type:Is,direction:$a,isReverse:!1,data:lr},II4:{type:xs,direction:$a,isReverse:!1,data:ur},II5:{type:ks,direction:$a,isReverse:!1,data:pr},J1:{type:bs,direction:ns,isReverse:!0,data:Ys},J2:{type:bs,direction:es,isReverse:!0,data:ir},J3:{type:bs,direction:is,isReverse:!0,data:$s},J4:{type:bs,direction:ts,isReverse:!0,data:Xs},L1:{type:bs,direction:ns,isReverse:!1,data:Ys},L2:{type:bs,direction:ts,isReverse:!1,data:Zs},L3:{type:bs,direction:is,isReverse:!1,data:Qs},L4:{type:bs,direction:es,isReverse:!1,data:nr},O:{type:_s,direction:null,isReverse:!1,data:mr},S1:{type:Ds,direction:os,isReverse:!1,data:Er},S2:{type:Ds,direction:as,isReverse:!1,data:vr},T1:{type:Ms,direction:ns,isReverse:!1,data:br},T2:{type:Ms,direction:ts,isReverse:!1,data:Sr},T3:{type:Ms,direction:is,isReverse:!1,data:Pr},T4:{type:Ms,direction:es,isReverse:!1,data:Tr},V1:{type:Ps,direction:ts,isReverse:!1,data:Js},V2:{type:Ps,direction:is,isReverse:!1,data:er},V3:{type:Ps,direction:ns,isReverse:!1,data:Ks},V4:{type:Ps,direction:es,isReverse:!1,data:ar},VV1:{type:Cs,direction:ts,isReverse:!1,data:qs},VV2:{type:Cs,direction:is,isReverse:!1,data:tr},VV3:{type:Cs,direction:ns,isReverse:!1,data:Ws},VV4:{type:Cs,direction:es,isReverse:!1,data:sr},Z1:{type:Ds,direction:rs,isReverse:!1,data:Ar},Z2:{type:Ds,direction:ss,isReverse:!1,data:yr}},Dc=Fa.A.GAMEPLAY_32,Mc=Dc.KEY,Bc=Dc.FRAME,Lc=GameCore.Configs.Board,Nc=Lc.cols,Gc=Lc.rows,Fc=function(e){function t(n,i,a){var s;return(s=e.call(this,n)||this).scene=void 0,s.parent=void 0,s.matrixData=void 0,s.cellItems=[],s.cells=[],s.data=[],s.type=void 0,s.direction=void 0,s.texture=void 0,s.frame=void 0,s.isCanMove=void 0,s.isReverse=!1,s.isSetDrag=!1,s.isCreateCell=!1,s.isDragEnd=!1,s.isActive=!0,s.isVisible=!0,s.pointerY=void 0,s.parentHeight=void 0,s.cellScale=void 0,s.index=void 0,s.backupPx=void 0,s.backupPy=void 0,s.pXPiece=void 0,s.pYPiece=void 0,s.distancePY=void 0,s.moveTopNumber=30,s.correctAlpha=1,s.wrapPiece=void 0,s.animMoveTopAndScaleUp=void 0,s.animScaleDownCells=void 0,s.animMoveDownAndScaleDown=void 0,s.animScaleUp=void 0,s.animScaleDown=void 0,s.type=a.type,s.matrixData=a.matrixData,s.data=t.buildData(s.matrixData),s.direction=a.direction||null,s.parentHeight=a.parentHeight||0,s.isReverse=a.isReverse||!1,s.parent=i,s.scene=n,s.setSize(i.width/3,i.height),s.createWrapPiece(),s.registerEvents(),s.scene.add.existing((0,ka.A)(s)),s}(0,_.A)(t,e);var n=t.prototype;return n.createWrapPiece=function(){this.wrapPiece=this.scene.make.image({key:Mc,frame:Bc.GEM_TRANSPARENT}),this.wrapPiece.setWorldSize(this.width,this.height)},n.setInteractiveContainer=function(){this.wrapPiece.setInteractive({useHandCursor:!0}).input.hitArea.setTo(0,0,this.width/this.wrapPiece.scaleX,this.height/this.wrapPiece.scaleY),this.scene.input.setDraggable(this.wrapPiece)},n.registerEvents=function(){this.unregisterEvents(),this.setInteractiveContainer(),this.wrapPiece.on(Phaser.Input.Events.POINTER_DOWN,this.handlePointerDown.bind(this)),this.wrapPiece.on(Phaser.Input.Events.DRAG_START,this.handleDragStart.bind(this)),this.wrapPiece.on(Phaser.Input.Events.DRAG,this.handleDrag.bind(this)),this.wrapPiece.on(Phaser.Input.Events.DRAG_END,this.handleDragEnd.bind(this))},n.unregisterEvents=function(){this.wrapPiece.off(Phaser.Input.Events.POINTER_DOWN),this.wrapPiece.off(Phaser.Input.Events.DRAG_START),this.wrapPiece.off(Phaser.Input.Events.DRAG),this.wrapPiece.off(Phaser.Input.Events.DRAG_END),this.wrapPiece.disableInteractive()},n.updatePosition=function(e,t){this.setPosition(e,t),this.backupPx=this.x,this.backupPy=this.y},n.updatePositionWrapPiece=function(){var e=this.getWorldPosition(),t=e.x,n=e.y;this.wrapPiece.setPosition(t,n)},n.setIndex=function(e){this.index=e},n.drawPiece=function(){},n.playAnimScaleDownCells=function(){var e=this,t=[];this.cellItems.forEach((function(e){var n=e.cell;t.push(n)})),this.animScaleDownCells=this.scene.add.tween({targets:t,scale:{from:this.cellScale,to:.85*this.cellScale},duration:150,ease:Phaser.Math.Easing.Sine.InOut,delay:20,onComplete:function(){for(var n=0;n<t.length;n++){t[n].setScale(.85*e.cellScale)}}})},n.checkOutOfThePage=function(e){var t=this.getContainerSize(),n=t.width,i=t.height,a=this.scene.gameZone,s=a.width,r=a.height,o=e.worldX,c=e.worldY,l=this.distancePY-this.getWorldPosition().y+this.y,h=!1,u=!1;return(o<n/2||o>s-n/2)&&(h=!0),(c-l<i/2||c-l>r)&&(u=!0),{lockX:h,lockY:u}},n.checkItemInArray=function(e,t){var n=f()(e).call(e,(function(e){return e.x===t.x&&e.y===t.y}));return!(!n||0===n.length)},n.highlightCellCanCapture=function(e,t,n){for(var i=this,a=Nc,s=Gc,r=[],o=0;o<n.length;o++){var c=n[o],l=c.x,h=c.y;a>l&&(a=l),s>h&&(s=h)}for(var u=function(){var t=e[d],a=f()(n).call(n,(function(e){return e.y===t}));if(!a||0===a.length)return 1;for(var s=0;s<a.length;s++){var o=a[s];i.checkItemInArray(r,o)||r.push(o)}},d=0;d<e.length;d++)u();for(var p=function(){var e=t[m],a=f()(n).call(n,(function(t){return t.x===e}));if(!a||0===a.length)return 1;for(var s=0;s<a.length;s++){var o=a[s];i.checkItemInArray(r,o)||r.push(o)}},m=0;m<t.length;m++)p();for(var g=this.cellItems[0].cell.gemFrame,v=function(){var e,t=r[y],n=t.x,o=t.y,c=f()(e=i.cellItems).call(e,(function(e){return e.x===n-a&&e.y===o-s}));if(!c||0===c.length)return 1;c[0].cell.setFrame(g)},y=0;y<r.length;y++)v()},n.resetCellItems=function(){for(var e=0;e<this.cellItems.length;e++)this.cellItems[e].cell.resetGemFrame()},n.handleDragPieceInvalidMove=function(){},n.handlePointerDown=function(e){this.parent.playTweenToEnableMaxFps()},n.handleDragStart=function(e){},n.handleDrag=function(e){},n.handleDragEnd=function(){this.parent.stopTweenToEnableMaxFps()},n.cancelDrag=function(){},n.handleBoardMoveCompleted=function(){},n.getContainerSizeOrigin=function(){var e=this.data[0].length-1,t=this.data.length-1,n=this.parent.cellSize;return{width:e*n*this.scale,height:t*n*this.scale}},n.calcScore=function(){var e;if(!this.matrixData)return 0;var t=this.matrixData.length||0;if(0===t)return 0;for(var n=(null==(e=this.matrixData[0])?void 0:e.length)||0,i=0,a=0;a<t;a++)for(var s=0;s<n;s++)1===this.matrixData[a][s]&&i++;return i},n.hide=function(){this.setVisible(!1),this.wrapPiece.setVisible(!1)},n.show=function(){this.setVisible(!0),this.wrapPiece.setVisible(!0)},n.playAnimShow=function(){this.setAlpha(0).setScale(0),this.show(),this.animScaleUp.play()},n.onBoardHandleMoveCompleted=function(){},n.drawSuggestCells=function(){},n.handleInvalidMove=function(){},n.canMove=function(){return!0},n.getCellsHighlight=function(){},n.getPositionTopLeftInBoard=function(){},n.getPositionCellBottomRight=function(){if(this.data.length<=0)return{x:0,y:0};var e=this.data.length-1,t=41*this.scene.main.board.cellPadding/100,n=this.parent.cellSize*this.scale,i=n+t,a=n+t;return{x:(this.data[e].length-1)*i+2*t,y:(this.data.length-1)*a+2*t}},t.buildData=function(e){for(var t=[],n=0;n<e.length;n++){t[n]=[];for(var i=0;i<e[n].length;i++){var a=1===e[n][i]?Bc.GEM:null;t[n][i]={x:i,y:n,texture:a}}}return t},n.getPaddingCell=function(){return this.height/this.data.length/40},n.createAnimShow=function(){var e=this,t=140*this.index;this.animScaleUp=this.scene.tweens.add({delay:t,paused:!0,duration:163,targets:this,alpha:{from:0,to:this.alpha},scale:{from:0,to:1.2},ease:Phaser.Math.Easing.Sine.Out,onComplete:function(){e.animScaleDown.play()}}),this.animScaleDown=this.scene.tweens.add({delay:83,paused:!0,duration:150,targets:this,scale:1,ease:Phaser.Math.Easing.Sine.Out})},n.createCells=function(e){},n.updateCellsWithPadding=function(e){for(var t=this.parent.cellSize,n=t-2*e,i=t-2*e,a=this.data.length,s=this.data[0].length,r=0;r<this.data.length;r++)for(var o=0;o<this.data[r].length;o++)if(this.data[r][o].texture){var c=this.cells[r][o],l=(o-(s-1)/2)*(t+e),h=(r-(a-1)/2)*(t+e);c.setWorldSize(n,i),c.setPosition(l,h)}},n.getContainerSize=function(){for(var e=0,t=this.data.length,n=0;n<this.data.length;n++)this.data[n].length>e&&(e=this.data[n].length);var i=this.parent.cellSize;return{width:e*i*this.scale,height:t*i*this.scale}},n.playTweenMoveDownPiece=function(){var e=this,t=this.y;this.scene.add.tween({targets:[this],delay:133,duration:166,ease:Phaser.Math.Easing.Sine.InOut,y:{from:t,to:t+300},paused:!0,onComplete:function(){e.y=t}}).play()},n.setCanMove=function(e){this.isCanMove=e,this.correctAlpha=e?1:.4,this.setAlpha(this.correctAlpha)},n.reset=function(){this.setVisible(!1),this.setScale(1),this.wrapPiece.disableInteractive(),this.data=t.buildData(this.matrixData)},n.alignComponents=function(){if(this.wrapPiece.input&&this.wrapPiece.input.hitArea){var e=this.parentContainer.parentContainer.parentContainer;this.wrapPiece.setWorldSize(this.width*e.scaleX,this.height*e.scaleY),this.wrapPiece.input.hitArea.setTo(0,0,this.width/this.wrapPiece.scaleX,this.height/this.wrapPiece.scaleY)}this.updatePositionWrapPiece()},t}(Phaser.GameObjects.Container),Uc=GameCore.Configs.Board,jc=Uc.cols,Vc=Uc.rows,zc=function(e){function t(t,n,i){return e.call(this,t,n,i)||this}(0,_.A)(t,e);var n=t.prototype;return n.drawPiece=function(){return this.isCreateCell||this.createCells(.5),this.createAnimShow(),this.playAnimShow(),this.wrapPiece.setInteractive(),this},n.handleDragPieceInvalidMove=function(){this.scene.main.board.handleRemoveHighlight(),this.scene.main.board.removeAllCanCaptureCells()},n.handleDragStart=function(t){var n,i,a=this;if(e.prototype.handleDragStart.call(this,t),!this.scene.isGameOver){null==(n=this.animScaleUp)||n.stop(),null==(i=this.animScaleDown)||i.stop(),this.setAlpha(this.correctAlpha).setScale(1).setPosition(this.x,this.y),this.isDragEnd=!1,this.isSetDrag=!0,this.setDepth(Na.A.PIECE+1),this.parent.bringToTop(this),this.animMoveDownAndScaleDown&&this.animMoveDownAndScaleDown.isPlaying()&&(this.animMoveDownAndScaleDown.stop(),this.setScale(1)),this.scene.tutorialManager.isRunning()&&this.scene.tutorialManager.dragStart(),this.scene.audio.playSound(ja.A.PIECE_PICK);var s=this.scene.main.board.cellSize/this.parent.cellSize,r=this.getContainerSize().height,o=t.worldX-this.getWorldPosition().x+this.x,c=0;if(GameCore.Utils.Device.isDesktop())c=t.worldY-this.getWorldPosition().y+this.y-r*s/2;else{var l=0;l=this.scene.gameZone.width/this.scene.gameZone.height>=375/619?64+r*s/2:73+r*s/2,c=t.worldY-this.getWorldPosition().y+this.y-l}this.distancePY=t.worldY-c;var h=41*this.scene.main.board.cellPadding/100;this.updateCellsWithPadding(h),this.playAnimScaleDownCells(),this.animMoveTopAndScaleUp=this.scene.tweens.add({x:o,y:c,scale:s,duration:150,targets:this,ease:Phaser.Math.Easing.Sine.InOut,delay:20,onComplete:function(){if(!a.isDragEnd){var e=a.cellItems[0].cell.gemFrame,t=a.getCellsHighlight();a.scene.main.board.handleRemoveHighlight(),a.scene.main.board.handleHighlight(t,a.highlightCellCanCapture.bind(a),e)}}}),this.drawSuggestCells()}},n.handleDrag=function(e){if(!this.scene.isGameOver&&this.isSetDrag)try{var t=this.cellItems[0].cell.gemFrame,n=e.worldX-this.getWorldPosition().x+this.x,i=e.worldY-this.distancePY;if(this.animMoveTopAndScaleUp&&this.animMoveTopAndScaleUp.isPlaying())return this.animMoveTopAndScaleUp.updateTo("x",n,!0),void this.animMoveTopAndScaleUp.updateTo("y",i,!0);var a=this.checkOutOfThePage(e),s=a.lockX,r=a.lockY;if(s&&r)return;this.resetCellItems(),this.scene.game.updateFps(Ro.max),s?this.setY(i):r?this.setX(n):this.setPosition(n,i),this.canMove();var o=this.getCellsHighlight();this.scene.main.board.handleRemoveHighlight(),this.scene.main.board.handleHighlight(o,this.highlightCellCanCapture.bind(this),t)}catch(c){this.handleDragPieceInvalidMove()}},n.handleDragEnd=function(){if(!this.isDragEnd&&this.isSetDrag){this.isDragEnd=!0,this.isSetDrag=!1,this.setDepth(Na.A.PIECE),this.scene.main.board.handleRemoveSuggestMove(),this.resetCellItems();try{this.canMove(),this.scene.audio.playSound(ja.A.PIECE_DROP),this.handleBoardMoveCompleted(),this.wrapPiece.disableInteractive()}catch(t){this.handleInvalidMove()}e.prototype.handleDragEnd.call(this)}},n.cancelDrag=function(){!this.isDragEnd&&this.isSetDrag&&(this.isDragEnd=!0,this.isSetDrag=!1,this.setDepth(Na.A.PIECE),this.scene.main.board.handleRemoveSuggestMove(),this.scene.main.board.removeAllCanCaptureCells(),this.resetCellItems(),this.scene.main.board.handleRemoveHighlight(),this.handleInvalidMove())},n.handleBoardMoveCompleted=function(){var e=this,t=this.getPositionTopLeftInBoard();if(t){if(!this.scene.tutorialManager.isRunning()){var n=this.calcScore();this.scene.handleUpdateScore(n||0),this.scene.handleAddScoreAnim(n||0)}var i=t.x,a=t.y,s=this.scene.main.board.dataBoard[a][i].cell.getWorldPosition(),r=s.x,o=s.y,c=this.getWorldPosition(),l=c.x,h=c.y,u=this.x+r-l,d=this.y+o-h,p=this.getContainerSizeOrigin(),f=u+p.width/2,m=d+p.height/2,g=this.getCellsHighlight(),v=this.cellItems[0].cell.gemFrame,y=this.scene.tweens.addCounter({from:.85*this.cellScale,to:this.cellScale,duration:100,onUpdate:function(t){e.cellItems.forEach((function(e){e.cell.setScale(t.getValue())}))},ease:Phaser.Math.Easing.Sine.InOut,onComplete:function(){e.scene.main.board.handleMove(v,g,e.onBoardHandleMoveCompleted.bind(e))},paused:!0});this.scene.add.tween({targets:this,x:f,y:m,duration:100,ease:"Sine.easeInOut",onComplete:function(){e.scene.main.board.handleRemoveHighlight(),e.parent.removeActivePiece(e.index),y.play()}})}else this.scene.main.board.handleRemoveHighlight()},n.onBoardHandleMoveCompleted=function(){this.hide(),this.scene.tutorialManager.isRunning()||(this.parent.setActivePieces(),this.parent.existPiecesActive()||this.parent.showNewPieces())},n.drawSuggestCells=function(){var e=this.scene.main.board.dataBoard,t=Ac(e,{data:this.data});t&&this.scene.main.board.handleSuggestMove(t)},n.handleInvalidMove=function(){var e=this;this.scene.audio.playSound(ja.A.PIECE_INVALID_MOVE),this.scene.main.board.handleRemoveHighlight(),this.scene.tutorialManager.isRunning()&&this.scene.tutorialManager.invalidMove(),this.animMoveDownAndScaleDown=this.scene.tweens.add({x:this.backupPx,y:this.backupPy,scaleX:1,scaleY:1,duration:100,targets:this,ease:Phaser.Math.Easing.Sine.InOut,delay:20,onComplete:function(){e.updateCellsWithPadding(.5)}})},n.canMove=function(){var e=this.scene.main.board.dataBoard,t=this.getCellsHighlight();if(0===t.length)throw new _o;for(var n=!0,i=0;i<t.length;i++){var a=t[i],s=a.x,r=a.y;if(!e[r]||!e[r][s]||0!==e[r][s].value){n=!1;break}}if(!n||0===t.length)throw new _o;return n},n.getCellsHighlight=function(){var e=this.scene.main.board.dataBoard,t=[],n=this.getPositionTopLeftInBoard();if(null===n)return t;if(this.scene.tutorialManager.isRunning()&&!this.scene.tutorialManager.validTargetPosition(n))return t;for(var i=0;i<this.data.length;i++)for(var a=0;a<this.data[i].length;a++)if(this.data[i][a].texture){var s=a+n.x,r=i+n.y,o=e[r]&&e[r][s]?e[r][s].x:0,c=e[r]&&e[r][s]?e[r][s].y:0;if(r>=Vc||s>=jc||!e[r][s]||1===e[r][s].value)return[];t.push({x:s,y:r,pX:o,pY:c})}return t},n.getPositionTopLeftInBoard=function(){for(var e=this.scene.main,t=this.getContainerSize(),n=t.width,i=t.height,a=this.getWorldPosition(),s=a.x,r=a.y,o=e.board.dataBoard,c=s+this.parent.cellSize*this.scale-n/2,l=r+this.parent.cellSize*this.scale-i/2,h=e.board.cellPadding,u=-1,d=-1,p=0;p<Vc;p++)for(var f=0;f<jc;f++){var m=o[p][f].cell.getWorldPosition(),g=m.x,v=m.y;if(g-h/2<=c&&g+o[p][f].width+h/2>=c&&v-h/2<=l&&v+o[p][f].height+h/2>=l){u=f,d=p;break}}return u<0||u>jc-1||d<0||d>Vc-1?null:{x:u,y:d}},n.createCells=function(e){for(var t=this.parent.cellSize,n=Oc[Math.floor(Math.random()*Oc.length)],i=this.data.length,a=this.data[0].length,s=0;s<this.data.length;s++){this.cells[s]=[];for(var r=0;r<this.data[s].length;r++)if(this.data[s][r].texture){var o={x:(r-(a-1)/2)*(t+e),y:(s-(i-1)/2)*(t+e),width:t-2*e,height:t-2*e,gemFrame:n},c=new ic(this.scene,o);c.setFrame(n),c.setVisible(!0),this.cells[s][r]=c,this.cellItems.push({x:r,y:s,cell:c}),this.cellScale=c.scale,this.add(c)}}this.isCreateCell=!0},t}(Fc),Yc=function(e){function t(n,i,s){return e.call(this,n,i,(0,a.A)({},s,{matrixData:t.getMatrixData(s.type,s.direction,s.isReverse)}))||this}return(0,_.A)(t,e),t.getMatrixData=function(e,t,n){void 0===n&&(n=!1);var i=[];switch(t){case es:n?i=ir:(i=nr,e===Ps&&(i=ar),e===Cs&&(i=sr));break;case ts:n?i=Xs:(i=Zs,e===Ps&&(i=Js),e===Cs&&(i=qs));break;case ns:if(n){i=Hs;break}i=Ys,e===Ps&&(i=Ks),e===Cs&&(i=Ws);break;case is:n?i=$s:(i=Qs,e===Ps&&(i=er),e===Cs&&(i=tr))}return i},t.getData=function(e,n,i){return void 0===i&&(i=!1),t.buildData(t.getMatrixData(e,n,i))},t}(zc),Hc=Yc,Kc=function(e){function t(n,i,s){return e.call(this,n,i,(0,a.A)({},s,{matrixData:t.getMatrixData(s.type,s.direction)}))||this}return(0,_.A)(t,e),t.getMatrixData=function(e,t){var n=[];switch(e){case ks:n=t===Qa?dr:pr;break;case xs:n=t===Qa?hr:ur;break;case ws:n=t===Qa?rr:or;break;case Is:n=t===Qa?cr:lr}return n},t.getData=function(e,n){return t.buildData(t.getMatrixData(e,n))},t}(zc),Wc=Kc,Zc=function(e){function t(n,i,s){return e.call(this,n,i,(0,a.A)({},s,{matrixData:t.getMatrixData(s.type)}))||this}return(0,_.A)(t,e),t.getMatrixData=function(e){var t=[];switch(e){case Os:t=fr;break;case _s:t=mr;break;case Rs:t=gr}return t},t.getData=function(e){return t.buildData(t.getMatrixData(e))},t}(zc),Xc=Zc,Jc=function(e){function t(n,i,s){return e.call(this,n,i,(0,a.A)({},s,{matrixData:t.getMatrixData(s.direction)}))||this}return(0,_.A)(t,e),t.getMatrixData=function(e){var t=[];switch(e){case"left":default:t=Tr;break;case"right":t=Sr;break;case"top":t=br;break;case"bottom":t=Pr}return t},t.getData=function(e){return t.buildData(t.getMatrixData(e))},t}(zc),qc=Jc,Qc=function(e){function t(n,i,s){return e.call(this,n,i,(0,a.A)({},s,{matrixData:t.getMatrixData(s.type,s.direction)}))||this}return(0,_.A)(t,e),t.getDataByDirectionCross2=function(e){var t=[];switch(e){case"left":default:t=Or;break;case"right":t=_r}return t},t.getDataByDirectionCross3=function(e){var t=[];switch(e){case"left":default:t=Rr;break;case"right":t=Dr}return t},t.getDataByDirectionCross4=function(e){var t=[];switch(e){case"left":default:t=Mr;break;case"right":t=Br}return t},t.getDataByDirectionCross5=function(e){var t=[];switch(e){case"left":default:t=Lr;break;case"right":t=Nr}return t},t.getMatrixData=function(e,n){var i=[];switch(e){case Ns:i=t.getDataByDirectionCross2(n);break;case Gs:i=t.getDataByDirectionCross3(n);break;case Fs:i=t.getDataByDirectionCross4(n);break;case Us:i=t.getDataByDirectionCross5(n)}return i},t.getData=function(e,n){return t.buildData(t.getMatrixData(e,n))},t}(zc),$c=Qc,el=function(e){function t(n,i,s){return e.call(this,n,i,(0,a.A)({},s,{matrixData:t.getMatrixData(s.direction)}))||this}return(0,_.A)(t,e),t.getMatrixData=function(e){var t=[];switch(e){case"vertical_left":default:t=vr;break;case"vertical_right":t=yr;break;case"horizontal_right":t=Er;break;case"horizontal_left":t=Ar}return t},t.getData=function(e){return t.buildData(t.getMatrixData(e))},t}(zc),tl=el,nl=function(e){function t(n,i,s){return e.call(this,n,i,(0,a.A)({},s,{matrixData:t.getMatrixData()}))||this}return(0,_.A)(t,e),t.getMatrixData=function(){return kr},t.getData=function(){return t.buildData(t.getMatrixData())},t}(zc),il=nl,al=function(e){function t(n,i,s){return e.call(this,n,i,(0,a.A)({},s,{matrixData:t.getMatrixData(s.direction)}))||this}return(0,_.A)(t,e),t.getMatrixData=function(e){var t=[];switch(e){case"left":default:t=Cr;break;case"right":t=wr;break;case"top":t=Ir;break;case"bottom":t=xr}return t},t.getData=function(e){return t.buildData(t.getMatrixData(e))},t}(zc),sl=al,rl=function(e){function t(n,i,s){return e.call(this,n,i,(0,a.A)({},s,{matrixData:t.getMatrixData(s.direction)}))||this}return(0,_.A)(t,e),t.getMatrixData=function(e){var t=[];switch(e){case"left":default:t=Gr;break;case"right":t=Fr;break;case"top":t=Ur;break;case"bottom":t=jr}return t},t.getData=function(e){return t.buildData(t.getMatrixData(e))},t}(zc),ol=rl,cl=Fa.A.DEFAULT,ll=cl.KEY,hl=cl.FRAME,ul=function(){function e(e){this.scene=void 0,this.x=void 0,this.y=void 0,this.background=void 0,this.text=void 0,this.tweenStep1=void 0,this.tweenStep2=void 0,this.tweenStep3=void 0,this.tweenStep4=void 0,this.tweenStep5=void 0,this.tweenStep6=void 0,this.tweenTextStep1=void 0,this.tweenTextStep2=void 0,this.tweenTextStep5=void 0,this.tweenTextStep6=void 0,this.scene=e,this.init()}var t=e.prototype;return t.init=function(){this.createBackground(),this.createText(),this.createTween()},t.createBackground=function(){this.background=this.scene.make.image({key:ll,frame:hl.BLANK}),this.background.setWorldSize(106,38),this.background.setVisible(!1)},t.createText=function(){this.text=this.scene.make.bitmapText({font:za.A.FONT_TEXT_WHITE.KEY,size:this.scene.fontSize(50),origin:{x:.5,y:.5},text:"3X STREAK!"}),this.text.setVisible(!1)},t.createTween=function(){var e=this,t=this.background.scale+.3;this.tweenStep1=this.scene.tweens.add({targets:[this.background],duration:100,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{start:0,from:0,to:t}},paused:!0,onComplete:function(){e.tweenStep2.play()}}),this.tweenTextStep1=this.scene.tweens.add({targets:[this.text],duration:200,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{start:.3,from:.3,to:1.4}},paused:!0,onComplete:function(){e.tweenTextStep2.play()}}),this.tweenStep2=this.scene.tweens.add({targets:[this.background],duration:200,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{from:t,to:t-.3}},paused:!0,onComplete:function(){e.tweenStep3.play()}}),this.tweenTextStep2=this.scene.tweens.add({targets:[this.text],duration:100,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{from:1.4,to:1}},paused:!0,onComplete:function(){e.tweenTextStep5.play()}}),this.tweenStep3=this.scene.tweens.addCounter({from:0,to:20,paused:!0,duration:533,ease:Phaser.Math.Easing.Sine.InOut,onUpdate:function(t){var n=t.getValue();e.text.setPosition(e.x,e.y-n),e.background.setPosition(e.x,e.y-n)},onComplete:function(){e.y=e.y-20,e.tweenStep4.play()}}),this.tweenStep4=this.scene.tweens.addCounter({from:0,to:5,paused:!0,duration:333,ease:Phaser.Math.Easing.Sine.InOut,onUpdate:function(t){var n=t.getValue();e.text.setPosition(e.x,e.y+n),e.background.setPosition(e.x,e.y+n)},onComplete:function(){e.y=e.y+5,e.tweenStep5.play(),e.tweenTextStep5.play()}}),this.tweenStep5=this.scene.tweens.add({targets:[this.background],delay:567,duration:67,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{from:t-.3,to:t}},paused:!0,onComplete:function(){e.tweenStep6.play()}}),this.tweenTextStep5=this.scene.tweens.add({targets:[this.text],delay:467,duration:133,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{from:1,to:.8}},paused:!0,onComplete:function(){e.tweenTextStep6.play()}}),this.tweenStep6=this.scene.tweens.add({targets:[this.background],duration:200,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{from:t,to:0}},paused:!0,onComplete:function(){e.text.setVisible(!1),e.background.setVisible(!1),e.text.setScale(0),e.background.setScale(0)}}),this.tweenTextStep6=this.scene.tweens.add({targets:[this.text],duration:167,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{from:.8,to:1.7},alpha:{from:1,to:0}},paused:!0,onComplete:function(){e.text.setVisible(!1),e.text.setScale(0)}})},t.playAnim=function(e,t){(this.tweenTextStep1.isPlaying()||this.tweenTextStep2.isPlaying()||this.tweenTextStep5.isPlaying()||this.tweenTextStep6.isPlaying())&&(this.tweenTextStep1.stop(),this.tweenTextStep2.stop(),this.tweenTextStep5.stop(),this.tweenTextStep6.stop(),this.text.setScale(0),this.text.setVisible(!1),this.background.setScale(0),this.background.setVisible(!1)),this.x=e,this.y=t,this.text.setScale(0).setAlpha(1),this.background.setScale(0),this.text.setPosition(e,t),this.background.setPosition(e,t),this.text.setVisible(!0),this.tweenTextStep1.play()},t.setTextCombo=function(e){this.text.setText(e+"X COMBO!")},t.setTextStreak=function(e){this.text.setText(e+"X STREAK!")},t.setBgFrame=function(e){this.background.setFrame(e)},e}(),dl=function(){function e(e){this.scene=void 0,this.streakBreak=void 0,this.scene=e,this.init()}return e.prototype.init=function(){this.streakBreak=new ul(this.scene)},e}(),pl=n(494),fl=function(){function e(){}return e.create=function(e,t,n){var i;switch(n.type){case bs:case Ps:case Cs:i=new Hc(e,t,n);break;case ws:case Is:case xs:case ks:i=new Wc(e,t,n);break;case Os:case _s:case Rs:i=new Xc(e,t,n);break;case Ms:i=new qc(e,t,n);break;case Bs:i=new sl(e,t,n);break;case js:i=new ol(e,t,n);break;case Ls:i=new il(e,t,n);break;case Ns:case Gs:case Fs:case Us:i=new $c(e,t,n);break;case Ds:i=new tl(e,t,n);break;default:i=new Xc(e,t,n)}return i},e}(),ml=fl,gl={WIDTH:355,HEIGHT:356,CELL_PADDING:.5,CELL_SIZE:39.5},vl=Fa.A.GAMEPLAY_32,yl=vl.KEY,Al=vl.FRAME,El=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.tweenToEnableMaxFps=void 0,n.cellSize=void 0,n.canCaptureLines=void 0,n.allPieces=[],n.allPiecesGroup=[],n.piecesActive=[],n.positionPiece=void 0,t.add.existing((0,ka.A)(n)),n.scene=t,n.canCaptureLines={isCapture:!1,direction:"",minLine:5},n.init(),n}(0,_.A)(t,e);var n=t.prototype;return n.init=function(){this.setSizeAndPositionPiece(),this.initCellSize(),this.createAllPieces(),this.createAllPiecesGroup(),this.createTweenToEnableMaxFps()},n.setSizeAndPositionPiece=function(){this.setSize(338,102);var e=(this.scene.gameZone.height/2-176-27+100)/-2;console.log("pieceY",e),this.positionPiece=[{x:-this.width/3,y:e},{x:0,y:e},{x:this.width/3,y:e}]},n.initCellSize=function(){this.cellSize=40*gl.CELL_SIZE/100},n.setContentPosition=function(e,t){this.setPosition(e,t)},n.createTweenToEnableMaxFps=function(){this.tweenToEnableMaxFps=this.scene.add.tween({targets:[],duration:300,loop:-1,paused:!0})},n.playTweenToEnableMaxFps=function(){this.tweenToEnableMaxFps.play()},n.stopTweenToEnableMaxFps=function(){this.tweenToEnableMaxFps.stop()},n.getDirectionsByType=function(e){if([Os,_s,Rs].some((function(t){return t===e})))return[];var t=[];switch(e){case bs:case Ps:case Cs:t=[ns,es,ts,is];break;case ws:case Is:case xs:case ks:t=[Qa,$a];break;case Ms:t=[ns,es,ts,is];break;case Ds:t=[as,ss,rs,os];break;case Bs:case js:t=[ns,es,ts,is];break;case Ls:t=[];break;case Ns:case Gs:case Fs:case Us:t=[es,ts]}return t},n.createAllPieces=function(){for(var e=this.cellSize,t=[],n=0;n<Vs.length;n++){var i=this.getDirectionsByType(Vs[n]);if(i.length<=0)t.push({type:Vs[n]});else{for(var s=0;s<i.length;s++)t.push({type:Vs[n],direction:i[s]});if(bs===Vs[n])for(var r=0;r<i.length;r++)t.push({type:Vs[n],direction:i[r],isReverse:!0})}}for(var o=0;o<t.length;o++){var c=(0,a.A)({},t[o],{texture:yl,frame:Al.GEM,x:Math.floor(this.x),y:Math.floor(this.y),width:Math.floor(e/2),height:Math.floor(e/2),cellLength:Math.floor(e/2),parentHeight:this.height,wrap:{x:Math.floor(this.x),y:Math.floor(this.y),width:Math.floor(e/2),height:Math.floor(e/2)}}),l=ml.create(this.scene,this,c);l.hide(),this.allPieces.push(l)}this.add(this.allPieces)},n.createAllPiecesGroup=function(){for(var e=0;e<this.allPieces.length;e++){var t=this.allPieces[e];this.allPiecesGroup[t.type]||(this.allPiecesGroup[t.type]=[]),this.allPiecesGroup[t.type].push(e)}},n.randomPieces=function(){var e=this;this.scene.game.updateFps(Ro.max);for(var t=this.buildPieceRates(!1),n=[],i=function(){var i=Math.floor(Math.random()*t.length),a=t[i];if(!e.allPiecesGroup[a])return 1;var s=Math.floor(Math.random()*e.allPiecesGroup[a].length),r=e.allPiecesGroup[a][s],o=[xs,ks].some((function(e){return e===a}));if(e.canCaptureLines.isCapture&&o){for(var c=0;c<e.allPiecesGroup[a].length;c++){var l=e.allPiecesGroup[a][c];if(e.allPieces[l]&&e.allPieces[l].direction===e.canCaptureLines.direction){r=l;break}}t=e.buildPieceRates(!1)}!n.some((function(e){return e.index===r}))&&n.push({index:r,type:a})};n.length<3;)i();for(var a=[],s=0;s<n.length;s++){var r=n[s].index,o=this.allPieces[r];a.push({position:r,texture:yl,frame:Al.GEM,type:o.type,direction:o.direction,isReverse:o.isReverse})}this.piecesActive=a},n.buildPieceRates=function(e){void 0===e&&(e=!0);for(var t=[],n=0;n<zs.length;n++)t.push((0,a.A)({},zs[n]));if(e){var i=this.scene.main.board.dataBoard,s=5;if(this.canCaptureLines=this.scene.main.board.canCaptureLines(i,s),this.canCaptureLines.isCapture)for(var r=0;r<t.length;r++)t[r].type===ks&&(t[r].rate=8);else if(s=4,this.canCaptureLines=this.scene.main.board.canCaptureLines(i,s),this.canCaptureLines.isCapture)for(var o=0;o<t.length;o++)t[o].type===xs&&(t[o].rate=8)}for(var c=[],l=0;l<t.length;l++)for(var h=t[l],u=h.type,d=h.rate,p=0;p<d;p++)c.push(u);return c},n.drawPieces=function(){for(var e=0;e<this.piecesActive.length;e++){var t=this.allPieces[this.piecesActive[e].position],n=t.data,i=this.positionPiece[e].x;console.log("data[0] === ",n[0]),t.updatePosition(i,0),t.updatePositionWrapPiece(),t.setIndex(e),t.drawPiece(),this.allPieces[this.piecesActive[e].position]=t,this.scene.tutorialManager.isRunning()&&0==this.scene.tutorialManager.currentLevel&&t.setDepth(Na.A.PIECE)}},n.removeActivePiece=function(e){this.scene.tutorialManager.isRunning()||e>3||(this.piecesActive[e].used=!0)},n.existPiecesActive=function(){var e,t=f()(e=this.piecesActive).call(e,(function(e){return!e.used}));return t&&t.length>0},n.showNewPieces=function(){for(var e=0;e<this.allPieces.length;e++)this.allPieces[e].reset();this.randomPieces(),this.setActivePieces(),this.drawPieces()},n.calculatePieceInfo=function(){for(var e=0,t=0,n=this.cellSize,i=0;i<this.piecesActive.length;i++){var a=this.allPieces[this.piecesActive[i].position].data;e+=a[0].length,a.length>t&&(t=a.length)}return{cellLength:n/2,cols:e}},n.setActivePieces=function(){for(var e=this.scene.main.board.dataBoard,t=0;t<this.piecesActive.length;t++){var n=this.piecesActive[t].position,i=yc(e,this.allPieces[n]);this.allPieces[n].setCanMove(i)}},n.getPiecesByFen=function(e){var t=[],n=e.split(" ");if(n.length<2)throw new Error("Invalid fen");for(var i=_a()(n).call(n,2),a=0;a<i.length;a++){var s,r;if("l"!==sc()(s=i[a]).call(s)){var o=wc(sc()(r=i[a]).call(r));t.push(o)}}return t},n.getFenByPieces=function(){for(var e="l",t=0;t<this.piecesActive.length;t++){var n=this.piecesActive[t],i=n.type,a=n.direction,s=n.isReverse,r=n.frame;if(!n.used){var o=bc(i);a&&""!==a&&(o+="-"+bc(a)),s&&(o+="-r"),e+=" "+o+","+bc(r)}}return e},n.clearPieces=function(){for(var e=0;e<this.piecesActive.length;e++){var t=this.piecesActive[e].position;this.allPieces[t].hide()}this.piecesActive=[]},n.showAvailablePieces=function(e){if(e&&!(e.length<=0)){for(var t=[],n=0;n<e.length;n++)for(var i=e[n],a=i.type,s=i.direction,r=i.isReverse,o=i.frame,c=0;c<this.allPieces.length;c++){var l=this.allPieces[c];if(a===l.type&&s===l.direction&&r===l.isReverse){t.push({position:c,texture:yl,frame:o,type:l.type,direction:l.direction,isReverse:l.isReverse});break}}this.piecesActive=t,this.setActivePieces(),this.drawPieces()}},n.debuggerNextPieces=function(){for(var e=0;e<this.piecesActive.length;e++)this.removeActivePiece(e);for(var t=0;t<this.allPieces.length;t++)this.allPieces[t].wrapPiece.setVisible(!1);this.showNewPieces()},n.unregisterPiecesGlobalEvents=function(){this.allPieces.forEach((function(e){e.unregisterEvents()}))},n.registerPiecesGlobalEvents=function(){this.allPieces.forEach((function(e){e.registerEvents()}))},n.alignComponents=function(){for(var e=0;e<this.piecesActive.length;e++){this.allPieces[this.piecesActive[e].position].alignComponents()}},t}(Phaser.GameObjects.Container),Tl=Fa.A.GAMEPLAY,Sl=Tl.KEY,bl=Tl.FRAME,Pl=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.pieces=void 0,n.debugButton=void 0,n.tweenMoveUpFooter=void 0,n.tweenMoveDownFooter=void 0,n.bg=void 0,n.textExist=void 0,n.scene=t,n.init(),n.setSize(n.scene.gameZone.width,n.bg.height),t.add.existing((0,ka.A)(n)),n}(0,_.A)(t,e);var n=t.prototype;return n.init=function(){this.createBackground(),this.createPieces(),this.createTweenUpDownFooter(),this.createTweenMoveDownFooter()},n.createBackground=function(){this.bg=new pl.A(this.scene,0,0,338,102,"panel"),this.add(this.bg)},n.createPieces=function(){this.pieces=new El(this.scene),this.add(this.pieces)},n.createDebugButton=function(){GameCore.Utils.Valid.isDebugger()&&this.createDebugButtonNextPieces()},n.createDebugButtonNextPieces=function(){this.debugButton=new Va.A(this.scene,Sl,bl.BLANK,100,30),this.debugButton.setName("Debug");var e=this.scene.make.bitmapText({font:za.A.FONT_TEXT_WHITE.KEY,size:this.scene.fontSize(30),text:"Next pieces",origin:{x:.5,y:.5}});this.debugButton.add([e]),this.debugButton.onClick=this.clickButtonNextPieces.bind(this),this.add(this.debugButton),Phaser.Display.Align.In.BottomLeft(this.debugButton,this),this.textExist=this.scene.make.bitmapText({font:za.A.FONT_TEXT_WHITE.KEY,size:this.scene.fontSize(30),text:"Exist",origin:{x:.5,y:.5}}),this.debugButton.add([this.textExist]),Phaser.Display.Align.In.Center(this.textExist,this,80,0)},n.clickButtonNextPieces=function(){this.scene.footer.pieces.debuggerNextPieces()},n.createTweenUpDownFooter=function(){var e=this;this.tweenMoveUpFooter=this.scene.add.tween({targets:[this.bg],duration:133,ease:Phaser.Math.Easing.Sine.InOut,y:{from:this.bg.y,to:this.bg.y-5},paused:!0,onComplete:function(){e.tweenMoveDownFooter.play()}})},n.createTweenMoveDownFooter=function(){var e=this,t=this.bg.getWorldPosition().y;this.tweenMoveDownFooter=this.scene.add.tween({targets:[this.bg],duration:166,ease:Phaser.Math.Easing.Sine.InOut,y:{from:t,to:t+300},paused:!0,onComplete:function(){e.bg.y=t}})},n.playTweenMoveDownFooter=function(){this.pieces.allPieces.forEach((function(e){e.playTweenMoveDownPiece()})),this.tweenMoveUpFooter.play()},n.registerPiecesGlobalEvents=function(){this.pieces.registerPiecesGlobalEvents()},n.unregisterPiecesGlobalEvents=function(){this.pieces.unregisterPiecesGlobalEvents()},n.alignComponents=function(){this.pieces.alignComponents()},t}(Phaser.GameObjects.Container),Cl=Pl,wl=n(225),Il=function(e){function t(t,n){var i;(i=e.call(this,t)||this).payload=void 0,i.loading=void 0,i.photo=void 0,i.avtFrame=void 0,i.background=void 0,i.loadPhotoTimer=void 0,i.handleLoadPhotoAfterDelay=function(e,t){return function(){var n=i.scene.textures.get(e);n&&n.key===e?i.handleLoadComplete(e):(i.scene.load.once("filecomplete-image-"+e,i.handleLoadComplete),i.scene.load.image(e,t),i.scene.load.start())}},i.handleLoadComplete=function(e){if(i.scene){var t=i.payload,n=t.id,a=t.radius,s=void 0===a?0:a;if(n&&n===e){var r=n+"_bordered_"+s,o=s>0?r:n,c=i.scene.textures.get(o);if(c&&c.key===o)i.setPhoto(c.key);else if(0!=s&&s<100){if(!GameCore.Utils.Image.drawBorder({scene:i.scene,key:n,newKey:r,radius:s}))return void i.showLoading(!1);i.setPhoto(r)}else if(100==s){if(!GameCore.Utils.Image.drawCircle({scene:i.scene,key:n,newKey:r}))return void i.showLoading(!1);i.setPhoto(r)}else i.setPhoto(n)}}},i.handleLoadPhotoFailed=function(e){e.key===i.payload.id&&i.setDefaultAvatar(e.key)},i.scene.add.existing((0,ka.A)(i)),i.payload=n,i.setSize(n.width,n.height),i.createBackground(),i.createLoading(),i.createPhoto(),i.createFrame();var a=i.payload,s=a.id,r=a.url,o=a.radius;return s&&r&&i.loadPhoto(s,r,o),i.addDefaultListeners(),i}(0,_.A)(t,e);var n=t.prototype;return n.setFrame=function(e){this.avtFrame.setFrame(e),this.avtFrame.setVisible(!0)},n.setBackground=function(e){this.background.setFrame(e)},n.loadPhoto=function(e,t,n){var i;if(void 0===n&&(n=0),this.payload.id=e,this.payload.url=t,this.payload.radius=n,null==(i=this.loadPhotoTimer)||i.remove(),e&&t){var a=this.scene.textures.get(e);if(a&&a.key===e)this.handleLoadComplete(e);else{this.showLoading(!0);var s=this.payload.loadDelay||0;this.loadPhotoTimer=this.scene.time.delayedCall(s,this.handleLoadPhotoAfterDelay(e,t))}}else this.setPhoto(Ga.A.AVATAR.KEY)},n.addDefaultListeners=function(){var e=this;this.scene.load.on(Phaser.Loader.Events.FILE_LOAD_ERROR,this.handleLoadPhotoFailed),this.on(Phaser.GameObjects.Events.DESTROY,(function(){var t;null==(t=e.loadPhotoTimer)||t.remove(),e.scene.load.off(Phaser.Loader.Events.FILE_LOAD_ERROR,e.handleLoadPhotoFailed)}))},n.setDefaultAvatar=function(e){this.loadPhoto(e,Ga.A.AVATAR.FILE,this.payload.radius)},n.createBackground=function(){var e=this.payload,t=e.key,n=e.background,i=e.borderWidth,a=void 0===i?0:i;this.background=this.scene.make.image({key:t,frame:n}),this.background.setWorldSize(this.width-a,this.height-a),this.add(this.background)},n.createLoading=function(){this.loading=new wl.A(this.scene),this.loading.setWorldSize(.75*this.width,.75*this.height),this.loading.setVisible(!1),this.add(this.loading)},n.createPhoto=function(){this.photo=this.scene.make.image({x:0,y:0,origin:{x:.5,y:.5},visible:!1}),this.add(this.photo)},n.createFrame=function(){var e=this.payload,t=e.key,n=e.frame,i=e.width,a=e.height;n?(this.avtFrame=this.scene.make.image({key:t,frame:n}),this.avtFrame.setWorldSize(i,a)):this.avtFrame=this.scene.make.image({x:0,y:0,origin:{x:.5,y:.5},visible:!1}),this.add(this.avtFrame)},n.showLoading=function(e){this.photo.setVisible(!e),this.loading.setVisible(e)},n.setPhoto=function(e){this.showLoading(!1),this.photo.setTexture(e),this.photo.setFrame(0);var t=this.payload,n=t.width,i=t.height,a=Math.min(n,i)-(this.payload.borderWidth||8);this.photo.setWorldSize(a,a),Phaser.Display.Align.In.Center(this.photo,this.background)},t}(Phaser.GameObjects.Container),xl=Il,kl=Fa.A.GAMEPLAY,Ol=kl.KEY,_l=kl.FRAME,Rl=function(e){function t(t){var n;return(n=e.call(this,t)||this).background=void 0,n.iconCrown=void 0,n.avatarMe=void 0,n.bestScoreText=void 0,n.createBackground(),n.createScoreText(),n.createIconCrown(),n.createAvatar(),n.scene.add.existing((0,ka.A)(n)),n}(0,_.A)(t,e);var n=t.prototype;return n.createBackground=function(){this.background=this.scene.make.image({key:Ol,frame:_l.PANEL_BEST_SCORE}),this.background.setWorldSize(112,36),this.add(this.background),Phaser.Display.Align.In.Center(this.background,this)},n.createScoreText=function(){this.bestScoreText=this.scene.make.bitmapText({font:za.A.FONT_NUMBER.KEY,size:this.scene.fontSize(40),origin:{x:1,y:.5},text:"0"}),this.add(this.bestScoreText),Phaser.Display.Align.In.RightCenter(this.bestScoreText,this.background,-10,-1)},n.createIconCrown=function(){this.iconCrown=this.scene.make.image({key:Ol,frame:_l.ICON_CROWN}),this.iconCrown.setWorldSize(36,30),this.iconCrown.setVisible(!1),this.iconCrown.setRotation(-.2),this.add(this.iconCrown),Phaser.Display.Align.In.LeftCenter(this.iconCrown,this.background,5,-1)},n.createAvatar=function(){this.avatarMe=new xl(this.scene,{key:Ol,frame:_l.AVATAR_FRAME,background:_l.AVATAR_BACKGROUND,width:25,height:25,borderWidth:1}),this.avatarMe.setVisible(!1),this.add(this.avatarMe),Phaser.Display.Align.In.LeftCenter(this.avatarMe,this.background,-7,-1)},n.showAvatar=function(){this.avatarMe.setVisible(!0),this.iconCrown.setVisible(!1)},n.updateInfo=function(){var e=this.scene.storage.getState(),t=(0,fo.ix)(e),n=(0,po.sp)(e),i=n.playerId,a=n.photo,s=(t[i]||{}).score,r=void 0===s?0:s;console.log("updateInfo",i,a,r),this.bestScoreText.setText(String(r)),this.avatarMe.loadPhoto(i,a,5)},n.showIconCrown=function(){this.avatarMe.setVisible(!1),this.iconCrown.setVisible(!0)},n.setScoreText=function(e){var t=this.scene.storage.getState();"challenge-friends"!==(0,uo.qs)(t)&&this.bestScoreText.setText(String(e))},n.updateBestScoreText=function(e){var t=this.scene.storage.getState();e>(0,fo.TW)(t).bestScore&&this.setScoreText(e)},t}(Phaser.GameObjects.Container),Dl=Rl,Ml=Fa.A.GAMEPLAY,Bl=Ml.KEY,Ll=Ml.FRAME,Nl=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.scoreText=void 0,n.background=void 0,n.tweenShow=void 0,n.tweenHide=void 0,n.addScore=void 0,n.score=void 0,n.currentScore=0,n.scene=t,n.scene.add.existing((0,ka.A)(n)),n.createBackground(),n.createScoreText(),n}(0,_.A)(t,e);var n=t.prototype;return n.createBackground=function(){this.background=this.scene.make.image({key:Bl,frame:Ll.PANEL_YOUR_SCORE}),this.background.setWorldSize(112,36),this.add(this.background),Phaser.Display.Align.In.Center(this.background,this,0,0)},n.createScoreText=function(){this.scoreText=this.scene.make.bitmapText({font:za.A.FONT_NUMBER.KEY,size:this.scene.fontSize(40),text:"0",origin:{x:1,y:.5}}),this.add(this.scoreText),Phaser.Display.Align.In.RightCenter(this.scoreText,this.background,-10,-1)},n.setScore=function(e){this.score=e},n.setScoreText=function(e){this.scoreText.setText(String(e))},n.animAddScore=function(e){var t=this,n=this.score+e;this.currentScore=n,this.setScore(n),this.addScore&&this.addScore.isPlaying()&&(this.addScore.remove(),this.setScoreText(n)),this.addScore=this.scene.tweens.addCounter({from:this.score-e,to:this.score,duration:100,ease:Phaser.Math.Easing.Sine.Out,onUpdate:function(e){var n=Math.floor(e.getValue());t.setScoreText(n),t.scene.header.bestScoreBlock.updateBestScoreText(n)},onComplete:function(){t.setScoreText(t.score),t.scene.header.bestScoreBlock.updateBestScoreText(t.score),t.scene.tutorialManager.isRunning()?t.scene.tutorialManager.nextTutorial():(t.scene.handleNextTargetScore(),t.scene.bestScoreReached())}})},t}(Phaser.GameObjects.Container),Gl=Nl,Fl=Fa.A.DEFAULT,Ul=Fl.KEY,jl=Fl.FRAME,Vl=function(e){function t(t){var n;return(n=e.call(this,t,Ul,jl.BUTTON_RED_RECTANGLE,62,61)||this).setName("Pause"),n.createIcon(),n}return(0,_.A)(t,e),t.prototype.createIcon=function(){var e=this.scene.make.image({key:Ul,frame:jl.ICON_PAUSE});this.add(e),e.setWorldSize(20,23),Phaser.Display.Align.In.Center(e,this,0,0)},t}(Va.A),zl=Vl,Yl=Fa.A.GAMEPLAY,Hl=(Yl.KEY,Yl.FRAME,function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.panelTop=void 0,n.tweenMoveUpHeader=void 0,n.tweenMoveDownHeader=void 0,n.buttonPause=void 0,n.bestScoreBlock=void 0,n.mainScoreBlock=void 0,n.scene=t,t.add.existing((0,ka.A)(n)),n.createPanelTop(),n.setSize(n.scene.gameZone.width,n.panelTop.height),n.createPauseButton(),n.createBestScoreBlock(),n.createMainScoreBlock(),n}(0,_.A)(t,e);var n=t.prototype;return n.createPanelTop=function(){this.panelTop=new pl.A(this.scene,0,0,338,68,"panel"),this.add(this.panelTop)},n.createBestScoreBlock=function(){this.bestScoreBlock=new Dl(this.scene),this.add(this.bestScoreBlock),Phaser.Display.Align.In.Center(this.bestScoreBlock,this.panelTop,-100,.5)},n.createMainScoreBlock=function(){this.mainScoreBlock=new Gl(this.scene),this.add(this.mainScoreBlock),Phaser.Display.Align.In.Center(this.mainScoreBlock,this.panelTop,18,.5)},n.createPauseButton=function(){this.buttonPause=new zl(this.scene),this.add(this.buttonPause),Phaser.Display.Align.In.Center(this.buttonPause,this.panelTop,120,-1)},n.createTweenMoveDownHeader=function(){var e,t=this;null==(e=this.tweenMoveDownHeader)||e.remove(),this.tweenMoveDownHeader=this.scene.add.tween({targets:[this],duration:133,ease:Phaser.Math.Easing.Sine.InOut,y:{from:this.y,to:this.y+5},paused:!0,onComplete:function(){t.tweenMoveUpHeader.play()}})},n.createTweenMoveUpHeader=function(){var e,t=this;null==(e=this.tweenMoveUpHeader)||e.remove();var n=this.y;this.tweenMoveUpHeader=this.scene.add.tween({targets:[this],duration:166,ease:Phaser.Math.Easing.Sine.InOut,y:{from:this.y,to:this.y-300},paused:!0,onComplete:function(){t.y=n}})},n.playTweenMoveUpHeader=function(){this.createTweenMoveUpHeader(),this.createTweenMoveDownHeader(),this.tweenMoveDownHeader.play()},n.getScore=function(){return this.mainScoreBlock.score},n.showItemSingleMode=function(){this.bestScoreBlock.showIconCrown()},n.showItemPlayWithFriendsMode=function(){this.bestScoreBlock.showAvatar(),this.bestScoreBlock.updateInfo()},t}(Phaser.GameObjects.Container)),Kl=Hl,Wl=n(135),Zl=function(){var e=GameCore.Utils.Device,t=window.navigator.vibrate;return e.isAndroid()&&"function"===typeof t||e.isMobileWeb()&&"function"===typeof t||e.isIOS()},Xl=function(){var e=(0,O.A)(D().mark((function e(t){var n,i,a,s,r;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Math.round(t/80),i=0,a=function(){var e=(0,O.A)(D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,FBInstant.performHapticFeedbackAsync();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log("can not haptic");case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}();case 3:if(!(i<n)){e.next=11;break}return s=a(),r=(0,Wl.QN)(80),i+=1,e.next=9,N().all([s,r]);case 9:e.next=3;break;case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Jl=function(e){window.navigator.vibrate(0),window.navigator.vibrate(e)},ql=function(e){try{if(!Zl())return!1;var t=GameCore.Utils.Device;t.isAndroid()||t.isMobileWeb()?Jl(e):t.isIOS()&&Xl(e).catch((function(e){return console.log(e)}))}catch(n){}},Ql=n(112),$l=n.n(Ql),eh=Fa.A.GAMEPLAY_32,th=eh.KEY,nh=eh.FRAME,ih=function(e){function t(t){var n;return(n=e.call(this,t)||this).bg=void 0,n.cellSize=39.5,n.cellPadding=.5,n.createBackground(),n.createGrid(),n.scene.add.existing((0,ka.A)(n)),n}(0,_.A)(t,e);var n=t.prototype;return n.createGrid=function(){for(var e=-8*(this.cellPadding+this.cellSize)/2+this.cellSize/2,t=-8*(this.cellPadding+this.cellSize)/2+this.cellSize/2,n=0;n<8;n++)for(var i=0;i<8;i++){var a=this.scene.make.image({key:th,frame:nh.CELL});a.setWorldSize(this.cellSize,this.cellSize),this.add(a),Phaser.Display.Align.In.Center(a,this.bg,e+i*(this.cellSize+this.cellPadding),t+n*(this.cellSize+this.cellPadding))}},n.createBackground=function(){this.bg=new pl.A(this.scene,0,0,338,338,"board"),this.add(this.bg),Phaser.Display.Align.In.Center(this.bg,this)},t}(Phaser.GameObjects.Container),ah=ih,sh=Fa.A.GAMEPLAY_32,rh=sh.KEY,oh=sh.FRAME,ch=GameCore.Configs.Board,lh=ch.cols,hh=ch.rows,uh=function(e){function t(t){var n;return(n=e.call(this,t)||this).boardFrame=void 0,n.dataBoard=[],n.cellSize=void 0,n.cellPadding=void 0,n.cellsHighlight=[],n.cellSharking=[],n.suggestCells=[],n.tweenScaleUpBoardFrame=void 0,n.tweenScaleDownBoardFrame=void 0,n.canCaptureLines=function(e,t){void 0===t&&(t=5);for(var n=e.length,i=e[0].length,s=[],r=[],o=[],c=0;c<n;c++){for(var l=0,h={x:-1,y:-1},u=0;u<i;u++)0===c&&(o[u]={count:0,x:-1,y:-1}),1===e[c][u].value?(o[u].count++,l++):(h.x=u,h.y=c,o[u].x=u,o[u].y=c);if(l===i-1&&r.push((0,a.A)({row:c},h)),c===n-1)for(var d=0;d<i;d++)o[d].count===n-1&&s.push((0,a.A)({col:d},o[d]))}if(r.length>=t)for(var p=0,f={x:-1,y:-1},m=0;m<r.length;m++)if(0!==m){if(r[m].x===f.x&&r[m].y===f.y+1?(f.x=r[m].x,f.y=r[m].y,p++):p=1,p>=t)return{isCapture:!0,direction:"vertical",minLine:t}}else f.x=r[m].x,f.y=r[m].y,p++;if(s.length>=t)for(var g=0,v={x:-1,y:-1},y=0;y<s.length;y++)if(0!==y){if(s[y].x===v.x+1&&s[y].y===v.y?(v.x=s[y].x,v.y=s[y].y,g++):g=1,g>=t)return{isCapture:!0,direction:"horizontal",minLine:t}}else v.x=s[y].x,v.y=s[y].y,g++;return{isCapture:!1,direction:"",minLine:t}},n.range=function(e,t){var n=t-e+1;return $l()({length:n},(function(t,n){return e+n}))},n.shuffleArray=function(e){for(var t,n=B()(t=[]).call(t,e),i=n.length-1;i>0;i--){var a=Math.floor(Math.random()*(i+1)),s=[n[a],n[i]];n[i]=s[0],n[a]=s[1]}return n},n.setSize(gl.WIDTH,gl.HEIGHT),n.createBoard(),n.calcCellLength(),n.initDataBoard(),n.createTweenScaleUpBoard(),n.createTweenScaleDownBoard(),n}(0,_.A)(t,e);var n=t.prototype;return n.calcCellLength=function(){this.cellPadding=gl.CELL_PADDING,this.cellSize=gl.CELL_SIZE},n.createBoard=function(){this.boardFrame=new ah(this.scene),this.add(this.boardFrame),Phaser.Display.Align.In.Center(this.boardFrame,this)},n.initDataBoard=function(){for(var e=gl.CELL_PADDING,t=gl.CELL_SIZE,n=this.boardFrame.x-(e+t)*lh/2+t/2,i=this.boardFrame.y-(e+t)*hh/2+t/2,a=0;a<hh;a++){this.dataBoard[a]=[];for(var s=0;s<lh;s++){var r=n+s*t+e*s,o=i+a*t+e*a,c={x:r,y:o,width:t,height:t,texture:rh,frame:oh.GEM_TRANSPARENT,depth:Na.A.PIECE-.1,padding:e,isWoodenEffect:!0},l=new tc(this.scene,c);this.add(l),this.add(l.imageGameOver),this.add(l.imageHighlight),this.add(l.imageBreak),this.add(l.imageGameStart),l.setVisible(!1),this.dataBoard[a][s]={x:r,y:o,width:t,height:t,frame:oh.GEM_TRANSPARENT,value:0,cell:l}}}},n.createTweenScaleUpBoard=function(){var e=this;this.tweenScaleUpBoardFrame=this.scene.add.tween({targets:[this.boardFrame],duration:100,ease:Phaser.Math.Easing.Sine.InOut,scale:{from:this.boardFrame.scale,to:this.boardFrame.scale+.2*this.boardFrame.scale},paused:!0,onComplete:function(){e.tweenScaleDownBoardFrame.play()}})},n.createTweenScaleDownBoard=function(){var e=this,t=this.boardFrame.scale;this.tweenScaleDownBoardFrame=this.scene.add.tween({targets:[this.boardFrame],duration:133,ease:Phaser.Math.Easing.Sine.InOut,scale:{from:this.boardFrame.scale+.2*this.boardFrame.scale,to:0},paused:!0,onComplete:function(){e.scene.time.delayedCall(500,(function(){e.boardFrame.scale=t}))}})},n.playTweenScaleDownBoard=function(){for(var e=0;e<hh;e++)for(var t=0;t<lh;t++){this.dataBoard[e][t].cell.playTweenScaleDownCell()}this.tweenScaleUpBoardFrame.play()},n.handleHighlight=function(e,t,n){this.cellsHighlight=e;for(var i=0;i<e.length;i++){var a=e[i],s=a.x,r=a.y;if(this.dataBoard[r]&&this.dataBoard[r][s]&&0===this.dataBoard[r][s].value){var o=this.dataBoard[r][s].cell;this.dataBoard[r][s].frame=n,o.setVisible(!0),o.setFrame(n),o.setAlpha(.3),o.setWorldSize(this.cellSize,this.cellSize)}}this.canCaptureCells(n,e,t)},n.canCaptureCells=function(e,t,n){for(var i=this,s=this.dataBoard,r=[],o=0;o<s.length;o++){r[o]=[];for(var c=0;c<s[o].length;c++)r[o][c]=(0,a.A)({},s[o][c])}for(var l=0;l<t.length;l++){var h=t[l],u=h.x;r[h.y][u].value=1}this.removeAnimCanCaptureCells(r);var d=pc(r);if(!d||d.length<=0)return!1;for(var p=function(){var e=d[f],n=e.x,s=e.y;t.some((function(e){return e.x===n&&e.y===s}))||i.cellSharking.push((0,a.A)({},d[f]))},f=0;f<d.length;f++)p();for(var m=0;m<this.cellSharking.length;m++){var g=this.cellSharking[m],v=g.x,y=g.y,A=this.dataBoard[y][v].cell;A.isHighlight()||A.showImageHighlight(e)}n(fc(r),mc(r),t)},n.removeAnimCanCaptureCells=function(e){if(0!==this.cellSharking.length){for(var t=fc(e),n=mc(e),i=0;i<this.cellSharking.length;i++){var a=this.cellSharking[i],s=a.x,r=a.y,o=this.dataBoard[r][s].cell;-1===g()(t).call(t,r)&&-1===g()(n).call(n,s)&&o.hideImageHighlight()}this.cellSharking=[]}},n.clearBoard=function(){for(var e=0;e<hh;e++)for(var t=0;t<lh;t++){var n=this.dataBoard[e][t];n.value=0,n.frame=oh.GEM_TRANSPARENT,n.cell.reset(),n.cell.setFrame(oh.GEM_TRANSPARENT),n.cell.setVisible(!0),n.cell.resetImageGameOver()}},n.handleResetFrameBoard=function(){console.log("this.dataBoard === ",this.dataBoard);for(var e=0;e<hh;e++)for(var t=0;t<lh;t++)if(this.dataBoard[e]&&this.dataBoard[e][t]&&1===this.dataBoard[e][t].value){var n=this.dataBoard[e][t],i=n.frame,a=n.cell;a.visible||(0,x.a0)(new Error("Cell is invisible")),a.frame.name!==i&&(0,x.a0)(new Error("Cell is frame not true")),a.setVisible(!0).setFrame(i)}},n.removeAllCanCaptureCells=function(){if(0!==this.cellSharking.length){for(var e=0;e<this.cellSharking.length;e++){var t=this.cellSharking[e],n=t.x,i=t.y;this.dataBoard[i][n].cell.hideImageHighlight()}this.cellSharking=[]}},n.handleRemoveHighlight=function(){try{if(!this.cellsHighlight)return;for(var e=0;e<this.cellsHighlight.length;e++){var t=this.cellsHighlight[e],n=t.x,i=t.y;if(this.dataBoard[i]&&this.dataBoard[i][n]&&0===this.dataBoard[i][n].value){var a=this.dataBoard[i][n].cell;this.dataBoard[i][n].frame=oh.GEM_TRANSPARENT,a.setVisible(!1),a.setFrame(oh.GEM_TRANSPARENT),a.setAlpha(1)}}this.cellsHighlight=[]}catch(s){console.log(s)}},n.isCellHighlight=function(e){var t,n=f()(t=this.cellsHighlight).call(t,(function(t){return t.x===e.x&&t.y&&e.y}));return!!(n&&n.length>0)},n.playEatSound=function(e){switch(this.scene.audio.playSound(ja.A.EAT_BLOCK,{volume:1}),e){case 1:default:break;case 2:this.scene.audio.playSound(ja.A.GOOD);break;case 3:this.scene.audio.playSound(ja.A.COOL);break;case 4:case 5:case 6:this.scene.audio.playSound(ja.A.EXCELLENT)}},n.handleTweenStartMission=function(){for(var e=this,t=100,n=0;n<hh;n++)for(var i=function(){var i=e.dataBoard[n][a].cell,s=0;s=4==n&&4==a?t:n>=3&&n<=5&&a>=3&&a<=5?200:n>=2&&n<=6&&a>=2&&a<=6?300:n>=1&&n<=7&&a>=1&&a<=7?400:500,e.scene.time.delayedCall(s,(function(){i.playTweenStartMission()}))},a=0;a<lh;a++)i()},n.checkPositionCellOnCaptureCell=function(e,t){var n=f()(t).call(t,(function(t){return t.x===e.x&&t.y===e.y}));return n&&n.length>0},n.handleSuggestMove=function(e){try{this.suggestCells=e;for(var t=0;t<e.length;t++){var n=e[t],i=n.x,a=n.y,s=this.dataBoard[a][i].cell;s.setFrame(oh.GEM_HIGHT_LIGHT),s.setVisible(!0),s.setAlpha(1)}}catch(r){console.log(r)}},n.handleRemoveSuggestMove=function(){try{for(var e=0;e<this.suggestCells.length;e++){var t=this.suggestCells[e],n=t.x,i=t.y,a=this.dataBoard[i][n].cell;this.isCellHighlight(a)||(a.setFrame(oh.GEM_TRANSPARENT),a.setVisible(!1))}this.suggestCells=[]}catch(s){console.log(s)}},n.runAnimationGameOver=function(){var e=this;try{this.scene.audio.playSound(ja.A.BOARD_GAME_OVER);for(var t=this.shuffleArray(this.range(0,63)),n=0,i=function(){var i=t[a],s=Math.floor(i/8),r=i%8;e.dataBoard[r]&&e.dataBoard[r][s]&&1===e.dataBoard[r][s].value&&(n++,e.scene.time.delayedCall(23.5*n,(function(){e.dataBoard[r][s].cell.playAnimImageGameOver()})))},a=0;a<t.length;a++)i()}catch(s){console.log(s)}},n.fadeIn=function(){for(var e=[],t=[],n=0;n<hh;n++)for(var i=0;i<lh;i++){var a=this.dataBoard[n][i];a.value&&(e.push(a.cell),t.push(a.cell.imageTargetItem))}if(e&&0!==e.length){var s=e[0].alphaImageTargetItem,r=e[0].scaleImageTargetItem,o=this.scene.add.tween({targets:e,duration:300,ease:Phaser.Math.Easing.Quadratic.InOut,alpha:{from:0,to:e[0].alpha0},scale:{from:0,to:e[0].scale0},paused:!0}),c=this.scene.add.tween({targets:t,duration:300,ease:Phaser.Math.Easing.Quadratic.InOut,alpha:{from:0,to:s},scale:{from:0,to:r},paused:!0});o.play(),c.play()}},n.getTotalCellOnBoard=function(){for(var e=0,t=0;t<hh;t++)for(var n=0;n<lh;n++){1===this.dataBoard[t][n].value&&e++}return e},t}(Phaser.GameObjects.Container),dh=uh,ph=Fa.A.GAMEPLAY_32,fh=(ph.KEY,ph.FRAME),mh=Fa.A.DEFAULT.FRAME,gh=GameCore.Configs.Board,vh=gh.cols,yh=gh.rows,Ah=GameCore.Configs.Gameplay.VibrateValue,Eh=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.scene=t,n}(0,_.A)(t,e);var n=t.prototype;return n.handleCapturePiece=function(e,t,n){var i=this;try{if(!t||t.length<=0)throw Tc(),new Error("Invalid Capture");console.log("captureCells === ",t,n);for(var a=[],s=0;s<n.length;s++){var r=n[s],o=r.x,c=r.y;a.push([o,c])}this.scene.timeDelayOutOfMove=1200;for(var l=fc(this.dataBoard),h=mc(this.dataBoard),u=dc(),d=[],p=0;p<t.length;p++)for(var f=t[p],m=f.x,g=f.y,v=0;v<a.length;v++){var y=a[v],A=y[0],E=y[1];if(m==A&&g==E){d.push([m,g]);var T=this.dataBoard[g][m].cell;T.setFrame(e),T.hideImageHighlight(),T.playTweenScaleDown(e),T.runJewelEffect(u,e),T.isGemHighlight()||T.setVisible(!1),this.scene.player.getPlayerSettings().vibrate&&ql(100),this.dataBoard[g][m].frame=fh.GEM_TRANSPARENT,this.dataBoard[g][m].value=0}}for(var S=100,b=function(){for(var t=l[P],n=9,a=-1,s=0;s<d.length;s++){var r=d[s],o=r[0],c=r[1];t==c&&(n>o&&(n=o),a<o&&(a=o))}for(var h=function(s){var r=0,o=i.dataBoard[t][s].cell;if(s<n&&(r=S*(n-s)),s>a&&(r=S*(s-a)),0==r)return 1;o.setFrame(e),o.hideImageHighlight(),i.scene.time.delayedCall(r,(function(){o.playTweenScaleDown(e),o.runJewelEffect(u,e),0!=i.dataBoard[t][s].value||o.isGemHighlight()||o.setVisible(!1),i.scene.player.getPlayerSettings().vibrate&&ql(100)})),i.dataBoard[t][s].frame=fh.GEM_TRANSPARENT,i.dataBoard[t][s].value=0},p=0;p<8;p++)h(p)},P=0;P<l.length;P++)b();for(var C=function(){for(var t=h[w],n=9,a=-1,s=0;s<d.length;s++){var r=d[s],o=r[0],c=r[1];t==o&&(n>c&&(n=c),a<c&&(a=c))}for(var l=function(s){var r=0,o=i.dataBoard[s][t].cell;if(s<n&&(r=S*(n-s)),s>a&&(r=S*(s-a)),0==r)return 1;o.setFrame(e),o.hideImageHighlight(),i.scene.time.delayedCall(r,(function(){o.playTweenScaleDown(e),o.runJewelEffect(u,e),0!=i.dataBoard[s][t].value||o.isGemHighlight()||o.setVisible(!1),i.scene.player.getPlayerSettings().vibrate&&ql(100)})),i.dataBoard[s][t].frame=fh.GEM_TRANSPARENT,i.dataBoard[s][t].value=0},p=0;p<8;p++)l(p)},w=0;w<h.length;w++)C()}catch(I){}},n.handlePraise=function(e,t){if(t&&0!==t.length){var n=10*Math.round(t.length/yh),i=dc();i>2&&(n=10*(uc-1)*Math.round(t.length/yh));for(var a=[],s=0;s<e.length;s++){var r=e[s];this.checkPositionCellOnCaptureCell(r,t)&&a.push(r)}if(0!==a.length){for(var o=a[0].pX,c=0,l=a[0].pY,h=0,u=0;u<a.length;u++){var d=a[u];d.pX<o&&(o=d.pX),d.pX>c&&(c=d.pX),d.pY<l&&(l=d.pY),d.pY>h&&(h=d.pY)}var p=this.scene.gameZone,f=o+(c-o)/2+p.width/2,m=l+(h-l)/2+p.height/2;this.scene.main.praise.handlePraise(f,m,n,i),this.handleStreakBreak(f,m),this.playEatSound(i)}}},n.handleStreakBreak=function(e,t){if(!this.scene.tutorialManager.isRunning()){var n=dc(),i=Sc()-1;if(e-75<0&&(e=75),e+75>375&&(e=300),!(i<2||n>=2)){var a=i>6?6:i,s=this.getVibrateByLevel(a);this.scene.player.getPlayerSettings().vibrate&&ql(s),this.playEatSound(a),this.scene.effectManager.streakBreak.setTextStreak(i),this.scene.effectManager.streakBreak.setBgFrame(mh.BLANK),this.scene.effectManager.streakBreak.playAnim(e,t-20)}}},n.getVibrateByLevel=function(e){return Ah[e]||0},n.handleMove=function(e,t,n){try{for(var i=0;i<t.length;i++){var a=t[i],s=a.x,r=a.y;if(this.dataBoard[r]&&this.dataBoard[r][s]){this.dataBoard[r][s].frame=e,this.dataBoard[r][s].value=1;var o=this.dataBoard[r][s].cell;o.setVisible(!0),o.setFrame(e),o.setAlpha(1)}}var c=pc(this.dataBoard);this.handleCapturePiece(e,c,t),this.checkIsGameOver()&&this.scene.setIsGameOver(!0),this.handlePraise(t,c),n&&n(),this.handleResetFrameBoard(),this.scene.updateMatchData(),this.handleGameOver()}catch(l){console.log(l)}},n.checkIsGameOver=function(){for(var e=this.scene.footer.pieces,t=[],n=e.piecesActive,i=e.allPieces,a=0;a<n.length;a++){var s=n[a],r=s.position;if(!s.used){var o=i[r];t.push({data:o.data,type:o.type,direction:o.direction,isReverse:o.isReverse,frame:o.frame})}}return!!gc(this.dataBoard,t)},n.handleGameOver=function(){var e=this;this.checkIsGameOver()?(this.scene.disableInput(),this.scene.time.addEvent({callback:function(){e.scene.time.delayedCall(e.scene.timeDelayOutOfMove,(function(){e.scene.handleRequestFinishGame()}))}})):this.scene.timeDelayOutOfMove=0},n.rescue=function(){this.handleUseBomb()},n.hasPieceL5=function(){var e=this.scene.footer.pieces.piecesActive;return f()(e).call(e,(function(e){return e.type===ks})).length>0},n.hasPieceCross5=function(){var e=this.scene.footer.pieces.piecesActive;return f()(e).call(e,(function(e){return e.type===Us})).length>0},n.handleUseBomb=function(){try{var e=this.hasPieceL5(),t=this.hasPieceCross5(),n=Math.floor(Math.random()*Xa.length),i=Xa[n];e&&(i=Ja[n]),t&&(i=qa[n]);for(var a=[],s=i.minRow;s<i.minRow+i.rows;s++)for(var r=i.minCol;r<i.minCol+i.cols;r++)this.dataBoard[s][r].frame!==fh.GEM_TRANSPARENT&&a.push({x:r,y:s});for(var o=0;o<a.length;o++){var c=a[o],l=c.x,h=c.y,u=this.dataBoard[h][l];u.cell.runJewelEffect(1,u.frame),u.frame=fh.GEM_TRANSPARENT,u.value=0,u.cell.setFrame(fh.GEM_TRANSPARENT),u.cell.setVisible(!1)}console.log("cells ==== ",a),this.scene.footer.pieces.setActivePieces(),this.scene.updateMatchData()}catch(d){console.log(d)}},n.getBoardByFen=function(e){var t=[],n=e.split(" ");if(n.length<2)throw new Error("Invalid fen");for(var i=n[0].split("/"),a=i.length,s=0;s<a;s++){t[s]=[];for(var r=Cc(i[s]),o=r.length>vh?vh:r.length,c=0;c<o;c++)t[s][c]=r[c]}return t},n.getFenByBoard=function(){for(var e="",t=0;t<yh;t++){for(var n=0,i="",a=0;a<vh;a++){if(0===this.dataBoard[t][a].value&&n++,1===this.dataBoard[t][a].value)n>0&&(i+=n>=yh?"x":""+n,n=0),i+=""+bc(this.dataBoard[t][a].frame);a===this.dataBoard[t].length-1&&n>0&&(i+=n>=yh?"x":""+n)}e+=t===this.dataBoard.length-1?""+i:i+"/"}return e},n.startGame=function(e){if(e){for(var t=0;t<e.length;t++)for(var n=0;n<e[t].length;n++){var i=e[t][n],a=i.value,s=i.frame,r=this.dataBoard[t][n];1===a&&(r.value=1,r.frame=s,r.cell.setFrame(s),r.cell.setVisible(!0),r.cell.setWorldSize(this.cellSize,this.cellSize),r.cell.setAlpha(0),r.cell.setScale(0))}this.fadeIn()}},t}(dh),Th=GameCore.Configs.Gameplay.VibrateValue,Sh=Fa.A.EFFECTS,bh=Sh.KEY,Ph=Sh.FRAME,Ch=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.listScore=[],n.score=void 0,n.startX=void 0,n.startY=void 0,n.scoreText=void 0,n.tweenShowScoreText=void 0,n.tweenHideScoreText=void 0,n.tweenShowPraiseFrame=void 0,n.tweenHidePraiseFrame=void 0,n.praiseFrame=void 0,n.praiseScoreText=void 0,n.particle=void 0,n.emitter=void 0,n.scene=t,t.add.existing((0,ka.A)(n)),n.setVisible(!1).setAlpha(0),n.init(),n}(0,_.A)(t,e);var n=t.prototype;return n.init=function(){this.createScoreText(),this.createTweenScoreText(),this.createPraiseFrame(),this.createPraiseScoreText(),this.createParticle(),this.createEmitter()},n.createParticle=function(){this.particle=this.scene.add.particles(bh),this.particle.setDepth(Na.A.ON_TOP+1)},n.createEmitter=function(){this.emitter=this.particle.createEmitter({x:0,y:0,scale:{start:.05,end:.2},speed:{min:20,max:70},lifespan:{min:500,max:1e3},quantity:20,on:!1,tint:[16441092,16422659],frame:Ph.FX_STAR,delay:350})},n.createScoreText=function(){this.scoreText=this.scene.make.bitmapText({font:za.A.FONT_NUMBER.KEY,size:this.scene.fontSize(50),text:"+0",origin:{x:.5,y:.5}}),this.scoreText.setScale(0).setAlpha(0),this.scoreText.setDepth(Na.A.ON_TOP),this.scoreText.setVisible(!1)},n.createTweenScoreText=function(){var e,t=this,n=this.scene.storage.getState(),i=(0,uo.qs)(n),a=this.scene.gameZone.width/2;g()(e=[ho.Ee,ho.QT,ho.zA]).call(e,i)>=0&&(a=105),this.tweenShowScoreText=this.scene.tweens.add({paused:!0,targets:this.scoreText,scale:{from:0,to:1},alpha:{from:0,to:1},duration:300,onComplete:function(){t.tweenHideScoreText=t.scene.tweens.add({targets:t.scoreText,scale:{from:1,to:.5},alpha:{from:1,to:.5},x:a,y:65,delay:600,duration:210,onComplete:function(){t.scoreText.setVisible(!1),t.scoreText.setAlpha(0),t.scoreText.setScale(0),t.scene.handleAddScoreAnim(t.score||0)}})}})},n.playAnimShowScoreText=function(){if(this.tweenHideScoreText&&this.tweenHideScoreText.isPlaying()){var e,t;this.tweenHideScoreText.stop(),this.scoreText.setPosition(this.startX,this.startY);var n=this.scene.storage.getState(),i=(0,uo.qs)(n),a=0;(g()(e=[ho.Nu,ho.zA]).call(e,i)>=0||g()(t=[ho.Ee,ho.QT]).call(t,i)>=0)&&(a=this.scene.header.mainScoreBlock.score,this.scene.header.mainScoreBlock.setScore(a+(this.score||0)),this.scene.header.mainScoreBlock.setScoreText(a+(this.score||0)))}this.score=this.listScore.shift()||0,this.scene.handleUpdateScore(this.score),this.scoreText.setScale(0).setAlpha(0).setVisible(!0),this.tweenShowScoreText.play()},n.createPraiseFrame=function(){this.praiseFrame=this.scene.make.image({x:0,y:0,key:bh}),this.praiseFrame.setScale(0),this.praiseFrame.setAlpha(0),this.praiseFrame.setDepth(Na.A.ON_TOP),this.praiseFrame.setVisible(!1)},n.createTweenPraiseFrame=function(){var e=this;if(!this.tweenShowPraiseFrame||!this.tweenHidePraiseFrame){var t=this.praiseFrame.scale;this.tweenShowPraiseFrame=this.scene.tweens.add({paused:!0,targets:this.praiseFrame,scale:{from:0,to:t},alpha:{from:0,to:1},duration:300,delay:100,ease:Phaser.Math.Easing.Back.Out,onComplete:function(){e.tweenHidePraiseFrame.play()}}),this.tweenHidePraiseFrame=this.scene.tweens.add({paused:!0,targets:this.praiseFrame,scale:{from:t,to:0},alpha:{from:1,to:0},duration:300,delay:1e3,onComplete:function(){e.praiseFrame.setScale(0),e.praiseFrame.setAlpha(0),e.praiseFrame.setVisible(!1)}})}},n.playAnimShowPraiseFrame=function(){this.createTweenPraiseFrame(),(this.tweenShowPraiseFrame.isPlaying()||this.tweenHidePraiseFrame.isPlaying())&&(this.tweenShowPraiseFrame.resetTweenData(!1),this.tweenHidePraiseFrame.resetTweenData(!1)),this.praiseFrame.setScale(0).setAlpha(0).setVisible(!0),this.tweenShowPraiseFrame.play()},n.createPraiseScoreText=function(){this.praiseScoreText=this.scene.make.bitmapText({font:za.A.FONT_TEXT_WHITE.KEY,size:this.scene.fontSize(30),origin:{x:.5,y:.5}}),this.praiseScoreText.setDepth(Na.A.ON_TOP),this.add(this.praiseScoreText),Phaser.Display.Align.In.Center(this.praiseScoreText,this,0,20)},n.handlePraise=function(e,t,n,i){this.startX=e,this.startY=t+15-78,this.listScore.push(n);var a=e-10;this.scoreText.setPosition(a,this.startY),this.scoreText.setText("+"+n),a-this.scoreText.fontSize/2<0&&(a+=this.scoreText.fontSize/2,this.scoreText.setPosition(a,this.startY)),this.playAnimShowScoreText(),this.handlePraiseFrameText(e,t-78,i);var s=this.getVibrateByLevel(i);this.scene.player.getPlayerSettings().vibrate&&ql(s),i<=1||this.changeExplode(a,t-78,i)},n.getVibrateByLevel=function(e){return Th[e]||0},n.changeExplode=function(e,t,n){var i=this.getExplodeByLevel(n);i&&(this.emitter.setScale({start:.05*i.scale,end:.2*i.scale}),this.emitter.setSpeed({min:30*i.speed,max:80*i.speed}),this.emitter.setQuantity(20*i.quantity)),this.emitter.explode(20*i.quantity,e,t)},n.handlePraiseFrameText=function(e,t,n){var i=this.getMainFrameByLevel(n);if(i){var a=0,s=0;switch(i){case Ph.TEXT_COOL:a=134,s=56;break;case Ph.TEXT_PERFECT:a=175,s=60;break;case Ph.TEXT_EXCELLENT:a=211,s=58;break;case Ph.TEXT_UNBELIEVABLE:a=282,s=70}this.praiseFrame.setFrame(i),this.praiseFrame.setWorldSize(a,s);var r=e,o=this.scene.gameZone.width;r=e-a/2<0?a/2:e+a/2>o?o-a/2:e,this.praiseFrame.setPosition(r,t-40),this.playAnimShowPraiseFrame()}},n.getExplodeByLevel=function(e){return Ss[e-1]||Ss[0]||null},n.getMainFrameByLevel=function(e){if(e>6)return Fa.A.EFFECTS.FRAME.TEXT_EXCELLENT;var t=Ts[e-1]||Ts[0];return Phaser.Utils.Array.GetRandom(t.frames)},n.reset=function(){this.createTweenScoreText()},t}(Phaser.GameObjects.Container),wh=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.header=void 0,n.board=void 0,n.footer=void 0,n.praise=void 0,n.currentIdx=0,n.scene=t,n.updateSize(),t.add.existing((0,ka.A)(n)),n.init(),n.alignComponents(),n}(0,_.A)(t,e);var n=t.prototype;return n.init=function(){this.createHeader(),this.createBoard(),this.createFooter(),this.createPraise(),this.alignUI()},n.createHeader=function(){this.header=new Kl(this.scene),this.add(this.header)},n.createFooter=function(){this.footer=new Cl(this.scene),this.add(this.footer)},n.createBoard=function(){this.board=new Eh(this.scene),this.add(this.board)},n.createPraise=function(){this.praise=new Ch(this.scene),this.add(this.praise)},n.alignUI=function(){var e=this.x,t=this.y;this.setPosition(0,0);var n=this.scene.ads.getBannerHeight();Phaser.Display.Align.In.TopCenter(this.header,this,0,-25),Phaser.Display.Align.In.BottomCenter(this.footer,this,0,-n-25);var i=this.header.y+this.header.height/2,a=this.footer.y-this.footer.height/2;this.board.setPosition(0,(a+i)/2),this.praise.setPosition(this.board.x,this.board.y),this.setPosition(e,t)},n.alignComponents=function(){this.alignUI(),this.footer.alignComponents()},n.updateLayout=function(){this.updateSize(),this.alignComponents()},n.updateSize=function(){var e=this.scene.gameZone.height;this.scene.gameZone.height<622?(e=622,this.setScale(this.scene.gameZone.height/622)):this.setScale(1);var t=e/this.scene.gameZone.height*this.scene.gameZone.width;this.setSize(t,e)},n.registerPiecesGlobalEvents=function(){this.footer.registerPiecesGlobalEvents()},n.unregisterPiecesGlobalEvents=function(){this.footer.unregisterPiecesGlobalEvents()},t}(Phaser.GameObjects.Container),Ih=wh,xh=Fa.A.GAMEPLAY_32,kh=xh.KEY,Oh=xh.FRAME,_h=Fa.A.DEFAULT,Rh=_h.KEY,Dh=_h.FRAME,Mh=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).scene=void 0,s.textWellDone=void 0,s.listTargetFrame=[],s.listAnim=[],s.closeTimerEvent=void 0,s.tweenBackground=void 0,s.tweenShowTextWellDone=void 0,s.scaleTextWellDone=void 0,s.open=function(t){e.prototype.open.call((0,ka.A)(s),t),s.runPopupEntrancesAnimation(0,300)},s.close=function(){e.prototype.close.call((0,ka.A)(s))},s.scene=t,s.setDepth(Ua.Ae.POPUP),s.background.setAlpha(0),s.createContent(),s}(0,_.A)(t,e);var n=t.prototype;return n.handleDelegate=function(){var e,t=this,n=this.getData(["duration","onClose"]),i=n[0],a=void 0===i?0:i,s=n[1];null==(e=this.closeTimerEvent)||e.remove(),a>0&&(this.closeTimerEvent=this.scene.time.addEvent({delay:a,callback:function(){t.visible&&t.scene.screen.close(t.name),s&&s()}}))},n.runAnim=function(){},n.createContent=function(){this.createText(),this.createTweenTextWellDone()},n.createText=function(){this.textWellDone=this.scene.make.image({key:Rh,frame:Dh.TEXT_WELL_DONE}),this.textWellDone.setWorldSize(278,52),this.scaleTextWellDone=this.textWellDone.scale,this.add(this.textWellDone),Phaser.Display.Align.In.Center(this.textWellDone,this)},n.createTweenTextWellDone=function(){this.tweenShowTextWellDone=this.scene.tweens.add({targets:[this.textWellDone],paused:!0,duration:300,ease:Phaser.Math.Easing.Back.Out,scale:{from:0,to:this.scaleTextWellDone}})},n.createTargetItems=function(){var e=this.scene.journeyGameplay.header.collectItems.getTargetKeys();if(e&&0!==e.length){for(var t=0;t<3;t++){var n=this.scene.make.image({key:kh});n.setWorldSize(30,30),n.setFrame(e[t]||e[0]||Oh.BUBBLE_BLUE),n.setVisible(!1).setAlpha(0),this.listTargetFrame.push(n)}this.add(this.listTargetFrame)}},n.updateTargetItems=function(){var e=this.scene.journeyGameplay.header.collectItems.getTargetKeys();if(e&&0!==e.length)for(var t=0;t<3;t++){var n=this.listTargetFrame[t];n.setWorldSize(30,30),n.setFrame(e[t]||e[0]),n.setVisible(!1).setAlpha(0)}},n.createAnimTargetItems=function(){var e=this;this.listAnim.forEach((function(e){e.stop(),e.remove()})),this.listAnim=[];for(var t=[0,400,700],n=[-120,0,120],i=[-100,-150,-100],a=[.7,1,.7],s=[ja.A.STAR_PROGRESS_1,ja.A.STAR_PROGRESS_2,ja.A.STAR_PROGRESS_3],r=function(r){e.listTargetFrame[r].setAlpha(0).setVisible(!0);var o=e.scene.add.tween({targets:e.listTargetFrame[r],delay:t[r],x:{from:0,to:n[r]},y:{from:300,to:i[r]},alpha:{from:0,to:1},scale:{from:0,to:a[r]},rotation:{from:-180,to:0},duration:500,paused:!0,onStart:function(){e.scene.time.delayedCall(400,(function(){e.scene.audio.playSound(s[r])}))},onComplete:function(){2===r&&(e.scene.audio.playSound(ja.A.WELL_DONE),e.tweenShowTextWellDone.play())}});e.listAnim.push(o)},o=0;o<3;o++)r(o)},n.playAnimTargetItems=function(){for(var e=0;e<3;e++){this.listTargetFrame[e].setAlpha(0).setVisible(!0),this.listAnim[e].play()}},n.runPopupEntrancesAnimation=function(e,t){var n=this;this.listTargetFrame.forEach((function(e){e.setAlpha(0)})),this.textWellDone.setScale(0),this.tweenBackground||(this.tweenBackground=this.scene.tweens.addCounter({paused:!0,from:0,to:.6,delay:e,duration:t,onUpdate:function(e){var t=e.getValue();n.background.setAlpha(t)},onComplete:function(){0===n.listTargetFrame.length?n.createTargetItems():n.updateTargetItems(),n.createAnimTargetItems(),n.playAnimTargetItems(),n.handleDelegate(),n.runAnim()}})),this.background.setAlpha(0),this.tweenBackground.play()},t}(GameCore.Screen),Bh=n(487),Lh=n(491),Nh=n(492),Gh=n(669),Fh=n(493),Uh=function(){function e(e){this.scene=void 0,this.tweenScaleUp=void 0,this.tweenScaleDown=void 0,this.tweenMoveTo=void 0,this.target=void 0,this.handleOnComplete=void 0,this.playing=void 0,this.path=void 0,this.scene=e,this.path=new Phaser.Curves.Path}var t=e.prototype;return t.runScaleUpAnimation=function(e,t){var n;null==(n=this.tweenScaleUp)||n.remove(),this.tweenScaleUp||(this.tweenScaleUp=new Gh.A({targets:[this.target],delay:e,duration:t,props:{scale:"+=0.05"}})),this.tweenScaleUp.play()},t.runScaleDownAnimation=function(e,t){var n;null==(n=this.tweenScaleDown)||n.remove(),this.tweenScaleDown||(this.tweenScaleDown=new Fh.A({targets:[this.target],delay:e,duration:t,props:{scale:"-=0.15"}})),this.tweenScaleDown.play()},t.runAnimMoveToPosition=function(e,t,n,i){var a=this;this.playing=!0,this.target.setDepth(Na.A.ON_TOP);var s=this.target.x,r=this.target.y;this.path.startPoint=new Phaser.Math.Vector2(s,r);for(var o=Math.abs(n-s)/2,c=Math.abs(i-r),l=Phaser.Math.Between(1,2),h=[],u=1;u<4;u++){var d=-1;u%2==0&&(d=1);var p=(o-d*Phaser.Math.Between(o/4,o/3))*l,f=r-u*(c/4);h.push(new Phaser.Math.Vector2(p,f))}h.push(new Phaser.Math.Vector2(n,i)),this.path.splineTo(h),this.path.lineTo(n,i);var m=new Phaser.Curves.Spline(h);this.tweenMoveTo=this.scene.add.tween({delay:e,targets:this.path,t:{from:0,to:1},ease:"Sine.easeInOut",duration:t,onUpdate:function(e){var t=e.getValue(0),n=m.getPoint(t);a.target.setPosition(n.x,n.y)},onComplete:function(){a.playing=!1,a.handleOnComplete&&a.handleOnComplete()}})},t.runGemMoveToPosition=function(e,t,n,i){var a=this;this.playing=!0;var s=this.target.x,r=this.target.y;this.path.startPoint=new Phaser.Math.Vector2(s,r);for(var o=this.scene.gameZone.width/2,c=Math.abs(n-s)+o-50,l=Math.abs(i-r),h=[],u=1;u<4;u++){var d=-1;u%2==0&&(d=1);var p=1.5*(c-d*Phaser.Math.Between(c/8,c/7)),f=r-u*(l/4);h.push(new Phaser.Math.Vector2(p,f))}h.push(new Phaser.Math.Vector2(n,i)),this.path.splineTo(h),this.path.lineTo(n,i);var m=new Phaser.Curves.Spline(h);return this.tweenMoveTo=this.scene.add.tween({delay:e,targets:this.path,t:{from:0,to:1},ease:"Sine.easeInOut",duration:t,onUpdate:function(e){var t=e.getValue(0),n=1-t+.1,i=m.getPoint(t);a.target.setAlpha(n),a.target.setPosition(i.x,i.y)},onComplete:function(){a.playing=!1,a.handleOnComplete&&a.handleOnComplete()}}),this.tweenMoveTo},t.setTarget=function(e){this.target=e},(0,ve.A)(e,[{key:"onComplete",set:function(e){this.handleOnComplete=e}},{key:"isPlaying",get:function(){return this.playing}}]),e}(),jh=Fa.A.GAMEPLAY_32.KEY,Vh=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.imageGem=void 0,n.text=void 0,n.scene=t,n.init(),n}(0,_.A)(t,e);var n=t.prototype;return n.init=function(){this.createImageGem(),this.createText()},n.createImageGem=function(){this.imageGem=this.scene.make.image({key:jh}),this.imageGem.setWorldSize(41,41),this.add(this.imageGem),Phaser.Display.Align.In.Center(this.imageGem,this,0,0)},n.createText=function(){this.text=this.scene.make.bitmapText({font:za.A.MIKADO_WHITE.KEY,size:13,origin:{x:.5,y:.5}}),this.add(this.text),Phaser.Display.Align.In.Center(this.text,this.imageGem,12,7)},n.updateGem=function(e){this.imageGem.setFrame(e)},n.updateText=function(e){this.text.setText("x"+e)},n.getFrame=function(){return this.imageGem.frame.name},t}(Phaser.GameObjects.Container),zh=Fa.A.DEFAULT,Yh=zh.KEY,Hh=zh.FRAME,Kh=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).scene=void 0,s.popup=void 0,s.contents=void 0,s.targetImages=[],s.listItems=[],s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.listAnimCollectionItem=[],s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.handleClose=function(){s.runCloseAnimation()},s.scene=t,s.createPopup(),s.createPanelMissionTarget(),s.addItem(),s.setDepth(Ua.Ae.POPUP),s.background.setAlpha(.5),s}(0,_.A)(t,e);var n=t.prototype;return n.open=function(t){var n=this;e.prototype.open.call(this,t);var i=this.getData(["duration"])[0];this.hideAllCollectionItems(),this.createCollectionItems(),this.alginCollectionItems(),this.runOpenAnimation(),this.scene.time.delayedCall(i,(function(){n.handleClose()}))},n.createPopup=function(){this.popup=this.scene.add.container(),this.popup.setSize(375,84),this.add(this.popup)},n.createPanelMissionTarget=function(){var e=this.scene.make.image({key:Yh,frame:Hh.PANEL_MISSION_TARGET});e.setWorldSize(341,84),this.popup.add(e),Phaser.Display.Align.In.Center(e,this.popup,0,-8)},n.createCollectionItems=function(){for(var e=this.getData(["jsonTarget"])[0],t=he()(e),n=0;n<t.length;n++){var i=t[n],a=this.getCollectionItemFree(n);console.log("jsonTarget[key] === ",e[i]),a.updateGem(i),a.updateText(e[i])}},n.getCollectionItemFree=function(e){var t=this.listItems[e];return t||(t=new Vh(this.scene),this.popup.add(t),this.listItems.push(t)),t.setVisible(!0),t},n.alginCollectionItems=function(){var e;this.targetImages=[];for(var t=f()(e=this.listItems).call(e,(function(e){return e.visible})),n=t.length,i=-51*(n-1)/2,a=0;a<n;a++){var s=t[a];Phaser.Display.Align.In.Center(s,this.popup,i+51*a,-9);var r=s.getFrame(),o=this.scene.make.image({key:Fa.A.GAMEPLAY_32.KEY,frame:r});o.setWorldSize(22,22),o.setVisible(!1),this.targetImages.push(o),Phaser.Display.Align.In.Center(o,this.popup,i+51*a+this.scene.gameZone.width/2,this.scene.gameZone.height/2)}},n.hideAllCollectionItems=function(){for(var e=0;e<this.listItems.length;e++){this.listItems[e].setVisible(!1)}},n.moveGemsToCollectItems=function(){var e=this;console.log("moveGemsToCollectItems");var t=this.scene.journeyGameplay.header;this.resetPositionTargetImages();for(var n=t.collectItems,i=n.getTargetKeys(),a=this.scene.gameZone.width/2,s=function(s){var r=i[s],o=n.getPositionCollectionItem(r),c=a+o.x,l=n.getWorldPosition().y;e.targetImages[s].setAlpha(1),e.targetImages[s].setVisible(!0);var h=e.getFreeAnim(),u=Phaser.Math.Between(500,1e3);h.setTarget(e.targetImages[s]),h.runGemMoveToPosition(0,u,c,l).on(Phaser.Tweens.Events.TWEEN_COMPLETE,(function(){t.collectItems.showCollectItemByKey(r),e.targetImages[s].setVisible(!1),s==e.targetImages.length-1&&e.scene.main.board.handleTweenStartMission()}))},r=0;r<i.length;r++)s(r)},n.resetPositionTargetImages=function(){for(var e,t=f()(e=this.listItems).call(e,(function(e){return e.visible})),n=263/(t.length+1)+5,i=-n*(t.length-1)/2,a=0;a<t.length;a++){var s;this.targetImages[a]&&(null==(s=this.targetImages[a])||s.setVisible(!1),Phaser.Display.Align.In.Center(this.targetImages[a],this.popup,i+n*a+this.scene.gameZone.width/2,this.scene.gameZone.height/2))}},n.getFreeAnim=function(){var e=new Uh(this.scene);return this.listAnimCollectionItem.push(e),e},n.addItem=function(){this.contents=this.scene.add.group(),this.contents.addMultiple([])},n.runOpenAnimation=function(){var e;null!=(e=this.popupShowUpAnimation)&&null!=(e=e.tween)&&e.isPlaying()||(this.scene.audio.playSound(ja.A.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300),this.runPopupContentEntrancesAnimation(200,300))},n.runCloseAnimation=function(){var e,t=this;null!=(e=this.popupFadeOutAnimation)&&null!=(e=e.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.scene.time.delayedCall(50,(function(){t.moveGemsToCollectItems()})),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(e,t){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new Nh.A({targets:[this.popup],delay:e,duration:t,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(e,t){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new Lh.A({targets:this.contents.getChildren(),duration:t,delay:e,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(e,t){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new Bh.A({targets:[this.popup],delay:e,duration:t,props:{scale:0},onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name),n.scene.journeyGameplay.startGameAfterCollectionItemsScreenClose()}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(e,t){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new wo.A({targets:[this.background],delay:e,duration:t,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(e,t){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new Bh.A({targets:[this.background],delay:e,duration:t,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},t}(GameCore.Screen),Wh=Kh,Zh=Fa.A.DEFAULT,Xh=Zh.KEY,Jh=Zh.FRAME,qh=function(e){function t(t,n,i){var a;return(a=e.call(this,t,Xh,Jh.BLANK,125,76)||this).options=void 0,a.icon=void 0,a.text=void 0,a.getFrameByStatus=function(){var e=a.options,t=e.enable,n=e.frameOn,i=e.frameOff;return t?n:i},a.setLabelByStatus=function(){var e=a.options,t=e.enable,n=e.frameTextOn,i=e.frameTextOff;t?a.text.setFrame(n):a.text.setFrame(i)},a.button.setVisible(!1),a.options=i,a.createIcon(),a.createText(),t.add.existing((0,ka.A)(a)),a}(0,_.A)(t,e);var n=t.prototype;return n.updateStatus=function(e){console.log("updateStatus",e),this.options.enable=e;var t=this.getFrameByStatus();this.icon.setFrame(t),this.setLabelByStatus()},n.createIcon=function(){var e=this.getFrameByStatus();this.icon=this.scene.make.image({key:Xh,frame:e,x:0,y:-10}),this.add(this.icon),Phaser.Display.Align.In.Center(this.icon,this,0,-6)},n.createText=function(){var e=this.options,t=e.frameTextOn,n=e.textW,i=e.textH,a=e.textOffsetY,s=void 0===a?0:a;this.text=this.scene.make.image({key:Xh,frame:t,origin:{x:.5,y:.5}}),this.text.setWorldSize(n,i),this.add(this.text),Phaser.Display.Align.In.Center(this.text,this,0,20+s)},t}(Va.A),Qh=qh,$h=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t)||this).numOfTabs=void 0,s.currentIdx=void 0,s.callback=void 0,s.numOfTabs=a,s.setSize(n,i),t.add.existing((0,ka.A)(s)),s}(0,_.A)(t,e);var n=t.prototype;return n.addLabels=function(e){this.add(e);var t=this.width/this.numOfTabs;this.placeCenter(e,0,0,t+1)},n.placeCenter=function(e,t,n,i,a){void 0===a&&(a=0);for(var s=t-(this.numOfTabs/2-.5-a)*i,r=0;r<e.length;r++)e[r].setPosition(s+r*i,n)},n.selectTab=function(e){var t=e.idx,n=e.isSelectAgain,i=void 0!==n&&n,a=e.immediately,s=void 0!==a&&a,r=e.callOnOpen,o=void 0===r||r,c=e.onContentOpenData;(t!=this.currentIdx||i)&&(c&&(c.fromTab=this.currentIdx),this.currentIdx=t,this.callback&&this.callback(t,s,o,c))},t}(Phaser.GameObjects.Container),eu=$h,tu=83.5,nu=Fa.A.DEFAULT,iu=nu.KEY,au=nu.FRAME,su=function(e){function t(t){var n;return(n=e.call(this,t)||this).dashboardButton=void 0,n.journeyButton=void 0,n.tournamentsButton=void 0,n.chooseContainers=[],n.currentIdx=0,n.tab=void 0,n.background=void 0,n.backgroundReverse=void 0,n.createBackground(),n.createButtons(),n.createTabSelector(),n.scene.add.existing((0,ka.A)(n)),n.alignComponents(),n}(0,_.A)(t,e);var n=t.prototype;return n.createBackground=function(){this.background=this.scene.make.image({key:iu,frame:au.BG_FOOTER}),this.background.setDepth(Na.A.BACKGROUND),this.add(this.background),this.backgroundReverse=this.scene.make.image({key:iu,frame:au.BG_FOOTER}),this.backgroundReverse.setFlipY(!0),this.backgroundReverse.setDepth(Na.A.BACKGROUND),this.add(this.backgroundReverse)},n.createButtons=function(){this.createTournamentsButton(),this.createDashboardButton(),this.createJourneyButton()},n.createTournamentsButton=function(){this.tournamentsButton=new Qh(this.scene,"Tournaments",{enable:!0,frameOn:au.ICON_TOURNAMENT_ON,frameOff:au.ICON_TOURNAMENT_OFF,frameTextOn:au.TEXT_TOURNAMENTS_ON,frameTextOff:au.TEXT_TOURNAMENTS_OFF,textW:78.5,textH:12.5}),this.tournamentsButton.icon.setWorldSize(37,33),this.tournamentsButton.setSize(40,40),this.add(this.tournamentsButton)},n.createDashboardButton=function(){this.dashboardButton=new Qh(this.scene,"Home",{enable:!0,frameOn:au.ICON_HOME_ON,frameOff:au.ICON_HOME_OFF,frameTextOn:au.TEXT_HOME_ON,frameTextOff:au.TEXT_HOME_OFF,textW:35.5,textH:12.5}),this.dashboardButton.icon.setWorldSize(36.5,34.5),this.dashboardButton.setSize(40,40),this.add(this.dashboardButton)},n.createJourneyButton=function(){this.journeyButton=new Qh(this.scene,"Journey",{enable:!0,frameOn:au.ICON_JOURNEY_ON,frameOff:au.ICON_JOURNEY_OFF,frameTextOn:au.TEXT_JOURNEY_ON,frameTextOff:au.TEXT_JOURNEY_OFF,textW:49,textH:15,textOffsetY:1}),this.journeyButton.icon.setWorldSize(41,36),this.journeyButton.setSize(40,40),this.add(this.journeyButton)},n.createTabSelector=function(){var e=this,t=[this.tournamentsButton,this.dashboardButton,this.journeyButton];this.tab=new eu(this.scene,375,40,t.length),this.add(this.tab),Phaser.Display.Align.In.Center(this.tab,this,0,3),this.tab.addLabels(t),this.tab.callback=function(n,i,a,s){t.forEach((function(t,i){t.updateStatus(n==i),t.onClick=function(){e.tab.selectTab({idx:i})}})),e.callbackButton(n,i,a,s)}},n.callbackButton=function(e,t,n,i){var a=this;this.chooseContainers[e].setVisible(!0),n&&this.chooseContainers[e].onOpen(i);var s=this.scene.gameZone.width,r=this.currentIdx<e?s:-s,o=this.currentIdx;this.currentIdx==e&&(r=0);var c=t?0:200;this.scene.tweens.add({targets:this.chooseContainers[this.currentIdx],x:this.currentIdx<e?-s:s,duration:c,ease:Phaser.Math.Easing.Sine.InOut,onComplete:function(){o!==e&&a.chooseContainers[o].visible&&(a.chooseContainers[o].setVisible(!1),a.chooseContainers[o].onClose())}}),this.chooseContainers[e].x=r,this.scene.tweens.add({targets:this.chooseContainers[e],x:{from:r,to:0},duration:c,ease:Phaser.Math.Easing.Sine.InOut}),this.currentIdx=e},n.alignComponents=function(){var e=this.scene.gameZone.width;this.background.setWorldSize(e,tu),this.setSize(this.background.displayWidth,this.background.displayHeight);var t=this.x,n=this.y;this.setPosition(0,0),this.backgroundReverse.setWorldSize(e,tu),Phaser.Display.Align.To.BottomCenter(this.backgroundReverse,this,0,0),this.setPosition(t,n)},n.addChooseContainers=function(e){var t;(t=this.chooseContainers).push.apply(t,e)},n.selectTab=function(e){this.tab.selectTab(e)},n.getCurrentIdx=function(){return this.tab.currentIdx},t}(Phaser.GameObjects.Container),ru=su,ou=function(e){function t(){return e.apply(this,arguments)||this}return(0,_.A)(t,e),t}(Phaser.GameObjects.Container),cu=ou,lu=n(670),hu=n(108),uu=n(231),du=n(502),pu=function(e){if("string"!==typeof e||!e)throw new uu.A(null,{imageShare:e})},fu=function(e){var t=e?e.split("_"):[],n=t.length>0?t[0]:"en_US";switch(n){case"id":case"in":n="id"}return n},mu=Fa.A.GAMEPLAY,gu=mu.KEY,vu=mu.FRAME,yu=function(e){function t(t){var n;return(n=e.call(this,t,{key:gu,frame:vu.AVATAR_FRAME,background:vu.AVATAR_BACKGROUND,width:39,height:39,borderWidth:0})||this).scene=void 0,n.scene=t,n}return(0,_.A)(t,e),t}(xl),Au=yu,Eu=Fa.A.GAMEPLAY,Tu=Eu.KEY,Su=Eu.FRAME,bu=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.buttonAddFriend=void 0,i.buttonGlobal=void 0,i.buttonPlus=void 0,i.originXButtonPlus=void 0,i.iconAddFriend=void 0,i.iconGlobal=void 0,i.avatar=void 0,i.payload=void 0,i.scene=t,i.createButtonAddFriend(),i.createButtonGlobal(),i.createButtonPlus(),i.createAvatar(),n&&i.updateInfo(n),i.scene.add.existing((0,ka.A)(i)),i}(0,_.A)(t,e);var n=t.prototype;return n.updateInfo=function(e){this.payload=e,this.updateAvatar()},n.createButtonAddFriend=function(){this.buttonAddFriend=new Va.A(this.scene,Tu,Su.BUTTON_GREEN_RECTANGLE,67,66),this.buttonAddFriend.setVisible(!1),this.add(this.buttonAddFriend),this.iconAddFriend=this.scene.make.image({key:Tu,frame:Su.ICON_ADD_FRIEND}),this.iconAddFriend.setWorldSize(26,25),this.buttonAddFriend.add(this.iconAddFriend),Phaser.Display.Align.In.Center(this.iconAddFriend,this.buttonAddFriend,0,0),Phaser.Display.Align.In.Center(this.buttonAddFriend,this,-37,33)},n.createButtonGlobal=function(){this.buttonGlobal=new Va.A(this.scene,Tu,Su.BUTTON_PINK_RECTANGLE,67,66),this.buttonGlobal.setVisible(!1),this.add(this.buttonGlobal),this.iconGlobal=this.scene.make.image({key:Tu,frame:Su.ICON_GLOBAL}),this.iconGlobal.setWorldSize(25,25),this.buttonGlobal.add(this.iconGlobal),Phaser.Display.Align.In.Center(this.iconGlobal,this.buttonGlobal,0,0),Phaser.Display.Align.In.Center(this.buttonGlobal,this,-12,33)},n.createButtonPlus=function(){this.buttonPlus=new Va.A(this.scene,Tu,Su.BUTTON_GREEN_SQUARE,25,37),this.buttonPlus.setVisible(!1),this.add(this.buttonPlus);var e=this.scene.make.image({key:Tu,frame:Su.ICON_PLUS});e.setWorldSize(14,15),this.buttonPlus.add(e),Phaser.Display.Align.In.Center(e,this.buttonPlus,0,0),Phaser.Display.Align.In.Center(this.buttonPlus,this,-10,33),this.originXButtonPlus=this.buttonPlus.x},n.showButtonAddFriend=function(){this.buttonAddFriend.setVisible(!0),this.avatar.setVisible(!1)},n.showButtonGlobal=function(){this.buttonGlobal.setVisible(!0),this.avatar.setVisible(!1)},n.showPlus=function(){this.buttonPlus.setVisible(!0),this.avatar.setVisible(!1)},n.createAvatar=function(){this.avatar=new Au(this.scene),Phaser.Display.Align.In.Center(this.avatar,this,0,33),this.add(this.avatar)},n.updateAvatar=function(){var e=this.payload,t=e.playerId,n=e.photo;n&&this.avatar.loadPhoto(t,n,50)},(0,ve.A)(t,[{key:"onClick",set:function(e){this.avatar.setInteractive({useHandCursor:!0}),this.avatar.off(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN),this.avatar.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,e)}}]),t}(Phaser.GameObjects.Container),Pu=bu,Cu=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.payload=void 0,i.leaderBlocks=void 0,i.entrancesAnimation=void 0,i.listLeaderBlocks=void 0,i.handleChallengeFriend=function(e){return function(){i.scene.storage.dispatch((0,oo.kw)(e))}},i.handlePlayWithFriend=function(){i.scene.storage.dispatch((0,oo.nv)())},i.handleShareLeaderboard=function(){i.scene.audio.playSound(ja.A.BUTTON_CLICK),i.scene.storage.dispatch((0,du.Qp)())},i.handleMatchingGroup=(0,O.A)(D().mark((function e(){var t,n,a,s,r,o,c,l;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.scene,n=t.player,a=t.storage,s=t.game,e.prev=1,s.globalScene.screen.open(Ua.R8.NOTIFY_SCREEN,{message:"Loading...",loading:!0}),r=n.getPlayer(),o="global","en"===(c=fu(r.locale))&&(o="en"),"in"===c&&(o="in"),e.next=10,i.scene.facebook.matchPlayer(o);case 10:if(l=e.sent,s.globalScene.screen.close(Ua.R8.NOTIFY_SCREEN),l){e.next=14;break}return e.abrupt("return");case 14:a.dispatch((0,oo.oE)()),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(1),s.globalScene.screen.close(Ua.R8.NOTIFY_SCREEN);case 20:case"end":return e.stop()}}),e,null,[[1,17]])}))),i.scene=t,i.setName("LeadersBar"),i.listLeaderBlocks=[],i.createLeaderBlocks(),i.createEntrancesAnimation(),n&&i.updateInfo(n),i.scene.add.existing((0,ka.A)(i)),i}(0,_.A)(t,e);var n=t.prototype;return n.updateInfo=function(e){var t=this;this.payload=e;var n,i=this.payload.leaders,a=!1;(i.forEach((function(e){var n,s=t.leaderBlocks.getFirstDead(!0);switch(s.updateInfo(e),e.playerId){case"button-add-friend":s.showButtonAddFriend(),s.buttonAddFriend.onClick=t.handlePlayWithFriend;break;case"button-global":s.showButtonGlobal(),s.buttonGlobal.onClick=t.handleMatchingGroup;break;case"button-plus":s.showPlus(),s.buttonPlus.onClick=t.handleInviteFriends.bind(t),s.buttonPlus.setX(s.originXButtonPlus+48*(6-i.length));break;default:s.onClick=t.handleChallengeFriend(e.playerId)}t.add(s),s.setVisible(!0),s.setActive(!0),g()(n=t.listLeaderBlocks).call(n,s)<0&&(a=!0)})),this.alignBlocks(),a)&&(this.listLeaderBlocks=f()(n=this.leaderBlocks.getChildren()).call(n,(function(e){return e.active})),this.createEntrancesAnimation());this.runAnimation()},n.killAndHideAll=function(){var e=this;this.removeAll(!1),this.leaderBlocks.getChildren().forEach((function(t){return e.leaderBlocks.killAndHide(t)}))},n.runAnimation=function(){this.leaderBlocks.setAlpha(0),this.entrancesAnimation.play()},n.createEntrancesAnimation=function(){this.entrancesAnimation=new lu.A({targets:this.listLeaderBlocks,delay:this.scene.tweens.stagger(50,{start:400}),props:{y:{from:100,to:0},alpha:{from:0,to:1}}})},n.alignBlocks=function(){this.leaderBlocks.setX(-84,48)},n.createLeaderBlocks=function(){this.leaderBlocks=this.scene.add.group({classType:Pu})},n.handleInviteFriends=function(){this.scene.storage.dispatch((0,O.A)(D().mark((function e(){var t,n,i,a,s,r,o,c,l,h;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.game,n=t.player,i=t.analytics,a=t.facebook,s=t.globalScene,e.prev=1,s.screen.open(Ua.R8.NOTIFY_SCREEN,{message:"Loading...",loading:!0}),e.next=5,(0,du.kF)();case 5:return r=e.sent,pu(r),o=n.getPlayer(),c=o.playerId,l=o.name,h=o.photo,e.next=10,a.inviteAsync({template:hu.Hr,cta:{default:"Play",localizations:{en_US:"Play",vi_VN:"Ch\u01a1i ngay"}},text:{default:"Great! I have a best score!",localizations:{en_US:"Great! I have a best score!",vi_VN:"Th\u1eadt tuy\u1ec7t! M\xecnh v\u1eeba ph\xe1 k\u1ef7 l\u1ee5c n\xe0y!"}},image:r||"",data:{playerId:c,playerName:l,playerPhoto:h,type:hu.Hr}});case 10:i.event(rn.o.INVITE,{invite_content_type:"BestScore",success:!0}),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),i.event(rn.o.INVITE,{invite_content_type:"BestScore",success:!1}),(0,x.a0)(e.t0);case 17:return e.prev=17,s.screen.close(Ua.R8.NOTIFY_SCREEN),e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[1,13,17,20]])}))))},t}(Phaser.GameObjects.Container),wu=Cu,Iu=n(49),xu={targets:[],yoyo:!0,duration:120,ease:Phaser.Math.Easing.Circular.Out,props:{scale:{from:1,to:1.3}}},ku=function(e){function t(t){return e.call(this,xu,t)||this}return(0,_.A)(t,e),t}(Iu.A),Ou=ku,_u=Fa.A.GAMEPLAY,Ru=_u.KEY,Du=_u.FRAME,Mu=function(e){function t(t){var n;return(n=e.call(this,t,Ru,Du.BUTTON_BLUE_SMALL,60,66)||this).setName("Share"),n.createIcon(),n}return(0,_.A)(t,e),t.prototype.createIcon=function(){var e=this.scene.make.image({key:Ru,frame:Du.ICON_SHARE});e.setWorldSize(26,30),this.add(e),Phaser.Display.Align.In.Center(e,this,-2,-4)},t}(Va.A),Bu=Mu,Lu=n(212),Nu={targets:[],yoyo:!0,repeat:-1,duration:600,repeatDelay:50,ease:n.n(Lu)()(.55,.47,.43,.91),easeParams:[0,.9],props:{scale:{from:1,to:1.2}}},Gu=function(e){function t(t){return e.call(this,Nu,t)||this}return(0,_.A)(t,e),t}(Iu.A),Fu=Gu,Uu=Fa.A.GAMEPLAY,ju=Uu.KEY,Vu=Uu.FRAME,zu=function(e){function t(t){var n;return(n=e.call(this,t,ju,Vu.BUTTON_GREEN_LONG_RECTANGLE,175,66)||this).textNewGame=void 0,n.tweenNewGameButton=void 0,n.setName("NewGame"),n.createText(),n}(0,_.A)(t,e);var n=t.prototype;return n.createText=function(){this.textNewGame=this.scene.make.image({key:ju,frame:Vu.TEXT_NEW_GAME}),this.textNewGame.setWorldSize(97,17),this.add(this.textNewGame),Phaser.Display.Align.In.Center(this.textNewGame,this,0,-4)},n.runAnimation=function(){var e,t,n=this;null==(e=this.tweenNewGameButton)||e.remove(),this.tweenNewGameButton=new Fu({targets:[this],props:{scale:{from:1,to:1.05}}}),null==(t=this.tweenNewGameButton)||t.play(),this.hitZone.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,(function(){var e;null==(e=n.tweenNewGameButton)||e.stop()})),this.hitZone.on(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,(function(){var e,t;null!=(e=n.tweenNewGameButton.tween)&&e.isPlaying()||null==(t=n.tweenNewGameButton)||t.play()}))},t}(Va.A),Yu=zu,Hu=n(671),Ku=Fa.A.GAMEPLAY,Wu=Ku.KEY,Zu=Ku.FRAME,Xu=function(e){function t(t){var n;return(n=e.call(this,t)||this).background=void 0,n.textTitle=void 0,n.textScore=void 0,n.scoreText=void 0,n.textBest=void 0,n.iconCup=void 0,n.bestScoreText=void 0,n.newGameButton=void 0,n.shareButton=void 0,n.contents=void 0,n.popupShowUpAnimation=void 0,n.popupFadeOutAnimation=void 0,n.bestScore=void 0,n.currentScore=void 0,n.payload=void 0,n.buttonClose=void 0,n.counterAnimation=void 0,n.tweenScaleDownTextTitle=void 0,n.tweenScaleUpTextTitle=void 0,n.tweenScaleDownTextScore=void 0,n.tweenScaleUpTextScore=void 0,n.tweenScaleUpButtonShare=void 0,n.tweenScaleDownButtonShare=void 0,n.tweenScaleUpButtonNewGame=void 0,n.tweenScaleDownButtonNewGame=void 0,n.scoreAnimation=void 0,n.confettiLeftEffect=void 0,n.confettiRightEffect=void 0,n.tweenCounterConfetti=void 0,n.clickNewGame=function(){n.scene.storage.dispatch((0,oo.nv)())},n.clickShare=function(){n.scene.storage.dispatch((0,du.yM)())},n.runConfettiEffect=function(){var e=n.scene.gameZone.width;n.confettiLeftEffect.stop(),n.confettiRightEffect.stop(),n.scene.children.bringToTop(n.confettiLeftEffect),n.scene.children.bringToTop(n.confettiRightEffect),n.confettiLeftEffect.run(1,0,-100),n.confettiRightEffect.run(1,0+e,-100),n.tweenCounterConfetti=n.scene.tweens.addCounter({delay:1e4,from:100,to:0,ease:Phaser.Math.Easing.Cubic.Out,duration:400,onUpdate:function(e){var t,i,a=e.getValue()/100;null==(t=n.confettiLeftEffect.emitter)||t.setAlpha(a),null==(i=n.confettiRightEffect.emitter)||i.setAlpha(a)},onComplete:function(){n.stopEmitter()}})},n.scene=t,n.setSize(n.scene.gameZone.width,n.scene.gameZone.height),n.createTextTitle(),n.createTextScore(),n.createTextBestScore(),n.createButtonNewGame(),n.createButtonShare(),n.initScore(),n.createPopupContent(),n.createScoreAnimation(),n.createTweenScaleUpAndDownTextScore(),n.createConfettiSmallAnimation(),n}(0,_.A)(t,e);var n=t.prototype;return n.createTextTitle=function(){var e=this;this.background=this.scene.make.image({key:Wu,frame:Zu.BUTTON_BLACK}),this.background.setWorldSize(273,78),this.add(this.background),this.textTitle=this.scene.make.image({key:Wu,frame:Zu.TEXT_GAME_OVER}),this.textTitle.setWorldSize(155,27),this.add(this.textTitle),Phaser.Display.Align.In.TopCenter(this.background,this,0,-100),Phaser.Display.Align.In.Center(this.textTitle,this.background,0,-2);var t=this.background.scale;this.tweenScaleUpTextTitle=this.scene.tweens.add({paused:!0,targets:[this.background,this.textTitle],scale:{from:.75*t,to:1*t},alpha:{from:.5,to:1},duration:100}),this.tweenScaleDownTextTitle=this.scene.tweens.add({paused:!0,targets:[this.background,this.textTitle],scale:{from:1.2*t,to:.75*t},alpha:{from:0,to:.5},duration:100,onUpdate:function(){e.textTitle.setVisible(!0),e.background.setVisible(!0)},onComplete:function(){e.tweenScaleUpTextTitle.play()}})},n.createTextScore=function(){this.textScore=this.scene.make.image({key:Wu,frame:Zu.TEXT_SCORE}),this.textScore.setWorldSize(69,23),this.add(this.textScore),Phaser.Display.Align.In.Center(this.textScore,this,0,-112),this.scoreText=this.scene.make.bitmapText({font:za.A.FONT_NUMBER.KEY,size:this.scene.fontSize(80),text:"0",origin:{x:.5,y:.5}}),this.add(this.scoreText),Phaser.Display.Align.In.Center(this.scoreText,this,0,-72)},n.createTextBestScore=function(){this.textBest=this.scene.make.image({key:Wu,frame:Zu.TEXT_BEST}),this.textBest.setWorldSize(55,23),this.add(this.textBest),Phaser.Display.Align.In.Center(this.textBest,this,0,-3),this.bestScoreText=this.scene.make.bitmapText({font:za.A.FONT_NUMBER.KEY,size:this.scene.fontSize(80),text:"0",origin:{x:.5,y:.5}}),this.add(this.bestScoreText),Phaser.Display.Align.In.Center(this.bestScoreText,this,0,39),this.iconCup=this.scene.make.image({key:Wu,frame:Zu.ICON_CUP}),this.iconCup.setWorldSize(45,38),this.add(this.iconCup),Phaser.Display.Align.In.Center(this.iconCup,this.bestScoreText,-this.bestScoreText.width/2-42,3)},n.createTweenScaleUpAndDownTextScore=function(){var e=this,t=this.textScore.scale;this.tweenScaleUpTextScore=this.scene.tweens.add({paused:!0,targets:[this.textScore,this.textBest,this.iconCup],scale:{from:0,to:1.1*t},duration:100,onUpdate:function(){e.textScore.setVisible(!0),e.textBest.setVisible(!0),e.iconCup.setVisible(!0)},onComplete:function(){e.tweenScaleDownTextScore.play()}}),this.tweenScaleDownTextScore=this.scene.tweens.add({paused:!0,targets:[this.textScore,this.textBest,this.iconCup],scale:{from:1.1*t,to:t},duration:100})},n.createConfettiSmallAnimation=function(){this.confettiLeftEffect=new Hu.A(this.scene,{speedX:{min:-20,max:100},rotate:{start:-1080,end:0}}),this.confettiRightEffect=new Hu.A(this.scene,{speedX:{min:20,max:-100},rotate:{start:0,end:1080}}),this.confettiLeftEffect.setDepth(Na.A.ON_TOP),this.confettiRightEffect.setDepth(Na.A.ON_TOP)},n.createButtonNewGame=function(){this.newGameButton=new Yu(this.scene),this.newGameButton.onClick=this.clickNewGame,this.add(this.newGameButton),Phaser.Display.Align.In.Center(this.newGameButton,this,33,118)},n.createButtonShare=function(){this.shareButton=new Bu(this.scene),this.shareButton.onClick=this.clickShare,this.add(this.shareButton),Phaser.Display.Align.In.Center(this.shareButton,this,-92,118)},n.createPopupContent=function(){this.contents=this.scene.make.group({}),this.contents.addMultiple([this.newGameButton,this.shareButton])},n.runCloseAnimation=function(){this.runPopupExitsAnimation(0,200)},n.runPopupExitsAnimation=function(e,t){var n,i=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new Bh.A({targets:[this],delay:e,duration:t,props:{scale:0},onComplete:function(){i.setY(0)}})),null==(n=this.popupFadeOutAnimation)||n.play()},n.setBestScore=function(e){this.bestScoreText.setText(""+e),Phaser.Display.Align.In.Center(this.iconCup,this.bestScoreText,-this.bestScoreText.width/2-42,3)},n.runOpenAnimation=function(){this.background.setVisible(!1),this.textTitle.setVisible(!1),this.textScore.setScale(0),this.textBest.setScale(0),this.iconCup.setScale(0),this.scene.audio.playSound(ja.A.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runPopupContentEntrancesAnimation(200)},n.runPopupEntrancesAnimation=function(e,t){var n=this;if(!this.popupShowUpAnimation){var i=this.scale;this.popupShowUpAnimation=new Nh.A({targets:[this],delay:e,duration:t,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:i}},onComplete:function(){n.tweenScaleDownTextTitle.play(),n.tweenScaleUpTextScore.play()}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(e){var t=this,n=this.shareButton.scale;this.shareButton.setScale(0),this.tweenScaleUpButtonShare=this.scene.tweens.add({paused:!0,targets:[this.shareButton],scale:{from:0*n,to:1.2*n},delay:e,duration:100,onComplete:function(){t.tweenScaleDownButtonShare.play()}}),this.tweenScaleDownButtonShare=this.scene.tweens.add({paused:!0,targets:[this.shareButton],scale:{from:1.2*n,to:1*n},duration:66});var i=this.newGameButton.scale;this.newGameButton.setScale(0),this.tweenScaleUpButtonNewGame=this.scene.tweens.add({paused:!0,targets:[this.newGameButton],scale:{from:0*i,to:1.2*i},delay:e+66,duration:100,onComplete:function(){t.tweenScaleDownButtonNewGame.play()}}),this.tweenScaleDownButtonNewGame=this.scene.tweens.add({paused:!0,targets:[this.newGameButton],scale:{from:1.2*i,to:1*i},duration:66,onComplete:function(){t.newGameButton.runAnimation()}}),this.tweenScaleUpButtonShare.play(),this.tweenScaleUpButtonNewGame.play()},n.initScore=function(){var e=this.scene.player.getBestScore();this.bestScore=e,this.currentScore=0},n.updateScore=function(){var e=this.scene.storage.getState(),t=(0,fo.TW)(e),n=t.score,i=t.bestScore;if(void 0===n&&void 0===i){var a=(0,fo.ix)(e)[this.scene.player.getPlayerId()];n=(null==a?void 0:a.score)||0,i=this.scene.player.getBestScore()}this.bestScore=(i||0)<this.bestScore?this.bestScore:i||0,this.currentScore=n,this.updateData({bestScore:this.bestScore,currentScore:this.currentScore})},n.updateData=function(e){this.payload=e;var t=e.bestScore,n=e.currentScore;if(this.setBestScore(t),n<=t)return this.setCurrentScore(0),this.runScoreAnimation(),void(n>0?this.runScoreCounter():this.counterAnimation=null);this.runScoreCounter()},n.runScoreAnimation=function(){this.scoreAnimation.play()},n.createScoreAnimation=function(){this.scoreAnimation=new Ou({targets:[this.scoreText],props:{scale:{from:1,to:1.3}}})},n.runScoreCounter=function(){var e,t=this,n=this.payload,i=n.bestScore,a=n.currentScore;null==(e=this.counterAnimation)||e.remove(),this.counterAnimation=this.scene.tweens.addCounter({from:0,to:a,delay:700,duration:2e3,completeDelay:300,onUpdate:function(e){t.scene.audio.playSound(ja.A.SCORE_COUNT);var n=Math.floor(e.getValue());t.runScoreAnimation(),t.setCurrentScore(n)},onComplete:function(){t.setBestScore(i<a?a:i),t.setCurrentScore(a),i<a&&(t.scene.audio.playSound(ja.A.CONGRATULATION),t.runConfettiEffect())}})},n.setCurrentScore=function(e){this.scoreText.setText(""+e)},n.stopEmitter=function(){var e,t,n,i,a;null==(e=this.tweenCounterConfetti)||e.stop(),null==(t=this.confettiLeftEffect.emitter)||t.killAll(),null==(n=this.confettiRightEffect.emitter)||n.killAll(),null==(i=this.confettiLeftEffect.emitter)||i.setAlpha(1),null==(a=this.confettiRightEffect.emitter)||a.setAlpha(1),this.confettiLeftEffect.stop(),this.confettiRightEffect.stop()},n.stopAnim=function(){var e;null==(e=this.counterAnimation)||e.stop()},t}(Phaser.GameObjects.Container),Ju=Xu,qu=Fa.A.GAMEPLAY,Qu=qu.KEY,$u=qu.FRAME,ed=function(e){function t(t){var n;return(n=e.call(this,t,Qu,$u.BUTTON_RED_SMALL,60,66)||this).setName("Replay"),n.createIcon(),n}return(0,_.A)(t,e),t.prototype.createIcon=function(){var e=this.scene.make.image({key:Qu,frame:$u.ICON_RESTART});e.setWorldSize(28,28),this.add(e),Phaser.Display.Align.In.Center(e,this,-2,-4)},t}(Va.A),td=ed,nd=n(500),id=Fa.A.GAMEPLAY,ad=id.KEY,sd=id.FRAME,rd=function(e){function t(t){var n;return(n=e.call(this,t)||this).background=void 0,n.textTitle=void 0,n.textVS=void 0,n.replayButton=void 0,n.shareButton=void 0,n.newGameButton=void 0,n.playerScore=void 0,n.avatarMe=void 0,n.textScoreMe=void 0,n.avatarOpponent=void 0,n.textScoreOpponent=void 0,n.contents=void 0,n.popupShowUpAnimation=void 0,n.contentShowUpAnimation=void 0,n.popupFadeOutAnimation=void 0,n.myInfoBlock=void 0,n.tweenMyInfoBlock=void 0,n.opponentInfoBlock=void 0,n.tweenOpponentInfoBlock=void 0,n.tweenScaleDownTextTitle=void 0,n.tweenScaleUpTextTitle=void 0,n.iconCrown=void 0,n.tweenIconCrown=void 0,n.buttonClose=void 0,n.confettiLeftEffect=void 0,n.confettiRightEffect=void 0,n.tweenCounterConfetti=void 0,n.preContextId="",n.preOpponentInfo={},n.switchContext=function(){var e=(0,O.A)(D().mark((function e(t){var n,i;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=window.game.facebook,(i=FBInstant.context.getID())!==t||""===t){e.next=4;break}return e.abrupt("return",i);case 4:if(!t){e.next=8;break}return e.next=7,n.switchAsync(t);case 7:return e.abrupt("return",FBInstant.context.getID());case 8:return e.abrupt("return","");case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.clickReplay=(0,O.A)(D().mark((function e(){var t,i;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.preOpponentInfo,i=t.playerId,e.next=4,n.scene.storage.dispatch((0,nd.Aq)(i));case 4:if(""===n.preContextId){e.next=14;break}return e.prev=5,e.next=8,n.switchContext(n.preContextId);case 8:e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(5),n.scene.game.globalScene.screen.open(Ua.R8.NOTIFY_SCREEN,{message:"Sorry!, you can not rematch now!",duration:2500,loading:!1}),e.abrupt("return");case 14:return e.next=16,n.scene.storage.dispatch((0,oo.nK)(n.preOpponentInfo));case 16:n.runCloseAnimation();case 17:case"end":return e.stop()}}),e,null,[[5,10]])}))),n.clickShare=function(){n.scene.storage.dispatch((0,du.N_)(n.playerScore))},n.clickNewGame=(0,O.A)(D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.scene.storage.dispatch((0,oo.nv)());case 1:case"end":return e.stop()}}),e)}))),n.runConfettiEffect=function(){var e=n.scene.gameZone.width;n.confettiLeftEffect.stop(),n.confettiRightEffect.stop(),n.scene.children.bringToTop(n.confettiLeftEffect),n.scene.children.bringToTop(n.confettiRightEffect),n.confettiLeftEffect.run(1,0,-100),n.confettiRightEffect.run(1,0+e,-100),n.tweenCounterConfetti=n.scene.tweens.addCounter({delay:1e4,from:100,to:0,ease:Phaser.Math.Easing.Cubic.Out,duration:400,onUpdate:function(e){var t,i,a=e.getValue()/100;null==(t=n.confettiLeftEffect.emitter)||t.setAlpha(a),null==(i=n.confettiRightEffect.emitter)||i.setAlpha(a)},onComplete:function(){n.stopEmitter()}})},n.setSize(n.scene.gameZone.width,n.scene.gameZone.height),n.createTextTitle(),n.createMyInfoBlock(),n.createTextVS(),n.createOpponentInfoBlock(),n.createIconCrown(),n.createButtons(),n.createPopupContent(),n.createConfettiSmallAnimation(),n}(0,_.A)(t,e);var n=t.prototype;return n.createTextTitle=function(){var e=this;this.background=this.scene.make.image({key:ad,frame:sd.BUTTON_BLACK}),this.background.setWorldSize(273,78),this.add(this.background),this.textTitle=this.scene.make.image({key:ad,frame:sd.TEXT_WAITING}),this.textTitle.setWorldSize(139,27),this.add(this.textTitle),Phaser.Display.Align.In.TopCenter(this.background,this,0,-100),Phaser.Display.Align.In.Center(this.textTitle,this.background,0,-2);var t=this.background.scale;this.tweenScaleUpTextTitle=this.scene.tweens.add({paused:!0,targets:[this.background,this.textTitle],scale:{from:.75*t,to:1*t},alpha:{from:.5,to:1},duration:100}),this.tweenScaleDownTextTitle=this.scene.tweens.add({paused:!0,targets:[this.background,this.textTitle],scale:{from:1.2*t,to:.75*t},alpha:{from:0,to:.5},duration:100,onUpdate:function(){e.textTitle.setVisible(!0),e.background.setVisible(!0)},onComplete:function(){e.tweenScaleUpTextTitle.play()}})},n.createMyInfoBlock=function(){this.myInfoBlock=this.scene.add.container(),this.myInfoBlock.setAlpha(0),this.avatarMe=new xl(this.scene,{key:ad,frame:sd.AVATAR_FRAME,background:sd.AVATAR_BACKGROUND,width:78,height:80,borderWidth:0}),this.myInfoBlock.add(this.avatarMe),Phaser.Display.Align.In.Center(this.avatarMe,this.myInfoBlock,0,0);var e=this.scene.make.image({key:ad,frame:sd.PANEL_SCORE});e.setWorldSize(82,36),this.myInfoBlock.add(e),Phaser.Display.Align.In.Center(e,this.myInfoBlock,0,68),this.textScoreMe=this.scene.make.bitmapText({font:za.A.FONT_NUMBER.KEY,size:this.scene.fontSize(40),text:"7523",origin:{x:.5,y:.5}}),this.myInfoBlock.add(this.textScoreMe),Phaser.Display.Align.In.Center(this.textScoreMe,e,0,0),this.add(this.myInfoBlock),Phaser.Display.Align.In.Center(this.myInfoBlock,this,-100,-53),this.tweenMyInfoBlock=this.scene.tweens.add({targets:this.myInfoBlock,paused:!0,duration:200,delay:400,scale:{from:1.5,to:1},alpha:{from:0,to:1},ease:Phaser.Math.Easing.Bounce.Out})},n.createTextVS=function(){this.textVS=this.scene.make.image({key:ad,frame:sd.TEXT_VS}),this.textVS.setWorldSize(62,41),this.add(this.textVS),Phaser.Display.Align.In.Center(this.textVS,this,0,-54)},n.createOpponentInfoBlock=function(){this.opponentInfoBlock=this.scene.add.container(),this.opponentInfoBlock.setAlpha(0),this.avatarOpponent=new xl(this.scene,{key:ad,frame:sd.AVATAR_FRAME,background:sd.AVATAR_BACKGROUND,width:78,height:80,borderWidth:0}),this.opponentInfoBlock.add(this.avatarOpponent),Phaser.Display.Align.In.Center(this.avatarOpponent,this.opponentInfoBlock,0,0);var e=this.scene.make.image({key:ad,frame:sd.PANEL_SCORE});e.setWorldSize(82,36),this.opponentInfoBlock.add(e),Phaser.Display.Align.In.Center(e,this.opponentInfoBlock,0,68),this.textScoreOpponent=this.scene.make.bitmapText({font:za.A.FONT_NUMBER.KEY,size:this.scene.fontSize(40),text:"2264",origin:{x:.5,y:.5}}),this.opponentInfoBlock.add(this.textScoreOpponent),Phaser.Display.Align.In.Center(this.textScoreOpponent,e,0,0),this.add(this.opponentInfoBlock),Phaser.Display.Align.In.Center(this.opponentInfoBlock,this,100,-53),this.tweenOpponentInfoBlock=this.scene.tweens.add({targets:this.opponentInfoBlock,paused:!0,duration:200,delay:500,scale:{from:1.5,to:1},alpha:{from:0,to:1},ease:Phaser.Math.Easing.Bounce.Out})},n.createIconCrown=function(){this.iconCrown=this.scene.make.image({key:ad,frame:sd.ICON_CROWN}),this.iconCrown.setWorldSize(36,30),this.iconCrown.setVisible(!1),this.add(this.iconCrown);var e=this.iconCrown.scale;this.iconCrown.setScale(0),this.tweenIconCrown=this.scene.tweens.add({targets:this.iconCrown,paused:!0,duration:200,delay:300,scale:{from:1.5,to:e},alpha:{from:0,to:1},ease:"Power1"})},n.createButtons=function(){this.createButtonReplay(),this.createButtonShare(),this.createButtonNewGame()},n.createButtonReplay=function(){this.replayButton=new td(this.scene),this.replayButton.onClick=this.clickReplay,this.add(this.replayButton),Phaser.Display.Align.In.Center(this.replayButton,this,-92,118)},n.createButtonShare=function(){this.shareButton=new Bu(this.scene),this.shareButton.onClick=this.clickShare,this.shareButton.setVisible(!1),this.add(this.shareButton),Phaser.Display.Align.In.Center(this.shareButton,this,-92,118)},n.createButtonNewGame=function(){this.newGameButton=new Yu(this.scene),this.newGameButton.onClick=this.clickNewGame,this.add(this.newGameButton),Phaser.Display.Align.In.Center(this.newGameButton,this,33,118)},n.createConfettiSmallAnimation=function(){this.confettiLeftEffect=new Hu.A(this.scene,{speedX:{min:-20,max:100},rotate:{start:-1080,end:0}}),this.confettiRightEffect=new Hu.A(this.scene,{speedX:{min:20,max:-100},rotate:{start:0,end:1080}}),this.confettiLeftEffect.setDepth(Na.A.ON_TOP),this.confettiRightEffect.setDepth(Na.A.ON_TOP)},n.createPopupContent=function(){this.contents=this.scene.make.group({}),this.contents.addMultiple([this.replayButton])},n.runCloseAnimation=function(){console.log("CLose popup result"),this.runPopupExitsAnimation(0,200)},n.runPopupExitsAnimation=function(e,t){var n,i=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new Bh.A({targets:[this],delay:e,duration:t,props:{scale:0},onComplete:function(){i.setY(0)}})),null==(n=this.popupFadeOutAnimation)||n.play()},n.runOpenAnimation=function(){this.background.setVisible(!1),this.textTitle.setVisible(!1),this.scene.audio.playSound(ja.A.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runPopupContentEntrancesAnimation(300,500)},n.runPopupEntrancesAnimation=function(e,t){var n=this;if(!this.popupShowUpAnimation){var i=this.scale;this.popupShowUpAnimation=new Nh.A({targets:[this],delay:e,duration:t,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:i}},onComplete:function(){n.tweenScaleDownTextTitle.play()}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(e,t){this.contentShowUpAnimation||(this.contentShowUpAnimation=new Lh.A({targets:this.contents.getChildren(),duration:t,delay:this.scene.tweens.stagger(80,{start:e}),props:{alpha:{start:0,from:0,to:1}}})),this.contentShowUpAnimation.play()},n.getChallengeData=function(){var e=this.scene.storage.getState(),t=(0,fo.ix)(e),n=this.scene.player.getPlayer(),i=n.playerId,a=n.photo,s=(0,po.sp)(e),r=s.playerId,o=(0,po.sp)(e).photo;"10"===r&&(r=(0,po.eo)(e));var c=(0,po.pr)(e,{playerId:i}),l=(0,po.Bx)(e,{opponentId:r}),h=(t[i]||{}).score,u=void 0===h?0:h,d=(t[r]||{}).score,p=void 0===d?0:d;return this.playerScore=u,this.preOpponentInfo=s,{playerScore:u,opponentScore:p,isPlayerFinish:c,isOpponentFinish:l,playerPhoto:a,opponentPhoto:o,playerId:i,opponentId:r}},n.updateInfo=function(e){var t=e||this.getChallengeData(),n=t.isOpponentFinish,i=t.isPlayerFinish,a=t.opponentScore,s=t.playerScore;this.textScoreMe.setText(String(s));var r=0!=a?String(a):"";return this.textScoreOpponent.setText(r),this.replayButton.setVisible(!1),this.shareButton.setVisible(!1),i&&n?(i&&n&&window.isShowResultChallengeFromPost?(window.isShowResultChallengeFromPost=!1,this.replayButton.setVisible(!0)):this.shareButton.setVisible(!0),s===a?(this.iconCrown.setVisible(!1),this.textTitle.setFrame(sd.TEXT_YOU_DRAW),this.textTitle.setWorldSize(144,28),void this.scene.audio.playSound(ja.A.DRAW)):s>a?(this.textTitle.setFrame(sd.TEXT_YOU_WIN),this.textTitle.setWorldSize(118,28),this.iconCrown.setVisible(!0),Phaser.Display.Align.In.Center(this.iconCrown,this.myInfoBlock,0,-53),this.scene.audio.playSound(ja.A.WIN),void this.runConfettiEffect()):s<a?(this.textTitle.setFrame(sd.TEXT_YOU_LOSE),this.textTitle.setWorldSize(129,28),this.iconCrown.setVisible(!0),Phaser.Display.Align.In.Center(this.iconCrown,this.opponentInfoBlock,0,-53),void this.scene.audio.playSound(ja.A.LOSE)):void 0):(this.iconCrown.setVisible(!1),this.shareButton.setVisible(!0),this.textTitle.setFrame(sd.TEXT_WAITING),this.textTitle.setWorldSize(139,27),void this.scene.audio.playSound(ja.A.WAIT_OPPONENT))},n.stopEmitter=function(){var e,t,n,i,a;null==(e=this.tweenCounterConfetti)||e.stop(),null==(t=this.confettiLeftEffect.emitter)||t.killAll(),null==(n=this.confettiRightEffect.emitter)||n.killAll(),null==(i=this.confettiLeftEffect.emitter)||i.setAlpha(1),null==(a=this.confettiRightEffect.emitter)||a.setAlpha(1),this.confettiLeftEffect.stop(),this.confettiRightEffect.stop()},n.loadAvatars=function(e){var t=e||this.getChallengeData(),n=t.playerId,i=t.playerPhoto,a=t.opponentId,s=t.opponentPhoto;this.avatarMe.loadPhoto(n,i,5),this.avatarOpponent.loadPhoto(a,s,5)},n.runAnim=function(){this.myInfoBlock.setVisible(!0),this.opponentInfoBlock.setVisible(!0),this.iconCrown.setScale(0),this.tweenMyInfoBlock.play(),this.tweenOpponentInfoBlock.play(),this.tweenIconCrown.play(),this.newGameButton.runAnimation()},n.setPreContextId=function(e){this.preContextId=e},t}(Phaser.GameObjects.Container),od=rd,cd=function(e){return e[Qn]},ld=((0,Te.Mz)([function(e){return cd(e).leaderboardId}],(function(e){return e})),(0,Te.Mz)([function(e){return cd(e).limit}],(function(e){return e})),(0,Te.Mz)([function(e){return cd(e).offset}],(function(e){return e})),(0,Te.Mz)([function(e){return cd(e).leaders}],(function(e){return e}))),hd=((0,Te.Mz)([function(e){return cd(e).type}],(function(e){return e})),(0,Te.Mz)([function(e){return cd(e).isRequesting}],(function(e){return e})),n(93)),ud=n.n(hd),dd=n(145),pd=n.n(dd);n(227),n(497);GameCore.Configs.LeadersBoard;var fd=function(){function e(){this.previousMode="single",this.preContextId="",this.playerScore=0,this.opponentScore=0,this.isPlayerFinish=!1,this.isOpponentFinish=!1,this.playerPhoto="",this.opponentPhoto="",this.playerId="",this.opponentId=""}var t=e.prototype;return t.fetchNewChallengeData=function(){return 0},t.getChallengeData=function(){return{playerScore:this.playerScore,opponentScore:this.opponentScore,isPlayerFinish:this.isPlayerFinish,isOpponentFinish:this.isOpponentFinish,playerPhoto:this.playerPhoto,opponentPhoto:this.opponentPhoto,playerId:this.playerId,opponentId:this.opponentId}},t.setChallengeData=function(e){this.playerScore=e.playerScore,this.opponentScore=e.opponentScore,this.isPlayerFinish=e.isPlayerFinish,this.isOpponentFinish=e.isOpponentFinish,this.playerPhoto=e.playerPhoto,this.opponentPhoto=e.opponentPhoto,this.playerId=e.playerId,this.opponentId=e.opponentId},e}(),md=fd,gd=(GameCore.Configs.LeadersBoard,Fa.A.DEFAULT),vd=gd.KEY,yd=gd.FRAME,Ad=function(e){function t(t){var n;return(n=e.call(this,t)||this).backgroundDark=void 0,n.coralLeft=void 0,n.coralRight=void 0,n.bestScore=void 0,n.leadersBar=void 0,n.panelBottom=void 0,n.popupYourScore=void 0,n.popupResult=void 0,n.tweenMoveUpLeaderBar=void 0,n.gameOverData=new md,n.panelOriginY=0,n.setSizeContainer(),n.scene=t,n.createBackgroundDark(),n.createCorals(),n.createPopups(),n.createTweenMoveUpLeaderBar(),n}(0,_.A)(t,e);var n=t.prototype;return n.setSizeContainer=function(){var e=this.scene.gameZone,t=e.width,n=e.height;this.setSize(t,n)},n.createBackgroundDark=function(){var e=this.scene.gameZone,t=e.width,n=e.height;this.backgroundDark=this.scene.make.image({key:Ga.A.BACKGROUND_DARK.KEY}),this.backgroundDark.setWorldSize(t,n),this.add(this.backgroundDark)},n.createCorals=function(){this.coralLeft=this.scene.make.image({key:vd,frame:yd.CORAL_LEFT}),this.coralLeft.setWorldSize(62,189),this.coralRight=this.scene.make.image({key:vd,frame:yd.CORAL_RIGHT}),this.coralRight.setWorldSize(67,170),this.add([this.coralLeft,this.coralRight]),Phaser.Display.Align.In.TopLeft(this.coralLeft,this.backgroundDark,0,0),Phaser.Display.Align.In.TopRight(this.coralRight,this.backgroundDark,0,0)},n.createBgLeaders=function(){this.panelBottom=new pl.A(this.scene,0,0,336,84,"panel"),this.panelBottom.setVisible(!1),this.add(this.panelBottom),Phaser.Display.Align.In.BottomCenter(this.panelBottom,this,0,-155),this.panelOriginY=this.panelBottom.y},n.createLeadersBar=function(){this.leadersBar=new wu(this.scene),Phaser.Display.Align.In.Center(this.leadersBar,this.panelBottom,0,-34),this.add(this.leadersBar)},n.createPopups=function(){this.createPopupYourScore(),this.createPopupResult()},n.createPopupYourScore=function(){this.popupYourScore=new Ju(this.scene),this.popupYourScore.setVisible(!1),this.add(this.popupYourScore)},n.createPopupResult=function(){this.popupResult=new od(this.scene),this.popupResult.setVisible(!1),this.add(this.popupResult),Phaser.Display.Align.In.Center(this.popupResult,this,0,-61)},n.createTweenMoveUpLeaderBar=function(){var e=this;this.tweenMoveUpLeaderBar=this.scene.tweens.add({paused:!0,targets:[this.panelBottom],y:{from:this.panelOriginY+200,to:this.panelOriginY},duration:300,onUpdate:function(){e.panelBottom.setVisible(!0)}})},n.registerEvents=function(){this.scene.world.events.on(on.A.RESIZE,this.handleResizeEvent,this)},n.unregisterEvents=function(){this.scene.world.events.off(on.A.RESIZE,this.handleResizeEvent,this)},n.handleResizeEvent=function(){var e=this.scene.world.getWorldSize(),t=e.width,n=e.height;this.backgroundDark.setWorldSize(t,n),Phaser.Display.Align.In.TopLeft(this.coralLeft,this.backgroundDark,0,0),Phaser.Display.Align.In.TopRight(this.coralRight,this.backgroundDark,0,0)},n.onOpen=function(e){var t,n,i,a,s=this;this.handleResizeEvent(),this.registerEvents();var r=e||{},o=r.shouldPlayAnim,c=void 0!==o&&o,l=r.fromTab,h=void 0===l?-1:l;this.popupYourScore.setVisible(!1),this.popupResult.setVisible(!1),c&&(null==(t=this.panelBottom)||t.setVisible(!1)),this.initScore(),c&&(null==(n=this.leadersBar)||n.killAndHideAll()),this.updateScore(),c&&this.updateLeaders();var u=this.scene.storage.getState(),d=(0,uo.qs)(u);console.log("Show popup"),1!=h&&"single"===this.gameOverData.previousMode?this.showPopupYourScore(c):1!=h&&"challenge"===this.gameOverData.previousMode?this.showPopupResult(c,this.gameOverData.getChallengeData()):!d||g()(i=[ho.Nu,ho.zA]).call(i,d)>=0?(console.log("Show popup your score"),this.showPopupYourScore(c)):g()(a=[ho.Ee,ho.QT]).call(a,d)>=0?(console.log("Show popup result"),this.showPopupResult(c)):(console.log("Show popup your score 111"),this.showPopupYourScore(c)),c&&this.scene.time.delayedCall(2e3,(function(){s.scene.postSessionScore()}))},n.onClose=function(){var e,t;this.unregisterEvents(),null==(e=this.popupYourScore)||e.stopAnim(),null==(t=this.popupYourScore)||t.stopEmitter()},n.alignComponents=function(){},n.initScore=function(){var e=this.scene.player.getBestScore();this.bestScore=e},n.updateScore=function(){var e=this.scene.storage.getState(),t=(0,fo.TW)(e),n=t.score,i=t.bestScore;if(this.bestScore=i,void 0===n||void 0===i){var a=(0,fo.ix)(e)[this.scene.player.getPlayerId()];n=(null==a?void 0:a.score)||0,i=this.scene.player.getBestScore()||0}this.bestScore=i<this.bestScore?this.bestScore:i||0},n.updateLeaders=function(){},n.getLeadersExcludeIds=function(e){var t=this.scene.storage.getState(),n=ld(t),i={};if(!e||0===e.length)return n;for(var a in n)if(g()(e).call(e,a)<0){var s=n[a],r=s.playerId,o=s.photo,c=s.score,l=s.rank,h=s.name;i[a]={playerId:r,photo:o,score:c,rank:l,name:h}}return i},n.updateLeaderBar=function(e){var t={playerId:this.scene.player.getPlayerId(),leaders:[]};for(var n in t.leaders.push({playerId:"button-add-friend",photo:"",rank:-1,score:-1,name:""}),e){if(t.leaders.length>=5)break;var i=e[n],a=i.playerId,s=i.photo,r=i.score,o=void 0===r?0:r,c=i.rank,l=i.name;this.isLeadersHasItem(t.leaders,a)||t.leaders.push({playerId:a,photo:s,score:o,rank:c,name:l})}t.leaders.push({playerId:"button-plus",photo:"",rank:-1,score:-1,name:""}),this.leadersBar.updateInfo(t)},n.isLeadersHasItem=function(e,t){if(!e||0===e.length)return!1;var n=f()(e).call(e,(function(e){return e.playerId===t}));return n&&n.length>0},n.showPopupYourScore=function(e){this.popupYourScore.setVisible(!0);var t=this.scene.screen.get(Ua.R8.RESULT_SCREEN),n=(null==t?void 0:t.getShouldUpdateScoreAnimForTournament())||!1;(e||n)&&(this.popupYourScore.updateScore(),null==t||t.setShouldUpdateScoreAnimForTournament()),e&&(this.popupYourScore.runOpenAnimation(),this.gameOverData.previousMode="single",this.gameOverData.preContextId="")},n.showPopupResult=function(e,t){this.popupResult.setVisible(!0),e&&(this.popupResult.runOpenAnimation(),this.popupResult.updateInfo(t),this.popupResult.loadAvatars(t),this.popupResult.runAnim(),this.popupResult.setPreContextId(this.gameOverData.preContextId),this.gameOverData.setChallengeData(this.popupResult.getChallengeData()),this.gameOverData.previousMode="challenge",this.gameOverData.preContextId=FBInstant.context.getID()||"")},n.playTweenMoveUpLeaderBar=function(){this.tweenMoveUpLeaderBar.play()},t}(cu),Ed=Ad,Td=Ed,Sd=n(655),bd=n.n(Sd),Pd=Fa.A.DEFAULT,Cd=Pd.KEY,wd=Pd.FRAME,Id=function(e){function t(t){var n;return(n=e.call(this,t)||this).endTime=void 0,n.countdownTimer=void 0,n.timerText=void 0,n.comingSoonText=void 0,n.updateCountdown=function(){var e=n.scene.journeySeason.getDateNow(),t=1e3*n.endTime-e;if(t<=0)return n.timerText.kill(),void n.comingSoonText.revive();var i=Math.floor(Math.abs(t)/864e5);t-=864e5*i;var a=Math.floor(Math.abs(t)/36e5);t-=36e5*a;var s=Math.floor(Math.abs(t)/6e4);t-=6e4*s;for(var r=[i,a,s,Math.round(Math.abs(t)/1e3)],o="Time left: ",c=["D","H","M","S"],l=0,h=0;h<r.length;h++){var u=r[h];if(0!=u&&(l++,o+=""+u+c[h]+" "),2==l)break}o=bd()(o).call(o),n.timerText.setText(o)},n.createBackground(),n.createTimerContainer(),n.createComingSoonText(),n.createCountdownTimer(),t.add.existing((0,ka.A)(n)),n}(0,_.A)(t,e);var n=t.prototype;return n.createBackground=function(){var e=this.scene.make.image({key:Cd,frame:wd.TIME_PANEL});e.setWorldSize(106,18),this.add(e);var t=this.scene.make.image({key:Cd,frame:wd.ICON_CLOCK});t.setWorldSize(21,22.5),this.add(t),Phaser.Display.Align.In.LeftCenter(t,e,2,0)},n.createTimerContainer=function(){this.timerText=this.scene.make.bitmapText({font:za.A.MIKADO_YELLOW.KEY,size:this.scene.fontSize(23),origin:{x:.5,y:.5}}),this.add([this.timerText]),Phaser.Display.Align.In.Center(this.timerText,this,7,0)},n.createComingSoonText=function(){this.comingSoonText=this.scene.make.bitmapText({font:za.A.MIKADO_YELLOW.KEY,size:this.scene.fontSize(25),origin:{x:.5,y:.5},text:"Coming soon"}),this.comingSoonText.kill(),this.add(this.comingSoonText),Phaser.Display.Align.In.Center(this.comingSoonText,this,6,1)},n.createCountdownTimer=function(){var e;void 0!=this.endTime&&(null==(e=this.countdownTimer)||e.destroy(),this.countdownTimer=this.scene.time.addEvent({loop:!0,delay:1e3,startAt:1e3,callback:this.updateCountdown}))},n.setCountdown=function(e){this.endTime=e,this.createCountdownTimer()},t}(Phaser.GameObjects.Container),xd=Id,kd=Fa.A.DEFAULT,Od=kd.KEY,_d=kd.FRAME,Rd=function(e){function t(t){var n;return(n=e.call(this,t)||this).background=void 0,n.title=void 0,n.addBackground(),n.addTitle(),n.scene.add.existing((0,ka.A)(n)),n.alignUI(),n.setInteractive(),n}(0,_.A)(t,e);var n=t.prototype;return n.addBackground=function(){this.background=this.scene.make.image({key:Od,frame:_d.TOP_PANEL}),this.add(this.background)},n.alignUI=function(){var e=this.scene.gameZone.width;this.background.setWorldSize(e,79.5),this.setSize(e,79.5);var t=this.x,n=this.y;this.setPosition(0,0),Phaser.Display.Align.In.TopCenter(this.background,this),this.setPosition(t,n)},n.alignComponents=function(){this.alignUI(),this.input&&this.input.hitArea&&this.input.hitArea.setSize(this.width,this.height)},n.addTitle=function(){this.title=this.scene.make.image({key:Od}),this.add(this.title)},n.setTitle=function(e){this.title.setFrame(e)},n.setTitleSize=function(e,t){this.title.setWorldSize(e,t),Phaser.Display.Align.In.Center(this.title,this.background,0,-15)},t}(Phaser.GameObjects.Container),Dd=Fa.A.DEFAULT,Md=Dd.KEY,Bd=Dd.FRAME,Ld=function(e){function t(t){var n;return(n=e.call(this,t,Md,Bd.BUTTON_CONTINUE,173,66)||this).animation=void 0,n.setName("Play Journey"),n.createIcon(),n.createText(),n}(0,_.A)(t,e);var n=t.prototype;return n.createIcon=function(){var e=this.scene.make.image({key:Md,frame:Bd.ICON_NEXT});e.setWorldSize(24,29),this.add(e),Phaser.Display.Align.In.Center(e,this,-25,-5)},n.createText=function(){var e=this.scene.make.image({key:Md,frame:Bd.TEXT_PLAY});e.setWorldSize(41,24),this.add(e),Phaser.Display.Align.In.Center(e,this,16,-4)},n.runAnimation=function(){var e,t,n=this;null==(e=this.animation)||e.remove(),this.animation=new Fu({targets:[this],props:{scale:{from:1,to:1.05}}}),null==(t=this.animation)||t.play(),this.hitZone.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,(function(){var e;null==(e=n.animation)||e.stop()})),this.hitZone.on(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,(function(){var e,t;null!=(e=n.animation.tween)&&e.isPlaying()||null==(t=n.animation)||t.play()}))},t}(Va.A),Nd=Ld,Gd=n(507),Fd=n(672),Ud=n(674),jd=(function(e){function t(t){var n;return(n=e.call(this,t,"UpdateAbleObject")||this).updateInfo=void 0,n}(0,_.A)(t,e)}(Phaser.GameObjects.GameObject),function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).classType=void 0,i.listConfigs=void 0,i.padding=void 0,i.startObjectIndex=void 0,i.endObjectIndex=void 0,i.listObjects=void 0,i.classType=n.classType,i.listConfigs=n.listConfigs,i.padding=n.padding?n.padding:0,i.objects.classType=i.classType,i.updateConfig(i.listConfigs),i}(0,_.A)(t,e);var n=t.prototype;return n.reset=function(){e.prototype.reset.call(this),this.killAndHideAll()},n.getChildren=function(){var e;return f()(e=this.listObjects).call(e,(function(e){return void 0!=e&&e.active}))},n.updateConfig=function(e){var t;this.reset(),this.listConfigs=e,this.listObjects=Da()(t=new Array(e.length)).call(t,void 0),this.addObjectIndex(0,0);var n=this.getEndObjectIndex();this.addObjectIndex(1,n),this.startObjectIndex=this.getStartObjectIndex(),this.endObjectIndex=this.getEndObjectIndex(),this.updateMaxHeight(),this.value=this.marginTop},n.killAndHideAll=function(){var e,t=this;this.listObjects instanceof Array&&Be()(e=this.listObjects).call(e,(function(e){void 0!==e&&t.objects.killAndHide(e)}))},n.setItemPosition=function(e,t){var n=e.height;e.setPosition(0,n/2+(n+this.padding)*t-this.height/2)},n.updateMaxHeight=function(){return this.maxValue=Math.max(this.listConfigs.length*(this.objHeight+this.padding)-this.padding+this.marginBottom-this.height,-this.marginTop)},n.updateObject=function(t){e.prototype.updateObject.call(this,t);for(var n=this.getStartObjectIndex(),i=this.getEndObjectIndex(),a=this.startObjectIndex;a<=this.endObjectIndex;a++)(a<n||a>i)&&this.killObjectIndex(a,a);for(var s=n;s<=i;s++)(s<this.startObjectIndex||s>this.endObjectIndex)&&this.addObjectIndex(s,s);this.startObjectIndex=n,this.endObjectIndex=i},n.killObjectIndex=function(e,t){for(var n=e;n<=t;n++){var i=this.listObjects[n];i&&(this.objects.killAndHide(i),this.listObjects[n]=void 0)}},n.addObjectIndex=function(e,t){for(var n=e;n<=t;n++){var i=this.padding,a=this.listConfigs;if(n>=a.length)return;var s=this.objects.getFirstDead(!0),r=s.height,o=r/2+(r+i)*n+this.value-this.height/2;s.updateInfo(a[n]),s.setPosition(0,o),s.setActive(!0),s.setVisible(!0),this.addAt(s),this.listObjects[n]=s}},n.getStartObjectIndex=function(){var e=this.objHeight,t=this.padding;return Math.max(Math.floor((0-this.value)/(e+t)),0)},n.getEndObjectIndex=function(){var e=this.objHeight,t=this.padding,n=this.listConfigs,i=e+t;return Math.min(Math.floor((this.height-this.value)/i),n.length)},(0,ve.A)(t,[{key:"objHeight",get:function(){var e=this.objects.getChildren();return 0==e.length?this.maxValue=0:e[0].height}}]),t}(Ud.A)),Vd=function(e){function t(t,n){return e.call(this,t,n)||this}(0,_.A)(t,e);var n=t.prototype;return n.updateObject=function(t){e.prototype.updateObject.call(this,t);for(var n=this.getStartObjectIndex(),i=this.getEndObjectIndex(),a=this.startObjectIndex;a<=this.endObjectIndex;a++)(a<n||a>i)&&this.killObjectIndex(a,a);for(var s=n;s<=i;s++)(s<this.startObjectIndex||s>this.endObjectIndex)&&this.addObjectIndex(s,s);this.startObjectIndex=n,this.endObjectIndex=i,this.bringToTopPreviousElement()},n.bringToTopPreviousElement=function(){if(this.listObjects)for(var e=this.getChildren(),t=e.length-1;t>=0;t--){var n=e[t];this.bringToTop(n)}},n.getMaxValue=function(){return this.maxValue},t}(jd),zd=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.scroller=void 0,n.particle=void 0,n.bubbleWaterEmitter=void 0,n.scene=t,n.setSizeContainer(),n.createReuseScroller(),n.createBubbleWaterEmitter(),n.scene.add.existing((0,ka.A)(n)),n}(0,_.A)(t,e);var n=t.prototype;return n.setSizeContainer=function(){var e=this.scene.world.getWorldSize(),t=e.width,n=e.height;this.setSize(t,n)},n.createReuseScroller=function(){var e=this.scene.ads.getBannerHeight();this.scroller=new Vd(this.scene,{classType:Fd.A,listConfigs:[],width:this.width,height:this.height,padding:0,marginTop:80,marginBottom:e+tu+100,maxScrollOver:.3,scrollingBackRate:5}),this.add(this.scroller)},n.updateData=function(e){var t=this.scene.storage.getState();console.log("updateData",t,e);for(var n=(0,po.IP)(t)||1,i=[],a=Math.ceil(Gd.A.length/4),s=0;s<a;s++)i.push({index:a-s-1,currentLevel:n,runAnimationJourney:e,roadLevelParticle:this.particle,bubbleWaterEmitter:this.bubbleWaterEmitter});this.scroller.updateConfig(i),this.scroller.value=this.getScrollerValueByLevel(n),this.showLeaders()},n.getScrollerValueByLevel=function(e){var t=this.scene.ads.getBannerHeight(),n=this.scroller.getChildren()[0].height,i=t+tu+100,a=this.scroller.getMaxValue(),s=-a-i+n*(e/4);return a+s<0&&(s=-a),s},n.removeLevelItems=function(){this.scroller.updateConfig([])},n.getLevelItems=function(){return this.scroller.getChildren()},n.showLeaders=function(){var e=this.getLevelItems();if(!(e.length<1)){for(var t=e.length>8?8:e.length,n=0;n<t;n++){var i=e[n];if(!i)return;i.setVisible(!0)}this.scroller.setEnable(!0)}},n.createBubbleWaterEmitter=function(){this.particle=this.scene.add.particles(Fa.A.EFFECTS.KEY),this.particle.setDepth(Na.A.ON_TOP),this.add(this.particle),this.bubbleWaterEmitter=this.particle.createEmitter({on:!1,angle:{start:0,end:360,steps:8},frame:[Fa.A.EFFECTS.FRAME.BUBBLE_WATER],lifespan:1500,quantity:1,scale:{min:.2,max:.4,end:0},accelerationX:{min:-400,max:400},accelerationY:{min:-400,max:400},alpha:{start:1,end:0,ease:"Quart.easeIn"},speed:100})},n.alignComponents=function(){var e=this.scene.world.getWorldSize(),t=e.width,n=e.height;this.setSize(t,n),this.scroller.setSize(t,n),this.scroller.input.hitArea.setSize(t,n)},t}(Phaser.GameObjects.Container),Yd=zd,Hd=Fa.A.DEFAULT,Kd=Hd.KEY,Wd=Hd.FRAME,Zd=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.currentIdx=0,n.header=void 0,n.journeyScroller=void 0,n.buttonSetting=void 0,n.timerContainer=void 0,n.buttonPlayJourney=void 0,n.bg=void 0,n.onClickButtonPlayJourney=function(){n.scene.storage.dispatch((0,oo.ST)({mode:ho.Nu,status:zn.Sr})),n.scene.journeyGameplay.startGame(),n.scene.showJourneyGameplay(),n.scene.screen.close(Ua.R8.RESULT_SCREEN)},n.scene=t,n.createBackground(),n.createMain(),n.createHeader(),n.createButtonSetting(),n.createButtonPlayJourney(),n.addTimerContainer(),t.add.existing((0,ka.A)(n)),n.alignUI(),n.listenEvents(),n}(0,_.A)(t,e);var n=t.prototype;return n.listenEvents=function(){var e=this;go.A.on(ro.A.START_JOURNEY_ANIM,(function(){e.buttonPlayJourney.kill(),e.buttonPlayJourney.animation.stop()})),go.A.on(ro.A.END_JOURNEY_ANIM,(function(){e.buttonPlayJourney.revive(),e.buttonPlayJourney.setAlpha(0),e.scene.add.tween({targets:e.buttonPlayJourney,alpha:1,ease:Phaser.Math.Easing.Linear,duration:300}),e.buttonPlayJourney.runAnimation()}))},n.createBackground=function(){var e=this.scene.make.image({key:Ga.A.BACKGROUND_TAB.KEY});this.add(e),this.bg=e},n.createHeader=function(){this.header=new Rd(this.scene),this.header.setTitle(Wd.TEXT_JOURNEY),this.header.setTitleSize(130,26),this.add(this.header)},n.createButtonSetting=function(){this.buttonSetting=new Va.A(this.scene,Kd,Wd.ICON_SETTINGS,27,29),this.buttonSetting.setVisible(!1),this.buttonSetting.onClick=this.scene.handlePauseGame,this.add(this.buttonSetting)},n.createButtonPlayJourney=function(){this.buttonPlayJourney=new Nd(this.scene),this.buttonPlayJourney.onClick=this.onClickButtonPlayJourney,this.add(this.buttonPlayJourney)},n.addTimerContainer=function(){this.timerContainer=new xd(this.scene),this.add(this.timerContainer)},n.createMain=function(){this.journeyScroller=new Yd(this.scene),this.add(this.journeyScroller)},n.runAnimationBubble=function(){this.buttonPlayJourney.runAnimation()},n.alignUI=function(){var e=this.x,t=this.y;this.setPosition(0,0),this.setSize(this.scene.gameZone.width,this.scene.gameZone.height),this.bg.setWorldSize(this.scene.gameZone.width,this.scene.gameZone.height),Phaser.Display.Align.In.TopCenter(this.header,this,0,0),Phaser.Display.Align.In.RightCenter(this.buttonSetting,this.header,-22,-5),Phaser.Display.Align.In.TopCenter(this.timerContainer,this,0,-50);var n=this.scene.ads.getBannerHeight();Phaser.Display.Align.In.Center(this.journeyScroller,this),Phaser.Display.Align.In.BottomCenter(this.buttonPlayJourney,this,0,-n-73),this.setPosition(e,t)},n.alignComponents=function(){this.alignUI(),this.header.alignComponents(),this.journeyScroller.alignComponents()},t}(Phaser.GameObjects.Container),Xd=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.currentIdx=0,n.journeyLevel=void 0,n.scene=t,n.createJourneyLevel(),t.add.existing((0,ka.A)(n)),n.alignUI(),n.listenEvents(),n}(0,_.A)(t,e);var n=t.prototype;return n.createJourneyLevel=function(){this.journeyLevel=new Zd(this.scene),this.add(this.journeyLevel)},n.listenEvents=function(){var e=this;go.A.on(ro.A.UPDATE_SCROLLER_DATA,(function(){console.log("UPDATE_SCROLLER_DATA"),e.journeyLevel.journeyScroller.updateData(!1)}))},n.onOpen=function(e){var t=this.journeyLevel,n=t.journeyScroller,i=t.timerContainer,a=this.scene.journeySeason.getTimeEnd(),s=!1;if(e){var r=e.fromTab,o=void 0===r?void 0:r,c=e.shouldPlayAnim;2==o&&(void 0!==c&&c)&&!this.scene.journeyGameplay.replayPreviousLevel&&(s=!0)}console.log("onOpen",e),n.updateData(s),i.setCountdown(a),this.journeyLevel.runAnimationBubble()},n.onClose=function(){},n.alignUI=function(){this.setSize(this.scene.gameZone.width,this.scene.gameZone.height)},n.alignComponents=function(){this.alignUI(),this.journeyLevel.alignComponents()},t}(cu),Jd=Xd,qd=Jd,Qd=n(169),$d=n.n(Qd),ep=Fa.A.DEFAULT,tp=ep.KEY,np=ep.FRAME,ip=function(e){function t(t){var n;return(n=e.call(this,t)||this).background=void 0,n.title=void 0,n.buttonSetting=void 0,n.addBackground(),n.addTitle(),n.createButtonSetting(),n.alignUI(),n.scene.add.existing((0,ka.A)(n)),n.setInteractive(),n}(0,_.A)(t,e);var n=t.prototype;return n.addBackground=function(){this.background=this.scene.make.image({key:tp,frame:np.TOP_PANEL}),this.add(this.background)},n.addTitle=function(){this.title=this.scene.make.image({key:tp}),this.add(this.title)},n.setTitle=function(e){this.title.setFrame(e)},n.setTitleSize=function(e,t){this.title.setWorldSize(e,t),Phaser.Display.Align.In.Center(this.title,this,2,-6.5)},n.alignUI=function(){var e=this.scene.gameZone.width;this.background.setWorldSize(e,79.5),this.setSize(e,79.5);var t=this.x,n=this.y;this.setPosition(0,0),Phaser.Display.Align.In.TopCenter(this.background,this),this.setPosition(t,n)},n.alignComponents=function(){var e=this.scene.gameZone.width;this.alignUI(),this.input&&this.input.hitArea&&this.input.hitArea.setSize(e,79.5)},n.createButtonSetting=function(){this.buttonSetting=new Va.A(this.scene,tp,np.ICON_SETTINGS,28,30.5),this.add(this.buttonSetting),this.buttonSetting.setPosition(149,-5),this.buttonSetting.kill()},(0,ve.A)(t,[{key:"btnSettingOnClick",set:function(e){this.buttonSetting.onClick=e}}]),t}(Phaser.GameObjects.Container),ap=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="TournamentPayloadInvalid",i.message=t||"The tournament payload invalid",i.payload=n,i}return(0,_.A)(t,e),t}((0,$.A)(Error)),sp=ap,rp=function(e){function t(t,n,i,a,s,r){var o;return void 0===r&&(r=!1),(o=e.call(this,t)||this).useSound=!0,o.isClicked=!1,o.boundTop=void 0,o.boundBottom=void 0,o.scaleUp=-1,o.scaleDown=-1,o.button=void 0,o.upAnimation=void 0,o.downAnimation=void 0,o.isUsePixelPerfect=!1,o.hitArea=void 0,o.hitZone=void 0,o.scaleDownPress=void 0,o.parentName=void 0,o.handelObjectDestroy=function(){o.scene&&o.scene.events.off(Phaser.Scenes.Events.SLEEP,o.handleSceneSleep)},o.handleSceneSleep=function(){o.scene&&o.scene.tweens.killTweensOf((0,ka.A)(o))},o.handleDrag=function(){o.isClicked=!1,o.runUpAnimation()},o.handlePointerDown=function(e){var t;o.isClicked||null!=(t=o.upAnimation)&&null!=(t=t.tween)&&t.isPlaying()||(o.isClicked=!0,o.runDownAnimation(),o.boundTop&&o.boundBottom&&(e.worldY<o.boundTop||e.worldY>o.boundBottom)&&(o.isClicked=!1))},o.handleOnClick=function(e){return function(){var t,n;if(o.isClicked){var i;if(null!=(t=o.upAnimation)&&null!=(t=t.tween)&&t.isPlaying())null==(i=o.upAnimation)||i.stop();o.isClicked=!1,o.runUpAnimation(),null==(n=o.upAnimation)||null==(n=n.tween)||n.once(Phaser.Tweens.Events.TWEEN_COMPLETE,(function(){o.logButtonEvent(),o.addDebugData(),o.processCallback(e)}))}}},o.handlePointerOut=function(){var e;o.isClicked&&(null!=(e=o.upAnimation)&&null!=(e=e.tween)&&e.isPlaying()||(o.isClicked=!1,o.runUpAnimation()))},o.runDownAnimation=function(){var e;-1===o.scaleDown&&(o.scaleUp=o.scale,o.scaleDown=o.scaleDownPress),o.useSound&&o.scene.audio.playSound(ja.A.BUTTON_CLICK),null==(e=o.downAnimation)||e.remove(),o.downAnimation=new Fh.A({targets:[(0,ka.A)(o)],duration:150,props:{scale:o.scaleDown},onUpdate:function(){o.hitZone.scale=1/o.scale}}),o.downAnimation.play()},o.runUpAnimation=function(){var e;-1!==o.scaleUp&&(null==(e=o.upAnimation)||e.remove(),o.upAnimation=new Fh.A({targets:[(0,ka.A)(o)],duration:150,props:{scale:o.scaleUp},onUpdate:function(){o.hitZone.scale=1/o.scale}}),o.upAnimation.play())},o.isUsePixelPerfect=r,o.setDepth(Na.A.BUTTON),o.createButton(n,i,a,s),o.updateSize(),o.listenEvents(),o.scene.add.existing((0,ka.A)(o)),o}(0,_.A)(t,e);var n=t.prototype;return n.listenEvents=function(){this.scene.events.on(Phaser.Scenes.Events.SLEEP,this.handleSceneSleep),this.once(Phaser.GameObjects.Events.DESTROY,this.handelObjectDestroy)},n.setBound=function(e,t){this.boundTop=e,this.boundBottom=t},n.processCallback=function(e){var t,n,i;null==(t=this.upAnimation)||t.stop(),null==(n=this.downAnimation)||n.stop(),null==(i=this.scene)||i.tweens.killTweensOf(this),-1!==this.scaleUp&&this.setScale(this.scaleUp),e()},n.setDisabled=function(e){var t,n;e?(this.setAlpha(.5),null==(t=this.hitArea)||t.disableInteractive()):(this.setAlpha(1),null==(n=this.hitArea)||n.setInteractive())},n.createButton=function(e,t,n,i){this.button=this.scene.add.image(0,0,e,t),n&&i&&this.button.setWorldSize(n,i),this.scaleDownPress=this.scale-.1;var a=this.button,s=a.displayWidth,r=a.displayHeight;this.hitZone=this.scene.make.zone({displayWidth:s,displayHeight:r}),this.add([this.button,this.hitZone])},n.updateSize=function(){var e=this.button,t=e.width,n=e.height,i=t/100*10,a=n/100*10,s=i<10?i:10,r=a<10?a:10;this.setSize(t+s,n+r),this.hitZone.setSize(t+s,n+r)},n.addDebugData=function(){var e=this.getParentName(),t=this.name;(0,x.SJ)("ui-click",e+":"+t)},n.logButtonEvent=function(){var e=this.getParentName(),t=this.name;this.scene.analytics.event(rn.o.BUTTON_CLICK,{button_name:t,screen_name:e})},n.getParentName=function(){if(this.parentName)return this.parentName;for(var e=this.parentContainer;e;){if(e instanceof GameCore.Screen){var t=e;return this.parentName=t.getScreenName(),this.parentName}e=e.parentContainer}return this.parentName=this.scene.getSceneName(),this.parentName},(0,ve.A)(t,[{key:"onClick",set:function(e){this.isUsePixelPerfect?(this.hitArea=this.button,this.hitArea.setInteractive({useHandCursor:!0,pixelPerfect:!0})):(this.hitArea=this.hitZone,this.updateSize(),this.hitArea.setInteractive({useHandCursor:!0})),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.handlePointerDown),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,this.handleOnClick(e)),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,this.handlePointerOut),this.scene.input.on(Phaser.Input.Events.DRAG_START,this.handleDrag)}},{key:"isUsePixelPerFect",get:function(){return this.isUsePixelPerfect}}]),t}(Phaser.GameObjects.Container),op=rp,cp={HEADER:{HEIGHT:48},FOOTER:{HEIGHT:66},PUZZLES:{TITLE:{HEIGHT:25}}},lp=Fa.A.DEFAULT,hp=lp.KEY,up=lp.FRAME,dp=function(e){function t(t,n,i){var a;return(a=e.call(this,t,n,i)||this).topMiddle=void 0,a.middleLeft=void 0,a.middleMiddle=void 0,a.middleRight=void 0,a.bottomMiddle=void 0,a.underMiddle=void 0,a.loadingRing=void 0,a.handleLoadComplete=function(e){a.middleMiddle.setTexture(e),a.middleMiddle.setWorldSize(a.topMiddle.displayWidth-a.middleLeft.displayWidth-a.middleRight.displayWidth,a.topMiddle.displayHeight+a.bottomMiddle.displayHeight+a.middleLeft.displayHeight-18-94),a.middleMiddle.revive(),a.loadingRing.kill()},a.setSize(306.5,239.5),a.createLoadingRing(),a.createPopup(),a.scene.add.existing((0,ka.A)(a)),a}(0,_.A)(t,e);var n=t.prototype;return n.createLoadingRing=function(){this.loadingRing=new wl.A(this.scene)},n.createPopup=function(){this.createPopupImages(),this.updatePopupSize(),this.alignPopupImages()},n.createPopupImages=function(){this.topMiddle=this.scene.add.image(0,0,hp,up.TOUR_BLOCK_TOP),this.bottomMiddle=this.scene.add.image(0,0,hp,up.TOUR_BLOCK_BOTTOM),this.middleLeft=this.scene.add.image(0,0,hp,up.TOUR_BLOCK_MIDDLE_LEFT),this.middleMiddle=this.scene.add.image(0,0,hp,up.BLANK),this.middleRight=this.scene.add.image(0,0,hp,up.TOUR_BLOCK_MIDDLE_RIGHT),this.underMiddle=this.scene.add.image(0,0,hp,up.BLANK),this.underMiddle.setTintFill(3944520),this.add([this.underMiddle,this.loadingRing]),this.add([this.middleMiddle,this.middleLeft,this.middleRight]),this.add([this.topMiddle]),this.add([this.bottomMiddle]),this.middleMiddle.kill(),this.loadingRing.kill()},n.updatePopupSize=function(){this.topMiddle.setWorldSize(306.5,56),this.bottomMiddle.setWorldSize(306.5,75.5),this.middleLeft.setWorldSize(19,108),this.middleRight.setWorldSize(18,108),this.middleMiddle.setWorldSize(this.topMiddle.displayWidth-this.middleLeft.displayWidth-this.middleRight.displayWidth,this.topMiddle.displayHeight+this.bottomMiddle.displayHeight+this.middleLeft.displayHeight-18-94),this.underMiddle.setWorldSize(this.middleMiddle.displayWidth,this.middleMiddle.displayHeight)},n.alignPopupImages=function(){Phaser.Display.Align.In.Center(this.topMiddle,this,0,-this.middleLeft.displayHeight/2-this.topMiddle.displayHeight/2-9),Phaser.Display.Align.In.Center(this.bottomMiddle,this,0,this.middleLeft.displayHeight/2+this.bottomMiddle.displayHeight/2-9),Phaser.Display.Align.In.Center(this.middleLeft,this,-this.topMiddle.displayWidth/2+this.middleLeft.displayWidth/2,-9),Phaser.Display.Align.In.Center(this.middleMiddle,this,0,-9),Phaser.Display.Align.In.Center(this.middleRight,this,this.topMiddle.displayWidth/2-this.middleRight.displayWidth/2,-9),this.loadingRing.setPosition(this.middleMiddle.x,this.middleMiddle.y),this.underMiddle.setPosition(this.middleMiddle.x,this.middleMiddle.y)},n.setMiddleImage=function(e,t){var n=this.scene.textures.get(e);n&&n.key===e?this.handleLoadComplete(e):(this.loadingRing.revive(),this.loadPhoto(e,t))},n.loadPhoto=function(e,t){var n=this.scene.textures.get(e);n&&n.key===e?this.handleLoadComplete(e):(this.scene.load.once("filecomplete-image-"+e,this.handleLoadComplete),this.scene.load.image(e,t),this.scene.load.start())},t}(Phaser.GameObjects.Container),pp=dp,fp=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t)||this).background=void 0,s.payload=void 0,s.setSizeContainer(n,i),a&&s.updateInfo(a),s.scene.add.existing((0,ka.A)(s)),s}(0,_.A)(t,e);var n=t.prototype;return n.updateInfo=function(e){console.log("payload: "+e),this.payload=e,this.updateBg()},n.updateBg=function(){var e=this.payload.type;"worldwide"===e?this.background.setMiddleImage(Ga.A.IMAGES.KEY[1],Ga.A.IMAGES.FILE[1]):"friends"===e?this.background.setMiddleImage(Ga.A.IMAGES.KEY[2],Ga.A.IMAGES.FILE[2]):"you"===e&&this.background.setMiddleImage(Ga.A.IMAGES.KEY[3],Ga.A.IMAGES.FILE[3])},n.setSizeContainer=function(e,t){this.background=new pp(this.scene,0,0),this.add(this.background),this.setSize(this.background.width,this.background.height)},t}(Phaser.GameObjects.Container),mp=Fa.A.DEFAULT,gp=mp.KEY,vp=mp.FRAME,yp=function(e){function t(t){var n;return(n=e.call(this,t)||this).bg=void 0,n.endTime=void 0,n.countdownTimer=void 0,n.timerText=void 0,n.updateCountdown=(0,O.A)(D().mark((function e(){var t,i,a;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Date.now(),i=1e3*n.endTime-t,a=Math.ceil(Math.abs(i)/864e5),i<0&&(i=0),n.timerText.setText("Ends in "+a+" days");case 5:case"end":return e.stop()}}),e)}))),n.createBackground(),n.setSize(n.bg.displayWidth,n.bg.displayHeight),n.createTimerContainer(),n.createCountdownTimer(),t.add.existing((0,ka.A)(n)),n}(0,_.A)(t,e);var n=t.prototype;return n.createBackground=function(){var e=this.scene.make.image({key:gp,frame:vp.TOUR_INFO_BG});e.setWorldSize(85.5,15),this.add(e);var t=this.scene.make.image({key:gp,frame:vp.ICON_CLOCK});t.setWorldSize(20,21),this.add(t),Phaser.Display.Align.In.LeftCenter(t,e,12,0),this.bg=e},n.createTimerContainer=function(){this.timerText=this.scene.make.bitmapText({font:za.A.MIKADO.KEY,size:10,origin:{x:.5,y:.5}}),this.add([this.timerText]),Phaser.Display.Align.In.Center(this.timerText,this,3,0)},n.createCountdownTimer=function(){var e;this.endTime&&(null==(e=this.countdownTimer)||e.destroy(),this.countdownTimer=this.scene.time.addEvent({loop:!0,delay:1e3,startAt:1e3,callback:this.updateCountdown}))},n.setCountdown=function(e){this.endTime=e,this.createCountdownTimer()},t}(Phaser.GameObjects.Container),Ap=yp,Ep=Fa.A.DEFAULT,Tp=Ep.KEY,Sp=Ep.FRAME,bp=function(e){function t(t){var n;return(n=e.call(this,t)||this).bg=void 0,n.playerCountText=void 0,n.createBackground(),n.setSize(n.bg.displayWidth,n.bg.displayHeight),n.createText(),t.add.existing((0,ka.A)(n)),n}(0,_.A)(t,e);var n=t.prototype;return n.createBackground=function(){var e=this.scene.make.image({key:Tp,frame:Sp.TOUR_PLAYER_INFO_BG});e.setWorldSize(69.5,15),this.add(e);var t=this.scene.make.image({key:Tp,frame:Sp.TOUR_ICON_PLAYER});t.setWorldSize(18,20.5),this.add(t),Phaser.Display.Align.In.LeftCenter(t,e,12,0),this.bg=e},n.createText=function(){this.playerCountText=this.scene.make.bitmapText({font:za.A.MIKADO.KEY,size:10,origin:{x:.5,y:.5},text:"10+ players"}),this.add([this.playerCountText]),Phaser.Display.Align.In.Center(this.playerCountText,this,0,0)},n.setPlayerCount=function(e){0===e?this.playerCountText.setText("waiting..."):1===e?this.playerCountText.setText("1 player"):e>999?this.playerCountText.setText("999+ players"):this.playerCountText.setText(e+" players")},t}(Phaser.GameObjects.Container),Pp=bp,Cp=n(506),wp=Fa.A.DEFAULT,Ip=wp.KEY,xp=wp.FRAME,kp=function(e){function t(t){var n;return(n=e.call(this,t)||this).title=void 0,n.titleShadow=void 0,n.playButton=void 0,n.timerContainer=void 0,n.tournamentTypeText=void 0,n.playerCount=void 0,n.handleJoinTournament=(0,O.A)(D().mark((function e(){var t,i,a,s,r,o,c,l;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Cp.A.setData(n.payload),a=n.payload.id,s=n.payload.endTime,r=(null==(t=n.payload.payload)?void 0:t.leaderboardId)||"",o=(null==(i=n.payload.payload)?void 0:i.level)||1,e.prev=5,e.prev=6,e.next=9,n.scene.facebook.tournament.joinAsync(a.toString());case 9:e.next=15;break;case 11:if(e.prev=11,e.t0=e.catch(6),!GameCore.Utils.Valid.isObject(e.t0)||!GameCore.Utils.Object.hasOwn(e.t0,"code")||"SAME_CONTEXT"===e.t0.code){e.next=15;break}throw e.t0;case 15:return n.scene.storage.dispatch((0,mo.Ub)(a.toString(),r)),n.scene.storage.dispatch((0,oo.ry)()),e.next=19,n.scene.facebook.getTournamentAsync();case 19:return c=e.sent,e.next=22,n.scene.storage.dispatch((0,oo.mX)(c));case 22:l={leaderboardId:r,endTime:s,level:o},n.scene.player.joinTournament(l),n.scene.screen.close(Ua.R8.RESULT_SCREEN),e.next=36;break;case 27:if(e.prev=27,e.t1=e.catch(5),console.warn("error",e.t1),Cp.A.clearData(),!GameCore.Utils.Valid.isObject(e.t1)){e.next=35;break}if(!GameCore.Utils.Object.hasOwn(e.t1,"code")){e.next=35;break}if("USER_INPUT"!==e.t1.code){e.next=35;break}return e.abrupt("return");case 35:throw e.t1;case 36:case"end":return e.stop()}}),e,null,[[5,27],[6,11]])}))),n.addTextStyleTournament(),n.addTimerContainer(),n.addPlayerCount(),n.addTournamentTypeText(),n.addPlayButton(),n.handleInput(),n}(0,_.A)(t,e);var n=t.prototype;return n.addTextStyleTournament=function(){this.titleShadow=this.scene.make.text({style:{fontFamily:za.A.FONT_FAMILY,fontSize:"15px"},origin:{x:.5,y:.5},text:"GLOBAL TOURNAMENT"}),this.titleShadow.setColor("#694748"),this.titleShadow.setShadow(0,1,"#000000",3),this.titleShadow.setHighQuality(),this.title=this.scene.make.text({style:{fontFamily:za.A.FONT_FAMILY,fontSize:"15px"},origin:{x:.5,y:.5},text:"GLOBAL TOURNAMENT"}),this.title.setTintFill(13610920,13610920,10321790,10321790),this.title.setHighQuality(),this.add([this.titleShadow,this.title]),Phaser.Display.Align.In.TopCenter(this.title,this.background,0,-22),this.titleShadow.setY(this.title.y+1)},n.addTimerContainer=function(){this.timerContainer=new Ap(this.scene),this.add(this.timerContainer),Phaser.Display.Align.In.Center(this.timerContainer,this.background,-75,41)},n.addPlayerCount=function(){this.playerCount=new Pp(this.scene),this.add(this.playerCount),Phaser.Display.Align.In.Center(this.playerCount,this.background,91,41)},n.addTournamentTypeText=function(){this.tournamentTypeText=this.scene.make.bitmapText({font:za.A.MIKADO_YELLOW.KEY,text:"Worldwide\nTournament",size:15.5,origin:{x:.5,y:.5}}),this.tournamentTypeText.setCenterAlign(),this.add(this.tournamentTypeText),Phaser.Display.Align.In.Center(this.tournamentTypeText,this.background,-88,82)},n.updateInfo=function(t){e.prototype.updateInfo.call(this,t),this.timerContainer.setCountdown(t.endTime),this.updateTournamentTypeText(),this.title.setText(t.title.toUpperCase()),this.titleShadow.setText(t.title.toUpperCase()),this.playerCount.setPlayerCount(t.amountPlayer)},n.updateTournamentTypeText=function(){var e=this.payload.type;"worldwide"===e?this.tournamentTypeText.setText("Worldwide\nTournament"):"friends"===e?this.tournamentTypeText.setText("Friends\nTournament"):this.tournamentTypeText.setText("Your\nTournament")},n.addPlayButton=function(){this.playButton=new op(this.scene,Ip,xp.TOUR_BTN_JOIN,94.5,41.5);var e=this.scene.make.bitmapText({font:za.A.MIKADO_GREEN_STROKE.KEY,text:"Join",origin:{x:.5,y:.5},size:15});e.setY(-4),this.playButton.add([e]),this.add(this.playButton),Phaser.Display.Align.In.BottomRight(this.playButton,this.background,-10,-12)},n.handleInput=function(){var e=this,t=cp.HEADER.HEIGHT,n=cp.FOOTER.HEIGHT,i=t,a=this.scene.world.getWorldSize().height-n;this.playButton.setBound(i,a),this.playButton.onClick=function(){e.handleJoinTournament()}},t}(fp),Op=Fa.A.DEFAULT,_p=Op.KEY,Rp=Op.FRAME,Dp=function(e){function t(t){var n;return(n=e.call(this,t,_p,Rp.TOUR_BTN_CREATE,201.5,67.5)||this).animation=void 0,n.setName("CreateNewTournament"),n.createButtonLabel(),n.createText(),n}(0,_.A)(t,e);var n=t.prototype;return n.createButtonLabel=function(){var e=this.scene.make.image({key:_p,frame:Rp.TOUR_ICON_CREATE});e.setWorldSize(20.5,21),this.add(e),e.setPosition(-45,-4)},n.createText=function(){var e=this.scene.make.bitmapText({font:za.A.MIKADO_GREEN_STROKE.KEY,size:21,text:"Create",origin:{x:.5,y:.5}});this.add(e),e.setPosition(2,-5)},n.runAnimation=function(){var e,t,n=this;null==(e=this.animation)||e.remove(),this.animation=new Fu({targets:[this],props:{scale:{from:1,to:1.05}}}),null==(t=this.animation)||t.play(),this.hitZone.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,(function(){var e;null==(e=n.animation)||e.stop()})),this.hitZone.on(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,(function(){var e,t;null!=(e=n.animation.tween)&&e.isPlaying()||null==(t=n.animation)||t.play()}))},t}(Va.A),Mp=Fa.A.DEFAULT,Bp=Mp.KEY,Lp=Mp.FRAME,Np=function(e){function t(t){var n;(n=e.call(this,t)||this).illustration=void 0,n.createNewTournamentButton=void 0,n.payload=void 0,n.animOriginObjY=[];var i=n.scene.gameZone,a=i.width,s=i.height;return n.setSize(a,s),n.createIllustration(),n.createText(),n.createButton(),n}(0,_.A)(t,e);var n=t.prototype;return n.createIllustration=function(){var e=this.scene.make.image({key:Bp,frame:Lp.TOUR_CUP});e.setWorldSize(122,118),this.add(e),this.illustration=e,Phaser.Display.Align.In.Center(e,this,0,-140)},n.createText=function(){var e=this.scene.make.bitmapText({font:za.A.MIKADO_WHITE.KEY,size:22,text:"No tournaments available.",origin:{x:.5,y:.5}});this.add(e),this.alignUnder(e,this.illustration)},n.createButton=function(){this.createNewTournamentButton=new Dp(this.scene),this.createNewTournamentButton.runAnimation(),this.add(this.createNewTournamentButton),Phaser.Display.Align.In.Center(this.createNewTournamentButton,this,4,55)},n.alignUnder=function(e,t){var n=(e.height+t.height)/2;Phaser.Display.Align.In.Center(e,t,0,n+12.5)},n.playEntranceAnimation=function(){var e=this,t=this.getAll();0===this.animOriginObjY.length&&t.forEach((function(t){e.animOriginObjY.push(t.y)})),t.forEach((function(t,n){t.alpha=0,t.y=e.animOriginObjY[n]-50})),this.scene.tweens.add({targets:this.getAll(),duration:500,delay:this.scene.tweens.stagger(80,{}),props:{alpha:{value:1,ease:Phaser.Math.Easing.Expo.In},y:{value:"+=50",ease:"Power1"}}})},(0,ve.A)(t,[{key:"onClick",set:function(e){this.createNewTournamentButton.onClick=e}}]),t}(Phaser.GameObjects.Container),Gp=n(230),Fp=Fa.A.DEFAULT.FRAME,Up=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.scroller=void 0,n.header=void 0,n.currentIdx=0,n.tournaments=void 0,n.lbAmountPlayers={},n.worldTournament=void 0,n.noTourBlock=void 0,n.loading=void 0,n.bg=void 0,n.onOpen=(0,O.A)(D().mark((function e(){var t;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=n.currentIdx,console.log("updateContainer tournament ===============",t),n.updateContent();case 3:case"end":return e.stop()}}),e)}))),n.onClose=function(){},n.handleCreateTournament=(0,O.A)(D().mark((function e(){var t,i,a,s,r,o,c;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.scene.game.globalScene,e.prev=1,i=n.scene.player.getPlayer(),a=i.playerId,s=i.name,r={playerId:a,playerName:s,score:0,autoStartGame:!0,success:!0},t.screen.open(Ua.R8.NOTIFY_SCREEN,{message:"Creating tournament...",loading:!0}),e.next=7,(0,Wl.QN)(500);case 7:return e.next=9,(0,oo.Gd)();case 9:return e.next=11,n.scene.storage.dispatch((0,mo.UG)(r));case 11:return e.next=13,n.scene.facebook.getTournamentAsync();case 13:return o=e.sent,e.next=16,n.scene.storage.dispatch((0,oo.mX)(o));case 16:return e.next=18,n.updateContent();case 18:c={id:o.getID(),title:o.getTitle()||s+"'s Tournament",endTime:o.getEndTime(),contextID:o.getContextID(),type:"you"},Cp.A.setData(c),n.scene.screen.close(Ua.R8.RESULT_SCREEN),window.game.globalScene.screen.close(Ua.R8.NOTIFY_SCREEN),e.next=32;break;case 24:if(e.prev=24,e.t0=e.catch(1),!GameCore.Utils.Valid.isObject(e.t0)){e.next=31;break}if(!GameCore.Utils.Object.hasOwn(e.t0,"code")){e.next=31;break}if("USER_INPUT"!==e.t0.code){e.next=31;break}return window.game.globalScene.screen.close(Ua.R8.NOTIFY_SCREEN),e.abrupt("return");case 31:t.screen.open(Ua.R8.NOTIFY_SCREEN,{message:"Oops!\n You are not able to create\ntournaments right now.\n\nPlease try again later.",duration:2e3,loading:!1});case 32:case"end":return e.stop()}}),e,null,[[1,24]])}))),n.scene=t,n.createBackground(),n.setSize(n.scene.gameZone.width,n.scene.gameZone.height),n.createHeader(),n.createScroller(),n.createNoTournamentBlock(),n.add([n.header]),n.addLoading(),n.alignUI(),n}(0,_.A)(t,e);var n=t.prototype;return n.createBackground=function(){var e=this.scene.make.image({key:Ga.A.BACKGROUND_TAB.KEY});this.add(e),this.bg=e},n.loadTournament=function(){var e=(0,O.A)(D().mark((function e(){var t;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.scene.facebook.tournament.getTournamentsAsync();case 3:this.tournaments=e.sent,this.tournaments=$d()(t=this.tournaments).call(t),console.log("this.tournaments",this.tournaments),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),this.tournaments=[];case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),n.loadTournamentsAmountPlayers=function(){var e=(0,O.A)(D().mark((function e(){var t,n,i,a,s,r;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=0;case 1:if(!(t<this.tournaments.length)){e.next=22;break}if(n=this.tournaments[t],e.prev=3,i=n.getPayload()){e.next=7;break}return e.abrupt("return");case 7:if(a=JSON.parse(i),s=a.leaderboardId){e.next=11;break}throw new sp(null,a);case 11:return e.next=13,(0,Gp.iF)(s);case 13:r=e.sent,this.lbAmountPlayers[s]=r,e.next=19;break;case 17:e.prev=17,e.t0=e.catch(3);case 19:t++,e.next=1;break;case 22:console.log("this.tournamentsAmountPlayer",this.lbAmountPlayers);case 23:case"end":return e.stop()}}),e,this,[[3,17]])})));return function(){return e.apply(this,arguments)}}(),n.loadWorldTournament=function(){var e=(0,O.A)(D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,Gp.L5)();case 3:this.worldTournament=e.sent,console.log("worldTournament",this.worldTournament),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("worldTournament error",e.t0),this.worldTournament=[];case 11:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),n.updateContent=function(){var e=(0,O.A)(D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.noTourBlock.kill(),this.loading.setVisible(!0),e.next=4,this.loadTournament();case 4:return e.next=6,this.loadTournamentsAmountPlayers();case 6:return e.next=8,this.loadWorldTournament();case 8:this.updateScroller(),this.loading.setVisible(!1);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.alignUI=function(){var e=this.x,t=this.y;this.setPosition(0,0),this.bg.setWorldSize(this.scene.gameZone.width,this.scene.gameZone.height),this.setSize(this.scene.gameZone.width,this.scene.gameZone.height),Phaser.Display.Align.In.TopCenter(this.header,this,0,0),this.setPosition(e,t)},n.alignComponents=function(){this.alignUI();var e=this.scene.world.getWorldSize(),t=e.width,n=e.height;this.scroller.setSize(t,n),this.scroller.input&&this.scroller.input.hitArea&&this.scroller.input.hitArea.setSize(t,n),this.header.alignComponents()},n.getTournamentsByType=function(e){var t,n,i,a=this.scene.player.getPlayerId();switch(e){case"you":return f()(t=this.tournaments).call(t,(function(e){var t=e.getPayload();if(!t)return!1;var n=JSON.parse(t);return a==n.playerId}));case"friends":return f()(n=this.tournaments).call(n,(function(e){var t=e.getPayload();if(!t)return!1;var n=JSON.parse(t);return a!=n.playerId&&""!=n.playerId}));default:return f()(i=this.tournaments).call(i,(function(e){return!!e.getPayload()}))}},n.updateScroller=function(){var e,t=this.scroller;console.log("updateScroller");var n=B()(e=[]).call(e,this.worldTournament,this.getFormattedOrderedTournamentsData());if(n.length<1)return this.noTourBlock.revive(),this.noTourBlock.playEntranceAnimation(),t.updateConfig(n),void t.setEnable(!1);var i=t.value;t.updateConfig(n),t.value=i,t.onTouchEnd(),t.setEnable(!0)},n.getFormattedOrderedTournamentsData=function(){var e,t=this,n=[],i=this.scene.player.getPlayerId();return B()(e=[]).call(e,this.getTournamentsByType("friends"),this.getTournamentsByType("you")).forEach((function(e){try{var a=e.getID(),s=e.getPayload();if(!s)return;var r=JSON.parse(s),o=r.playerName,c=r.leaderboardId;if(!c)throw new sp(null,r);var l={id:a,title:e.getTitle()||o+"'s Tournament",payload:r,type:i==r.playerId?"you":"friends",endTime:e.getEndTime(),contextID:e.getContextID(),amountPlayer:t.lbAmountPlayers[c]||0};n.push(l)}catch(h){console.warn(h)}})),n},n.createHeader=function(){this.header=new ip(this.scene),this.header.setTitle(Fp.TEXT_TOURNAMENTS),this.header.setTitleSize(209,26),this.header.btnSettingOnClick=this.scene.handlePauseGame},n.createNoTournamentBlock=function(){var e=new Np(this.scene);this.noTourBlock=e,this.add(e),this.noTourBlock.onClick=this.handleCreateTournament},n.addLoading=function(){this.loading=new wl.A(this.scene),this.loading.setTint(12237498);var e=this.height-this.header.height-tu-this.scene.ads.getBannerHeight(),t=-this.height/2,n=this.header.height+e/2;this.loading.setPosition(0,t+n),this.add(this.loading)},n.createScroller=function(){var e=this.scene.ads.getBannerHeight(),t=new jd(this.scene,{classType:kp,listConfigs:[],width:this.width,height:this.height,padding:11,marginTop:this.header.height+2,marginBottom:e+tu});this.add(t),t.setEnable(!1),this.scroller=t},t}(cu),jp=Up,Vp=jp,zp=function(e){function t(t){var n;return(n=e.call(this,t)||this).chooseContainers=void 0,n.createChooseContainer(),n.alignUI(),t.add.existing((0,ka.A)(n)),n}(0,_.A)(t,e);var n=t.prototype;return n.setSizeContainer=function(){var e=this.scene.gameZone,t=e.width,n=e.height;this.setSize(t,n)},n.createChooseContainer=function(){var e,t=this.scene;this.chooseContainers=[];var n=new Vp(t),i=new Td(t),a=new qd(t);(e=this.chooseContainers).push.apply(e,[n,i,a]);for(var s=this.scene.world.getWorldSize().width,r=0;r<this.chooseContainers.length;r++)this.chooseContainers[r].setVisible(!1),Phaser.Display.Align.In.Center(this.chooseContainers[r],this,s);this.add(this.chooseContainers)},n.alignUI=function(){var e=this.x,t=this.y;this.setPosition(0,0),this.setSizeContainer(),this.setPosition(e,t)},n.alignComponents=function(){this.alignUI(),this.chooseContainers.forEach((function(e){return e.alignComponents()}))},n.getChooseContainers=function(){var e;return B()(e=[]).call(e,this.chooseContainers)},t}(Phaser.GameObjects.Container),Yp=zp,Hp=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).scene=void 0,s.footerBg=void 0,s.disableZone=void 0,s.footerBar=void 0,s.resultContents=void 0,s.popupFadeInMaskAnimation=void 0,s.shouldUpdateScoreAnimForTournament=!1,s.open=function(t){e.prototype.open.call((0,ka.A)(s),t),s.scene.runSetMusicVolume(.4);var n=!0;t&&(n=t.shouldPlayAnim),window.focus(),s.scene.addShortcut(),s.runFadeInMaskAnimation(100,300),console.log("Show popup",n);var i=s.footerBar.getCurrentIdx(),a=s.scene.storage.getState();(0,uo.qs)(a)===ho.zA&&(i=0,s.shouldUpdateScoreAnimForTournament=!0),s.footerBar.selectTab({idx:i,isSelectAgain:!0,immediately:!0,callOnOpen:!0,onContentOpenData:{shouldPlayAnim:n,fromTab:-1}}),1===i&&s.scene.audio.playSound(ja.A.GAME_OVER_SCENE)},s.scene=t,s.createResultContent(),s.createBackgroundVeil(),s.createFooterBar(),s.setDepth(Ua.Ae.POPUP),s.background.setAlpha(.5),s.alignComponents(),s.scene.events.on(Vr.A.LAYOUT_UPDATE,(function(){s.alignComponents()})),s}(0,_.A)(t,e);var n=t.prototype;return n.close=function(){this.shouldUpdateScoreAnimForTournament=!1,e.prototype.close.call(this)},n.createResultContent=function(){this.resultContents=new Yp(this.scene),this.add(this.resultContents)},n.runFadeInMaskAnimation=function(e,t){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new wo.A({targets:[this.background],delay:e,duration:t,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.createFooterBar=function(){this.footerBar=new ru(this.scene),this.footerBar.setDepth(Na.A.BUTTON),this.initFooterBar(),this.add(this.footerBar)},n.createBackgroundVeil=function(){var e=this.scene.make.image({key:Ga.A.BACKGROUND_TAB.KEY});e.setOrigin(.5,0),this.add(e);var t=this.scene.make.zone({});this.add(t),this.footerBg=e,this.disableZone=t},n.alignUI=function(){var e=this.x,t=this.y;this.setPosition(0,0);var n=this.scene.gameZone,i=n.width,a=n.height,s=this.scene.ads.getBannerHeight();Phaser.Display.Align.In.Center(this.resultContents,this),this.footerBg.setWorldSize(i,a);var r=this.footerBg,o=r.displayWidth,c=r.displayHeight,l=r.scaleX,h=r.scaleY,u=(c-s-78.5)/h;this.footerBg.setCrop(0,u,o/l,c/h),this.footerBg.setPosition(0,-a/2),this.disableZone.setSize(o,tu+s),this.disableZone.setPosition(0,a/2-this.disableZone.height/2),this.disableZone.setInteractive(),Phaser.Display.Align.In.BottomCenter(this.footerBar,this,0,-s),this.setPosition(e,t)},n.alignComponents=function(){this.alignUI();var e=this.footerBg.displayWidth,t=this.scene.ads.getBannerHeight();this.disableZone&&this.disableZone.input&&this.disableZone.input.hitArea.setSize(e,tu+t),this.footerBar.selectTab({idx:this.footerBar.getCurrentIdx(),isSelectAgain:!0,immediately:!0,callOnOpen:!1}),this.resultContents.alignComponents(),this.footerBar.alignComponents()},n.getCurrentPageIdx=function(){return this.footerBar.getCurrentIdx()},n.initFooterBar=function(){this.footerBar.addChooseContainers(this.resultContents.getChooseContainers()),this.footerBar.selectTab({idx:1,isSelectAgain:!1,immediately:!0,callOnOpen:!1})},n.getShouldUpdateScoreAnimForTournament=function(){return this.shouldUpdateScoreAnimForTournament},n.setShouldUpdateScoreAnimForTournament=function(){this.shouldUpdateScoreAnimForTournament=!1},t}(GameCore.Screen),Kp=Hp,Wp=Fa.A.GAMEPLAY,Zp=Wp.KEY,Xp=Wp.FRAME,Jp=function(e){function t(t){var n;return(n=e.call(this,t,Zp,Xp.BUTTON_GREEN_LONG_RECTANGLE,175,66)||this).text=void 0,n.animation=void 0,n.setName("Continue"),n.createText(),n}(0,_.A)(t,e);var n=t.prototype;return n.createText=function(){this.text=this.scene.make.image({key:Zp,frame:Xp.TEXT_CONTINUE}),this.text.setWorldSize(87,19),this.add(this.text),Phaser.Display.Align.In.Center(this.text,this,0,-4)},n.runAnimation=function(){var e,t,n=this;null==(e=this.animation)||e.remove(),this.animation=new Fu({targets:[this],props:{scale:{from:1,to:1.05}}}),null==(t=this.animation)||t.play(),this.hitZone.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,(function(){var e;null==(e=n.animation)||e.stop()})),this.hitZone.on(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,(function(){var e,t;null!=(e=n.animation.tween)&&e.isPlaying()||null==(t=n.animation)||t.play()}))},t}(Va.A),qp=Jp,Qp=Fa.A.GAMEPLAY,$p=Qp.KEY,ef=Qp.FRAME,tf=Fa.A.DEFAULT,nf=tf.KEY,af=tf.FRAME,sf=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).scene=void 0,s.buttonShare=void 0,s.buttonContinue=void 0,s.backgroundDark=void 0,s.coralLeft=void 0,s.coralRight=void 0,s.textLevel=void 0,s.textLevelNumber=void 0,s.titleBlock=void 0,s.titleText=void 0,s.popupShowUpAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.confettiLeftEffect=void 0,s.confettiRightEffect=void 0,s.tweenCounterConfetti=void 0,s.listTweenAnim=[],s.clickButtonShare=function(){FBInstant.shareLinkAsync({data:{},text:"Play now!"})},s.clickButtonContinue=function(){s.runCloseAnimation(),s.scene.screen.open(Ua.R8.RESULT_SCREEN,{shouldPlayAnim:!0})},s.scene=t,s.createBackgroundDark(),s.createCorals(),s.createTitle(),s.createTexts(),s.createButtons(),s.createConfettiSmallAnimation(),s.setDepth(Ua.Ae.POPUP),s.scene.events.on(Vr.A.LAYOUT_UPDATE,(function(){s.alignComponents()})),s}(0,_.A)(t,e);var n=t.prototype;return n.alignComponents=function(){var e=this.scene.gameZone,t=e.width,n=e.height;this.backgroundDark.setWorldSize(t,n),Phaser.Display.Align.In.TopLeft(this.coralLeft,this.backgroundDark,0,0),Phaser.Display.Align.In.TopRight(this.coralRight,this.backgroundDark,0,0)},n.open=function(){e.prototype.open.call(this),this.logWON1391Bug(),this.scene.runSetMusicVolume(.4),this.runOpenAnimation();var t=this.scene.journeyGameplay.levelManager.getCorrectLevel();this.textLevelNumber.setText(""+(t-1))},n.logWON1391Bug=function(){try{this.scene.main.visible&&(console.error("%c WON-1391: ","font-size:12px;background-color: #EA7E5C;color:#fff;","WON-1391"),this.scene.rollbar.sendException(new Error("WON-1391"),{level:this.scene.journeyGameplay.levelManager.getLevel(),screen:this.name,state:this.scene.game.storage.getState()}))}catch(e){console.error(e)}},n.close=function(){e.prototype.close.call(this),this.stopEmitter()},n.createBackgroundDark=function(){var e=this.scene.gameZone,t=e.width,n=e.height;this.backgroundDark=this.scene.make.image({key:Ga.A.BACKGROUND_DARK.KEY}),this.backgroundDark.setWorldSize(t,n),this.add(this.backgroundDark)},n.createCorals=function(){this.coralLeft=this.scene.make.image({key:nf,frame:af.CORAL_LEFT}),this.coralLeft.setOrigin(0,0),this.coralLeft.setWorldSize(62,189),this.coralRight=this.scene.make.image({key:nf,frame:af.CORAL_RIGHT}),this.coralRight.setOrigin(1,0),this.coralRight.setWorldSize(67,170),this.add([this.coralLeft,this.coralRight]),Phaser.Display.Align.In.TopLeft(this.coralLeft,this.backgroundDark,0,0),Phaser.Display.Align.In.TopRight(this.coralRight,this.backgroundDark,0,0)},n.createTitle=function(){var e=this.scene.make.image({key:$p,frame:ef.BUTTON_BLACK});e.setWorldSize(273,78);var t=this.scene.make.image({key:$p,frame:ef.TEXT_COMPLETED});t.setWorldSize(159,27),this.add([e,t]),Phaser.Display.Align.In.TopCenter(e,this,0,-100),Phaser.Display.Align.In.Center(t,e,0,-2),this.titleBlock=e,this.titleText=t},n.createTexts=function(){this.createTextLevel(),this.createTextLevelNumber()},n.createTextLevel=function(){this.textLevel=this.scene.make.image({key:$p,frame:ef.TEXT_LEVEL}),this.textLevel.setWorldSize(64,25),this.add(this.textLevel),Phaser.Display.Align.In.Center(this.textLevel,this,0,-117)},n.createTextLevelNumber=function(){this.textLevelNumber=this.scene.make.bitmapText({font:za.A.FONT_NUMBER.KEY,size:this.scene.fontSize(90),text:"0",origin:{x:.5,y:.5}}),this.add(this.textLevelNumber),Phaser.Display.Align.In.Center(this.textLevelNumber,this,0,-68)},n.clickButtonClose=function(){var e=this.scene.journeyGameplay,t=this.scene.journeyGameplay.header;this.runCloseAnimation(),this.scene.time.delayedCall(300,(function(){t.progressBar.reset(),e.clearFen()}))},n.createButtons=function(){this.createButtonShare(),this.createButtonContinue()},n.createButtonShare=function(){this.buttonShare=new Bu(this.scene),this.buttonShare.onClick=this.clickButtonShare,this.add(this.buttonShare),Phaser.Display.Align.In.Center(this.buttonShare,this,-92,62)},n.clickButtonBack=function(){var e=this.scene.journeyGameplay,t=this.scene.journeyGameplay.header;this.runCloseAnimation(),this.scene.time.delayedCall(300,(function(){t.progressBar.reset(),e.clearFen()}))},n.createButtonContinue=function(){this.buttonContinue=new qp(this.scene),this.buttonContinue.onClick=this.clickButtonContinue,this.add(this.buttonContinue),Phaser.Display.Align.In.Center(this.buttonContinue,this,33,62)},n.createConfettiSmallAnimation=function(){this.confettiLeftEffect=new Hu.A(this.scene,{speedX:{min:-20,max:100},rotate:{start:-1080,end:0}}),this.confettiRightEffect=new Hu.A(this.scene,{speedX:{min:20,max:-100},rotate:{start:0,end:1080}}),this.confettiLeftEffect.setDepth(Na.A.ON_TOP),this.confettiRightEffect.setDepth(Na.A.ON_TOP)},n.runOpenAnimation=function(){var e;null!=(e=this.popupShowUpAnimation)&&null!=(e=e.tween)&&e.isPlaying()||(this.scene.audio.playSound(ja.A.POPUP_SHOW),this.runFadeInMaskAnimation(100,300),this.runContentAnimation())},n.runCloseAnimation=function(){this.close()},n.runFadeInMaskAnimation=function(e,t){this.backgroundDark.alpha=0,this.background.alpha=0,this.popupFadeInMaskAnimation||(this.popupFadeInMaskAnimation=new wo.A({targets:[this.background,this.backgroundDark],delay:e,duration:t,props:{alpha:{start:0,from:0,to:1}}})),this.popupFadeInMaskAnimation.play()},n.runContentAnimation=function(){var e=(0,O.A)(D().mark((function e(){var t,n,i,a,s=this;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.listTweenAnim.forEach((function(e){e.stop(),e.remove()})),this.listTweenAnim=[],(i=f()(t=this.getAll()).call(t,(function(e){return e!==s.background&&e!==s.backgroundDark}))).forEach((function(e){e.alpha=0})),a=this.scene.add.tween({targets:i,alpha:{from:0,to:1},duration:300,delay:300}),this.listTweenAnim.push(a),this.runCoralAnimation(),null==(n=this.buttonContinue.animation)||n.stop(),this.textLevelNumber.scale=0,this.textLevelNumber.alpha=0,this.buttonShare.alpha=0,this.buttonContinue.alpha=0,this.buttonShare.scale=0,this.buttonContinue.scale=0,this.runTopContentAnimation(),e.next=17,(0,Wl.QN)(900);case 17:return this.scene.audio.playSound(ja.A.STAR_PROGRESS_1),this.runPopOutAnimation([this.textLevelNumber]),e.next=21,(0,Wl.QN)(800);case 21:return this.runConfettiEffect(),this.scene.audio.playSound(ja.A.STAR_PROGRESS_2),this.scene.time.delayedCall(700,(function(){s.scene.audio.playSound(ja.A.YOU_WIN)})),e.next=26,this.runPopOutAnimation([this.buttonShare,this.buttonContinue],2e3);case 26:this.buttonContinue.runAnimation();case 27:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runCoralAnimation=function(){var e=this.coralLeft,t=e.x,n=e.y,i=this.coralRight,a=i.x,s=i.y;this.coralLeft.setPosition(t-50,n-50),this.coralRight.setPosition(a+50,s-50);var r=[{x:t,y:n},{x:a,y:s}],o=this.scene.add.tween({targets:[this.coralLeft,this.coralRight],props:{x:{getEnd:function(e,t,n,i){return r[i].x}},y:{getEnd:function(e,t,n,i){return r[i].y}}},ease:Phaser.Math.Easing.Cubic.Out,duration:1e3});this.listTweenAnim.push(o),o=this.scene.add.tween({targets:[this.coralLeft],props:{angle:{from:0,to:5}},duration:5e3,yoyo:!0,repeat:-1}),this.listTweenAnim.push(o),o=this.scene.add.tween({delay:500,targets:[this.coralRight],props:{angle:{from:0,to:-5}},duration:3e3,yoyo:!0,repeat:-1}),this.listTweenAnim.push(o)},n.runTopContentAnimation=function(){var e=this,t=[this.titleBlock,this.titleText,this.textLevel],n=Be()(t).call(t,(function(e){return e.scale}));return t.forEach((function(e){e.scale=.8*e.scale})),new(N())((function(i){e.scene.add.tween({targets:t,props:{scale:{getStart:function(e,t,i,a){return.8*n[a]},getEnd:function(e,t,i,a){return n[a]}}},ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.45],duration:1e3,delay:e.scene.tweens.stagger(100,{start:300}),onComplete:i})}))},n.runPopOutAnimation=function(e,t){var n=this;return void 0===t&&(t=1e3),new(N())((function(i){n.scene.add.tween({targets:e,alpha:{from:0,to:1},scale:{from:.6,to:1},duration:t,ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.45],onComplete:i})}))},n.runConfettiEffect=function(){var e=this,t=this.scene.gameZone.width;this.confettiLeftEffect.stop(),this.confettiRightEffect.stop(),this.scene.children.bringToTop(this.confettiLeftEffect),this.scene.children.bringToTop(this.confettiRightEffect),this.confettiLeftEffect.run(1,0,-100),this.confettiRightEffect.run(1,0+t,-100),this.tweenCounterConfetti=this.scene.tweens.addCounter({delay:1e4,from:100,to:0,ease:Phaser.Math.Easing.Cubic.Out,duration:400,onUpdate:function(t){var n,i,a=t.getValue()/100;null==(n=e.confettiLeftEffect.emitter)||n.setAlpha(a),null==(i=e.confettiRightEffect.emitter)||i.setAlpha(a)},onComplete:function(){e.stopEmitter()}})},n.stopEmitter=function(){var e,t,n,i,a;null==(e=this.tweenCounterConfetti)||e.stop(),null==(t=this.confettiLeftEffect.emitter)||t.killAll(),null==(n=this.confettiRightEffect.emitter)||n.killAll(),null==(i=this.confettiLeftEffect.emitter)||i.setAlpha(1),null==(a=this.confettiRightEffect.emitter)||a.setAlpha(1),this.confettiLeftEffect.stop(),this.confettiRightEffect.stop()},n.runFadeOutMaskAnimation=function(e,t){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new Bh.A({targets:[this.background],delay:e,duration:t,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},t}(GameCore.Screen),rf=Fa.A.GAMEPLAY,of=rf.KEY,cf=rf.FRAME,lf=function(e){function t(t){var n;return(n=e.call(this,t,of,cf.BUTTON_RED_LONG_RECTANGLE,175,66)||this).text=void 0,n.setName("Retry"),n.createText(),n}return(0,_.A)(t,e),t.prototype.createText=function(){this.text=this.scene.make.image({key:of,frame:cf.TEXT_RETRY}),this.text.setWorldSize(54,23),this.add(this.text),Phaser.Display.Align.In.Center(this.text,this,0,-4)},t}(Va.A),hf=lf,uf=Fa.A.GAMEPLAY,df=uf.KEY,pf=uf.FRAME,ff=function(e){function t(t){var n;return(n=e.call(this,t,df,pf.BUTTON_BLUE_SMALL,60,66)||this).setName("Journey"),n.createIcon(),n}return(0,_.A)(t,e),t.prototype.createIcon=function(){var e=this.scene.make.image({key:df,frame:pf.ICON_JOURNEY});e.setWorldSize(35,29),this.add(e),Phaser.Display.Align.In.Center(e,this,-2,-4)},t}(Va.A),mf=ff,gf=Fa.A.GAMEPLAY,vf=gf.KEY,yf=gf.FRAME,Af=Fa.A.DEFAULT,Ef=Af.KEY,Tf=Af.FRAME,Sf=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).scene=void 0,s.buttonJourney=void 0,s.buttonRetry=void 0,s.backgroundDark=void 0,s.coralLeft=void 0,s.coralRight=void 0,s.textLevel=void 0,s.textLevelNumber=void 0,s.titleBlock=void 0,s.titleText=void 0,s.popupShowUpAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.listTweenAnim=[],s.clickJourney=function(){s.scene.screen.close(s.name),s.scene.screen.open(Ua.R8.RESULT_SCREEN,{shouldPlayAnim:!1})},s.clickButtonRetry=function(){var e=s.scene.journeyGameplay;s.scene.screen.close(s.name),e.handleRetryLevel()},s.scene=t,s.createBackgroundDark(),s.createCorals(),s.createTitle(),s.createTexts(),s.createButtons(),s.setDepth(Ua.Ae.POPUP),s.scene.events.on(Vr.A.LAYOUT_UPDATE,(function(){s.alignComponents()})),s}(0,_.A)(t,e);var n=t.prototype;return n.alignComponents=function(){var e=this.scene.gameZone,t=e.width,n=e.height;this.backgroundDark.setWorldSize(t,n),Phaser.Display.Align.In.TopLeft(this.coralLeft,this.backgroundDark,0,0),Phaser.Display.Align.In.TopRight(this.coralRight,this.backgroundDark,0,0)},n.open=function(){e.prototype.open.call(this),this.logWON1391Bug(),this.scene.runSetMusicVolume(.4),this.scene.enableInput(),this.runOpenAnimation();var t=this.scene.journeyGameplay.levelManager.getLevel();this.textLevelNumber.setText(""+t)},n.logWON1391Bug=function(){try{this.scene.main.visible&&(console.error("%c WON-1391: ","font-size:12px;background-color: #EA7E5C;color:#fff;","WON-1391"),this.scene.rollbar.sendException(new Error("WON-1391"),{level:this.scene.journeyGameplay.levelManager.getLevel(),screen:this.name,state:this.scene.game.storage.getState()}))}catch(e){console.error(e)}},n.createBackgroundDark=function(){var e=this.scene.gameZone,t=e.width,n=e.height;this.backgroundDark=this.scene.make.image({key:Ga.A.BACKGROUND_DARK.KEY}),this.backgroundDark.setWorldSize(t,n),this.add(this.backgroundDark)},n.createCorals=function(){this.coralLeft=this.scene.make.image({key:Ef,frame:Tf.CORAL_LEFT}),this.coralLeft.setOrigin(0,0),this.coralLeft.setWorldSize(62,189),this.coralRight=this.scene.make.image({key:Ef,frame:Tf.CORAL_RIGHT}),this.coralRight.setOrigin(1,0),this.coralRight.setWorldSize(67,170),this.add([this.coralLeft,this.coralRight]),Phaser.Display.Align.In.TopLeft(this.coralLeft,this.backgroundDark,0,0),Phaser.Display.Align.In.TopRight(this.coralRight,this.backgroundDark,0,0)},n.createTitle=function(){var e=this.scene.make.image({key:vf,frame:yf.BUTTON_BLACK});e.setWorldSize(273,78);var t=this.scene.make.image({key:vf,frame:yf.TEXT_FAILED});t.setWorldSize(97,27),this.add([e,t]),Phaser.Display.Align.In.TopCenter(e,this,0,-100),Phaser.Display.Align.In.Center(t,e,0,-2),this.titleBlock=e,this.titleText=t},n.createTexts=function(){this.createTextLevel(),this.createTextLevelNumber()},n.createTextLevel=function(){this.textLevel=this.scene.make.image({key:vf,frame:yf.TEXT_LEVEL}),this.textLevel.setWorldSize(64,25),this.add(this.textLevel),Phaser.Display.Align.In.Center(this.textLevel,this,0,-117)},n.createTextLevelNumber=function(){this.textLevelNumber=this.scene.make.bitmapText({font:za.A.FONT_NUMBER.KEY,size:this.scene.fontSize(90),text:"0",origin:{x:.5,y:.5}}),this.add(this.textLevelNumber),Phaser.Display.Align.In.Center(this.textLevelNumber,this,0,-68)},n.createButtons=function(){this.createButtonJourney(),this.createButtonRetry()},n.createButtonJourney=function(){this.buttonJourney=new mf(this.scene),this.buttonJourney.onClick=this.clickJourney,this.add(this.buttonJourney),Phaser.Display.Align.In.Center(this.buttonJourney,this,-92,62)},n.createButtonRetry=function(){this.buttonRetry=new hf(this.scene),this.buttonRetry.onClick=this.clickButtonRetry,this.add(this.buttonRetry),Phaser.Display.Align.In.Center(this.buttonRetry,this,33,62)},n.runOpenAnimation=function(){var e;null!=(e=this.popupShowUpAnimation)&&null!=(e=e.tween)&&e.isPlaying()||(this.scene.audio.playSound(ja.A.POPUP_SHOW),this.runFadeInMaskAnimation(100,300),this.runContentAnimation())},n.runFadeInMaskAnimation=function(e,t){this.backgroundDark.alpha=0,this.background.alpha=0,this.popupFadeInMaskAnimation||(this.popupFadeInMaskAnimation=new wo.A({targets:[this.background,this.backgroundDark],delay:e,duration:t,props:{alpha:{start:0,from:0,to:1}}})),this.popupFadeInMaskAnimation.play()},n.runContentAnimation=function(){var e=(0,O.A)(D().mark((function e(){var t,n,i,a=this;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.listTweenAnim.forEach((function(e){e.stop(),e.remove()})),this.listTweenAnim=[],(n=f()(t=this.getAll()).call(t,(function(e){return e!==a.background&&e!==a.backgroundDark}))).forEach((function(e){e.alpha=0})),i=this.scene.add.tween({targets:n,alpha:{from:0,to:1},duration:300,delay:300}),this.listTweenAnim.push(i),this.runCoralAnimation(),this.buttonJourney.alpha=0,this.buttonRetry.alpha=0,this.buttonJourney.scale=0,this.buttonRetry.scale=0,this.scene.audio.playSound(ja.A.GAME_OVER_SCENE,{volume:.7}),this.runTopContentAnimation(),e.next=15,(0,Wl.QN)(900);case 15:return this.scene.audio.playSound(ja.A.STAR_PROGRESS_3),e.next=18,this.runPopOutAnimation([this.buttonJourney,this.buttonRetry],1500);case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runCoralAnimation=function(){var e=this.coralLeft,t=e.x,n=e.y,i=this.coralRight,a=i.x,s=i.y;this.coralLeft.setPosition(t-50,n-50),this.coralRight.setPosition(a+50,s-50);var r=[{x:t,y:n},{x:a,y:s}],o=this.scene.add.tween({targets:[this.coralLeft,this.coralRight],props:{x:{getEnd:function(e,t,n,i){return r[i].x}},y:{getEnd:function(e,t,n,i){return r[i].y}}},ease:Phaser.Math.Easing.Cubic.Out,duration:1e3});this.listTweenAnim.push(o),o=this.scene.add.tween({targets:[this.coralLeft],props:{angle:{from:0,to:5}},duration:5e3,yoyo:!0,repeat:-1}),this.listTweenAnim.push(o),o=this.scene.add.tween({delay:500,targets:[this.coralRight],props:{angle:{from:0,to:-5}},duration:3e3,yoyo:!0,repeat:-1}),this.listTweenAnim.push(o)},n.runTopContentAnimation=function(){var e=this,t=[this.titleBlock,this.titleText,this.textLevel,this.textLevelNumber],n=Be()(t).call(t,(function(e){return e.scale}));return t.forEach((function(e){e.scale=.8*e.scale})),new(N())((function(i){e.scene.add.tween({targets:t,props:{scale:{getStart:function(e,t,i,a){return.8*n[a]},getEnd:function(e,t,i,a){return n[a]}}},ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.45],duration:1e3,delay:e.scene.tweens.stagger(100,{start:300}),onComplete:i})}))},n.runPopOutAnimation=function(e,t){var n=this;return void 0===t&&(t=1e3),new(N())((function(i){n.scene.add.tween({targets:e,alpha:{from:0,to:1},scale:{from:.6,to:1},duration:t,ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.45],onComplete:i})}))},t}(GameCore.Screen),bf=n(141),Pf=Fa.A.DEFAULT,Cf=Pf.KEY,wf=Pf.FRAME,If=function(e){function t(t,n,i,a,s,r){var o;return(o=e.call(this,t,n,i)||this).top=void 0,o.mid=void 0,o.bottom=void 0,o.payload=void 0,o.payload=r,o.setSize(a,s),o.setDepth(Na.A.POPUP),o.createPopup(),o.scene.add.existing((0,ka.A)(o)),o}(0,_.A)(t,e);var n=t.prototype;return n.createPopup=function(){this.createPopupImages(),this.updatePopupSize(),this.alignPopupImages()},n.createPopupImages=function(){this.top=this.scene.add.image(0,0,Cf,wf.BLANK),this.mid=this.scene.add.image(0,0,Cf,wf.BLANK),this.bottom=this.scene.add.image(0,0,Cf,wf.BLANK),this.add([this.top,this.mid,this.bottom])},n.updatePopupSize=function(){var e,t=(null==(e=this.payload)?void 0:e.forceHeightTop)||this.width*this.top.height/this.top.width;this.top.setWorldSize(this.width,t),this.bottom.setWorldSize(this.width,this.width*this.bottom.height/this.bottom.width),this.mid.setWorldSize(this.width,this.height-this.top.displayHeight-this.bottom.displayHeight)},n.alignPopupImages=function(){Phaser.Display.Align.In.Center(this.top,this,0,-this.mid.displayHeight/2-this.top.displayHeight/2),Phaser.Display.Align.In.Center(this.mid,this),Phaser.Display.Align.In.Center(this.bottom,this,0,this.mid.displayHeight/2+this.bottom.displayHeight/2)},n.setFrameTop=function(e,t,n){t||(t=this.top.displayWidth),n||(n=this.top.displayHeight),this.top.setFrame(e),this.top.setWorldSize(t,n)},(0,ve.A)(t,[{key:"onClose",set:function(e){this.setInteractive({useHandCursor:!0}),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,e)}}]),t}(Phaser.GameObjects.Container),xf=If,kf=Fa.A.DEFAULT,Of=kf.KEY,_f=kf.FRAME,Rf=function(e){function t(t){var n;return(n=e.call(this,t,Of,_f.BUTTON_CONTINUE,177,67)||this).animation=void 0,n.setName("Continue"),n.createIcon(),n.createText(),n}(0,_.A)(t,e);var n=t.prototype;return n.createIcon=function(){var e=this.scene.make.image({key:Of,frame:_f.ICON_ADS});e.setWorldSize(36,29),this.add(e),Phaser.Display.Align.In.Center(e,this,-47,-5)},n.createText=function(){var e=this.scene.make.image({key:Of,frame:_f.TEXT_CONTINUE});e.setWorldSize(87,19),this.add(e),Phaser.Display.Align.In.Center(e,this,22,-5)},n.runAnimation=function(){var e,t,n=this;null==(e=this.animation)||e.remove(),this.animation=new Fu({targets:[this],props:{scale:{from:1,to:1.05}}}),null==(t=this.animation)||t.play(),this.hitZone.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,(function(){var e;null==(e=n.animation)||e.stop()})),this.hitZone.on(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,(function(){var e,t;null!=(e=n.animation.tween)&&e.isPlaying()||null==(t=n.animation)||t.play()}))},t}(Va.A),Df=Fa.A.DEFAULT,Mf=Df.KEY,Bf=Df.FRAME,Lf=GameCore.Configs,Nf=Lf.Match,Gf=Lf.Network,Ff=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).scene=void 0,s.isUseRescue=void 0,s.countdownCount=void 0,s.titleY=void 0,s.popup=void 0,s.skipText=void 0,s.continueButton=void 0,s.tweenContinueButton=void 0,s.textCountDown=void 0,s.tweenTextCountDown=void 0,s.progressCircle=void 0,s.tweenProgressCircle=void 0,s.skipTextTween=void 0,s.countdownTimer=void 0,s.bgProgress=void 0,s.tweenBgProgress=void 0,s.title=void 0,s.tweenTextTitle=void 0,s.tweenShowTextTitle=void 0,s.popupShowUpAnimation=void 0,s.adsTimer=void 0,s.open=function(){e.prototype.open.call((0,ka.A)(s)),s.textCountDown.setText(""+Nf.RescueGamePopupTimeout),s.runOpenAnimation()},s.close=function(){e.prototype.close.call((0,ka.A)(s)),s.scene.audio.stopSound(ja.A.RESCUE_TIME),s.bgProgress.setVisible(!1),s.progressCircle.setVisible(!1),s.continueButton.setVisible(!1),s.skipText.setVisible(!1),s.textCountDown.setScale(0).setAlpha(0),s.title.setVisible(!1).setScale(0),s.title.setY(s.titleY)},s.handleShowRewardedVideoAd=(0,O.A)(D().mark((function e(){var t,n,i,a;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s.scene.audio.stopSound(ja.A.RESCUE_TIME),t=s.scene.game,n=t.globalScene,i=t.audio,s.countdownTimer.remove(),e.prev=3,!s.isUseRescue){e.next=6;break}return e.abrupt("return");case 6:return s.isUseRescue=!0,n.screen.open(Ua.R8.NOTIFY_SCREEN,{message:"Loading ads...",duration:0,loading:!0}),i.pauseMusic(),i.muteAll(),e.next=12,new(N())((function(e,t){var n;null==(n=s.adsTimer)||n.remove(),s.adsTimer=s.scene.time.delayedCall(Gf.Timeout,t),s.scene.ads.getAdStatus(GameCore.Ads.Types.REWARDED)===GameCore.Ads.Status.LOADING?s.scene.ads.events.once(GameCore.Ads.Events.LOADED,e):s.scene.ads.preloadRewardedVideoAsync().then(e).catch(t)}));case 12:return e.next=14,s.scene.ads.showRewardedVideoAsync();case 14:n.screen.close(Ua.R8.NOTIFY_SCREEN),i.unmuteAll(),i.playMusic(),s.scene.ads.preloadRewardedVideoAsync().catch((function(e){})),n.screen.events.off(GameCore.Screens.Events.CLOSE),go.A.emit(ro.A.RESCUE),s.scene.storage.dispatch((0,oo.nd)()),i.playSound(ja.A.DAILY_REWARD),e.next=31;break;case 24:if(e.prev=24,e.t0=e.catch(3),!(e.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(e.t0,"code"))){e.next=30;break}if("USER_INPUT"!==e.t0.code){e.next=30;break}return s.showNotifySkipAds(),e.abrupt("return");case 30:s.showNotifyNoAds();case 31:return e.prev=31,null==(a=s.adsTimer)||a.destroy(),i.unmuteAll(),i.playMusic(),window.focus(),s.scene.screen.close(s.name),e.finish(31);case 38:case"end":return e.stop()}}),e,null,[[3,24,31,38]])}))),s.showNotifyNoAds=function(e){if(!e||e.name===Ua.R8.NOTIFY_SCREEN){var t=s.scene.game.globalScene;t.screen.events.off(GameCore.Screens.Events.CLOSE),t.screen.events.once(GameCore.Screens.Events.CLOSE,s.showGameOver),t.screen.open(Ua.R8.NOTIFY_SCREEN,{message:"No ads to display!",duration:2e3,loading:!1})}},s.showNotifySkipAds=function(){var e=s.scene.game.globalScene;e.screen.events.off(GameCore.Screens.Events.CLOSE),e.screen.events.once(GameCore.Screens.Events.CLOSE,s.showGameOver),e.screen.open(Ua.R8.NOTIFY_SCREEN,{message:"Sorry, No Rewards!\nYou have cancelled the ad!",duration:3e3,loading:!1})},s.showGameOver=function(e){e&&e.name!==Ua.R8.NOTIFY_SCREEN||(s.countdownTimer.remove(),s.scene.screen.close(s.name),s.scene.runAnimationGameOver())},s.handleSkip=function(){s.countdownTimer.remove(),s.scene.screen.close(s.name),s.scene.runAnimationGameOver()},s.handleRunCountdown=function(){s.countdownCount-=1,s.textCountDown.setText(""+s.countdownCount),s.countdownCount<=0&&s.rescueTimeout()},s.scene=t,s.countdownCount=Nf.MaxRescueCount,s.setDepth(Ua.Ae.POPUP),s.background.setAlpha(.75),s.createPopup(),s.createContent(),s}(0,_.A)(t,e);var n=t.prototype;return n.runAnim=function(){this.continueButton.setScale(0).setAlpha(0),this.skipText.setAlpha(0),this.tweenShowTextTitle.play()},n.createPopup=function(){this.popup=new xf(this.scene,0,-5,290,290,{forceHeightTop:51}),this.popup.setVisible(!1),this.add(this.popup)},n.createContent=function(){this.createTitle(),this.createBgProgressCircle(),this.createProgressCircle(),this.createTextRescueTime(),this.createContinueButton(),this.createTweenContinueButton(),this.createSkipText()},n.createTitle=function(){var e=this,t=this.scene.ads.getBannerHeight();this.title=this.scene.make.image({key:Mf,frame:Bf.TEXT_SECOND_CHANGE}),this.title.setVisible(!1),this.title.setWorldSize(197,23);var n=this.title.scale;this.title.setScale(0),this.add(this.title),Phaser.Display.Align.In.Center(this.title,this,0,-t),this.titleY=this.title.y,this.tweenShowTextTitle=this.scene.tweens.add({paused:!0,targets:[this.title],duration:600,scale:{from:0,to:n},completeDelay:1e3,onComplete:function(){e.tweenTextTitle.play()},ease:Phaser.Math.Easing.Back.Out}),this.tweenTextTitle=this.scene.tweens.add({paused:!0,targets:[this.title],duration:400,y:{from:this.title.y,to:this.title.y-140},onComplete:function(){e.setProgressCircle(0),e.progressCircle.setScale(0),e.progressCircle.setVisible(!0),e.tweenBgProgress.play(),e.tweenProgressCircle.play(),e.tweenTextCountDown.play()},ease:Phaser.Math.Easing.Circular.Out})},n.createTextRescueTime=function(){var e=this;this.textCountDown=this.scene.make.bitmapText({font:za.A.MIKADO_YELLOW_BIG_NUMBER.KEY,size:86,origin:{x:.5,y:.5}}),this.textCountDown.setCenterAlign(),this.add(this.textCountDown),Phaser.Display.Align.In.Center(this.textCountDown,this.bgProgress),this.tweenTextCountDown=this.scene.tweens.add({targets:this.textCountDown,paused:!0,duration:300,delay:300,scale:{from:0,to:1},alpha:{from:0,to:1},ease:Phaser.Math.Easing.Back.Out,onComplete:function(){e.tweenContinueButton.play()}}),this.textCountDown.setScale(0).setAlpha(0)},n.createProgressCircle=function(){var e=this.scene.ads.getBannerHeight();this.progressCircle=this.scene.add.graphics(),this.add(this.progressCircle),this.progressCircle.setPosition(0,-16-e),this.tweenProgressCircle=this.scene.tweens.add({paused:!0,targets:this.progressCircle,scale:{from:0,to:1},duration:300,ease:Phaser.Math.Easing.Sine.InOut})},n.setProgressCircle=function(e){var t=Phaser.Math.DegToRad(-90),n=Phaser.Math.DegToRad(e-360-90);this.progressCircle.clear(),this.progressCircle.beginPath(),this.progressCircle.lineStyle(7,16774400),this.progressCircle.arc(0,0,67,t,n,!0,.02),this.progressCircle.strokePath(),this.progressCircle.closePath()},n.runCountdown=function(){this.startProgressCircle();var e={delay:1e3,loop:!0,callback:this.handleRunCountdown};this.countdownTimer=this.scene.time.addEvent(e)},n.startProgressCircle=function(){var e=this;this.scene.tweens.addCounter({from:0,to:360,duration:1e3*Nf.RescueGamePopupTimeout,ease:Phaser.Math.Easing.Sine.InOut,onUpdate:function(t){var n=+t.getValue().toFixed(2);e.setProgressCircle(n)},onComplete:function(){e.setProgressCircle(0),e.progressCircle.setAlpha(1)}})},n.createBgProgressCircle=function(){var e=this,t=this.scene.ads.getBannerHeight();this.bgProgress=this.scene.make.image({key:Mf,frame:Bf.BG_CIRCLE_BLACK}),this.bgProgress.setVisible(!1),this.bgProgress.setWorldSize(152,152),this.add(this.bgProgress),Phaser.Display.Align.In.Center(this.bgProgress,this.popup,0,-t-10),this.tweenBgProgress=this.scene.tweens.add({paused:!0,targets:this.bgProgress,scale:{from:0,to:this.bgProgress.scale},duration:300,ease:Phaser.Math.Easing.Sine.InOut,onComplete:function(){e.progressCircle.setVisible(!0),e.scene.audio.playSound(ja.A.RESCUE_TIME,{loop:!0,delay:1}),e.countdownCount=Nf.RescueGamePopupTimeout,e.runCountdown()}})},n.rescueTimeout=function(){this.countdownTimer.remove(),this.scene.screen.close(this.name),this.scene.runAnimationGameOver()},n.createContinueButton=function(){var e=this.scene.ads.getBannerHeight();this.continueButton=new Rf(this.scene),this.continueButton.onClick=this.handleShowRewardedVideoAd,this.add(this.continueButton),Phaser.Display.Align.In.Center(this.continueButton,this,0,135-e),this.continueButton.setScale(0).setAlpha(0)},n.createTweenContinueButton=function(){var e=this;this.tweenContinueButton=this.scene.tweens.add({paused:!0,targets:this.continueButton,ease:bf.A,props:{alpha:{from:0,to:1},scale:{from:0,to:1}},duration:300,onComplete:function(){e.continueButton.runAnimation(),e.playSkipTextTween()}})},n.createSkipText=function(){var e=this.scene.ads.getBannerHeight();this.skipText=new Va.A(this.scene,Mf,Bf.BLANK,120,25),this.skipText.setName("NoThanks"),this.skipText.button.setVisible(!1);var t=this.scene.make.image({key:Mf,frame:Bf.TEXT_NO_THANK});t.setWorldSize(88,17),this.skipText.add(t),this.add(this.skipText),this.skipText.onClick=this.handleSkip,Phaser.Display.Align.In.TopCenter(t,this.skipText,0,0),Phaser.Display.Align.In.Center(this.skipText,this,0,185-e),this.skipText.setVisible(!1).setAlpha(0)},n.playSkipTextTween=function(){var e,t=this;null==(e=this.skipTextTween)||e.remove(),this.skipTextTween=this.scene.tweens.add({targets:this.skipText,delay:1500,alpha:{from:0,to:1},ease:Phaser.Math.Easing.Back.Out,onStart:function(){t.skipText.setVisible(!0)},duration:500})},n.runOpenAnimation=function(){var e;null!=(e=this.popupShowUpAnimation)&&null!=(e=e.tween)&&e.isPlaying()||(this.title.setVisible(!0),this.scene.oufOfMovesEffect.hideTextOutOfMoves(),this.scene.audio.playSound(ja.A.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300))},n.runPopupEntrancesAnimation=function(e,t){var n=this;if(!this.popupShowUpAnimation){var i=this.popup.scale;this.popupShowUpAnimation=new Nh.A({targets:[this.popup],delay:e,duration:t,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:i}},onComplete:function(){n.bgProgress.setScale(0),n.bgProgress.setVisible(!0),n.continueButton.setVisible(!0),n.runAnim(),n.isUseRescue=!1}})}this.popupShowUpAnimation.play()},t}(GameCore.Screen),Uf=Ff,jf=Fa.A.DEFAULT,Vf=jf.KEY,zf=jf.FRAME,Yf=function(e){function t(t){var n;return(n=e.call(this,t,Vf,zf.BUTTON_SETTING,55,55)||this).icon=void 0,n.dash=void 0,n.createIcon(),n.createDash(),n}(0,_.A)(t,e);var n=t.prototype;return n.createIcon=function(){this.icon=this.scene.make.image({key:Vf}),this.add(this.icon),Phaser.Display.Align.In.Center(this.icon,this,0,0)},n.createDash=function(){this.dash=this.scene.make.image({key:Vf,frame:zf.ICON_DASH}),this.dash.setVisible(!1),this.dash.setWorldSize(23,37),this.add(this.dash),Phaser.Display.Align.In.Center(this.dash,this,0,0)},n.setFrameIcon=function(e,t,n){this.icon.setFrame(e),this.icon.setWorldSize(t,n)},n.updateStatus=function(e){this.dash.setVisible(!e)},t}(Va.A),Hf=Yf,Kf=Fa.A.DEFAULT,Wf=Kf.KEY,Zf=Kf.FRAME,Xf=function(e){function t(t){var n;return(n=e.call(this,t,Wf,Zf.BUTTON_GREEN,100,72)||this).setName("Continue"),n.createIcon(),n}return(0,_.A)(t,e),t.prototype.createIcon=function(){var e=this.scene.make.image({key:Wf,frame:Zf.ICON_NEXT});e.setWorldSize(24,29),this.add(e),Phaser.Display.Align.In.Center(e,this,-2,-5)},t}(Va.A),Jf=Xf,qf=Fa.A.DEFAULT,Qf=qf.KEY,$f=qf.FRAME,em=function(e){function t(t){var n;return(n=e.call(this,t,Qf,$f.BUTTON_RED,100,72)||this).setName("Replay"),n.createIcon(),n}return(0,_.A)(t,e),t.prototype.createIcon=function(){var e=this.scene.make.image({key:Qf,frame:$f.ICON_RESTART});e.setWorldSize(31,30),this.add(e),Phaser.Display.Align.In.Center(e,this,-2,-5)},t}(Va.A),tm=em,nm=Fa.A.DEFAULT,im=nm.KEY,am=nm.FRAME,sm=function(e){function t(t){var n;return(n=e.call(this,t,im,am.SETTINGS_BLUE_BTN,197,88)||this).setName("Share"),n.createText(),n}return(0,_.A)(t,e),t.prototype.createText=function(){var e=this.scene.make.bitmapText({font:za.A.MIKADO_BLUE_STROKE.KEY,origin:{x:.5,y:.5},size:25,text:"Share"});this.add(e),Phaser.Display.Align.In.Center(e,this,0,0)},t}(Va.A),rm=sm,om=Fa.A.DEFAULT,cm=om.KEY,lm=om.FRAME,hm=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).popup=void 0,s.title=void 0,s.buttonClose=void 0,s.contents=void 0,s.settingMusic=void 0,s.settingSound=void 0,s.settingVibrate=void 0,s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.buttonReplay=void 0,s.buttonContinue=void 0,s.buttonShare=void 0,s.replayButtonAnimation=void 0,s.continueButtonAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.handleClose=function(){s.runCloseAnimation()},s.handleMusicSetting=function(){var e=s.scene.player.getPlayerSettings().music;s.scene.player.setSetting("music",!e),e?s.scene.audio.pauseMusic():s.scene.audio.playMusic(),s.settingMusic.updateStatus(!e)},s.handleSoundSetting=function(){var e=s.scene.player.getPlayerSettings().sound;s.settingSound.updateStatus(!e),s.scene.player.setSetting("sound",!e)},s.handleVibrateSetting=function(){var e=s.scene.player.getPlayerSettings().vibrate;e||ql(199),s.scene.player.setSetting("vibrate",!e),s.settingVibrate.updateStatus(!e)},s.clickReplay=function(){s.runCloseAnimation(),s.popupFadeOutAnimation.next((0,O.A)(D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.scene.screen.close(s.name),e.next=3,s.scene.storage.dispatch((0,oo.El)());case 3:go.A.emit(ro.A.REPLAY);case 4:case"end":return e.stop()}}),e)}))))},s.clickButtonShare=function(){s.runCloseAnimation(),s.popupFadeOutAnimation.next((0,O.A)(D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s.scene.storage.dispatch((0,du.M8)());case 1:case"end":return e.stop()}}),e)}))))},s.handleEndGame=function(){s.runCloseAnimation(),s.popupFadeOutAnimation.next((function(){s.scene.fastEndGame()}))},s.createPopup(),s.createTitle(),s.createSwitchButtons(),s.createButtons(),s.alignPopup(),s.addItem(),s.createInput(),s.createReplayButtonAnimation(),s.createContinueButtonAnimation(),s.setDepth(Ua.Ae.POPUP),s.background.setAlpha(.75),s}(0,_.A)(t,e);var n=t.prototype;return n.open=function(){e.prototype.open.call(this);var t=this.scene.player.getPlayerSettings(),n=t.sound,i=t.vibrate,a=t.music;this.settingSound.updateStatus(n),this.settingVibrate.updateStatus(i),this.settingMusic.updateStatus(a),this.runOpenAnimation(),this.updateVibrateButton()},n.updateVibrateButton=function(){Zl()?(this.settingVibrate.revive(),Phaser.Display.Align.In.Center(this.settingSound,this.settingVibrate,-70),Phaser.Display.Align.In.Center(this.settingMusic,this.settingVibrate,70)):(this.settingVibrate.kill(),Phaser.Display.Align.In.Center(this.settingSound,this.settingVibrate,-70),Phaser.Display.Align.In.Center(this.settingMusic,this.settingVibrate,70))},n.createPopup=function(){this.popup=new pl.A(this.scene,0,0,262,330,"settings"),this.add(this.popup)},n.alignPopup=function(){var e=this.scene.ads.getBannerHeight();Phaser.Display.Align.In.Center(this.popup,this,0,30-e)},n.createTitle=function(){this.title=this.scene.add.container(),this.buttonClose=new Va.A(this.scene,cm,lm.BUTTON_CLOSE,39,56),this.buttonClose.setName("Close"),this.title.add([this.buttonClose]),Phaser.Display.Align.In.Center(this.buttonClose,this.title,128,0),Phaser.Display.Align.In.TopCenter(this.title,this.popup,0,0)},n.createSwitchButtons=function(){var e=this.scene.player.getPlayerSettings(),t=e.sound,n=e.music,i=e.vibrate;this.createSoundButton(t),this.createMusicButton(n),this.createVibrateButton(i)},n.createSoundButton=function(e){this.settingSound=new Hf(this.scene),this.settingSound.setName("Sound"),this.settingSound.setFrameIcon(lm.ICON_SETTINGS_SOUND,34,29),this.settingSound.updateStatus(e),this.popup.add(this.settingSound)},n.createMusicButton=function(e){this.settingMusic=new Hf(this.scene),this.settingMusic.setName("Music"),this.settingMusic.setFrameIcon(lm.ICON_SETTINGS_MUSIC,28,28),this.settingMusic.updateStatus(e),this.popup.add(this.settingMusic)},n.createVibrateButton=function(e){this.settingVibrate=new Hf(this.scene),this.settingVibrate.setName("Vibrate"),this.settingVibrate.setFrameIcon(lm.ICON_SETTINGS_VIBRATE,24,31),this.settingVibrate.updateStatus(e),this.popup.add(this.settingVibrate),Phaser.Display.Align.In.TopCenter(this.settingVibrate,this.popup,0,-20)},n.createInput=function(){this.buttonClose.onClick=this.handleClose,this.buttonContinue.onClick=this.handleClose,this.settingSound.onClick=this.handleSoundSetting,this.settingMusic.onClick=this.handleMusicSetting,this.settingVibrate.onClick=this.handleVibrateSetting},n.createButtons=function(){this.createContinueButton(),this.createReplayButton(),this.createShareButton(),this.createEndGameButton()},n.createReplayButton=function(){this.buttonReplay=new tm(this.scene),this.popup.add(this.buttonReplay),this.buttonReplay.onClick=this.clickReplay,Phaser.Display.Align.In.Center(this.buttonReplay,this.popup,-49.5,112)},n.createContinueButton=function(){this.buttonContinue=new Jf(this.scene),this.popup.add(this.buttonContinue),Phaser.Display.Align.In.Center(this.buttonContinue,this.popup,52,112)},n.createShareButton=function(){this.buttonShare=new rm(this.scene),this.popup.add(this.buttonShare),this.buttonShare.onClick=this.clickButtonShare,Phaser.Display.Align.In.Center(this.buttonShare,this.popup,0,-45)},n.createEndGameButton=function(){var e=new Va.A(this.scene,cm,lm.SETTINGS_RED_LONG_BTN,197,88);e.setName("EndGame"),this.popup.add(e),Phaser.Display.Align.In.Center(e,this.popup,0,30);var t=this.scene.make.bitmapText({text:"End Game",font:za.A.MIKADO_RED_STROKE.KEY,origin:{x:.5,y:.5},size:25});e.add(t),e.onClick=this.handleEndGame},n.addItem=function(){this.popup.add([this.title]),this.contents=this.scene.add.group(),this.contents.addMultiple([])},n.runOpenAnimation=function(){var e;null!=(e=this.popupShowUpAnimation)&&null!=(e=e.tween)&&e.isPlaying()||(this.scene.audio.playSound(ja.A.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(0,300),this.runPopupContentEntrancesAnimation(200,300))},n.runCloseAnimation=function(){var e;null!=(e=this.popupFadeOutAnimation)&&null!=(e=e.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(e,t){if(!this.popupShowUpAnimation){var n=this.popup,i=n.scale,a=n.y;this.popupShowUpAnimation=new Nh.A({targets:[this.popup],delay:e,duration:t,props:{y:{from:a+20,to:a},alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:i}},onComplete:function(){}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(e,t){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new Lh.A({targets:this.contents.getChildren(),duration:t,delay:e,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(e,t){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new Bh.A({targets:[this.popup],delay:e,duration:t,props:{scale:0},onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(e,t){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new wo.A({targets:[this.background],delay:e,duration:t,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(e,t){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new Bh.A({targets:[this.background],delay:e,duration:t,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},n.createReplayButtonAnimation=function(){this.replayButtonAnimation=new Fu({targets:[this.buttonReplay],props:{scale:{from:1,to:1.02}}})},n.createContinueButtonAnimation=function(){this.continueButtonAnimation=new Fu({targets:[this.buttonContinue],props:{scale:{from:1,to:1.05}}})},t}(GameCore.Screen),um=hm,dm=Fa.A.DEFAULT,pm=dm.KEY,fm=dm.FRAME,mm=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).scene=void 0,s.popup=void 0,s.title=void 0,s.buttonClose=void 0,s.contents=void 0,s.settingMusic=void 0,s.settingSound=void 0,s.settingVibrate=void 0,s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.buttonReplay=void 0,s.buttonContinue=void 0,s.buttonShare=void 0,s.replayButtonAnimation=void 0,s.continueButtonAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.handleClose=function(){s.runCloseAnimation()},s.handleMusicSetting=function(){var e=s.scene.player.getPlayerSettings().music;s.scene.player.setSetting("music",!e),e?s.scene.audio.pauseMusic():s.scene.audio.playMusic(),s.settingMusic.updateStatus(!e)},s.handleSoundSetting=function(){var e=s.scene.player.getPlayerSettings().sound;s.settingSound.updateStatus(!e),s.scene.player.setSetting("sound",!e)},s.handleVibrateSetting=function(){var e=s.scene.player.getPlayerSettings().vibrate;e||ql(199),s.scene.player.setSetting("vibrate",!e),s.settingVibrate.updateStatus(!e)},s.clickReplay=function(){var e=s.scene.journeyGameplay;s.runCloseAnimation(),s.popupFadeOutAnimation.next((0,O.A)(D().mark((function t(){return D().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s.scene.screen.close(s.name),e.handleRetryLevel();case 2:case"end":return t.stop()}}),t)}))))},s.clickButtonShare=function(){s.runCloseAnimation(),s.popupFadeOutAnimation.next((0,O.A)(D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s.scene.storage.dispatch((0,du.M8)());case 1:case"end":return e.stop()}}),e)}))))},s.handleEndGame=function(){var e=s.scene.journeyGameplay;s.runCloseAnimation(),s.popupFadeOutAnimation.next((function(){e.fastEndGame()}))},s.scene=t,s.createPopup(),s.createTitle(),s.createSwitchButtons(),s.createButtons(),s.alignPopup(),s.addItem(),s.createInput(),s.createReplayButtonAnimation(),s.createContinueButtonAnimation(),s.setDepth(Ua.Ae.POPUP),s.background.setAlpha(.75),s}(0,_.A)(t,e);var n=t.prototype;return n.open=function(){e.prototype.open.call(this);var t=this.scene.player.getPlayerSettings(),n=t.sound,i=t.vibrate,a=t.music;this.settingSound.updateStatus(n),this.settingVibrate.updateStatus(i),this.settingMusic.updateStatus(a),this.runOpenAnimation(),this.updateVibrateButton()},n.updateVibrateButton=function(){Zl()?(this.settingVibrate.revive(),Phaser.Display.Align.In.Center(this.settingSound,this.settingVibrate,-70),Phaser.Display.Align.In.Center(this.settingMusic,this.settingVibrate,70)):(this.settingVibrate.kill(),Phaser.Display.Align.In.Center(this.settingSound,this.settingVibrate,-70),Phaser.Display.Align.In.Center(this.settingMusic,this.settingVibrate,70))},n.createPopup=function(){this.popup=new pl.A(this.scene,0,0,262,330,"settings"),this.add(this.popup)},n.alignPopup=function(){var e=this.scene.ads.getBannerHeight();Phaser.Display.Align.In.Center(this.popup,this,0,30-e)},n.createTitle=function(){this.title=this.scene.add.container(),this.buttonClose=new Va.A(this.scene,pm,fm.BUTTON_CLOSE,39,56),this.buttonClose.setName("Close"),this.title.add([this.buttonClose]),Phaser.Display.Align.In.Center(this.buttonClose,this.title,128,0),Phaser.Display.Align.In.TopCenter(this.title,this.popup,0,0)},n.createSwitchButtons=function(){var e=this.scene.player.getPlayerSettings(),t=e.sound,n=e.music,i=e.vibrate;this.createSoundButton(t),this.createMusicButton(n),this.createVibrateButton(i)},n.createSoundButton=function(e){this.settingSound=new Hf(this.scene),this.settingSound.setName("Sound"),this.settingSound.setFrameIcon(fm.ICON_SETTINGS_SOUND,34,29),this.settingSound.updateStatus(e),this.popup.add(this.settingSound)},n.createMusicButton=function(e){this.settingMusic=new Hf(this.scene),this.settingMusic.setName("Music"),this.settingMusic.setFrameIcon(fm.ICON_SETTINGS_MUSIC,28,28),this.settingMusic.updateStatus(e),this.popup.add(this.settingMusic)},n.createVibrateButton=function(e){this.settingVibrate=new Hf(this.scene),this.settingVibrate.setName("Vibrate"),this.settingVibrate.setFrameIcon(fm.ICON_SETTINGS_VIBRATE,24,31),this.settingVibrate.updateStatus(e),this.popup.add(this.settingVibrate),Phaser.Display.Align.In.TopCenter(this.settingVibrate,this.popup,0,-20)},n.createInput=function(){this.buttonClose.onClick=this.handleClose,this.buttonContinue.onClick=this.handleClose,this.settingSound.onClick=this.handleSoundSetting,this.settingMusic.onClick=this.handleMusicSetting,this.settingVibrate.onClick=this.handleVibrateSetting},n.createButtons=function(){this.createContinueButton(),this.createReplayButton(),this.createShareButton(),this.createEndGameButton()},n.createReplayButton=function(){this.buttonReplay=new tm(this.scene),this.popup.add(this.buttonReplay),this.buttonReplay.onClick=this.clickReplay,Phaser.Display.Align.In.Center(this.buttonReplay,this.popup,-49.5,112)},n.createContinueButton=function(){this.buttonContinue=new Jf(this.scene),this.popup.add(this.buttonContinue),Phaser.Display.Align.In.Center(this.buttonContinue,this.popup,52,112)},n.createShareButton=function(){this.buttonShare=new rm(this.scene),this.popup.add(this.buttonShare),this.buttonShare.onClick=this.clickButtonShare,Phaser.Display.Align.In.Center(this.buttonShare,this.popup,0,-45)},n.createEndGameButton=function(){var e=new Va.A(this.scene,pm,fm.SETTINGS_RED_LONG_BTN,197,88);e.setName("EndGame"),this.popup.add(e),Phaser.Display.Align.In.Center(e,this.popup,0,30);var t=this.scene.make.bitmapText({text:"End Game",font:za.A.MIKADO_RED_STROKE.KEY,origin:{x:.5,y:.5},size:25});e.add(t),e.onClick=this.handleEndGame},n.addItem=function(){this.popup.add([this.title]),this.contents=this.scene.add.group(),this.contents.addMultiple([])},n.runOpenAnimation=function(){var e;null!=(e=this.popupShowUpAnimation)&&null!=(e=e.tween)&&e.isPlaying()||(this.scene.audio.playSound(ja.A.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300),this.runPopupContentEntrancesAnimation(200,300))},n.runCloseAnimation=function(){var e;null!=(e=this.popupFadeOutAnimation)&&null!=(e=e.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(e,t){if(!this.popupShowUpAnimation){var n=this.popup,i=n.scale,a=n.y;this.popupShowUpAnimation=new Nh.A({targets:[this.popup],delay:e,duration:t,props:{y:{from:a+20,to:a},alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:i}},onComplete:function(){}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(e,t){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new Lh.A({targets:this.contents.getChildren(),duration:t,delay:e,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(e,t){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new Bh.A({targets:[this.popup],delay:e,duration:t,props:{scale:0},onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(e,t){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new wo.A({targets:[this.background],delay:e,duration:t,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(e,t){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new Bh.A({targets:[this.background],delay:e,duration:t,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},n.createReplayButtonAnimation=function(){this.replayButtonAnimation=new Fu({targets:[this.buttonReplay],props:{scale:{from:1,to:1.02}}})},n.createContinueButtonAnimation=function(){this.continueButtonAnimation=new Fu({targets:[this.buttonContinue],props:{scale:{from:1,to:1.05}}})},t}(GameCore.Screen),gm=mm,vm=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidTileMap",i.message=t||"This tile is not valid",i.payload=n,i}return(0,_.A)(t,e),t}((0,$.A)(Error)),ym=vm,Am=(Fa.A.GAMEPLAY_32.FRAME,"vertical"),Em="left",Tm="right",Sm="top",bm="bottom",Pm=(Fa.A.EFFECTS.FRAME.TEXT_COOL,Fa.A.EFFECTS.FRAME.TEXT_PERFECT,Fa.A.EFFECTS.FRAME.TEXT_EXCELLENT,Fa.A.EFFECTS.FRAME.TEXT_EXCELLENT,Fa.A.EFFECTS.FRAME.TEXT_UNBELIEVABLE,"l"),Cm="l_1",wm="l_3",Im="line_2",xm="line_3",km="line_4",Om="line_5",_m="square_1",Rm="square_2",Dm="square_3",Mm="trapezoid",Bm="triangle",Lm=[Cm,wm,Im,xm,km,Om,_m,Rm,Dm],Nm=[{type:Pm,rate:3},{type:Cm,rate:4},{type:wm,rate:2},{type:Im,rate:16},{type:xm,rate:12},{type:km,rate:8},{type:Om,rate:4},{type:_m,rate:16},{type:Rm,rate:8},{type:Bm,rate:4},{type:Mm,rate:4},{type:"t_piece",rate:2},{type:"plus_piece",rate:1},{type:"cross_piece_2",rate:4},{type:"cross_piece_3",rate:2},{type:"cross_piece_4",rate:1},{type:"u_piece",rate:2}],Gm=[[1,0],[1,0],[1,1]],Fm=[[0,1],[0,1],[1,1]],Um=[[1,0],[1,1]],jm=[[1,0,0],[1,0,0],[1,1,1]],Vm=[[1,1,1],[1,0,0]],zm=[[1,1,1],[0,0,1]],Ym=[[1,1],[1,0]],Hm=[[1,1,1],[1,0,0],[1,0,0]],Km=[[1,1],[0,1],[0,1]],Wm=[[1,1],[1,0],[1,0]],Zm=[[1,1],[0,1]],Xm=[[1,1,1],[0,0,1],[0,0,1]],Jm=[[0,0,1],[1,1,1]],qm=[[1,0,0],[1,1,1]],Qm=[[0,1],[1,1]],$m=[[0,0,1],[0,0,1],[1,1,1]],eg=[[1],[1]],tg=[[1,1]],ng=[[1],[1],[1]],ig=[[1,1,1]],ag=[[1],[1],[1],[1]],sg=[[1,1,1,1]],rg=[[1],[1],[1],[1],[1]],og=[[1,1,1,1,1]],cg=[[1]],lg=[[1,1],[1,1]],hg=[[1,1,1],[1,1,1],[1,1,1]],ug=[[1,0],[1,1],[0,1]],dg=[[0,1],[1,1],[1,0]],pg=[[1,1,0],[0,1,1]],fg=[[0,1,1],[1,1,0]],mg=[[0,1],[1,1],[0,1]],gg=[[1,0],[1,1],[1,0]],vg=[[0,1,0],[1,1,1]],yg=[[1,1,1],[0,1,0]],Ag=[[0,0,1],[1,1,1],[0,0,1]],Eg=[[1,0,0],[1,1,1],[1,0,0]],Tg=[[0,1,0],[0,1,0],[1,1,1]],Sg=[[1,1,1],[0,1,0],[0,1,0]],bg=[[0,1,0],[1,1,1],[0,1,0]],Pg=[[1,0],[0,1]],Cg=[[0,1],[1,0]],wg=[[1,0,0],[0,1,0],[0,0,1]],Ig=[[0,0,1],[0,1,0],[1,0,0]],xg=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],kg=[[0,0,0,1],[0,0,1,0],[0,1,0,0],[1,0,0,0]],Og=[[1,0,0,0,0],[0,1,0,0,0],[0,0,1,0,0],[0,0,0,1,0],[0,0,0,0,1]],_g=[[0,0,0,0,1],[0,0,0,1,0],[0,0,1,0,0],[0,1,0,0,0],[1,0,0,0,0]],Rg=[[1,1],[0,1],[1,1]],Dg=[[1,1],[1,0],[1,1]],Mg=[[1,0,1],[1,1,1]],Bg=[[1,1,1],[1,0,1]],Lg=Fa.A.GAMEPLAY_32,Ng=Lg.KEY,Gg=Lg.FRAME,Fg=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).scene=void 0,i.frameTargetItem=void 0,i.scene=t,i.createTargetItem(),i}(0,_.A)(t,e);var n=t.prototype;return n.createTargetItem=function(){this.imageTargetItem=this.scene.make.image({key:Ng,frame:Gg.GEM_BLUE}),this.imageTargetItem.setVisible(!1),this.imageTargetItem.setWorldSize(26,26),this.imageTargetItem.setPosition(this.x,this.y),this.scaleImageTargetItem=this.imageTargetItem.scale,this.alphaImageTargetItem=this.imageTargetItem.alpha},n.setTargetItem=function(e){console.log("setTargetItem ===== ",e),this.frameTargetItem=e,this.imageTargetItem.setVisible(!0),this.imageTargetItem.setWorldSize(20,20),this.imageTargetItem.setFrame(e),this.imageTargetItem.setPosition(this.x,this.y),this.imageTargetItem.setScale(this.scaleImageTargetItem)},n.removeTargetItem=function(){this.frameTargetItem="",this.imageTargetItem.setVisible(!1)},t}(tc),Ug=Fg,jg="score",Vg="collect",zg=GameCore.Configs.Board,Yg=zg.cols,Hg=zg.rows,Kg=function(e){function t(t,n,i){var a;return(a=e.call(this,t,n,i)||this).gemFrame=void 0,a}(0,_.A)(t,e);var n=t.prototype;return n.drawPiece=function(){return this.isCreateCell?this.updateCells():this.createCells(.5),this.createAnimShow(),this.playAnimShow(),this.wrapPiece.setInteractive(),this},n.handleDragPieceInvalidMove=function(){var e=this.scene.journeyGameplay.main.board;e.handleRemoveHighlight(),e.removeAllCanCaptureCells()},n.handleDragStart=function(e){var t,n,i=this,a=this.scene.journeyGameplay;if(!a.isGameOver&&!a.isLevelCompleted()){null==(t=this.animScaleUp)||t.stop(),null==(n=this.animScaleDown)||n.stop(),this.setAlpha(this.correctAlpha).setScale(1).setPosition(this.x,this.y),this.isDragEnd=!1,this.isSetDrag=!0,this.setDepth(Na.A.PIECE+1),this.parent.bringToTop(this),this.animMoveDownAndScaleDown&&this.animMoveDownAndScaleDown.isPlaying()&&(this.animMoveDownAndScaleDown.stop(),this.setScale(1)),this.scene.audio.playSound(ja.A.PIECE_PICK);var s=this.scene.journeyGameplay.main.board,r=gl.CELL_SIZE/this.parent.cellSize,o=this.getContainerSize(),c=(o.width,o.height),l=e.worldX-this.getWorldPosition().x+this.x,h=0;if(GameCore.Utils.Device.isDesktop())h=e.worldY-this.getWorldPosition().y+this.y-c*r/2;else{var u=0;u=this.scene.gameZone.width/this.scene.gameZone.height>=375/619?64+c*r/2:73+c*r/2,h=e.worldY-this.getWorldPosition().y+this.y-u}this.distancePY=e.worldY-h;var d=41*s.cellPadding/100;this.updateCellsWithPadding(d),this.playAnimScaleDownCells(),this.animMoveTopAndScaleUp=this.scene.tweens.add({x:l,y:h,scale:r,duration:150,targets:this,ease:Phaser.Math.Easing.Sine.InOut,delay:20,onComplete:function(){if(!i.isDragEnd){var e=i.cellItems[0].cell.gemFrame,t=i.getCellsHighlight();s.handleRemoveHighlight(),s.handleHighlight(t,i.highlightCellCanCapture.bind(i),e)}}}),this.drawSuggestCells()}},n.handleDrag=function(e){var t=this.scene.journeyGameplay;if(!t.isGameOver&&!t.isLevelCompleted()&&this.isSetDrag)try{var n=this.cellItems[0].cell.gemFrame,i=e.worldX-this.getWorldPosition().x+this.x,a=e.worldY-this.distancePY;if(this.animMoveTopAndScaleUp&&this.animMoveTopAndScaleUp.isPlaying())return this.animMoveTopAndScaleUp.updateTo("x",i,!1),void this.animMoveTopAndScaleUp.updateTo("y",a,!1);var s=this.checkOutOfThePage(e),r=s.lockX,o=s.lockY;if(r&&o)return;this.resetCellItems(),this.scene.game.updateFps(Ro.max),r?this.setY(a):o?this.setX(i):this.setPosition(i,a),this.canMove();var c=this.getCellsHighlight(),l=this.scene.journeyGameplay.main.board;l.handleRemoveHighlight(),l.handleHighlight(c,this.highlightCellCanCapture.bind(this),n)}catch(h){this.handleDragPieceInvalidMove()}},n.handleDragEnd=function(){if(!this.isDragEnd&&this.isSetDrag){this.isDragEnd=!0,this.isSetDrag=!1;var t=this.scene.journeyGameplay,n=t.main.board;if(this.setDepth(Na.A.PIECE),n.handleRemoveSuggestMove(),!t.isGameOver&&!t.isLevelCompleted()){this.resetCellItems();try{this.canMove(),this.scene.audio.playSound(ja.A.PIECE_DROP),this.handleBoardMoveCompleted(),t.updateMatchData(),this.wrapPiece.disableInteractive()}catch(i){this.handleInvalidMove()}e.prototype.handleDragEnd.call(this)}}},n.cancelDrag=function(){if(!this.isDragEnd&&this.isSetDrag){this.isDragEnd=!0,this.isSetDrag=!1,this.setDepth(Na.A.PIECE);var e=this.scene.journeyGameplay.main.board;e.handleRemoveSuggestMove(),e.removeAllCanCaptureCells(),this.resetCellItems(),e.handleRemoveHighlight(),this.handleInvalidMove()}},n.handleBoardMoveCompleted=function(){var e=this,t=this.getPositionTopLeftInBoard(),n=this.scene.journeyGameplay.main.board;if(t){var i=this.scene.journeyGameplay;if(i.targetMissionManager.getTargetType()===jg){var a=this.calcScore();i.handleUpdateScore(a||0),i.handleAddScoreAnim(a||0)}var s=this.scene.journeyGameplay.main,r=t.x,o=t.y,c=s.board.dataBoard[o][r].cell.getWorldPosition(),l=c.x,h=c.y,u=this.getWorldPosition(),d=u.x,p=u.y,f=this.x+l-d,m=this.y+h-p,g=this.getContainerSizeOrigin(),v=f+g.width/2,y=m+g.height/2,A=this.getCellsHighlight(),E=this.cellItems[0].cell.gemFrame,T=this.scene.tweens.addCounter({from:.85*this.cellScale,to:this.cellScale,duration:100,onUpdate:function(t){e.cellItems.forEach((function(n){n.cell.setScale(t.getValue());var i=n.cell.scale0/e.scale,a=i+(n.cell.scaleImageTargetItem/e.scale-i)*Phaser.Math.Easing.Sine.InOut(t.progress);n.cell.imageTargetItem.setScale(a,a)}))},ease:Phaser.Math.Easing.Sine.InOut,onComplete:function(){n.handleMove(E,A,e.onBoardHandleMoveCompleted.bind(e))},paused:!0});this.scene.add.tween({targets:this,x:v,y:y,duration:100,ease:"Sine.easeInOut",onComplete:function(){n.handleRemoveHighlight(),e.parent.removeActivePiece(e.index),T.play()}})}else n.handleRemoveHighlight()},n.onBoardHandleMoveCompleted=function(){this.hide(),this.parent.setActivePieces(),this.parent.existPiecesActive()||this.parent.showNewPieces()},n.drawSuggestCells=function(){var e=this.scene.journeyGameplay.main.board,t=e.dataBoard,n=Ac(t,{data:this.data});n&&e.handleSuggestMove(n)},n.handleInvalidMove=function(){var e=this;this.scene.audio.playSound(ja.A.PIECE_INVALID_MOVE),this.scene.journeyGameplay.main.board.handleRemoveHighlight(),this.animMoveDownAndScaleDown=this.scene.tweens.add({x:this.backupPx,y:this.backupPy,scaleX:1,scaleY:1,duration:300,targets:this,ease:Phaser.Math.Easing.Sine.InOut,delay:20,onComplete:function(){e.updateCellsWithPadding(.5)}})},n.canMove=function(){var e=this.scene.journeyGameplay.main.board.dataBoard,t=this.getCellsHighlight();if(0===t.length)throw new _o;for(var n=!0,i=0;i<t.length;i++){var a=t[i],s=a.x,r=a.y;if(!e[r]||!e[r][s]||0!==e[r][s].value){n=!1;break}}if(!n||0===t.length)throw new _o;return n},n.getCellsHighlight=function(){var e=this.scene.journeyGameplay.main.board.dataBoard,t=[],n=this.getPositionTopLeftInBoard();if(null===n)return t;for(var i=0;i<this.data.length;i++)for(var a=0;a<this.data[i].length;a++)if(this.data[i][a].texture){var s=a+n.x,r=i+n.y,o=e[r]&&e[r][s]?e[r][s].x:0,c=e[r]&&e[r][s]?e[r][s].y:0;if(r>=Hg||s>=Yg||!e[r][s]||1===e[r][s].value)return[];t.push({x:s,y:r,pX:o,pY:c,frameItem:this.data[i][a].texture})}return t},n.getPositionTopLeftInBoard=function(){for(var e=this.scene.journeyGameplay.main,t=this.getContainerSize(),n=t.width,i=t.height,a=this.getWorldPosition(),s=a.x,r=a.y,o=e.board.dataBoard,c=s+this.parent.cellSize*this.scale-n/2,l=r+this.parent.cellSize*this.scale-i/2,h=e.board.cellPadding,u=-1,d=-1,p=0;p<Hg;p++)for(var f=0;f<Yg;f++){var m=o[p][f].cell.getWorldPosition(),g=m.x,v=m.y;if(g-h/2<=c&&g+o[p][f].width+h/2>=c&&v-h/2<=l&&v+o[p][f].height+h/2>=l){u=f,d=p;break}}return u<0||u>Yg-1||d<0||d>Hg-1?null:{x:u,y:d}},n.createCells=function(e){var t=this.parent.cellSize;this.gemFrame=Oc[Math.floor(Math.random()*Oc.length)];for(var n=this.data.length,i=this.data[0].length,a=0;a<this.data.length;a++){this.cells[a]=[];for(var s=0;s<this.data[a].length;s++)if(this.data[a][s].texture){var r={x:(s-(i-1)/2)*(t+e),y:(a-(n-1)/2)*(t+e),width:t-2*e,height:t-2*e,gemFrame:this.gemFrame},o=new Ug(this.scene,r);o.setFrame(this.gemFrame),o.setVisible(!0),o.removeTargetItem(),Kt()(_c).call(_c,this.data[a][s].texture)&&(o.setTargetItem(this.data[a][s].texture),o.imageTargetItem.setWorldSize(26*o.scale,26*o.scale)),this.cells[a][s]=o,this.cellItems.push({x:s,y:a,cell:o}),this.cellScale=o.scale,this.add(o),this.add(o.imageTargetItem)}}this.isCreateCell=!0},n.getScore=function(){if(!this.matrixData)return 0;for(var e=0,t=0;t<this.matrixData.length;t++)for(var n=0;n<this.matrixData[0].length;n++)1===this.matrixData[t][n]&&e++;return e},n.updateDataPiece=function(e){this.data=e},n.updateCells=function(){for(var e=0;e<this.data.length;e++)for(var t=0;t<this.data[e].length;t++)if(this.data[e][t].texture&&"x"!==this.data[e][t].texture){var n=this.cells[e][t];n.setFrame(this.gemFrame),n.setVisible(!0),n.removeTargetItem(),Kt()(_c).call(_c,this.data[e][t].texture)&&(n.setTargetItem(this.data[e][t].texture),n.imageTargetItem.setWorldSize(26*n.scale,26*n.scale)),this.cells[e][t]=n}},t}(Fc),Wg=function(e){function t(n,i,s){return e.call(this,n,i,(0,a.A)({},s,{matrixData:t.getMatrixData(s.type,s.direction)}))||this}return(0,_.A)(t,e),t.getDataByDirectionCross2=function(e){var t=[];switch(e){case"left":default:t=Pg;break;case"right":t=Cg}return t},t.getDataByDirectionCross3=function(e){var t=[];switch(e){case"left":default:t=wg;break;case"right":t=Ig}return t},t.getDataByDirectionCross4=function(e){var t=[];switch(e){case"left":default:t=xg;break;case"right":t=kg}return t},t.getDataByDirectionCross5=function(e){var t=[];switch(e){case"left":default:t=Og;break;case"right":t=_g}return t},t.getMatrixData=function(e,n){var i=[];switch(e){case Ns:i=t.getDataByDirectionCross2(n);break;case Gs:i=t.getDataByDirectionCross3(n);break;case Fs:i=t.getDataByDirectionCross4(n);break;case Us:i=t.getDataByDirectionCross5(n)}return i},t.getData=function(e,n){return t.buildData(t.getMatrixData(e,n))},t}(Kg),Zg=Wg,Xg=function(e){function t(n,i,s){return e.call(this,n,i,(0,a.A)({},s,{matrixData:t.getMatrixData(s.type,s.direction)}))||this}return(0,_.A)(t,e),t.getMatrixData=function(e,t){var n=[];switch(e){case Om:n=t===Am?rg:og;break;case km:n=t===Am?ag:sg;break;case Im:n=t===Am?eg:tg;break;case xm:n=t===Am?ng:ig}return n},t.getData=function(e,n){return t.buildData(t.getMatrixData(e,n))},t}(Kg),Jg=Xg,qg=function(e){function t(n,i,s){return e.call(this,n,i,(0,a.A)({},s,{matrixData:t.getMatrixData(s.type,s.direction,s.isReverse)}))||this}return(0,_.A)(t,e),t.getMatrixData=function(e,t,n){void 0===n&&(n=!1);var i=[];switch(t){case Em:n?i=qm:(i=Jm,e===Cm&&(i=Qm),e===wm&&(i=$m));break;case Tm:n?i=zm:(i=Vm,e===Cm&&(i=Ym),e===wm&&(i=Hm));break;case Sm:if(n){i=Fm;break}i=Gm,e===Cm&&(i=Um),e===wm&&(i=jm);break;case bm:n?i=Wm:(i=Km,e===Cm&&(i=Zm),e===wm&&(i=Xm))}return i},t.getData=function(e,n,i){return void 0===i&&(i=!1),t.buildData(t.getMatrixData(e,n,i))},t}(Kg),Qg=qg,$g=function(e){function t(n,i,s){return e.call(this,n,i,(0,a.A)({},s,{matrixData:t.getMatrixData()}))||this}return(0,_.A)(t,e),t.getMatrixData=function(){return bg},t.getData=function(){return t.buildData(t.getMatrixData())},t}(Kg),ev=$g,tv=function(e){function t(n,i,s){return e.call(this,n,i,(0,a.A)({},s,{matrixData:t.getMatrixData(s.type)}))||this}return(0,_.A)(t,e),t.getMatrixData=function(e){var t=[];switch(e){case _m:t=cg;break;case Rm:t=lg;break;case Dm:t=hg}return t},t.getData=function(e){return t.buildData(t.getMatrixData(e))},t}(Kg),nv=tv,iv=function(e){function t(n,i,s){return e.call(this,n,i,(0,a.A)({},s,{matrixData:t.getMatrixData(s.direction)}))||this}return(0,_.A)(t,e),t.getMatrixData=function(e){var t=[];switch(e){case"left":default:t=Ag;break;case"right":t=Eg;break;case"top":t=Tg;break;case"bottom":t=Sg}return t},t.getData=function(e){return t.buildData(t.getMatrixData(e))},t}(Kg),av=iv,sv=function(e){function t(n,i,s){return e.call(this,n,i,(0,a.A)({},s,{matrixData:t.getMatrixData(s.direction)}))||this}return(0,_.A)(t,e),t.getMatrixData=function(e){var t=[];switch(e){case"vertical_left":default:t=ug;break;case"vertical_right":t=dg;break;case"horizontal_right":t=fg;break;case"horizontal_left":t=pg}return t},t.getData=function(e){return t.buildData(t.getMatrixData(e))},t}(Kg),rv=sv,ov=function(e){function t(n,i,s){return e.call(this,n,i,(0,a.A)({},s,{matrixData:t.getMatrixData(s.direction)}))||this}return(0,_.A)(t,e),t.getMatrixData=function(e){var t=[];switch(e){case"left":default:t=mg;break;case"right":t=gg;break;case"top":t=vg;break;case"bottom":t=yg}return t},t.getData=function(e){return t.buildData(t.getMatrixData(e))},t}(Kg),cv=ov,lv=function(e){function t(n,i,s){return e.call(this,n,i,(0,a.A)({},s,{matrixData:t.getMatrixData(s.direction)}))||this}return(0,_.A)(t,e),t.getMatrixData=function(e){var t=[];switch(e){case"left":default:t=Rg;break;case"right":t=Dg;break;case"top":t=Mg;break;case"bottom":t=Bg}return t},t.getData=function(e){return t.buildData(t.getMatrixData(e))},t}(Kg),hv=lv,uv=function(){function e(){}return e.create=function(e,t,n){var i;switch(n.type){case Pm:case Cm:case wm:i=new Qg(e,t,n);break;case Im:case xm:case km:case Om:i=new Jg(e,t,n);break;case _m:case Rm:case Dm:i=new nv(e,t,n);break;case Bm:i=new cv(e,t,n);break;case Bs:i=new av(e,t,n);break;case js:i=new hv(e,t,n);break;case Ls:i=new ev(e,t,n);break;case Ns:case Gs:case Fs:case Us:i=new Zg(e,t,n);break;case Mm:i=new rv(e,t,n);break;default:i=new nv(e,t,n)}return i},e}(),dv=uv,pv=Fa.A.GAMEPLAY_32,fv=pv.KEY,mv=pv.FRAME,gv=GameCore.Configs,vv=gv.Gameplay,yv=gv.Match,Av=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.tweenToEnableMaxFps=void 0,n.cellSize=void 0,n.canCaptureLines=void 0,n.allPieces=[],n.allPiecesGroup=[],n.piecesActive=[],n.positionPiece=void 0,n.listPieceMap=[],n.amountPieceContainGem=0,n.hasPieceContainGem=void 0,n.segmentAmountPiece1Min=0,n.segmentAmountPiece1Max=0,n.segmentAmountPiece1Cur=0,n.segmentAmountPiece5Min=0,n.segmentAmountPiece5Max=0,n.segmentAmountPiece5Cur=0,n.segmentAvgScore=0,n.segmentTotalPieceScore=0,n.segmentTotalPiece=0,n.segmentTotalScore=0,n.segmentPieceDistancePerGem=0,n.segmentPieceRandomGem=!1,t.add.existing((0,ka.A)(n)),n.scene=t,n.canCaptureLines={isCapture:!1,direction:"",minLine:5},n.init(),n}(0,_.A)(t,e);var n=t.prototype;return n.init=function(){this.setSizeAndPositionPiece(),this.initCellSize(),this.createAllPieces(),this.createAllPiecesGroup(),this.createTweenToEnableMaxFps()},n.setSizeAndPositionPiece=function(){this.setSize(338,102);var e=(this.scene.gameZone.height/2-176-27+100)/-2;this.positionPiece=[{x:-this.width/3,y:e},{x:0,y:e},{x:this.width/3,y:e}]},n.initCellSize=function(){this.cellSize=40*gl.CELL_SIZE/100},n.setContentPosition=function(e,t){this.setPosition(e,t)},n.createTweenToEnableMaxFps=function(){this.tweenToEnableMaxFps=this.scene.add.tween({targets:[],duration:300,loop:-1,paused:!0})},n.playTweenToEnableMaxFps=function(){this.tweenToEnableMaxFps.play()},n.stopTweenToEnableMaxFps=function(){this.tweenToEnableMaxFps.stop()},n.getDirectionsByType=function(e){if([_m,Rm,Dm].some((function(t){return t===e})))return[];var t=[];switch(e){case Pm:case Cm:case wm:t=[Sm,Em,Tm,bm];break;case Im:case xm:case km:case Om:t=[Am,"horizontal"];break;case Bm:t=[Sm,Em,Tm,bm];break;case Mm:t=["vertical_left","vertical_right","horizontal_left","horizontal_right"];break;case Bs:case js:t=[Sm,Em,Tm,bm];break;case Ls:t=[];break;case Ns:case Gs:case Fs:case Us:t=[Em,Tm]}return t},n.createAllPieces=function(){for(var e=this.cellSize,t=[],n=0;n<Lm.length;n++){var i=this.getDirectionsByType(Lm[n]);if(i.length<=0)t.push({type:Lm[n]});else{for(var s=0;s<i.length;s++)t.push({type:Lm[n],direction:i[s]});if(Pm===Lm[n])for(var r=0;r<i.length;r++)t.push({type:Lm[n],direction:i[r],isReverse:!0})}}for(var o=0;o<t.length;o++){var c=(0,a.A)({},t[o],{texture:fv,frame:mv.GEM,x:Math.floor(this.x),y:Math.floor(this.y),width:Math.floor(e/2),height:Math.floor(e/2),cellLength:Math.floor(e/2),parentHeight:this.height,wrap:{x:Math.floor(this.x),y:Math.floor(this.y),width:Math.floor(e/2),height:Math.floor(e/2)}}),l=dv.create(this.scene,this,c);l.hide(),this.allPieces.push({piece:l,isUsed:!1}),this.add(l)}},n.createAllPiecesGroup=function(){for(var e=0;e<this.allPieces.length;e++){var t=this.allPieces[e].piece;this.allPiecesGroup[t.type]||(this.allPiecesGroup[t.type]=[]),this.allPiecesGroup[t.type].push(e)}},n.randomPieces=function(){var e=this;this.scene.game.updateFps(Ro.max);for(var t=this.buildPieceRates(!1),n=[],i=function(){var i=Math.floor(Math.random()*t.length),a=t[i];if(!e.allPiecesGroup[a])return 1;var s=Math.floor(Math.random()*e.allPiecesGroup[a].length),r=e.allPiecesGroup[a][s],o=[km,Om].some((function(e){return e===a}));if(e.canCaptureLines.isCapture&&o){for(var c=0;c<e.allPiecesGroup[a].length;c++){var l=e.allPiecesGroup[a][c],h=e.allPieces[l].piece;if(h&&h.direction===e.canCaptureLines.direction){r=l;break}}t=e.buildPieceRates(!1)}n.some((function(e){return e.index===r}))||n.push({index:r,type:a})};n.length<3;)i();for(var a=[],s=0;s<n.length;s++){var r=n[s].index,o=this.allPieces[r].piece;a.push({position:r,texture:fv,frame:mv.GEM,type:o.type,direction:o.direction,isReverse:o.isReverse})}this.piecesActive=a},n.buildPieceRates=function(e){void 0===e&&(e=!0);for(var t=[],n=0;n<Nm.length;n++)t.push((0,a.A)({},Nm[n]));var i=this.scene.journeyGameplay.main.board,s=i.dataBoard;if(e){var r=5;if(this.canCaptureLines=i.canCaptureLines(s,r),this.canCaptureLines.isCapture)for(var o=0;o<t.length;o++)t[o].type===Om&&(t[o].rate=8);else if(r=4,this.canCaptureLines=i.canCaptureLines(s,r),this.canCaptureLines.isCapture)for(var c=0;c<t.length;c++)t[c].type===km&&(t[c].rate=8)}for(var l=[],h=0;h<t.length;h++)for(var u=t[h],d=u.type,p=u.rate,f=0;f<p;f++)l.push(d);return l},n.drawPieces=function(){console.log("drawPieces",this.piecesActive);for(var e=0;e<this.piecesActive.length;e++){var t=this.piecesActive[e],n=t.position,i=t.fenPiece,a=this.allPieces[n].piece,s=this.positionPiece[e].x;if(i){var r=this.convertFenPiecesToData(i);r&&a.updateDataPiece(r)}else{if(0===this.listPieceMap.length)if(this.isPieceContainGem()){var o=this.getRandomPieceData(a.data);o&&a.updateDataPiece(o)}}a.updatePosition(s,0),a.updatePositionWrapPiece(),a.setIndex(e),a.drawPiece(),this.allPieces[n]={piece:a,isUsed:!0}}},n.isPieceContainGem=function(){if(1===Phaser.Math.Between(0,1)&&!this.hasPieceContainGem)return this.amountPieceContainGem++,this.hasPieceContainGem=!0,!0;if(this.amountPieceContainGem<vv.RatePieceContainGem)return this.amountPieceContainGem++,!1;if(this.amountPieceContainGem>=vv.RatePieceContainGem){var e=this.hasPieceContainGem;return this.amountPieceContainGem=0,this.hasPieceContainGem=!1,!e}return!1},n.convertFenPiecesToData=function(e){if(!e)return null;var t=e.split("/");if(0===t.length)return null;for(var n=[],i=0;i<t.length;i++){var a=t[i].split(",");n[i]=[];for(var s=0;s<a.length;s++){var r=Pc(a[s]);"null"!==a[s]&&"x"!==a[s]||(r=null),n[i].push({x:i,y:s,texture:r})}}return n},n.countDataGem=function(e){for(var t=0,n=0;n<e.length;n++)e[n].texture&&t++;return t},n.getRandomPieceData=function(e){var t=this.scene.journeyGameplay.header.collectItems.getTargetKeys();if(!t||0===t.length)return null;for(var n=0,i=e.length,a=e[0].length,s=0;s<i;s++)for(var r=0;r<a;r++){var o=this.countDataGem(e[s]);if(e[s][r].texture&&(Phaser.Math.Between(0,1)||n||r+1===o)){var c=mv.GEM;if(n<vv.MaxGemInPiece)c=t[Phaser.Math.Between(0,t.length-1)];console.log("getRandomPieceData",t,c),e[s][r]={x:s,y:r,texture:c},n++}}return e},n.removeActivePiece=function(e){this.piecesActive[e].used=!0},n.existPiecesActive=function(){var e,t=f()(e=this.piecesActive).call(e,(function(e){return!e.used}));return t&&t.length>0},n.showNewPieces=function(){this.resetAllPieces(),this.listPieceMap.length>0?this.showListPieceMap():(this.randomPieces(),this.setActivePieces(),this.drawPieces())},n.setActivePieces=function(){for(var e=this.scene.journeyGameplay.main.board.dataBoard,t=0;t<this.piecesActive.length;t++){var n=this.piecesActive[t].position,i=this.allPieces[n].piece,a=yc(e,i);i.setCanMove(a)}},n.getPiecesByFen=function(e){var t=[],n=e.split(" ");if(n.length<2)throw new Error("Invalid fen");for(var i=_a()(n).call(n,2),a=0;a<i.length;a++){var s,r;if("l"!==sc()(s=i[a]).call(s)){var o=wc(sc()(r=i[a]).call(r));t.push(o)}}return t},n.getFenByPieces=function(){for(var e="l",t=0;t<this.piecesActive.length;t++){var n=this.piecesActive[t],i=n.type,a=n.direction,s=n.isReverse,r=n.used,o=n.position,c=n.frame;if(!r){var l=bc(i);a&&""!==a&&(l+="-"+bc(a)),s&&(l+="-r");this.allPieces[o].piece;e+=" "+l+","+bc(c)}}return e},n.getFenDataPiece=function(e){for(var t=e.data,n=t.length,i=t[0].length,a="",s=0;s<n;s++){for(var r="",o=0;o<i;o++)r+=","+bc(t[s][o].texture);a+="/"+r.substring(1)}return a.substring(1)},n.clearPieces=function(){for(var e=0;e<this.piecesActive.length;e++){var t=this.piecesActive[e].position;this.allPieces[t].isUsed=!1,this.allPieces[t].piece.hide()}this.piecesActive=[],this.listPieceMap=[]},n.resetAllPieces=function(){for(var e=0;e<this.allPieces.length;e++)this.allPieces[e].isUsed=!1,this.allPieces[e].piece.reset()},n.showAvailablePieces=function(e){try{if(!e||e.length<=0)return;this.resetAllPieces();for(var t=[],n=0;n<e.length;n++){for(var i=e[n],a=i.type,s=i.direction,r=i.isReverse,o=i.frame,c=!1,l=0;l<this.allPieces.length;l++){var h=this.allPieces[l],u=h.piece,d=h.isUsed;if(a===u.type&&s===u.direction&&r===u.isReverse){if(d){c=!0;continue}c=!1,t.push({position:l,texture:fv,frame:o,type:u.type,direction:u.direction,isReverse:u.isReverse,fenPiece:e[n].fenPiece}),this.allPieces[l].isUsed=!0;break}}if(c){var p=this.spawnPiece(a,s,r),f=p.piece,m=p.index;t.push({position:m,texture:fv,frame:o,type:f.type,direction:f.direction,isReverse:f.isReverse,fenPiece:e[n].fenPiece})}}this.piecesActive=t,this.setActivePieces(),this.drawPieces()}catch(g){console.log("zzzzzzzzzzzzzzzzzzzz",g)}},n.spawnPiece=function(e,t,n){var i=this.cellSize,a={type:e,direction:t,isReverse:n,texture:fv,frame:mv.GEM,x:Math.floor(this.x),y:Math.floor(this.y),width:Math.floor(i/2),height:Math.floor(i/2),cellLength:Math.floor(i/2),parentHeight:this.height,wrap:{x:Math.floor(this.x),y:Math.floor(this.y),width:Math.floor(i/2),height:Math.floor(i/2)}},s=dv.create(this.scene,this,a);return s.hide(),this.allPieces.push({piece:s,isUsed:!0}),this.add(s),{piece:s,index:this.allPieces.length-1}},n.showListPieceMap=function(){var e;if(this.piecesActive=_a()(e=this.listPieceMap).call(e,0,3),this.showAvailablePieces(this.piecesActive),this.scene.footer.textExist){var t=this.listPieceMap.length<=0?"Done":"Exits";this.scene.footer.textExist.setText(t)}},n.validItemsPieceMap=function(e){for(var t,n=!0,i=B()(t=[]).call(t,e),a=function(){var e=i.shift(),t=f()(i).call(i,(function(t){return t.type===(null==e?void 0:e.type)&&t.direction===e.direction&&t.isReverse===e.isReverse}));t&&t.length>0&&(n=!1)};i.length>1;)a();return n},n.getPieceDataByType=function(e){return Rc[e]},n.addItemPieceMap=function(e){if(e.properties){var t=this.getFenPieceForPropertiesPieceMap(e);t&&(e=(0,a.A)({},e,{fenPiece:t}))}this.listPieceMap.push(e)},n.getFenPieceForPropertiesPieceMap=function(e){var t,n;if(!e.properties)return"";var i="",a=null==(t=f()(n=this.allPieces).call(n,(function(t){var n=t.piece;return n.direction===e.direction&&n.isReverse===e.isReverse&&n.type===e.type}))[0])?void 0:t.piece,s=e.properties[0].value.split(","),r=e.properties[1].value.split(","),o=0;if(!a)return i;for(var c=a.data,l=c.length,h=c[0].length,u=0;u<l;u++){for(var d="",p=0;p<h;p++){var m=c[u][p].texture,v=m,y=g()(r).call(r,String(o));m&&(-1!==y&&(v=xc[s[y]]),o++);var A=null;v&&(A=bc(v)),d+=","+A}i+="/"+d.substring(1)}return i.substring(1)},n.start=function(){0!==this.listPieceMap.length?this.showListPieceMap():this.showNewPieces()},n.getListPieceMap=function(){return this.listPieceMap},n.setListPieceMap=function(e){var t;this.listPieceMap=B()(t=[]).call(t,e)},n.buildPiecesByMap=function(){var e=this.scene.journeyGameplay.mapManager.getTileMap().layers[0].properties;if(e&&!(e.length<=0)){for(var t=0;t<e.length;t++){var n=e[t].value;if(n){var i=n.avgScore,a=n.score,s=n.pieceDistancePerGem;console.log("pieceDistancePerGem === ",s,i,a);var r=n.piece1,o=n.piece5;r=r.replace("min",'"min"').replace("max",'"max"'),o=o.replace("min",'"min"').replace("max",'"max"');var c=JSON.parse(r),l=JSON.parse(o);this.segmentAvgScore=i,this.segmentAmountPiece1Min=c.min,this.segmentAmountPiece1Max=c.max,this.segmentAmountPiece5Min=l.min,this.segmentAmountPiece5Max=l.max,this.segmentTotalScore=a,this.segmentPieceDistancePerGem=s,this.segmentTotalPieceScore=0,this.segmentTotalPiece=0,this.listPieceMap=[],this.buildObjectPieces()}}console.log("list ",this.listPieceMap)}},n.buildObjectPieces=function(){for(;this.checkAverageScore();)this.buildObjectPiece()},n.checkAverageScore=function(){return 0===this.segmentTotalPiece||0===this.segmentTotalPieceScore||!(this.segmentTotalPiece>yv.PieceRandoms.maxPiece)&&!(this.segmentTotalPieceScore/this.segmentTotalPiece<=this.segmentAvgScore+yv.PieceRandoms.measureError&&this.segmentTotalPieceScore/this.segmentTotalPiece>=this.segmentAvgScore-yv.PieceRandoms.measureError&&this.segmentTotalPieceScore>=this.segmentTotalScore)},n.buildObjectPiece=function(){var e=this.getPieceByAvgScore();if(e)if(this.checkPieceMaxAmountConfig(e)){var t="";if(Math.floor((this.segmentTotalPiece-1)/3)%this.segmentPieceDistancePerGem===0){var n=Phaser.Math.Between(0,1);if((this.segmentTotalPiece-1)%3===0&&1===this.segmentPieceDistancePerGem&&(this.segmentPieceRandomGem=!1),n&&!this.segmentPieceRandomGem||!this.segmentPieceRandomGem&&this.segmentTotalPiece%3===2){var i=this.getRandomPieceData(e.data);i&&(e.updateDataPiece(i),t=this.getFenDataPiece(e)),this.segmentPieceRandomGem=!0}}else this.segmentPieceRandomGem=!1;this.listPieceMap.push({type:e.type,direction:e.direction,isReverse:e.isReverse,fenPiece:t})}else this.buildObjectPiece()},n.checkPieceMaxAmountConfig=function(e){var t=e.getScore();switch(t){case 1:if(this.segmentAmountPiece1Max<=this.segmentAmountPiece1Cur)return!1;this.segmentAmountPiece1Cur++;break;case 5:if(this.segmentAmountPiece5Max<=this.segmentAmountPiece5Cur)return!1;this.segmentAmountPiece5Cur++}return this.segmentTotalPiece++,this.segmentTotalPieceScore+=t,!0},n.getPieceByAvgScore=function(){var e=this;if(this.segmentTotalPieceScore<this.segmentTotalScore){var t=this.buildPieceRates(!1),n=t[Math.floor(Math.random()*t.length)];if(!this.allPiecesGroup[n])return null;var i=Math.floor(Math.random()*this.allPiecesGroup[n].length),a=this.allPiecesGroup[n][i];return this.allPieces[a].piece}if(this.segmentTotalPieceScore/this.segmentTotalPiece<=this.segmentAvgScore){var s,r=f()(s=this.allPieces).call(s,(function(t){return t.piece.getScore()<=e.segmentAvgScore}));return r&&0!==r.length?r[Phaser.Math.Between(0,r.length-1)].piece:null}if(this.segmentTotalPieceScore/this.segmentTotalPiece>this.segmentAvgScore){var o,c=f()(o=this.allPieces).call(o,(function(t){return t.piece.getScore()>e.segmentAvgScore}));return c&&0!==c.length?c[Phaser.Math.Between(0,c.length-1)].piece:null}return null},n.debuggerNextPieces=function(){for(var e=0;e<this.piecesActive.length;e++)this.removeActivePiece(e);for(var t=0;t<this.allPieces.length;t++)this.allPieces[t].piece.wrapPiece.setVisible(!1);this.showNewPieces()},n.addDebuggerBtnRandomPieces=function(){var e=this;if(GameCore.Utils.Valid.isDebugger())for(var t=[80,187.5,295],n=this.scene.gameZone.height,i=function(i){var a=new Va.A(e.scene,fv,mv.GEM,50,30);e.add(a),a.onClick=function(){e.debuggerNewPieces(i)},a.setPosition(t[i],n)},a=0;a<3;a++)i(a)},n.debuggerNewPieces=function(e){this.removeActivePiece(e);var t=this.piecesActive[e],n=this.allPieces[t.position].piece;n.setVisible(!1);var i=Phaser.Math.Between(0,this.allPieces.length-1);this.piecesActive[e]={position:i,texture:fv,frame:mv.GEM,type:n.type,direction:n.direction,isReverse:n.isReverse};var a=this.piecesActive[e],s=a.position,r=a.fenPiece,o=this.allPieces[s].piece,c=this.positionPiece[e].x;if(r){var l=this.convertFenPiecesToData(r);l&&o.updateDataPiece(l)}else{if(0===this.listPieceMap.length)if(this.isPieceContainGem()){var h=this.getRandomPieceData(o.data);h&&o.updateDataPiece(h)}}o.updatePosition(c,0),o.updatePositionWrapPiece(),o.setIndex(e),o.drawPiece()},n.unregisterPiecesGlobalEvents=function(){this.allPieces.forEach((function(e){e.piece.unregisterEvents()}))},n.registerPiecesGlobalEvents=function(){this.allPieces.forEach((function(e){e.piece.registerEvents()}))},n.alignComponents=function(){for(var e=0;e<this.piecesActive.length;e++){this.allPieces[this.piecesActive[e].position].piece.alignComponents()}},t}(Phaser.GameObjects.Container),Ev=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.pieces=void 0,n.bg=void 0,n.scene=t,n.init(),n.setSize(n.scene.gameZone.width,n.bg.height),t.add.existing((0,ka.A)(n)),n}(0,_.A)(t,e);var n=t.prototype;return n.init=function(){this.createBackground(),this.createPieces()},n.createBackground=function(){this.bg=new pl.A(this.scene,0,0,338,102,"panel"),this.add(this.bg)},n.createPieces=function(){this.pieces=new Av(this.scene),this.add(this.pieces)},n.alignComponents=function(){this.pieces.alignComponents()},n.registerPiecesGlobalEvents=function(){this.pieces.registerPiecesGlobalEvents()},n.unregisterPiecesGlobalEvents=function(){this.pieces.unregisterPiecesGlobalEvents()},t}(Phaser.GameObjects.Container),Tv=Fa.A.GAMEPLAY,Sv=Tv.KEY,bv=Tv.FRAME,Pv=function(){function e(e){this.scene=void 0,this.tweenScaleUp=void 0,this.tweenScaleDown=void 0,this.tweenMoveTo=void 0,this.target=void 0,this.handleOnComplete=void 0,this.playing=void 0,this.path=void 0,this.particle=void 0,this.emitterStar=void 0,this.scene=e,this.path=new Phaser.Curves.Path,this.createParticle(),this.createEmitterStar()}var t=e.prototype;return t.createParticle=function(){this.particle=this.scene.add.particles(Sv),this.particle.setDepth(Na.A.EFFECT)},t.createEmitterStar=function(){this.emitterStar=this.particle.createEmitter({x:0,y:0,frame:[bv.DUST],speed:{min:50,max:100},scale:{start:.7,end:0},follow:this.target,on:!1,angle:{min:80,max:100},lifespan:{min:500,max:1e3}})},t.runScaleUpAnimation=function(e,t){var n;null==(n=this.tweenScaleUp)||n.remove(),this.tweenScaleUp||(this.tweenScaleUp=new Gh.A({targets:[this.target],delay:e,duration:t,props:{scale:"+=0.05"}})),this.tweenScaleUp.play()},t.runScaleDownAnimation=function(e,t){var n;null==(n=this.tweenScaleDown)||n.remove(),this.tweenScaleDown||(this.tweenScaleDown=new Fh.A({targets:[this.target],delay:e,duration:t,props:{scale:"-=0.05"}})),this.tweenScaleDown.play()},t.runAnimMoveToPosition=function(e,t,n,i){var a=this;this.playing=!0,this.target.setDepth(Na.A.ON_TOP);var s=this.target.getWorldPosition(),r=s.x,o=s.y,c=this.scene.journeyGameplay.main.getWorldPosition(),l=c.x,h=c.y;this.particle.setPosition(l,h),this.path.startPoint=new Phaser.Math.Vector2(r,o);var u=Math.abs(n-r)/2,d=Math.abs(i-o),p=Phaser.Math.Between(.5,1),f=20;this.scene.world.isLandscape()&&(f=l-this.scene.gameZone.width/3);for(var m=[],g=1;g<4;g++){var v=-1;g%2==0&&(v=1);var y=f+(u-v*Phaser.Math.Between(u/4,u/3))*p,A=o-g*(d/4);m.push(new Phaser.Math.Vector2(y,A))}m.push(new Phaser.Math.Vector2(n,i)),this.path.splineTo(m),this.path.lineTo(n,i);var E=new Phaser.Curves.Spline(m),T=this.target.x,S=this.target.y;this.tweenMoveTo=this.scene.add.tween({delay:e,targets:this.path,t:{from:0,to:1},ease:Phaser.Math.Easing.Sine.InOut,duration:t,onStart:function(){a.emitterStar.setVisible(!0),a.emitterStar.startFollow(a.target),a.emitterStar.start()},onUpdate:function(e){var t=e.getValue(0),n=E.getPoint(t);a.target.setPosition(n.x-r+T,n.y-o+S)},onComplete:function(){a.playing=!1,a.emitterStar.stop(),a.handleOnComplete&&a.handleOnComplete()}})},t.runGemMoveToPosition=function(e,t,n,i){var a=this;this.playing=!0,this.target.setDepth(Na.A.ON_TOP);var s=this.target.x,r=this.target.y;this.path.startPoint=new Phaser.Math.Vector2(s,r);for(var o=this.scene.gameZone.width/2,c=Math.abs(n-s)+o-50,l=Math.abs(i-r),h=[],u=1;u<4;u++){var d=-1;u%2==0&&(d=1);var p=1.5*(c-d*Phaser.Math.Between(c/8,c/7)),f=r-u*(l/4);h.push(new Phaser.Math.Vector2(p,f))}h.push(new Phaser.Math.Vector2(n,i)),this.path.splineTo(h),this.path.lineTo(n,i);var m=new Phaser.Curves.Spline(h);return this.tweenMoveTo=this.scene.add.tween({delay:e,targets:this.path,t:{from:0,to:1},ease:Phaser.Math.Easing.Sine.InOut,duration:t,onUpdate:function(e){var t=e.getValue(0),n=1-t+.1,i=m.getPoint(t);a.target.setAlpha(n),a.target.setPosition(i.x,i.y)},onComplete:function(){a.playing=!1,a.handleOnComplete&&a.handleOnComplete()}}),this.tweenMoveTo},t.setTarget=function(e){this.target=e},(0,ve.A)(e,[{key:"onComplete",set:function(e){this.handleOnComplete=e}},{key:"isPlaying",get:function(){return this.playing}}]),e}(),Cv=function(){function e(e){this.scene=void 0,this.listAnimCollectionItem=[],this.scene=e}var t=e.prototype;return t.handleShowEffect=function(e){var t=this;if(e&&0!==e.length){this.scene.player.getPlayerSettings().vibrate&&ql(199);for(var n=this.scene.journeyGameplay,i=n.header,a=n.main,s=i.collectItems.getTargetKeys(),r=i.collectItems.getJsonAmount(),o=i.collectItems.getJsonTarget(),c=0,l=function(){var n=s[h],i=f()(e).call(e,(function(e){var t=e.x,i=e.y;return a.board.dataBoard[i][t].cell.frameTargetItem===n}));r[n]+i.length>=o[n]&&c++,t.showEffect(i)},h=0;h<s.length;h++)l();c===he()(o).length&&this.scene.journeyGameplay.setLevelCompleted(!0),this.scene.time.delayedCall(2e3,(function(){t.scene.journeyGameplay.handleCollectionItemsComplete()}))}},t.showEffect=function(e){for(var t=this,n=e.length,i=this.scene.journeyGameplay.main.board.dataBoard,a=function(){var a=e[s],r=a.x,o=a.y,c=a.frame,l=i[o][r].cell,h=l.imageBreak,u=l.imageTargetItem,d=l.frameTargetItem,p=t.scene.journeyGameplay.header.collectItems.getCollectItemByKey(d).getWorldPosition(),f=p.x,m=p.y,g=t.getFreeAnim();l.resetImageBreak(),h.setVisible(!0),h.setFrame(c),g.setTarget(u),g.onComplete=function(){(n--,l.removeTargetItem(),h.setVisible(!1),h.setPosition(l.x,l.y),t.scene.journeyGameplay.header.collectItems.collectItem(d),n<=0)&&(t.scene.journeyGameplay.header.collectItems.getCollectItemByKey(d).runAnimCollectionItem(),t.scene.updateMatchData())},g.runScaleUpAnimation(0,300),g.runScaleDownAnimation(450,400),g.runAnimMoveToPosition(700,Phaser.Math.Between(500,1e3),f,m)},s=0;s<e.length;s++)a()},t.getFreeAnim=function(){var e=new Pv(this.scene);return this.listAnimCollectionItem.push(e),e},e}(),wv=Cv,Iv=Fa.A.GAMEPLAY_32,xv=Iv.FRAME,kv=Iv.KEY,Ov=GameCore.Configs.Board,_v=Ov.cols,Rv=Ov.rows,Dv=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.collectionEffect=void 0,n.scene=t,n.collectionEffect=new wv(n.scene),n}(0,_.A)(t,e);var n=t.prototype;return n.initDataBoard=function(){for(var e=gl.CELL_PADDING,t=gl.CELL_SIZE,n=this.boardFrame.x-(e+t)*_v/2+t/2,i=this.boardFrame.y-(e+t)*Rv/2+t/2,a=0;a<Rv;a++){this.dataBoard[a]=[];for(var s=0;s<_v;s++){var r=n+s*t+e*s,o=i+a*t+e*a,c={x:r,y:o,width:t,height:t,texture:kv,frame:xv.GEM_TRANSPARENT,depth:Na.A.PIECE-.1,padding:e,isWoodenEffect:!0},l=new Ug(this.scene,c);this.add(l),this.add(l.imageGameOver),this.add(l.imageHighlight),this.add(l.imageBreak),this.add(l.imageGameStart),this.add(l.imageTargetItem),l.setVisible(!1),this.dataBoard[a][s]={x:r,y:o,width:t,height:t,frame:xv.GEM_TRANSPARENT,value:0,cell:l}}}},n.showBoard=function(){for(var e=0;e<Rv;e++)for(var t=0;t<_v;t++){var n=this.dataBoard[e][t];n.cell.setFrame(xv.GEM_BLUE),n.cell.setVisible(!0)}},n.handleCapturePiece=function(e,t,n){var i=this;try{if(!t||t.length<=0)throw Tc(),new Error("Invalid Capture");var a=f()(t).call(t,(function(e){var t=e.x,n=e.y;return i.dataBoard[n][t].cell.frameTargetItem}));this.collectionEffect.handleShowEffect(a);for(var s=[],r=0;r<n.length;r++){var o=n[r],c=o.x,l=o.y;s.push([c,l])}this.scene.journeyGameplay.timeDelayOutOfMove=1200,console.log("captureCells === ",t,n,this.scene.journeyGameplay.timeDelayOutOfMove);for(var h=fc(this.dataBoard),u=mc(this.dataBoard),d=dc(),p=[],m=function(){for(var n=t[g],a=n.x,r=n.y,o=function(){var t=s[c],n=t[0],o=t[1];if(a==n&&r==o){p.push([a,r]);var l=i.dataBoard[r][a].cell;l.setFrame(e),l.hideImageHighlight(),i.scene.time.delayedCall(0,(function(){l.playTweenScaleDown(e),l.runJewelEffect(d,e),0==i.dataBoard[r][a].value&&l.setVisible(!1)})),i.dataBoard[r][a].frame=xv.GEM_TRANSPARENT,i.dataBoard[r][a].value=0}},c=0;c<s.length;c++)o()},g=0;g<t.length;g++)m();for(var v=100,y=function(){for(var t=h[A],n=9,a=-1,s=0;s<p.length;s++){var r=p[s],o=r[0],c=r[1];t==c&&(n>o&&(n=o),a<o&&(a=o))}for(var l=function(s){var r=0,o=i.dataBoard[t][s].cell;if(s<n&&(r=v*(n-s)),s>a&&(r=v*(s-a)),0==r)return 1;o.setFrame(e),o.hideImageHighlight(),i.scene.time.delayedCall(r,(function(){o.playTweenScaleDown(e),o.runJewelEffect(d,e),0==i.dataBoard[t][s].value&&o.setVisible(!1)})),i.dataBoard[t][s].frame=xv.GEM_TRANSPARENT,i.dataBoard[t][s].value=0},u=0;u<8;u++)l(u)},A=0;A<h.length;A++)y();for(var E=function(){for(var t=u[T],n=9,a=-1,s=0;s<p.length;s++){var r=p[s],o=r[0],c=r[1];t==o&&(n>c&&(n=c),a<c&&(a=c))}for(var l=function(s){var r=0,o=i.dataBoard[s][t].cell;if(s<n&&(r=v*(n-s)),s>a&&(r=v*(s-a)),0==r)return 1;o.setFrame(e),o.hideImageHighlight(),i.scene.time.delayedCall(r,(function(){o.playTweenScaleDown(e),o.runJewelEffect(d,e),0==i.dataBoard[s][t].value&&o.setVisible(!1)})),i.dataBoard[s][t].frame=xv.GEM_TRANSPARENT,i.dataBoard[s][t].value=0},h=0;h<8;h++)l(h)},T=0;T<u.length;T++)E()}catch(S){console.log("zzzzzzzzzzzzzzzzzzzzzzzz ",S)}},n.handlePraise=function(e,t){for(var n=[],i=0;i<e.length;i++){var a=e[i];this.checkPositionCellOnCaptureCell(a,t)&&n.push(a)}0!==n.length&&this.playEatSound(1)},n.handleMove=function(e,t,n){try{for(var i=0;i<t.length;i++){var a=t[i],s=a.x,r=a.y,o=a.frameItem;if(this.dataBoard[r]&&this.dataBoard[r][s]){this.dataBoard[r][s].frame=e,this.dataBoard[r][s].value=1;var c=this.dataBoard[r][s].cell;c.setVisible(!0),c.setFrame(e),c.setAlpha(1),o&&Kt()(_c).call(_c,o)&&(this.dataBoard[r][s].frameTarget=o,c.setTargetItem(o))}}var l=pc(this.dataBoard);this.handleCapturePiece(e,l,t),this.handlePraise(t,l),n&&n(),this.handleResetFrameBoard(),this.scene.updateMatchData(),this.handleGameOver()}catch(h){console.log(h)}},n.handleGameOver=function(){var e=this;if(!this.scene.journeyGameplay.isLevelCompleted()){for(var t=[],n=this.scene.journeyGameplay.footer.pieces.piecesActive,i=this.scene.journeyGameplay.footer.pieces.allPieces,a=0;a<n.length;a++){var s=n[a],r=s.position;if(!s.used){var o=i[r].piece;t.push({data:o.data,type:o.type,direction:o.direction,isReverse:o.isReverse,frame:o.frame})}}if(gc(this.dataBoard,t)){this.scene.disableInput(),this.runAnimationGameOver();var c=this.scene.journeyGameplay;this.scene.time.addEvent({callback:function(){e.scene.time.delayedCall(1500+e.scene.journeyGameplay.timeDelayOutOfMove,(function(){c.handleRequestFinishGame()}))}})}else this.scene.journeyGameplay.timeDelayOutOfMove=0}},n.getBoardByFen=function(e){var t=[],n=e.split(" ");if(n.length<2)throw new Error("Invalid fen");for(var i=n[0].split("/"),a=i.length,s=0;s<a;s++){t[s]=[];for(var r=Cc(i[s]),o=r.length>_v?_v:r.length,c=0;c<o;c++)t[s][c]=r[c]}return t},n.getFenByBoard=function(){for(var e="",t=0;t<Rv;t++){for(var n="",i=0;i<_v;i++){var a=this.dataBoard[t][i],s=a.value,r=a.frameTarget,o="g";switch(r&&(o=bc(r)),s){case 0:n+=",x";break;case 1:n+=","+o}}e+="/"+(n=n.substring(1))}return console.log("getFenByBoard",e),e.substring(1)},n.startGame=function(e,t){if(e){for(var n=0;n<e.length;n++)for(var i=0;i<e[n].length;i++){var a=e[n][i].frame,s=e[n][i],r=s.value,o=s.frameTarget,c=this.dataBoard[n][i];1===r&&(a&&a!==xv.GEM_TRANSPARENT||((0,x.o9)(new Error("MapByBoardError"),{level:this.scene.levelManager.getLevel(),row:n,col:i,frame:a,fen:t}),a=xv.GEM),c.value=1,c.frame=a,c.cell.setFrame(a),o&&c.cell.setTargetItem(o),c.cell.setVisible(!0),c.cell.setWorldSize(this.cellSize,this.cellSize),c.cell.setAlpha(0),c.cell.setScale(0))}this.fadeIn()}},n.setFrameTargetBoardByIndex=function(e,t,n,i){if(console.log("setFrameBoardByIndex",e,t,n,i),!(e>7||t>7)){var a=this.dataBoard[e][t],s=a.cell;s.setFrame(n),s.setVisible(!0),i&&Kt()(_c).call(_c,i)&&s.setTargetItem(i),s.imageTargetItem.setScale(0),a.frame=n,a.frameTarget=i,a.value=1,s.setScale(0),s.setAlpha(0)}},n.getGemFrameByMapItemIndex=function(e){return console.log("index === ",e),xc[e]},n.getBubbleFrameByMapItemIndex=function(e){return console.log("index === ",e),kc[e]},n.fadeOut=function(){for(var e=[],t=[],n=0;n<Rv;n++)for(var i=0;i<_v;i++){var a=this.dataBoard[n][i];a.value&&(e.push(a.cell),t.push(a.cell.imageTargetItem))}if(!e||0===e.length)return null;var s=e[0].alphaImageTargetItem,r=e[0].scaleImageTargetItem,o=this.scene.add.tween({targets:e,duration:300,ease:Phaser.Math.Easing.Quadratic.InOut,alpha:{from:1,to:0},scale:{from:e[0].scale,to:0},paused:!0}),c=this.scene.add.tween({targets:t,duration:300,ease:Phaser.Math.Easing.Quadratic.InOut,alpha:{from:s,to:0},scale:{from:r,to:0},paused:!0});return o.play(),c.play(),o},n.clearBoard=function(){for(var e=0;e<Rv;e++)for(var t=0;t<_v;t++){var n=this.dataBoard[e][t];n.value=0,n.frame=xv.GEM_TRANSPARENT,n.cell.reset(),n.cell.setFrame(xv.GEM_TRANSPARENT),n.cell.setVisible(!0),n.cell.resetImageGameOver(),n.cell.removeTargetItem()}},t}(dh),Mv=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.board=void 0,n.scene=t,t.add.existing((0,ka.A)(n)),n.init(),n}(0,_.A)(t,e);var n=t.prototype;return n.init=function(){this.createBoard()},n.createBoard=function(){this.board=new Dv(this.scene),this.add(this.board)},t}(Phaser.GameObjects.Container),Bv=Mv,Lv=function(){function e(e){this.scene=void 0,this.currentLevel=void 0,this.scene=e,this.init()}var t=e.prototype;return t.init=function(){var e=this.scene.storage.getState(),t=(0,po.IP)(e)||1;this.currentLevel=t},t.setLevel=function(e){this.currentLevel=e},t.getLevel=function(){return this.currentLevel>=Gd.A.length-1?Gd.A.length-1:this.currentLevel},t.getCorrectLevel=function(){return this.currentLevel},t.getLevelConfig=function(){return{key:"level-test",mapJson:"./assets/json/levels/level-0.json"}},t.getNextLevel=function(){return this.currentLevel+1},t.getNextLevelConfig=function(){return Gd.A[this.currentLevel+1]},t.increaseLevel=function(){this.currentLevel++},e}(),Nv=function(){function e(e){this.scene=void 0,this.map=void 0,this.scene=e}var t=e.prototype;return t.init=function(){this.initMap()},t.initMap=function(){var e=this.scene.storage.getState(),t=(0,po.IP)(e),n=this.scene.journeyGameplay.levelManager.getLevelConfig(),i=this.scene.journeySeason.getCurrentSeasonConfig(),a=this.scene.cache.json.get(i.levelsKey);this.scene.load.tilemapTiledJSON(n.key,a[t-1]),this.scene.load.start(),this.map=this.scene.make.tilemap({key:n.key})},t.getTileMap=function(){return Be()(this)},t.reloadMap=function(){var e,t=this.scene.journeyGameplay.levelManager,n=t.getLevel();0===n&&t.setLevel(1);var i=t.getLevelConfig(),a=this.scene.journeySeason.getCurrentSeasonConfig(),s=this.scene.cache.json.get(a.levelsKey);this.scene.load.tilemapTiledJSON(i.key,s[n-1]),this.scene.load.start(),console.log("reloadMap",n,i),null==(e=Be()(this))||e.destroy(),this.map=this.scene.make.tilemap({key:i.key})},e}(),Gv=function(){function e(){this.targetType=void 0,this.targetValue=void 0,this.init()}var t=e.prototype;return t.init=function(){},t.setTargetType=function(e){this.targetType=e},t.setTargetValue=function(e){this.targetValue=e},t.getTargetType=function(){return this.targetType},t.getTargetValue=function(){return this.targetValue},e}(),Fv=n(233),Uv=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="LoadResourceFail",i.message=t||"Load resource fail",i.payload=n,i}return(0,_.A)(t,e),t}((0,$.A)(Error)),jv=n(512),Vv=n.n(jv),zv=Fa.A.GAMEPLAY,Yv=zv.KEY,Hv=zv.FRAME,Kv=Fa.A.GAMEPLAY_32.KEY,Wv=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.imageGem=void 0,n.imageCheck=void 0,n.text=void 0,n.particle=void 0,n.emitter=void 0,n.currentPosition=void 0,n.imageGlow=void 0,n.tweenGlow=void 0,n.imageGlowCrop=void 0,n.tweenCropMaskTopDown=void 0,n.tweenCropMaskDownBottom=void 0,n.imageStar=void 0,n.tweenShowStar=void 0,n.tweenHideStar=void 0,n.tweenShowMe=void 0,n.scale0=void 0,n.upAnimation=void 0,n.downAnimation=void 0,n.runUpAnimation=function(){var e;null==(e=n.upAnimation)||e.remove(),n.upAnimation=new Fh.A({targets:[(0,ka.A)(n)],duration:300,props:{scale:n.scale0+.2},onComplete:function(){n.runDownAnimation()}}),n.upAnimation.play()},n.runDownAnimation=function(){var e;null==(e=n.downAnimation)||e.remove(),n.downAnimation=new Fh.A({targets:[(0,ka.A)(n)],duration:300,props:{scale:n.scale0}}),n.downAnimation.play()},n.scene=t,n.init(),n.scale0=n.scale,n}(0,_.A)(t,e);var n=t.prototype;return n.init=function(){this.createImageGem(),this.createImageCheck(),this.createText(),this.createParticle(),this.createEmitter(),this.createGlow(),this.createTweenGlow(),this.createGlowCrop(),this.createStar(),this.createTweenStar(),this.createTweenShowMe()},n.createImageGem=function(){this.imageGem=this.scene.make.image({key:Kv}),this.imageGem.setWorldSize(30,30),this.add(this.imageGem),Phaser.Display.Align.In.Center(this.imageGem,this,0,0)},n.createImageCheck=function(){this.imageCheck=this.scene.make.image({key:Yv,frame:Hv.ICON_CHECK}),this.imageCheck.setWorldSize(16,16),this.imageCheck.setVisible(!1),this.add(this.imageCheck),Phaser.Display.Align.In.Center(this.imageCheck,this.imageGem,12,7)},n.createText=function(){this.text=this.scene.make.bitmapText({font:za.A.MIKADO_WHITE.KEY,size:10,origin:{x:.5,y:.5}}),this.add(this.text),Phaser.Display.Align.In.Center(this.text,this.imageGem,12,7)},n.createParticle=function(){this.particle=this.scene.add.particles(Yv).setDepth(Na.A.ON_TOP)},n.createEmitter=function(){var e=1.5/this.scene.world.getPixelRatio();this.emitter=this.particle.createEmitter({on:!1,angle:{start:0,end:360,steps:8},frame:[Hv.DUST],lifespan:1e3,quantity:1,scale:{start:e,end:0,ease:"Quart.easeIn"},speed:50})},n.createGlow=function(){this.imageGlow=this.scene.make.image({key:Yv,frame:Hv.ICON_PLUS}),this.imageGlow.setVisible(!1).setScale(0).setAlpha(0),this.add(this.imageGlow),Phaser.Display.Align.In.Center(this.imageGlow,this.imageGem)},n.createTweenGlow=function(){var e=this;this.tweenGlow=this.scene.tweens.add({targets:[this.imageGlow],paused:!0,scale:{from:0,to:.6},alpha:{from:0,to:1},delay:100,duration:600,onComplete:function(){e.imageGlow.setVisible(!1).setScale(0).setAlpha(0),e.playAnimMaskCrop(),e.playAnimStar()}})},n.createGlowCrop=function(){this.imageGlowCrop=this.scene.make.image({key:Yv,frame:Hv.MASK}),this.imageGlowCrop.setVisible(!1),this.imageGlowCrop.setWorldSize(this.imageGem.displayWidth,this.imageGem.displayHeight),this.add(this.imageGlowCrop),Phaser.Display.Align.In.Center(this.imageGlowCrop,this.imageGem)},n.createStar=function(){this.imageStar=this.scene.make.image({key:Yv,frame:Hv.ICON_PLUS}),this.imageStar.setVisible(!1).setScale(0).setAlpha(0),this.imageStar.setWorldSize(27,26),this.add(this.imageStar),Phaser.Display.Align.In.Center(this.imageStar,this.imageGem,-10,-10)},n.createTweenStar=function(){var e=this;this.tweenHideStar=this.scene.add.tween({paused:!0,targets:[this.imageStar],scale:{from:1,to:0},alpha:{from:1,to:0},delay:100,duration:500,onComplete:function(){e.imageStar.setVisible(!1).setScale(0).setAlpha(0)}}),this.tweenShowStar=this.scene.add.tween({paused:!0,targets:[this.imageStar],scale:{from:0,to:1},alpha:{from:0,to:1},delay:100,duration:500,onComplete:function(){e.tweenHideStar.play()}})},n.createTweenShowMe=function(){this.tweenShowMe=this.scene.add.tween({paused:!0,targets:[this],alpha:{from:0,to:1},duration:200})},n.cropTopDownImageGlow=function(){var e=this;if(!this.tweenCropMaskTopDown){var t=this.imageGlowCrop.displayHeight,n=this.imageGlowCrop.displayWidth,i=this.imageGlowCrop.scaleX,a=this.imageGlowCrop.scaleY;this.tweenCropMaskTopDown=this.scene.tweens.addCounter({from:0,to:1,delay:200,duration:300,paused:!0,onUpdate:function(s){var r=s.getValue(0)*t;e.imageGlowCrop.setCrop(0,0,n/i,r/a)},onComplete:function(){e.cropDownBottomImageGlow()}})}this.tweenCropMaskTopDown.play()},n.cropDownBottomImageGlow=function(){var e=this;if(!this.tweenCropMaskDownBottom){var t=this.imageGlowCrop.displayHeight,n=this.imageGlowCrop.displayWidth,i=this.imageGlowCrop.scaleX,a=this.imageGlowCrop.scaleY;this.tweenCropMaskDownBottom=this.scene.tweens.addCounter({from:0,to:1,delay:200,duration:300,paused:!0,onUpdate:function(s){var r=s.getValue(0)*t;e.imageGlowCrop.setCrop(0,r/a,n/i,t/a)}})}this.tweenCropMaskDownBottom.play()},n.playAnimStar=function(){this.imageStar.setVisible(!0),this.tweenShowStar.play()},n.playAnimMaskCrop=function(){this.imageGlowCrop.setVisible(!0).setCrop(0,0,0,0),this.cropTopDownImageGlow()},n.setFrame=function(e){this.imageGem.setFrame(e)},n.getFrame=function(){return this.imageGem.frame.name},n.setText=function(e,t){var n=t-e;n<0&&(n=0),this.text.setText("x"+n)},n.completeMission=function(){this.imageGem.setAlpha(.3),this.text.setVisible(!1),this.imageCheck.setVisible(!0)},n.reset=function(){this.imageGem.setAlpha(1),this.text.setVisible(!0),this.text.setAlpha(1),this.imageCheck.setVisible(!1)},n.updateCurrentPosition=function(e){this.currentPosition=e},n.runAnimCollectionItem=function(){var e=this.imageGem.getWorldPosition(),t=e.x,n=e.y;this.emitter.explode(8,t,n),this.runUpAnimation()},n.playAnimShowMe=function(){this.setVisible(!0).setAlpha(0),this.tweenShowMe.play()},t}(Phaser.GameObjects.Container),Zv=Fa.A.DEFAULT,Xv=Zv.KEY,Jv=Zv.FRAME,qv=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.target=void 0,n.targetKeys=[],n.jsonPosition={},n.jsonAmount={},n.jsonTarget={},n.jsonCollectItem={},n.listCollectItems=[],n.scene=t,n.setSize(165,49),n.createBackground(),n}(0,_.A)(t,e);var n=t.prototype;return n.createBackground=function(){var e=this.scene.make.image({key:Xv,frame:Jv.PANEL_MISSION});e.setWorldSize(this.width,this.height),this.add(e)},n.calcPosition=function(e){for(var t=[],n=165/(e+1),i=n*(e-1)/2,a=0;a<e;a++)t.push(n*a-i);return t},n.parseTargetToJson=function(){if(!(0,Fv.isObject)(this.target)){for(var e=JSON.parse(this.target),t=he()(e),n=this.calcPosition(t.length),i=0;i<t.length;i++){var a=t[i],s=xc[a];this.targetKeys.push(s),this.jsonAmount[s]=0,this.jsonTarget[s]=e[a],this.jsonPosition[s]={x:n[i],y:0};var r=this.listCollectItems[i];r||(r=new Wv(this.scene),this.add(r),this.listCollectItems.push(r)),r.updateCurrentPosition(this.jsonPosition[s]),r.setVisible(!0),r.setX(n[i]),r.setFrame(s),r.setText(0,e[a]),this.jsonCollectItem[s]=r}console.log("this.targetKeys === ",this.targetKeys)}},n.hideListCollectItems=function(){this.listCollectItems.forEach((function(e){e.setVisible(!1),e.reset()}))},n.showListCollectItems=function(){this.listCollectItems.forEach((function(e){e.reset(),e.playAnimShowMe()}))},n.showCollectItemByKey=function(e){var t,n=f()(t=this.listCollectItems).call(t,(function(t){return t.getFrame()===e}));n&&0!==n.length&&(this.jsonAmount[e]>=this.jsonTarget[e]?n[0].completeMission():n[0].reset(),n[0].playAnimShowMe())},n.start=function(){this.parseTargetToJson()},n.setTargets=function(e){var t,n;this.target=Vv()(t=Vv()(n=Vv()(e).call(e,"{",'{"')).call(n,", ",', "')).call(t,":",'":')},n.collectItem=function(e){if(e in this.jsonAmount){this.jsonAmount[e]++;var t=this.jsonAmount[e],n=this.jsonTarget[e];t===n?(this.jsonCollectItem[e].completeMission(),this.scene.audio.playSound(ja.A.TARGET_REACHED_2)):this.scene.audio.playSound(ja.A.TARGET_REACHED),this.jsonCollectItem[e].setText(t,n)}},n.checkCompleteMission=function(){for(var e=he()(this.jsonTarget),t=0;t<e.length;t++){var n=e[t];if(this.jsonTarget[n]>this.jsonAmount[n])return!1}return!0},n.reset=function(){this.hideListCollectItems(),this.targetKeys=[],this.jsonAmount={},this.jsonTarget={},this.jsonCollectItem={},this.jsonPosition={}},n.getPositionCollectionItem=function(e){return this.jsonPosition[e]},n.getTargetKeys=function(){return this.targetKeys},n.getJsonAmount=function(){return this.jsonAmount},n.getJsonTarget=function(){return this.jsonTarget},n.getCollectItemByKey=function(e){return this.jsonCollectItem[e]},n.updateJsonAmountByFen=function(e){this.jsonAmount=JSON.parse(Yt()(e));for(var t=he()(this.jsonTarget),n=0;n<t.length;n++){var i=t[n],a=this.jsonCollectItem[i];this.jsonTarget[i]>this.jsonAmount[i]?a.reset():a.completeMission(),a.setText(this.jsonAmount[i],this.jsonTarget[i])}},n.resetTextAmount=function(){for(var e=he()(this.jsonTarget),t=0;t<e.length;t++){var n=e[t],i=this.listCollectItems[t];i&&i.setText(0,this.jsonTarget[n])}},t}(Phaser.GameObjects.Container),Qv=Fa.A.DEFAULT,$v=Qv.KEY,ey=Qv.FRAME,ty=function(e){function t(t){var n;return(n=e.call(this,t)||this).background=void 0,n.bestScoreText=void 0,n.titleText=void 0,n.dayText=void 0,n.titleDayText=void 0,n.createBackground(),n.createScoreText(),n.createLevelTitleText(),n.createTitleDayText(),n.createDayText(),n.scene.add.existing((0,ka.A)(n)),n}(0,_.A)(t,e);var n=t.prototype;return n.createBackground=function(){this.background=this.scene.make.image({key:$v,frame:ey.PANEL_LEVEL}),this.background.setWorldSize(80,49),this.add(this.background),Phaser.Display.Align.In.Center(this.background,this)},n.createLevelTitleText=function(){this.titleText=this.scene.make.bitmapText({font:za.A.MIKADO_YELLOW.KEY,size:14,origin:{x:.5,y:.5},text:"Level"}),this.add(this.titleText),Phaser.Display.Align.In.Center(this.titleText,this.background,0,-9)},n.createScoreText=function(){this.bestScoreText=this.scene.make.bitmapText({font:za.A.MIKADO_YELLOW.KEY,size:18,origin:{x:.5,y:.5},text:"0"}),this.add(this.bestScoreText),Phaser.Display.Align.In.Center(this.bestScoreText,this.background,0,7)},n.createTitleDayText=function(){this.titleDayText=this.scene.make.bitmapText({font:za.A.FONT_TEXT_WHITE.KEY,size:this.scene.fontSize(18),origin:{x:.5,y:.5},text:"mm/dd/yy"}),this.add(this.titleDayText),Phaser.Display.Align.In.Center(this.titleDayText,this.background,0,4)},n.createDayText=function(){this.dayText=this.scene.make.bitmapText({font:za.A.FONT_TEXT_WHITE.KEY,size:this.scene.fontSize(24),origin:{x:.5,y:.5},text:"0"}),this.add(this.dayText),Phaser.Display.Align.In.Center(this.dayText,this.background,0,23)},n.setScoreText=function(e){this.bestScoreText.setText(String(e))},n.setDayText=function(e){this.dayText.setText(e)},n.showTextScore=function(){this.titleText.setVisible(!0),this.bestScoreText.setVisible(!0),this.titleDayText.setVisible(!1),this.dayText.setVisible(!1)},n.showTextDay=function(){this.titleText.setVisible(!1),this.bestScoreText.setVisible(!1),this.titleDayText.setVisible(!0),this.dayText.setVisible(!0)},t}(Phaser.GameObjects.Container),ny=ty,iy=Fa.A.GAMEPLAY,ay=(iy.KEY,iy.FRAME,function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.scoreText=void 0,n.tweenShow=void 0,n.tweenHide=void 0,n.addScore=void 0,n.score=0,n.scene=t,n.scene.add.existing((0,ka.A)(n)),n.createScoreText(),n}(0,_.A)(t,e);var n=t.prototype;return n.createScoreText=function(){this.scoreText=this.scene.make.bitmapText({font:za.A.FONT_TEXT_WHITE.KEY,size:this.scene.fontSize(52),text:"0",origin:{x:.5,y:.5}}),this.add(this.scoreText),Phaser.Display.Align.In.Center(this.scoreText,this)},n.setScore=function(e){this.score=e},n.setScoreText=function(e){this.scoreText.setText(String(e))},n.animAddScore=function(e){var t=this;if(this.addScore&&this.addScore.isPlaying()){this.addScore.stop();var n=this.score+e;this.setScore(n),this.setScoreText(n)}this.addScore=this.scene.tweens.addCounter({from:0,to:e,duration:100,onUpdate:function(e){var n=t.score+Math.floor(e.getValue());t.setScoreText(n)},onComplete:function(){var n=t.score+e;t.setScore(n),t.setScoreText(n)}})},n.reset=function(){this.setScore(0),this.setScoreText(0)},t}(Phaser.GameObjects.Container)),sy=ay,ry=n(495),oy=Fa.A.GAMEPLAY,cy=oy.KEY,ly=oy.FRAME,hy=function(e){function t(t,n,i){var a;return(a=e.call(this,t)||this).scene=void 0,a.leftBg=void 0,a.midBg=void 0,a.rightBg=void 0,a.leftProgress=void 0,a.midProgress=void 0,a.rightProgress=void 0,a.iconCup=void 0,a.glareCup=void 0,a.tweenRotationGlareCup=void 0,a.targetScore=void 0,a.listPoolMilestoneFrame=[],a.listMilestoneFrame=[],a.particle=void 0,a.emitter=void 0,a.progressBarFull=void 0,a.setSize(n,i),a.scene=t,a.init(),a}(0,_.A)(t,e);var n=t.prototype;return n.init=function(){this.initBg(),this.initProgressBar(),this.createParticle(),this.createEmitter(),this.createGlareCup(),this.createTweenGlare(),this.createIconCup()},n.initBg=function(){this.leftBg=this.scene.make.image({key:cy,frame:ly.BLANK}),this.midBg=this.scene.make.image({key:cy,frame:ly.BLANK}),this.rightBg=this.scene.make.image({key:cy,frame:ly.BLANK});var e=this.leftBg,t=e.width,n=e.height,i=t*this.height/n;this.leftBg.setWorldSize(i,this.height);var a=this.rightBg,s=a.width,r=a.height,o=s*this.height/r;this.rightBg.setWorldSize(o,this.height);var c=this.width-(i+o);this.midBg.setWorldSize(c,this.height),this.add(this.leftBg),this.add(this.midBg),this.add(this.rightBg),Phaser.Display.Align.In.LeftCenter(this.leftBg,this,0,0),Phaser.Display.Align.In.Center(this.midBg,this,0,0),Phaser.Display.Align.In.RightCenter(this.rightBg,this,0,0)},n.initProgressBar=function(){this.leftProgress=this.scene.make.image({key:cy,frame:ly.BLANK}),this.midProgress=this.scene.make.image({key:cy,frame:ly.BLANK}),this.rightProgress=this.scene.make.image({key:cy,frame:ly.BLANK});var e=this.leftProgress,t=e.width,n=e.height,i=t*this.height/n;this.leftProgress.setWorldSize(i,this.height);var a=this.rightProgress,s=a.width,r=a.height,o=s*this.height/r;this.rightProgress.setWorldSize(o,this.height);var c=this.width-(i+o)+2;this.midProgress.setWorldSize(c,this.height),this.add(this.leftProgress),this.add(this.midProgress),this.add(this.rightProgress),this.leftProgress.setVisible(!1),this.rightProgress.setVisible(!1),this.midProgress.setVisible(!1),Phaser.Display.Align.In.LeftCenter(this.leftProgress,this,0,0),Phaser.Display.Align.In.Center(this.midProgress,this,0,0),Phaser.Display.Align.In.RightCenter(this.rightProgress,this,0,0)},n.createIconCup=function(){this.iconCup=this.scene.make.image({key:cy,frame:ly.ICON_CUP}),this.iconCup.setWorldSize(25,20),this.add(this.iconCup),Phaser.Display.Align.In.RightCenter(this.iconCup,this.glareCup,-9,1)},n.createGlareCup=function(){this.glareCup=this.scene.make.image({key:cy,frame:ly.CUP_GLARE}),this.glareCup.setWorldSize(44,44),this.glareCup.setVisible(!1),this.add(this.glareCup),Phaser.Display.Align.In.RightCenter(this.glareCup,this.rightBg,42,-3)},n.createTweenGlare=function(){this.tweenRotationGlareCup=new ry.A({targets:[this.glareCup],repeat:-1,duration:6e3})},n.createParticle=function(){this.particle=this.scene.add.particles(cy),this.add(this.particle)},n.createEmitter=function(){this.emitter=this.particle.createEmitter({x:0,y:0,scale:{min:.3,max:1},speed:{min:10,max:30},lifespan:{min:500,max:1e3},quantity:1,on:!1,frame:ly.DUST}),this.emitter.setPosition(this.scene.gameZone.width/2-10,-3)},n.createMilestoneFrame=function(){var e=this.scene.make.image({key:cy,frame:ly.BLANK});return e.setWorldSize(16,22),e},n.getMilestoneFrame=function(){var e,t=f()(e=this.listPoolMilestoneFrame).call(e,(function(e){return!e.visible}));if(!t||0===t.length){var n=this.createMilestoneFrame();return this.listPoolMilestoneFrame.push(n),this.add(n),n}return t[0]},n.handleSetAlphaListMilestone=function(e){this.listMilestoneFrame.forEach((function(t){t.score<=e?t.frame.setAlpha(1):t.frame.setAlpha(.5)}))},n.handleSetAlphaCup=function(e){e>=this.targetScore?this.iconCup.setAlpha(1):this.iconCup.setAlpha(.5)},n.runEmitter=function(){this.emitter.start()},n.stopEmitter=function(){this.emitter.stop()},n.runAnimGlare=function(){this.glareCup.setVisible(!0),this.tweenRotationGlareCup.play()},n.stopAnimGlare=function(){this.tweenRotationGlareCup.stop(),this.glareCup.setVisible(!1)},n.hideProgressBar=function(){this.leftProgress.setVisible(!1),this.rightProgress.setVisible(!1),this.midProgress.setVisible(!1)},n.hideMilestone=function(){this.listPoolMilestoneFrame.forEach((function(e){e.setVisible(!1)}))},n.resetListMilestone=function(){this.listMilestoneFrame=[]},n.reset=function(){this.hideMilestone(),this.hideProgressBar(),this.setPercent(0),this.resetListMilestone()},n.setTargetScore=function(e){this.targetScore=e},n.getTargetScore=function(){return this.targetScore},n.setPercent=function(e){var t=e*this.width,n=this.leftProgress.displayWidth,i=this.midProgress.displayWidth,a=this.rightProgress.displayWidth;if(e>=1){if(this.progressBarFull)return;return this.progressBarFull=!0,this.leftProgress.setVisible(!0),this.midProgress.setVisible(!0),this.rightProgress.setVisible(!0),this.leftProgress.setCrop(0,0,n/this.leftProgress.scaleX,2*this.height),this.midProgress.setCrop(0,0,i/this.midProgress.scaleX,2*this.height),this.rightProgress.setCrop(0,0,a/this.rightProgress.scaleX,2*this.height),this.runAnimGlare(),void this.runEmitter()}return this.stopAnimGlare(),this.stopEmitter(),this.progressBarFull=!1,t<n?(this.leftProgress.setVisible(!0),void this.leftProgress.setCrop(0,0,t/this.leftProgress.scaleX,2*this.height)):t>n+i?(this.leftProgress.setVisible(!0),this.midProgress.setVisible(!0),this.midProgress.setCrop(0,0,i/this.midProgress.scaleX,2*this.height),this.rightProgress.setVisible(!0),void this.rightProgress.setCrop(0,0,(t-(n+i-2))/this.rightProgress.scaleX,2*this.height)):(this.leftProgress.setVisible(!0),this.leftProgress.setCrop(0,0,n/this.leftProgress.scaleX,2*this.height),this.midProgress.setVisible(!0),void this.midProgress.setCrop(0,0,(t-n)/this.midProgress.scaleX,2*this.height))},t}(Phaser.GameObjects.Container),uy=Fa.A.DEFAULT,dy=uy.KEY,py=uy.FRAME,fy=function(e){function t(t){var n;return(n=e.call(this,t,dy,py.BUTTON_SETTINGS,64,49)||this).setName("Setting"),n}return(0,_.A)(t,e),t}(Va.A),my=fy,gy=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.buttonSetting=void 0,n.mainScoreBlock=void 0,n.progressBar=void 0,n.collectItems=void 0,n.levelBlock=void 0,n.scene=t,n.setSize(n.scene.gameZone.width,65),n.createBackground(),n.createLevelBlock(),n.createSettingButton(),n.createMainScoreBlock(),n.createProgressBar(),n.createCollectItems(),t.add.existing((0,ka.A)(n)),n}(0,_.A)(t,e);var n=t.prototype;return n.createBackground=function(){var e=new pl.A(this.scene,0,0,338,67,"panel");this.add(e)},n.createLevelBlock=function(){this.levelBlock=new ny(this.scene),this.add(this.levelBlock),Phaser.Display.Align.In.Center(this.levelBlock,this,-121,0)},n.createMainScoreBlock=function(){this.mainScoreBlock=new sy(this.scene),this.add(this.mainScoreBlock),Phaser.Display.Align.In.Center(this.mainScoreBlock,this,0,52)},n.createSettingButton=function(){this.buttonSetting=new my(this.scene),this.add(this.buttonSetting),Phaser.Display.Align.In.Center(this.buttonSetting,this,129,6)},n.createProgressBar=function(){this.progressBar=new hy(this.scene,315,13),this.add(this.progressBar),Phaser.Display.Align.In.Center(this.progressBar,this,-19,92),this.progressBar.setVisible(!1)},n.createCollectItems=function(){this.collectItems=new qv(this.scene),this.add(this.collectItems),Phaser.Display.Align.In.Center(this.collectItems,this,5,0),this.collectItems.setVisible(!1)},n.getScore=function(){return this.mainScoreBlock.score},n.showItemSingleMode=function(){this.mainScoreBlock.setVisible(!0)},n.showItemPlayWithFriendsMode=function(){this.mainScoreBlock.setVisible(!1)},n.start=function(){switch(this.scene.journeyGameplay.targetMissionManager.getTargetType()){case jg:this.targetScore();break;case Vg:this.targetCollect()}},n.targetScore=function(){var e=this.scene.journeyGameplay,t=e.header,n=e.targetMissionManager,i=parseInt(n.getTargetValue()),a=this.scene.storage.getState(),s=(0,po.Ou)(a)||0;(0,Fv.isArray)(i)||(this.progressBar.reset(),this.progressBar.setVisible(!0),this.progressBar.setTargetScore(i),this.progressBar.setPercent(s/i),t.mainScoreBlock.reset(),t.mainScoreBlock.setVisible(!0),t.mainScoreBlock.setScore(s),t.mainScoreBlock.setScoreText(s),this.collectItems.setVisible(!1))},n.targetCollect=function(){var e=this.scene.journeyGameplay.targetMissionManager;this.collectItems.reset(),this.mainScoreBlock.setVisible(!1),this.progressBar.setVisible(!1);var t=e.getTargetValue();this.collectItems.setTargets(t),this.collectItems.setVisible(!0),this.collectItems.start()},t}(Phaser.GameObjects.Container),vy=gy,yy=n(232),Ay=function(e){return e[Pi]},Ey=(0,Te.Mz)([function(e){return Ay(e).lives}],(function(e){return e})),Ty=(0,Te.Mz)([function(e){return Ay(e).lastBonusLifeTime}],(function(e){return e})),Sy=((0,Te.Mz)([function(e){return Ay(e).countDownStartAt}],(function(e){return e})),GameCore.Configs),by=Sy.Match,Py=Sy.Lives,Cy=Fa.A.DEFAULT,wy=Cy.KEY,Iy=Cy.FRAME,xy=Fa.A.GAMEPLAY,ky=xy.KEY,Oy=xy.FRAME,_y=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.background=void 0,n.panelOutOfMoves=void 0,n.panel=void 0,n.textOutOfMoves=void 0,n.tweenMoveCenterScene=void 0,n.tweenScaleDown=void 0,n.popupFadeInMaskAnimation=void 0,n.scene=t,n.init(),n.registerEvents(),t.add.existing((0,ka.A)(n)),n}(0,_.A)(t,e);var n=t.prototype;return n.registerEvents=function(){this.scene.world.events.on(on.A.RESIZE,this.handleResize,this)},n.handleResize=function(){var e=this.scene.world.getWorldSize(),t=e.width,n=e.height;this.background.setWorldSize(t,n)},n.init=function(){this.addBackground(),this.createPanel(),this.createTextOutOfMoves(),this.createTweenMoveCenterScene(),this.createTweenScaleDown()},n.addBackground=function(){var e=this.scene.gameZone,t=e.width,n=e.height;this.background=this.scene.add.image(0,0,wy,Iy.BLANK),this.background.setTint(0),this.background.setWorldSize(t,n),this.background.setVisible(!1),this.add(this.background)},n.createPanel=function(){this.panelOutOfMoves=this.scene.add.container(),this.panelOutOfMoves.setSize(273,78),this.panel=this.scene.make.image({key:ky,frame:Oy.BUTTON_BLACK}),this.panel.setWorldSize(273,78),this.panelOutOfMoves.add(this.panel),this.add(this.panelOutOfMoves)},n.createTextOutOfMoves=function(){this.textOutOfMoves=this.scene.make.image({key:wy,frame:Iy.TEXT_OUT_OF_MOVES}),this.textOutOfMoves.setWorldSize(194,27),this.panelOutOfMoves.add(this.textOutOfMoves)},n.createTweenMoveCenterScene=function(){this.tweenMoveCenterScene=this.scene.tweens.add({targets:this.panelOutOfMoves,paused:!0,duration:600,ease:Phaser.Math.Easing.Back.Out,scale:{from:0,to:1},completeDelay:2e3})},n.createTweenScaleDown=function(){var e=this;this.tweenScaleDown=this.scene.tweens.add({targets:this.panelOutOfMoves,paused:!0,duration:300,ease:Phaser.Math.Easing.Back.In,scale:{from:1,to:0},completeDelay:250,onComplete:function(){e.hideTextOutOfMoves(),e.scene.screen.open(Ua.R8.MISSION_FAIL_SCREEN)}})},n.playTweenScaleDown=function(){this.tweenScaleDown.play()},n.playTweenMoveCenterScene=function(){var e=this.scene.journeyGameplay.main.y;this.panelOutOfMoves.setY(e),this.panelOutOfMoves.setScale(0),this.runFadeInMaskAnimation(0,300)},n.hideTextOutOfMoves=function(){this.panelOutOfMoves.setVisible(!1),this.background.setVisible(!1)},n.runFadeInMaskAnimation=function(e,t){var n=this;this.background.setVisible(!0),this.popupFadeInMaskAnimation||(this.popupFadeInMaskAnimation=new wo.A({targets:[this.background],delay:e,duration:t,props:{alpha:{start:0,from:0,to:.75}},onComplete:function(){n.panelOutOfMoves.setVisible(!0),n.tweenMoveCenterScene.play()}})),this.popupFadeInMaskAnimation.play()},t}(Phaser.GameObjects.Container),Ry=Fa.A.GAMEPLAY_32.FRAME,Dy=GameCore.Configs,My=Dy.Board,By=Dy.Network,Ly=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.currentIdx=0,n.header=void 0,n.main=void 0,n.footer=void 0,n.levelManager=void 0,n.mapManager=void 0,n.targetMissionManager=void 0,n.isGameOver=void 0,n.isLevelComplete=void 0,n.restartCurrentLevel=0,n.oufOfMovesEffect=void 0,n.timeDelayOutOfMove=0,n.replayPreviousLevel=!1,n.handlePauseGame=function(){n.isGameOver||n.isLevelComplete||n.scene.screen.open(Ua.R8.SETTINGS_SCREEN_JOURNEY)},n.handleLoadMapComplete=function(){var e=n.scene.storage.getState(),t=(0,po.IP)(e),i=n.levelManager.getLevel();if(i>t){var s=n.scene.journeySeason.getSeasonKey(),r=n.scene.player.getCustomData("levelOfSeasons"),o=(0,a.A)({},r);o[s]=i,n.scene.storage.dispatch((0,co.fA)(i)),n.scene.player.setCustomData("levelOfSeasons",o),n.replayPreviousLevel=!1}n.scene.load.off(Phaser.Loader.Events.COMPLETE)},n.handleShowInterstitialAd=(0,O.A)(D().mark((function e(){var t;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return");case 6:return t.screen.open(Ua.R8.NOTIFY_SCREEN,{message:"Loading ads...",duration:By.Timeout,loading:!0}),e.next=9,n.scene.ads.showInterstitialAdAsync();case 9:n.scene.analytics.showInterstitialAd(n.scene.getSceneName()),e.next=15;break;case 12:return e.prev=12,e.t0=e.catch(2),e.abrupt("return");case 15:return e.prev=15,t.screen.close(Ua.R8.NOTIFY_SCREEN),n.scene.audio.playMusic(),n.scene.ads.preloadInterstitialAdAsync().catch(x.a0),n.scene.audio.playMusic(),e.finish(15);case 21:case"end":return e.stop()}}),e,null,[[2,12,15,21]])}))),n.scene=t,n.updateSize(),n.createHeader(),n.createMain(),n.createFooter(),n.alignComponents(),n.createOutOfMovesEffect(),n.createLevelManager(),n.createMapManager(),n.createTargetMissionManager(),n.createInput(),t.add.existing((0,ka.A)(n)),n}(0,_.A)(t,e);var n=t.prototype;return n.init=function(){this.mapManager.init()},n.updateLayout=function(){this.updateSize(),this.alignComponents()},n.updateSize=function(){var e=this.scene.gameZone.height;this.scene.gameZone.height<624?(e=624,this.setScale(this.scene.gameZone.height/624)):this.setScale(1);var t=e/this.scene.gameZone.height*this.scene.gameZone.width;this.setSize(t,e)},n.createHeader=function(){this.header=new vy(this.scene),this.header.setVisible(!0),this.add(this.header)},n.createMain=function(){this.main=new Bv(this.scene),this.add(this.main)},n.createFooter=function(){this.footer=new Ev(this.scene),this.add(this.footer)},n.alignUI=function(){var e=this.x,t=this.y;this.setPosition(0,0);var n=this.scene.ads.getBannerHeight();Phaser.Display.Align.In.TopCenter(this.header,this,0,-25),Phaser.Display.Align.In.BottomCenter(this.footer,this,0,-n-25);var i=this.header.y+this.header.height/2,a=this.footer.y-this.footer.height/2;this.main.setPosition(0,(a+i)/2),this.setPosition(e,t)},n.alignComponents=function(){this.alignUI(),this.footer.alignComponents()},n.createLevelManager=function(){this.levelManager=new Lv(this.scene)},n.createMapManager=function(){this.mapManager=new Nv(this.scene)},n.createTargetMissionManager=function(){this.targetMissionManager=new Gv},n.createOutOfMovesEffect=function(){this.oufOfMovesEffect=new _y(this.scene),this.oufOfMovesEffect.hideTextOutOfMoves(),this.oufOfMovesEffect.setDepth(Na.A.ON_TOP),this.add(this.oufOfMovesEffect)},n.startGame=function(){console.log("start Game");try{var e;this.scene.runSetMusicVolume(.2),this.isGameOver=!1,this.isLevelComplete=!1,this.mapManager.reloadMap(),this.main.board.clearBoard(),this.footer.pieces.clearPieces(),this.loadTargetByMap(),this.header.start(),null==(e=this.header.mainScoreBlock.addScore)||e.stop().remove(),this.header.mainScoreBlock.setScore(0),this.header.mainScoreBlock.setScoreText(0),this.header.progressBar.hideProgressBar(),this.header.progressBar.setPercent(0),this.loadBoardAndPieces(),this.loadTargetAmountByFen(),this.loadTextHeader(),this.restartCurrentLevel=0,this.openMissionScreen(),this.scene.analytics.levelStart(this.levelManager.getLevel(),void 0,this.getLevelName())}catch(t){console.log("Error ",t),this.handleRestartLevel(),(0,x.o9)(t,{scene:"Journey Gameplay"})}},n.openMissionScreen=function(){if(this.targetMissionManager.getTargetType()===Vg)this.openCollectionItemsScreen()},n.openCollectionItemsScreen=function(){var e=this,t=this.header.collectItems.getJsonTarget();this.header.collectItems.hideListCollectItems(),this.scene.disableInput(),this.scene.time.delayedCall(500,(function(){e.scene.enableInput(),e.scene.screen.open(Ua.R8.COLLECTION_ITEMS_SCREEN,{jsonTarget:t,duration:1500}),e.scene.audio.playSound(ja.A.START_GAME)}))},n.loadTargetByMap=function(){var e=this.mapManager.getTileMap().properties;if(!e||!(0,Fv.isArray)(e)||e.length<2)throw new ym;console.log("properties === ",e);var t=e[0].value,n=e[1].value;this.targetMissionManager.setTargetValue(t),this.targetMissionManager.setTargetType(n)},n.loadBoardAndPieces=function(){var e,t=this.scene.storage.getState(),n=(0,po.$j)(t),i=((null==(e=(0,po._p)(t))?void 0:e.data)||{}).fen,a=null,s=null;if(i&&!n){var r=this.main.board.getBoardByFen(i);return a=this.handleDynamicFenSize(r),s=this.footer.pieces.getPiecesByFen(i),this.isFenGameOver(a,s)?(this.clearFen(),this.loadBoardByMap(),void this.loadPiecesByMap()):void this.loadBoardByFen(i)}this.loadBoardByMap(),this.loadPiecesByMap()},n.handleDynamicFenSize=function(e){var t,n,i=0;if((n=e.length)&&(i=e[0].length),0===n||0===i)return e;var a=B()(t=[]).call(t,e);if(n>My.rows)_a()(a).call(a,My.rows,n-My.rows);else if(i<My.rows)for(var s=0;s<My.rows-n;s++){var r;a.push(Da()(r=new Array(n)).call(r,{value:0,frame:Ry.GEM_TRANSPARENT}))}return i>My.cols?a.forEach((function(e){_a()(e).call(e,My.cols,i-My.cols)})):i<My.cols&&a.forEach((function(e){for(var t=0;t<My.cols-i;t++)e.push({value:0,frame:Ry.GEM_TRANSPARENT})})),a},n.isFenGameOver=function(e,t){for(var n=[],i=0;i<t.length;i++){var a=t[i],s=a.type,r=a.direction,o=a.isReverse;switch(s){case Pm:case Cm:case wm:n.push({data:Qg.getData(s,r,o)});break;case Im:case xm:case km:case Om:n.push({data:Jg.getData(s,r)});break;case _m:case Rm:case Dm:n.push({data:nv.getData(s)});break;case Bm:n.push({data:cv.getData(r)});break;case Bs:n.push({data:av.getData(r)});break;case js:n.push({data:hv.getData(r)});break;case Ns:case Gs:case Fs:case Us:n.push({data:Zg.getData(s,r)});break;case Mm:n.push({data:rv.getData(r)});break;case Ls:n.push({data:ev.getData()})}}return gc(e,n)},n.clearFen=function(){var e=this.scene.storage.getState(),t=(0,po.jI)(e),n=this.levelManager.getLevel();this.scene.storage.dispatch((0,co.u_)(t,{score:0,data:{fen:"",jsonAmount:{}},level:n,listPieceMap:[],updateAt:Date.now()}))},n.loadBoardByMap=function(){for(var e=this.mapManager.getTileMap().layers,t=e.length,n=0;n<t;n++){var i=e[n].data;console.log("loadBoardByMap",e[n]);for(var a=0;a<i.length;a++)for(var s=i[a],r=0;r<s.length;r++){var o=s[r];if(!(o.index<0)){var c=this.main.board.getGemFrameByMapItemIndex(o.index%10),l="";o.index>=10&&(l=this.main.board.getBubbleFrameByMapItemIndex(Math.floor(o.index/10))),c&&c!==Ry.GEM_TRANSPARENT||(c=this.main.board.getGemFrameByMapItemIndex(2),(0,x.o9)(new Error("MapByBoardError"),{index:o.index,level:this.levelManager.getLevel(),row:a,col:r})),this.main.board.setFrameTargetBoardByIndex(a,r,c,l)}}}console.log("AAAAAAAAAAAAAAAAAAAAA ",this.main.board.dataBoard),this.main.board.fadeIn()},n.loadPiecesByMap=function(){this.footer.pieces.buildPiecesByMap();var e=this.mapManager.getTileMap().getObjectLayer("spawnOrder");if(console.log("objects === ",e),e){for(var t=e.objects,n=0;n<t.length;n++){var i=t[n],s=i.type,r=i.properties,o=this.footer.pieces.getPieceDataByType(s);console.log("type",s,o),r&&(o=(0,a.A)({},o,{properties:r})),o&&this.footer.pieces.addItemPieceMap(o)}console.log("this.footer.pieces================ ",this.footer.pieces.listPieceMap)}},n.loadBoardByFen=function(e){var t=this.main.board.getBoardByFen(e);this.main.board.startGame(t,e)},n.loadTargetAmountByFen=function(){var e;this.header.collectItems.resetTextAmount();var t=this.scene.storage.getState();if(!(0,po.$j)(t)){var n=((null==(e=(0,po._p)(t))?void 0:e.data)||{}).jsonAmount;n&&0!==he()(n).length&&this.header.collectItems.updateJsonAmountByFen(n)}},n.handleRestartLevel=function(){this.restartCurrentLevel>0||(this.scene.game.globalScene.screen.open(Ua.R8.NOTIFY_SCREEN,{message:"Restarting map...",duration:By.Timeout,loading:!0}),this.restartCurrentLevel++,this.preloadCurrentLevel(),this.scene.load.off(Phaser.Loader.Events.COMPLETE),this.scene.load.once(Phaser.Loader.Events.COMPLETE,this.handleLoadCurrentMapComplete.bind(this)),this.scene.load.off(Phaser.Loader.Events.FILE_LOAD_ERROR),this.scene.load.once(Phaser.Loader.Events.FILE_LOAD_ERROR,this.handleLoadCurrentMapError.bind(this)))},n.preloadCurrentLevel=function(){var e=this.levelManager,t=e.getLevelConfig();if(t){var n=t.key;if(this.scene.cache.tilemap.exists(n))this.handleLoadCurrentMapComplete();else{var i=e.getLevel(),a=this.scene.journeySeason.getCurrentSeasonConfig(),s=this.scene.cache.json.get(a.levelsKey);this.scene.load.tilemapTiledJSON(n,s[i-1]),this.scene.load.start()}}},n.handleLoadCurrentMapComplete=function(){console.log("handleLoadCurrentMapComplete");var e=this.scene.game.globalScene;this.mapManager.reloadMap(),this.clearFen(),this.startGame(),e.screen.close(Ua.R8.NOTIFY_SCREEN)},n.handleLoadCurrentMapError=function(e){var t=this.scene.game.globalScene,n=new Uv("Load resources at LoadScene failed.");(0,x.o9)(n,{file:null==e?void 0:e.url}),t.screen.close(Ua.R8.NOTIFY_SCREEN)},n.startGameAfterCollectionItemsScreenClose=function(){var e;console.log("startGameAfterCollectionItemsScreenClose");var t=this.scene.storage.getState(),n=((null==(e=(0,po._p)(t))?void 0:e.data)||{}).fen;n?this.loadPiecesByFen(n):this.footer.pieces.start()},n.loadPiecesByFen=function(e){var t=this.footer.pieces.getPiecesByFen(e);this.footer.pieces.showAvailablePieces(t),this.loadListPieceMapByFen()},n.loadListPieceMapByFen=function(){var e=this.scene.storage.getState(),t=(0,po._p)(e).listPieceMap;t&&0!==t.length&&this.footer.pieces.setListPieceMap(t)},n.createInput=function(){this.isGameOver||(this.header.buttonSetting.onClick=this.handlePauseGame)},n.loadTextHeader=function(){var e=this.scene.storage.getState();if((0,po.$j)(e))return this.header.levelBlock.showTextDay(),void this.header.levelBlock.setDayText(this.getTextDay());var t=this.levelManager.getLevel();this.header.levelBlock.showTextScore(),this.header.levelBlock.setScoreText(t)},n.getTextDay=function(){var e,t=new Date,n="0"+t.getDate(),i="0"+(t.getMonth()+1),a=lt()(e=String(t.getFullYear())).call(e,-2);return lt()(i).call(i,-2)+"/"+lt()(n).call(n,-2)+"/"+a},n.setLevelCompleted=function(e){this.targetMissionManager.getTargetType()!==jg&&(this.isLevelComplete=e)},n.handleCollectionItemsComplete=function(){var e=this;if(this.targetMissionManager.getTargetType()!==jg&&this.header.collectItems.checkCompleteMission()){this.clearFen();var t=this.levelManager.getLevel();this.handleNextLevel(),t>Gd.A.length-1&&this.scene.time.delayedCall(2e3,(function(){e.scene.game.globalScene.screen.open(Ua.R8.NOTIFY_SCREEN,{message:"UPDATING NEW LEVELS...",duration:1e3}),e.scene.time.delayedCall(1e3,(function(){e.scene.scene.switch(ca.F7.LEVEL_SCENE)}))})),this.scene.screen.open(Ua.R8.COLLECTION_COMPLETED_SCREEN,{duration:3e3,onClose:function(){var t=(0,O.A)(D().mark((function t(){return D().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.isLevelComplete=!1,t.next=3,e.handleShowInterstitialAd().catch(x.a0);case 3:e.showPopupCompleteScreenAfterCollectionCompleted();case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}),this.scene.analytics.levelComplete(this.levelManager.getLevel(),void 0,this.getLevelName())}},n.handleNextLevel=function(){if(this.replayPreviousLevel=!0,!(this.levelManager.getCorrectLevel()>=Gd.A.length)){this.levelManager.increaseLevel();var e=this.levelManager.getLevelConfig(),t=this.scene.storage.getState(),n=(0,po.IP)(t);if(this.levelManager.getCorrectLevel()>Gd.A.length-1&&n!=Gd.A.length){var i=this.scene.journeySeason.getSeasonKey(),s=this.scene.player.getCustomData("levelOfSeasons"),r=(0,a.A)({},s);return r[i]=this.levelManager.getCorrectLevel(),this.scene.storage.dispatch((0,co.fA)(Gd.A.length)),this.scene.player.setCustomData("levelOfSeasons",r),void(this.replayPreviousLevel=!1)}if(e){var o=e.key;if(this.scene.cache.tilemap.exists(o))this.handleLoadMapComplete();else{var c=this.levelManager.getLevel(),l=this.scene.journeySeason.getCurrentSeasonConfig(),h=this.scene.cache.json.get(l.levelsKey);this.scene.load.once(Phaser.Loader.Events.COMPLETE,this.handleLoadMapComplete),this.scene.load.tilemapTiledJSON(o,h[c-1]),this.scene.load.start()}}}},n.showPopupCompleteScreenAfterCollectionCompleted=function(){var e=(0,O.A)(D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.scene.screen.open(Ua.R8.MISSION_COMPLETED_SCREEN);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.handleRequestFinishGame=function(){var e=this;this.isGameOver=!0,this.clearFen(),this.scene.storage.dispatch(function(){var e=(0,O.A)(D().mark((function e(t,n){var i,a,s,r,o,c,l,h;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=window.game.player,a=i.getPlayer(),s=a.playerId,r=n(),o=Ey(r),c=Ty(r),(l=o-Py.bonusLife)>Py.livesCapacity&&(l=Py.livesCapacity),l<0&&(l=0),t({type:Ci,payload:{data:h={lives:l,lastBonusLifeTime:c}}}),e.next=13,window.FBInstant.player.setDataAsync({lives:h});case 13:(0,yy.AD)(by.LivesStore+"-"+s,h),e.next=18;break;case 16:e.prev=16,e.t0=e.catch(0);case 18:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(t,n){return e.apply(this,arguments)}}()),this.scene.analytics.levelFail(this.levelManager.getLevel(),void 0,this.getLevelName()),this.scene.time.delayedCall(400,(function(){e.oufOfMovesEffect.playTweenMoveCenterScene()})),this.scene.time.delayedCall(2e3,(function(){e.oufOfMovesEffect.playTweenScaleDown()}))},n.fastEndGame=function(){this.isGameOver=!0,this.clearFen(),this.scene.analytics.event(rn.o.LEVEL_FAST_END,{level:this.levelManager.getLevel(),level_name:this.getLevelName(),success:!1}),this.scene.analytics.levelFail(this.levelManager.getLevel(),void 0,this.getLevelName()),this.scene.screen.open(Ua.R8.MISSION_FAIL_SCREEN)},n.getLevelName=function(){var e,t=this.levelManager.getLevel();return"journey_"+Ba()(e=GameCore.Utils.Number).call(e,t,4,"0")},n.handleRetryLevel=function(){this.clearFen(),this.startGame()},n.handleUpdateScore=function(e){var t=this.header.mainScoreBlock.score+e;this.scene.storage.dispatch((0,co.RF)(t))},n.handleAddScoreAnim=function(e){this.header.mainScoreBlock.animAddScore(e)},n.canUpdateFenMatch=function(){return!this.isGameOver&&!this.isLevelComplete},n.getFen=function(){return this.main.board.getFenByBoard()+" "+this.footer.pieces.getFenByPieces()},n.updateMatchData=function(){var e;if(this.canUpdateFenMatch()){var t=this.getFen(),n=this.scene.storage.getState(),i=(0,po._p)(n).data||{},s=(0,po.jI)(n),r=(0,po.Ou)(n)||0,o=this.levelManager.getLevel(),c=this.header.collectItems.getJsonAmount(),l=this.footer.pieces.getListPieceMap();this.scene.storage.dispatch((0,co.u_)(s,{score:r,data:(0,a.A)({},i,{fen:t,jsonAmount:(0,a.A)({},c)}),level:o,updateAt:Date.now(),listPieceMap:B()(e=[]).call(e,l)}))}},n.isLevelCompleted=function(){return this.isLevelComplete},n.registerPiecesGlobalEvents=function(){this.footer.registerPiecesGlobalEvents()},n.unregisterPiecesGlobalEvents=function(){this.footer.unregisterPiecesGlobalEvents()},t}(Phaser.GameObjects.Container),Ny=Ly,Gy=Fa.A.DEFAULT,Fy=Gy.KEY,Uy=Gy.FRAME,jy=function(e){function t(t){var n;return(n=e.call(this,t)||this).medalNo123=void 0,n.rankLabel=void 0,n.rank=1,n.setSize(20,20),n.createMedal123(),n.createRankLabel(),n}(0,_.A)(t,e);var n=t.prototype;return n.getRank=function(){return this.rank},n.setRank=function(e){var t=function(e){return e>99?"99+":0===e?"?":e.toString()}(e);switch(this.rank=e,this.rankLabel.kill(),this.rankLabel.setText(t),this.medalNo123.kill(),t){case"1":this.medalNo123.revive(),this.medalNo123.setFrame(Uy.TOUR_RESULT_GOLD),this.medalNo123.setWorldSize(10.5,19.5);break;case"2":this.medalNo123.revive(),this.medalNo123.setFrame(Uy.TOUR_RESULT_SILVER),this.medalNo123.setWorldSize(13,20);break;case"3":this.medalNo123.revive(),this.medalNo123.setFrame(Uy.TOUR_RESULT_BRONZE),this.medalNo123.setWorldSize(12.5,19.5);break;default:this.rankLabel.revive()}},n.createMedal123=function(){this.medalNo123=this.scene.make.image({key:Fy,frame:Uy.TOUR_RESULT_GOLD}),this.add(this.medalNo123)},n.createRankLabel=function(){this.rankLabel=this.scene.make.bitmapText({font:za.A.MIKADO_WHITE.KEY,size:15,origin:{x:.5,y:.5},text:""+this.rank}),this.add(this.rankLabel)},t}(Phaser.GameObjects.Container);var Vy=Fa.A.DEFAULT,zy=Vy.KEY,Yy=Vy.FRAME,Hy=function(e){function t(t,n){var i;return void 0===n&&(n=!1),(i=e.call(this,t)||this).scene=void 0,i._isPlayer=!1,i.normalPlayerBackground=void 0,i.avatar=void 0,i.username=void 0,i.score=void 0,i.medalIcon=void 0,i.scoreIcon=void 0,i.payload=void 0,i.instantPlayerVisualIndicator=!1,i.scene=t,i.createNormalPlayerBackground(),i.setSize(i.normalPlayerBackground.width,i.normalPlayerBackground.height),i.createMedalIcon(),i.createAvatar(),i.createUsername(),i.createScoreIcon(),i.createScore(),i.alignComponents(),i.isPlayer=n,i}(0,_.A)(t,e);var n=t.prototype;return n.createNormalPlayerBackground=function(){this.normalPlayerBackground=this.scene.make.image({key:zy,frame:Yy.BLANK}),this.normalPlayerBackground.setWorldSize(315,60.5),this.add(this.normalPlayerBackground)},n.createAvatar=function(){this.avatar=new xl(this.scene,{key:zy,background:Yy.BLANK,width:42,height:42,loadDelay:100}),this.avatar.update(),this.avatar.background.kill(),this.avatar.loadPhoto(GameCore.Utils.String.generateObjectId(),Ga.A.AVATAR.FILE),this.add(this.avatar);var e=this.scene.make.image({key:zy,frame:Yy.TOUR_RESULT_AVATAR_BORDER});e.setWorldSize(34.5,35),this.avatar.add(e)},n.createUsername=function(){this.username=this.scene.make.text({style:{fontFamily:za.A.FONT_FAMILY},origin:{x:0,y:.5}}),this.username.setHighQuality(),this.username.setFontSize(16),this.add(this.username)},n.createScore=function(){this.score=this.scene.make.bitmapText({font:za.A.MIKADO_WHITE.KEY,size:16,origin:{x:1,y:.5}}),this.add(this.score),this.setScore(0)},n.createScoreIcon=function(){this.scoreIcon=this.scene.add.image(0,0,zy,Yy.TOUR_RESULT_CUP_SMALL),this.scoreIcon.setWorldSize(26,22.5),this.add(this.scoreIcon)},n.createMedalIcon=function(){this.medalIcon=new jy(this.scene),this.medalIcon.kill(),this.add(this.medalIcon)},n.setScore=function(e){this.score.setText(""+e)},n.setUsername=function(e){var t=GameCore.Utils.String.getShortName(e,12),n=GameCore.Utils.String.removeDiacritics(t);this.username.setText(n)},n.getTimerIcon=function(){return this.scoreIcon},n.updateData=function(e){var t=e.playerId,n=void 0===t?"10":t,i=e.name,a=void 0===i?"???":i,s=e.photo,r=void 0===s?"":s,o=e.score,c=void 0===o?0:o,l=e.rank,h=void 0===l?0:l;if(!this.payload||(u=e,d=this.payload,u.playerId!==d.playerId||u.photo!==d.photo||u.score!==d.score||u.rank!==d.rank||u.name!==d.name)){var u,d;this.payload=e,this.isPlayer=n===this.scene.player.getPlayerId(),this.scoreIcon.setAlpha(0),this.score.setAlpha(0),this.username.setAlpha(0),this.avatar.setAlpha(0),this.setScore(c),this.medalIcon.setRank(h),this.updateNormalPlayerBackground(),0===c?(this.setUsername("Waiting..."),this.avatar.loadPhoto("","")):(this.setUsername(a),this.avatar.loadPhoto(n,r)),this.medalIcon.revive();var p=this.x,f=this.y;this.setPosition(0,0),Phaser.Display.Align.In.RightCenter(this.scoreIcon,this,-68,-1.25),this.x=p,this.y=f,this.playRecentlyUpdatedComponentEntrancesAnimation()}},n.getCorrectFrameForBg=function(){return this.isPlayer?Yy.TOUR_RESULT_LEADER_BAR_HIGHLIGHT:Yy.TOUR_RESULT_LEADER_BAR},n.updateNormalPlayerBackground=function(){var e=this.getCorrectFrameForBg();this.normalPlayerBackground.setFrame(e),this.normalPlayerBackground.setWorldSize(315,60.5)},n.alignComponents=function(){Phaser.Display.Align.In.LeftCenter(this.medalIcon,this,-16),Phaser.Display.Align.To.RightCenter(this.avatar,this.medalIcon,6,-2),Phaser.Display.Align.To.RightCenter(this.username,this.avatar,3),Phaser.Display.Align.In.RightCenter(this.score,this,-18,-1),Phaser.Display.Align.In.RightCenter(this.scoreIcon,this,-68,-1.25)},n.playRecentlyUpdatedComponentEntrancesAnimation=function(){this.scene.add.tween({targets:[this.scoreIcon,this.score,this.username,this.avatar],props:{alpha:{from:0,to:1}},duration:150})},n.hideContent=function(){this._isPlayer&&this.normalPlayerBackground.revive()},n.runScalingAnimation=function(){var e=(0,O.A)(D().mark((function e(){var t=this;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new(N())((function(e){t.scene.add.tween({targets:t,duration:200,ease:Phaser.Math.Easing.Cubic.In,props:{scale:.95},onComplete:function(){t.scene.add.tween({targets:t,ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.45],props:{scale:1},onComplete:e})}})})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){var e=(0,O.A)(D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._isPlayer){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,N().all([this.runScalingAnimation()]);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),(0,ve.A)(t,[{key:"isPlayer",get:function(){return this._isPlayer},set:function(e){this._isPlayer=e,this._isPlayer&&this.instantPlayerVisualIndicator?this.normalPlayerBackground.kill():this.normalPlayerBackground.revive()}}]),t}(Phaser.GameObjects.Container);var Ky=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.leaders=[],n.loading=void 0,n.payload=[],n.scene=t,n.createLeaders(),n.alignLeaders(),n.createLoading(),n}(0,_.A)(t,e);var n=t.prototype;return n.updateLeaders=function(e){(function(e,t){var n,i;if(e.length!==t.length)return!1;for(var a=ei()(n=lt()(e).call(e)).call(n,(function(e,t){return e.rank-t.rank})),s=ei()(i=lt()(t).call(t)).call(i,(function(e,t){return e.rank-t.rank})),r=0;r<a.length;r++){var o=a[r],c=s[r];if(o.playerId!==c.playerId||o.photo!==c.photo||o.score!==c.score||o.rank!==c.rank||o.name!==c.name)return!1}return!0})(this.payload,e)||(this.payload=e,this.leaders.forEach((function(t,n){t.updateData((0,a.A)({},e[n]))})))},n.createLeaders=function(){for(var e=0;e<4;e++){var t=new Hy(this.scene);this.leaders.push(t),3===e&&(t.isPlayer=!0);var n={playerId:e.toString(),photo:"",score:0,rank:e+1,name:"player"};t.updateData(n)}this.add(this.leaders)},n.alignLeaders=function(){var e=this,t=this.leaders.length,n=t*this.leaders[0].height+0*(t-1);this.setSize(303,n),this.leaders.forEach((function(t,n){0!==n?Phaser.Display.Align.To.BottomCenter(t,e.leaders[n-1],0,0):Phaser.Display.Align.In.TopCenter(t,e)}))},n.createLoading=function(){this.loading=new wl.A(this.scene),this.add(this.loading)},n.hideContent=function(){this.leaders.forEach((function(e){return e.setAlpha(0)})),this.leaders.forEach((function(e){return e.hideContent()}))},n.runEntranceAnimation=function(){var e=(0,O.A)(D().mark((function e(){var t,n,i,a,s=this;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Be()(t=this.leaders).call(t,(function(e,t){return new(N())((function(n){s.scene.add.tween({targets:[e],duration:250,delay:250*t/2,ease:Phaser.Math.Easing.Cubic.Out,props:{alpha:{from:0,to:1},y:{from:e.y+e.height/2,to:e.y},scale:{from:.85,to:1,ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.45],duration:1e3}},onComplete:n})}))})),e.next=3,N().all(i);case 3:return a=Be()(n=this.leaders).call(n,(function(e){return e.runEntranceAnimation()})),e.next=6,N().all(a);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(Phaser.GameObjects.Container);for(var Wy=Fa.A.DEFAULT,Zy=Wy.KEY,Xy=Wy.FRAME,Jy=function(e){function t(t){var n;return(n=e.call(this,t,Zy,Xy.TOUR_RESULT_BTN_GREEN,177,67.5)||this).animation=void 0,n.createButtonLabel(),n.setName("TournamentResultContinue"),n}(0,_.A)(t,e);var n=t.prototype;return n.createButtonLabel=function(){var e=this.scene.make.bitmapText({font:za.A.MIKADO_GREEN_STROKE.KEY,size:21,origin:{x:.5,y:.5},text:"Continue"});e.setY(-6),this.add(e)},n.runAnimation=function(){var e,t,n=this;null==(e=this.animation)||e.remove(),this.animation=new Fu({targets:[this],props:{scale:{from:1,to:1.05}}}),null==(t=this.animation)||t.play(),this.hitZone.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,(function(){var e;null==(e=n.animation)||e.stop()})),this.hitZone.on(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,(function(){var e,t;null!=(e=n.animation.tween)&&e.isPlaying()||null==(t=n.animation)||t.play()}))},t}(Va.A),qy=Fa.A.DEFAULT,Qy=qy.KEY,$y=qy.FRAME,eA={playerId:"10",name:"???",photo:"",score:0,rank:0},tA=[],nA=0;nA<4;nA++)tA.push((0,a.A)({},eA,{rank:nA+1}));var iA=function(e){function t(t){var n;(n=e.call(this,t)||this).scene=void 0,n.title=void 0,n.leaderList=void 0,n.rematchButton=void 0,n.continueButton=void 0,n.shareButton=void 0,n.buttons=[],n.congratulationText=void 0,n.continueButtonAnimation=void 0,n.scene=t;var i=t.gameZone,a=i.width,s=i.height;return n.setSize(a,s),n.createTitle(),n.createCongratulateText(),n.createLeaderList(),n.createRematchButton(),n.createContinueButton(),n.createShareButton(),Phaser.Display.Align.In.RightCenter(n.rematchButton,n.continueButton,n.rematchButton.width),Phaser.Display.Align.In.LeftCenter(n.shareButton,n.continueButton,n.shareButton.width-6),n}(0,_.A)(t,e);var n=t.prototype;return n.createTitle=function(){this.title=this.scene.make.container({});var e=this.scene.make.image({key:Qy,frame:$y.TOUR_RESULT_TITLE_PANEL});e.setWorldSize(273,78),this.title.add(e),this.title.setSize(e.displayWidth,e.displayHeight);var t=this.scene.make.image({key:Qy,frame:$y.TOUR_RESULT_CONGRATULATIONS});t.setWorldSize(237,26),this.title.add(t),this.add(this.title),Phaser.Display.Align.In.TopCenter(this.title,this,0,-71)},n.createCongratulateText=function(){var e=this.scene.make.bitmapText({font:za.A.MIKADO_YELLOW.KEY,size:19,origin:{x:.5,y:.5},text:"You have completed a tournament"});this.add(e),Phaser.Display.Align.In.BottomCenter(e,this.title,0,48),this.congratulationText=e},n.createLeaderList=function(){this.leaderList=new Ky(this.scene),this.leaderList.loading.kill(),this.add(this.leaderList),Phaser.Display.Align.To.BottomCenter(this.leaderList,this.congratulationText,0,15.5)},n.createRematchButton=function(){var e=this;this.rematchButton=new Va.A(this.scene,Qy,$y.TOUR_RESULT_BTN_RED,60,66.5),this.rematchButton.onClick=(0,O.A)(D().mark((function t(){return D().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.scene.screen.close(Ua.R8.TOURNAMENT_RESULT_SCREEN),t.next=3,e.scene.storage.dispatch((0,oo.El)());case 3:go.A.emit(ro.A.REPLAY);case 4:case"end":return t.stop()}}),t)}))),this.rematchButton.setName("RetryTournament");var t=this.scene.make.image({key:Qy,frame:$y.ICON_RESTART});t.setWorldSize(31,30),t.setPosition(-1,-4),this.rematchButton.add(t),this.add([this.rematchButton]),this.buttons.push(this.rematchButton)},n.createContinueButton=function(){var e=this;this.continueButton=new Jy(this.scene),this.continueButton.onClick=(0,O.A)(D().mark((function t(){return D().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.scene.screen.open(Ua.R8.RESULT_SCREEN),e.scene.screen.close(Ua.R8.TOURNAMENT_RESULT_SCREEN);case 2:case"end":return t.stop()}}),t)}))),this.add([this.continueButton]),this.buttons.push(this.continueButton),Phaser.Display.Align.To.BottomCenter(this.continueButton,this.leaderList,0,19.875)},n.createShareButton=function(){var e=new Va.A(this.scene,Qy,$y.TOUR_RESULT_BTN_BLUE,60,66.5);e.setName("TournamentResultShare"),this.add(e),e.onClick=(0,O.A)(D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(0,mo.oN)(Cp.A.getCurrentTourPlayerScore());case 1:case"end":return e.stop()}}),e)}))),this.shareButton=e;var t=this.scene.add.image(0,0,Qy,$y.ICON_SHARE);t.setWorldSize(26.5,30),t.setPosition(-4,-4),e.add(t),this.buttons.push(e)},n.updateLeadersViaId=function(){var e=(0,O.A)(D().mark((function e(t,n){var i,s,r,o,c,l,h,u,d,p,m,g,v,y,A=this;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=B()(i=[]).call(i,tA),this.leaderList.loading.revive(),this.leaderList.bringToTop(this.leaderList.loading),r=n,e.prev=4,o=[],void 0===t){e.next=10;break}return e.next=9,(0,Gp.Kv)(t,{limit:4});case 9:o=e.sent;case 10:if(console.log("update tournament result",{leaders:o}),!(o.length>0)){e.next=30;break}return l=Be()(o).call(o,(function(e){return e.playerId})),e.next=15,this.scene.profile.requestProfiles(l);case 15:if(h=this.scene.profile.getProfiles(),u=!1,d=f()(c=Be()(o).call(o,(function(e){var t=e.playerId,n=e.score,i=e.rank,a=h[t];if(t===A.scene.player.getPlayerId()&&(u=!0,r=parseInt(n)),!a)return{playerId:t,photo:"",score:parseInt(n),rank:i,name:"Player"};var s=a.name;return{playerId:t,photo:a.photo,score:n,rank:i,name:s}}))).call(c,(function(e){return null!==e})),!(d.length<1)){e.next=20;break}throw new Error("Leaderboard is empty");case 20:if(this.leaderList.revive(),d.forEach((function(e,t){s[t]=e})),u||void 0===t){e.next=28;break}return e.next=25,this.getCurrentPlayerLeaderDataPayload(t);case 25:p=e.sent,s[3]=(0,a.A)({},p),r=p.score;case 28:e.next=33;break;case 30:m=this.scene.player.getPlayer(),g=m.playerId,v=m.name,y=m.photo,s[0]={playerId:g,name:v,photo:y,score:n,rank:1},r=n;case 33:console.log("update tournament result",{leadersDataPayload:s}),this.leaderList.updateLeaders(s),e.next=40;break;case 37:e.prev=37,e.t0=e.catch(4),console.warn(e.t0);case 40:return e.prev=40,this.leaderList.loading.kill(),e.finish(40);case 43:Cp.A.setCurrentTourPlayerScore(r);case 44:case"end":return e.stop()}}),e,this,[[4,37,40,43]])})));return function(t,n){return e.apply(this,arguments)}}(),n.getCurrentPlayerLeaderDataPayload=function(){var e=(0,O.A)(D().mark((function e(t){var n,i,a,s,r,o,c;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.scene.player.getPlayer(),i=n.playerId,a=n.name,s=n.photo,e.next=3,(0,Gp.hJ)(i,t);case 3:return r=e.sent,console.log({player:r}),o=r.score,c=r.rank,e.abrupt("return",{playerId:i,photo:s,score:parseInt(o),rank:c,name:a});case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.hideContent=function(){var e,t;this.leaderList.hideContent(),null==(e=this.continueButtonAnimation)||e.stop(),null==(t=this.continueButtonAnimation)||t.remove(),this.continueButton.setScale(1),this.buttons.forEach((function(e){return e.setAlpha(0)}))},n.runEntranceAnimationButtons=function(){var e=(0,O.A)(D().mark((function e(){var t,n,i=this;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Be()(t=this.buttons).call(t,(function(e){return new(N())((function(t){i.scene.add.tween({targets:e,alpha:1,duration:200,onComplete:function(){e.setDisabled(!1),t(),i.continueButton.runAnimation()}})}))})),e.next=3,N().all(n);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){var e=(0,O.A)(D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.leaderList.runEntranceAnimation();case 2:return e.next=4,this.runEntranceAnimationButtons();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(Phaser.GameObjects.Container),aA=Fa.A.DEFAULT,sA=aA.KEY,rA=aA.FRAME,oA=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).scene=void 0,s.backgroundDark=void 0,s.coralLeft=void 0,s.coralRight=void 0,s.fadeInAnimation=void 0,s.fadeOutAnimation=void 0,s.slideInAnimation=void 0,s.container=void 0,s.confettiLeftEffect=void 0,s.confettiRightEffect=void 0,s.tweenCounterConfetti=void 0,s.listTweenAnim=[],s.runConfettiEffect=function(){var e=s.scene.gameZone.width;s.confettiLeftEffect.stop(),s.confettiRightEffect.stop(),s.scene.children.bringToTop(s.confettiLeftEffect),s.scene.children.bringToTop(s.confettiRightEffect),s.confettiLeftEffect.run(1,0,-100),s.confettiRightEffect.run(1,0+e,-100),s.tweenCounterConfetti=s.scene.tweens.addCounter({delay:1e4,from:100,to:0,ease:Phaser.Math.Easing.Cubic.Out,duration:400,onUpdate:function(e){var t,n,i=e.getValue()/100;null==(t=s.confettiLeftEffect.emitter)||t.setAlpha(i),null==(n=s.confettiRightEffect.emitter)||n.setAlpha(i)},onComplete:function(){s.stopEmitter()}})},s.scene=t,s.createBackgroundDark(),s.createCorals(),s.createContainer(),s.createConfettiSmallAnimation(),s.setDepth(Ua.Ae.POPUP),s.scene.events.on(Vr.A.LAYOUT_UPDATE,s.alignComponents,(0,ka.A)(s)),s}(0,_.A)(t,e);var n=t.prototype;return n.alignComponents=function(){var e=this.width,t=this.height;this.backgroundDark.setWorldSize(e,t),Phaser.Display.Align.In.TopLeft(this.coralLeft,this.backgroundDark,0,0),Phaser.Display.Align.In.TopRight(this.coralRight,this.backgroundDark,0,0)},n.createBackgroundDark=function(){var e=this.scene.gameZone,t=e.width,n=e.height;this.backgroundDark=this.scene.make.image({key:Ga.A.BACKGROUND_DARK.KEY}),this.backgroundDark.setWorldSize(t,n),this.add(this.backgroundDark)},n.createCorals=function(){this.coralLeft=this.scene.make.image({key:sA,frame:rA.CORAL_LEFT}),this.coralLeft.setOrigin(0,0),this.coralLeft.setWorldSize(62,189),this.coralRight=this.scene.make.image({key:sA,frame:rA.CORAL_RIGHT}),this.coralRight.setOrigin(1,0),this.coralRight.setWorldSize(67,170),this.add([this.coralLeft,this.coralRight]),Phaser.Display.Align.In.TopLeft(this.coralLeft,this.backgroundDark,0,0),Phaser.Display.Align.In.TopRight(this.coralRight,this.backgroundDark,0,0)},n.createContainer=function(){this.container=new iA(this.scene),this.add(this.container)},n.open=function(){var t=(0,O.A)(D().mark((function t(n){return D().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.prototype.open.call(this,n),this.scene.runSetMusicVolume(.4),this.updateInfo(),this.container.setAlpha(1),this.container.setInteractive(),this.background.setAlpha(1),this.runOpenAnimation(),this.runCoralAnimation(),this.scene.audio.playSound(ja.A.GAME_OVER_SCENE);case 9:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.updateInfo=function(){var e=(0,O.A)(D().mark((function e(){var t,n,i,a,s;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Cp.A.getData().catch((function(){return{id:0,title:"Summer tournament",endTime:2e9,contextID:""}}));case 2:if(i=e.sent){e.next=5;break}return e.abrupt("return");case 5:return a=null==(t=i.payload)?void 0:t.leaderboardId,s=(null==(n=this.data)?void 0:n.list.score)||1e3,e.next=9,this.container.updateLeadersViaId(a,s);case 9:this.scene.postSessionScore();case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.close=function(){this.runCloseAnimation(),this.stopEmitter()},n.runOpenAnimation=function(){var e=(0,O.A)(D().mark((function e(){var t,n=this;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==(t=this.slideInAnimation)||null==(t=t.tween)||!t.isPlaying()){e.next=2;break}return e.abrupt("return");case 2:this.scene.audio.playSound(ja.A.POPUP_SHOW),this.container.setAlpha(0),this.container.y=50,this.container.hideContent(),this.slideInAnimation||(this.slideInAnimation=new lu.A({targets:[this.container],ease:Phaser.Math.Easing.Back.Out,props:{y:{from:50,to:0},alpha:{from:0,to:1}},duration:300,onComplete:function(){var e=(0,O.A)(D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.container.runEntranceAnimation();case 2:n.runConfettiEffect();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()})),this.fadeInAnimation||(this.fadeInAnimation=new wo.A({targets:[this],duration:300})),this.fadeInAnimation.play(),this.slideInAnimation.play();case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runCoralAnimation=function(){this.listTweenAnim.forEach((function(e){e.stop(),e.remove()})),this.listTweenAnim=[];var e=this.coralLeft,t=e.x,n=e.y,i=this.coralRight,a=i.x,s=i.y;this.coralLeft.setPosition(t-50,n-50),this.coralRight.setPosition(a+50,s-50);var r=[{x:t,y:n},{x:a,y:s}],o=this.scene.add.tween({targets:[this.coralLeft,this.coralRight],props:{x:{getEnd:function(e,t,n,i){return r[i].x}},y:{getEnd:function(e,t,n,i){return r[i].y}}},ease:Phaser.Math.Easing.Cubic.Out,duration:1e3});this.listTweenAnim.push(o),o=this.scene.add.tween({targets:[this.coralLeft],props:{angle:{from:0,to:5}},duration:5e3,yoyo:!0,repeat:-1}),this.listTweenAnim.push(o),o=this.scene.add.tween({delay:500,targets:[this.coralRight],props:{angle:{from:0,to:-5}},duration:3e3,yoyo:!0,repeat:-1}),this.listTweenAnim.push(o)},n.runCloseAnimation=function(){var t,n=this;null!=(t=this.fadeOutAnimation)&&null!=(t=t.tween)&&t.isPlaying()||(this.scene.audio.playSound(ja.A.POPUP_OFF),this.fadeOutAnimation||(this.fadeOutAnimation=new Bh.A({targets:[this],props:{alpha:0},duration:300,onComplete:function(){e.prototype.close.call(n)}})),this.fadeOutAnimation.play())},n.createConfettiSmallAnimation=function(){this.confettiLeftEffect=new Hu.A(this.scene,{speedX:{min:-20,max:100},rotate:{start:-1080,end:0}}),this.confettiRightEffect=new Hu.A(this.scene,{speedX:{min:20,max:-100},rotate:{start:0,end:1080}}),this.confettiLeftEffect.setDepth(Na.A.ON_TOP),this.confettiRightEffect.setDepth(Na.A.ON_TOP)},n.stopEmitter=function(){var e,t,n,i,a;null==(e=this.tweenCounterConfetti)||e.stop(),null==(t=this.confettiLeftEffect.emitter)||t.killAll(),null==(n=this.confettiRightEffect.emitter)||n.killAll(),null==(i=this.confettiLeftEffect.emitter)||i.setAlpha(1),null==(a=this.confettiRightEffect.emitter)||a.setAlpha(1),this.confettiLeftEffect.stop(),this.confettiRightEffect.stop()},t}(GameCore.Screen),cA=oA,lA=GameCore.Configs,hA=lA.Match,uA=lA.Network,dA=lA.Tutorial,pA=lA.Board,fA=lA.Ads,mA=Fa.A.GAMEPLAY_32.FRAME,gA=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=e.call.apply(e,B()(t=[this]).call(t,a))||this).lastTimeInputEnabled=0,n.usedRescue=!1,n.levelManager=void 0,n.oufOfMovesEffect=void 0,n.bestScoreGlareEffect=void 0,n.header=void 0,n.main=void 0,n.footer=void 0,n.tutorialManager=void 0,n.effectManager=void 0,n.isBestScoreScreenShowed=void 0,n.isGameOver=void 0,n.isShowedNextTargetScreen=void 0,n.piecesByFen=void 0,n.isGameError=void 0,n.isRescueModeFriend=0,n.gamePlayMode=void 0,n.isNextTarget=!1,n.timeDelayOutOfMove=0,n.enableTestMode=!1,n.journeyGameplay=void 0,n.wake=function(){n.enableTestMode=!0,n.journeyGameplay.startGame(),n.showJourneyGameplay()},n.run=function(){var e=n.storage.getState();if(null===(0,uo.hX)(e)&&n.storage.dispatch((0,oo.V8)(!1)),n.ads.showBannerAdAsync().catch(x.a0),n.tutorialManager.isValidForTutorial()||dA.ForceUseTutorial)return n.handleStartTutorial(),void n.player.incUserGuideDisplays();var t=n.player.getPlayerId();if((0,po.pr)(e,{playerId:t}))return window.isShowResultChallengeFromPost=!0,void n.screen.open(Ua.R8.RESULT_SCREEN);n.startGame()},n.create=function(){e.prototype.create.call((0,ka.A)(n)),n.createBackground(Ga.A.BACKGROUND.KEY),n.createLevelManager(),n.createMain(),n.createJourneyGameplay(),n.createHeader(),n.createFooter(),n.createTutorialManager(),n.createEffectManager(),n.createScreens(),n.createOutOfMovesEffect(),n.createBestScoreGlareEffect(),n.createInput(),n.listenEvents(),n.input.setTopOnly(!0),n.preLoadAds()},n.closeSettingScreen=function(){(0,ka.A)(n).screen.close(Ua.R8.SETTINGS_SCREEN)},n.closeGameOverScreen=function(){(0,ka.A)(n).screen.close(Ua.R8.RESULT_SCREEN)},n.handlePauseGame=function(){n.isGameOver||(0,ka.A)(n).screen.open(Ua.R8.SETTINGS_SCREEN)},n.handleShowInterstitialAd=(0,O.A)(D().mark((function e(){var t;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.game.globalScene,e.prev=1,n.audio.pauseMusic(),n.ads.canbeShowInterstitialAd()){e.next=5;break}return e.abrupt("return");case 5:return t.screen.open(Ua.R8.NOTIFY_SCREEN,{message:"Loading ads...",duration:uA.Timeout,loading:!0}),e.next=8,n.ads.showInterstitialAdAsync();case 8:e.next=13;break;case 10:return e.prev=10,e.t0=e.catch(1),e.abrupt("return");case 13:return e.prev=13,t.screen.close(Ua.R8.NOTIFY_SCREEN),n.ads.preloadInterstitialAdAsync().catch(x.a0),window.focus(),n.audio.playMusic(),e.finish(13);case 19:case"end":return e.stop()}}),e,null,[[1,10,13,19]])}))),n.rescued=function(){try{var e=n.getLevelLogInfo(),t=e.level,i=e.score,a=e.levelName;n.analytics.levelRescue(t,i,a),n.main.board.rescue(),n.nextLevel(),n.usedRescue=!0}catch(s){}},n.replay=function(){n.addShortcut(),n.showNormalGameplay(),n.restartGame(),n.startGame(),n.resetRescued()},n.setPlayerBestScore=(0,T.s)((function(e){n.player.setBestScore(e)}),100),n}(0,_.A)(t,e);var n=t.prototype;return n.preload=function(){this.events.on(Phaser.Scenes.Events.WAKE,this.wake),this.events.on(Phaser.Scenes.Events.CREATE,this.wake)},n.preLoadAds=function(){this.ads.preloadInterstitialAdAsync().catch((function(e){return console.log(e)})),this.ads.preloadRewardedVideoAsync().catch((function(e){return console.log(e)}))},n.createHeader=function(){this.header=this.main.header},n.createLevelManager=function(){this.levelManager=new Co(this)},n.createOutOfMovesEffect=function(){this.oufOfMovesEffect=new Oo(this),this.oufOfMovesEffect.setDepth(Na.A.PIECE+1)},n.createBestScoreGlareEffect=function(){this.bestScoreGlareEffect=new Ao(this),Phaser.Display.Align.In.Center(this.bestScoreGlareEffect,this.gameZone)},n.createMain=function(){var e=this;this.main=new Ih(this),Phaser.Display.Align.In.Center(this.main,this.gameZone),this.events.on(Vr.A.LAYOUT_UPDATE,(function(){Phaser.Display.Align.In.Center(e.main,e.gameZone),e.main.updateLayout()}))},n.createJourneyGameplay=function(){var e=this;this.journeyGameplay=new Ny(this),this.journeyGameplay.init(),this.journeyGameplay.setVisible(!1),Phaser.Display.Align.In.Center(this.journeyGameplay,this.gameZone),this.add.existing(this.journeyGameplay),this.events.on(Vr.A.LAYOUT_UPDATE,(function(){Phaser.Display.Align.In.Center(e.journeyGameplay,e.gameZone),e.journeyGameplay.updateLayout()}))},n.createFooter=function(){this.footer=this.main.footer},n.createTutorialManager=function(){this.tutorialManager=new so(this)},n.createEffectManager=function(){this.effectManager=new dl(this)},n.createInput=function(){this.isGameOver||(this.header.buttonPause.onClick=this.handlePauseGame)},n.createScreens=function(){this.createSettingScreen(),this.createRescueScreen(),this.createResultScreen(),this.createTournamentResultScreen(),this.createSettingScreenJourney(),this.createCollectionItemsScreen(),this.createCollectionCompletedScreen(),this.createMissionCompletedScreen(),this.createMissionFailScreen()},n.createSettingScreen=function(){this.screen.add(Ua.R8.SETTINGS_SCREEN,um)},n.createSettingScreenJourney=function(){this.screen.add(Ua.R8.SETTINGS_SCREEN_JOURNEY,gm)},n.createCollectionItemsScreen=function(){this.screen.add(Ua.R8.COLLECTION_ITEMS_SCREEN,Wh)},n.createCollectionCompletedScreen=function(){this.screen.add(Ua.R8.COLLECTION_COMPLETED_SCREEN,Mh)},n.createMissionCompletedScreen=function(){this.screen.add(Ua.R8.MISSION_COMPLETED_SCREEN,sf)},n.createMissionFailScreen=function(){this.screen.add(Ua.R8.MISSION_FAIL_SCREEN,Sf)},n.runSetMusicVolume=function(e){var t=this;e!=this.audio.getMusicVolume()&&this.tweens.addCounter({from:this.audio.getMusicVolume(),to:e,onUpdate:function(e){var n=e.getValue();t.audio.setMusicVolume(n)},duration:500})},n.startGame=function(){var e=this;try{window.focus(),this.runSetMusicVolume(.2),this.isGameOver=!1,this.tutorialManager.skipTutorial(),this.showNormalGameplay(),this.closeSettingScreen(),this.closeGameOverScreen(),this.handleUsedRescue(),this.restartGame(),this.header.setVisible(!0),this.updateCurrentBestScore(),this.updateLevelManager(),this.handleGameModeUI(),this.header.buttonPause.setDisabled(!0),this.time.delayedCall(300,(function(){e.header.buttonPause.setDisabled(!1)}));var t=this.getLevelLogInfo(),n=t.level,i=t.levelName;this.analytics.levelStart(n,0,i)}catch(a){this.isGameError||(this.isGameError=!0,this.storage.dispatch((0,oo.ry)()),this.restartGame(),this.startGame(),this.resetRescued()),(0,x.o9)(new Error("Start game scene"),{error:a,scene:"GameScene"})}},n.handleGameModeChange=function(){var e=this,t=[{selector:uo.qs,callback:function(t){t!==e.gamePlayMode&&e.handleGameModeUI()}}];this.handleStateChange(t)},n.handleGameModeUI=function(){var e,t,n=this.storage.getState();this.gamePlayMode=(0,uo.qs)(n),console.log("============================ handleGameModeUI ============================",this.gamePlayMode),!this.gamePlayMode||g()(e=[ho.Nu,ho.zA]).call(e,this.gamePlayMode)>=0?this.handleStartGameSingleMode():g()(t=[ho.Ee,ho.QT]).call(t,this.gamePlayMode)>=0?this.handleStartGameFriendMode():this.handleStartGameSingleMode()},n.startGameAfterTargetScoreScreenClose=function(){var e,t=this.storage.getState(),n=(0,uo.qs)(t),i=this.getLevelLogInfo(),a=i.level,s=i.score,r=i.levelName;this.analytics.levelStart(a,s,r),g()(e=[ho.Ee,ho.QT,ho.zA]).call(e,n)>=0?this.footer.pieces.showNewPieces():this.piecesByFen?this.footer.pieces.showAvailablePieces(this.piecesByFen):this.footer.pieces.showNewPieces()},n.handleUsedRescue=function(){this.usedRescue&&this.storage.dispatch((0,oo.nd)())},n.handleStartTutorial=function(){this.analytics.event(rn.o.TUTORIAL_BEGIN),this.tutorialManager.start(),this.header.setVisible(!1)},n.handleStartGameSingleMode=function(){var e,t;if(this.header.showItemSingleMode(),this.gamePlayMode==ho.zA)return this.main.praise.reset(),this.main.board.clearBoard(),this.footer.pieces.clearPieces(),void this.footer.pieces.showNewPieces();var n=this.storage.getState(),i=(null==(e=(0,po.In)(n))?void 0:e.data)||{},a=(null==(t=(0,po.In)(n))?void 0:t.score)||0;if(i){var s=i.fen;console.log("matchSingleData ==== ",s);var r=null;if(this.piecesByFen=null,s){console.log("Fen === ",s);var o=this.main.board.getBoardByFen(s);r=this.handleDynamicFenSize(o),this.piecesByFen=this.footer.pieces.getPiecesByFen(s),this.isFenGameOver(r,this.piecesByFen)&&(r=null,this.piecesByFen=null,this.storage.dispatch((0,lo._D)()),this.storage.dispatch((0,co.Cs)()),a=0,this.resetRescued())}this.main.board.clearBoard(),r&&this.main.board.startGame(r),this.footer.pieces.clearPieces(),this.piecesByFen?this.footer.pieces.showAvailablePieces(this.piecesByFen):this.footer.pieces.showNewPieces(),this.header.mainScoreBlock.setScore(a),this.header.mainScoreBlock.setScoreText(a),this.main.praise.reset()}},n.handleStartGameFriendMode=function(){this.header.showItemPlayWithFriendsMode(),this.main.praise.reset(),this.main.board.clearBoard(),this.footer.pieces.clearPieces(),this.footer.pieces.showNewPieces()},n.listenEvents=function(){var e=this;go.A.on(ro.A.START_GAME,(function(){e.startGame()})),go.A.on(ro.A.RESCUE,this.rescued),go.A.on(ro.A.REPLAY,this.replay),go.A.on(ro.A.GAME_OVER,this.handleGameOver.bind(this)),go.A.on(La,this.handleStateChange.bind(this))},n.postSessionScore=function(){var e=this.storage.getState(),t=(0,fo.TW)(e).score,n=void 0===t?0:t;this.storage.dispatch((0,mo.bj)(n))},n.getFen=function(){return this.main.board.getFenByBoard()+" "+this.footer.pieces.getFenByPieces()},n.createRescueScreen=function(){this.screen.add(Ua.R8.RESCUE_SCREEN,Uf)},n.createResultScreen=function(){this.screen.add(Ua.R8.RESULT_SCREEN,Kp)},n.createTournamentResultScreen=function(){this.screen.add(Ua.R8.TOURNAMENT_RESULT_SCREEN,cA)},n.updateCurrentBestScore=function(){var e=this.player.getBestScore()||0,t=this.storage.getState(),n=(0,fo.TW)(t),i=n.score,a=void 0===i?0:i,s=n.bestScore,r=void 0===s?0:s,o=e>r?e:r;if(o=o>a?o:a,this.setPlayerBestScore(o),(0,pa.BC)(this.storage.getState())==ho.zA){var c=Cp.A.getCurrentTourPlayerScore();this.header.bestScoreBlock.setScoreText(c)}else this.header.bestScoreBlock.setScoreText(o)},n.updateLevelManager=function(){var e=this.getCurrentScoreByMode();this.levelManager.updateCurrentLevelByScore(e)},n.setIsGameOver=function(e){this.isGameOver=e},n.handleGameOver=function(){this.isGameOver=!0;var e=this.getLevelLogInfo(),t=e.level,n=e.score,i=e.levelName;this.analytics.levelFail(t,n,i);var a=this.storage.getState();this.gamePlayMode=(0,uo.qs)(a),this.gamePlayMode===ho.zA?this.screen.open(Ua.R8.TOURNAMENT_RESULT_SCREEN,{score:n}):this.screen.open(Ua.R8.RESULT_SCREEN)},n.handleRequestFinishGame=function(){var e=this;this.isGameOver=!0;var t=this.storage.getState();(0,uo.wY)(t)<hA.MaxRescueCount&&this.ads.preloadRewardedVideoAsync().catch((function(e){return console.log(e)})),this.enableInput(),this.time.delayedCall(400,(function(){e.oufOfMovesEffect.playTweenMoveCenterScene()})),this.time.delayedCall(2e3,(function(){e.oufOfMovesEffect.playTweenScaleDown()}))},n.fastEndGame=function(){this.isGameOver=!0,this.analytics.event(rn.o.LEVEL_FAST_END,{level:this.levelManager.getLevel(),level_name:this.getLevelName(),success:!1}),this.runAnimationGameOver()},n.checkShowRescueScreen=function(){var e,t=this,n=this.storage.getState(),i=(0,uo.wY)(n);return this.isRescueModeFriend<hA.MaxRescueCount&&fA.Enabled&&g()(e=[ho.Ee,ho.QT]).call(e,this.gamePlayMode)>=0?(this.isRescueModeFriend++,this.screen.open(Ua.R8.RESCUE_SCREEN),void(this.isGameOver=!1)):i<hA.MaxRescueCount&&fA.Enabled?(this.screen.open(Ua.R8.RESCUE_SCREEN),void(this.isGameOver=!1)):void this.time.delayedCall(1500,(function(){t.oufOfMovesEffect.hideTextOutOfMoves(),t.runAnimationGameOver()}))},n.runAnimationGameOver=function(){var e=this,t=1500;0===this.main.board.getTotalCellOnBoard()&&(t=0),this.main.board.runAnimationGameOver(),this.time.delayedCall(t,(function(){e.header.playTweenMoveUpHeader(),e.main.board.playTweenScaleDownBoard(),e.footer.playTweenMoveDownFooter()})),this.time.delayedCall(t+250,(function(){e.isRescueModeFriend=0,e.usedRescue=!1,e.endGame()}))},n.addShortcut=function(){var e=new Date,t=this.player.getPlayerData().timeAddShortcut,n=new Date(t),i=n.getDay(),a=n.getMonth(),s=n.getFullYear(),r=e.getDay(),o=e.getMonth(),c=e.getFullYear();console.log("addShortcut "+i+"-"+a+"-"+s+" || "+r+"-"+o+"-"+c),i==r&&a==o&&s==c||(console.log("attemptToAddShortcut"),this.player.setTimeAddShortcut(e.getTime()),this.facebook.attemptToAddShortcut())},n.checkAnimPlaying=function(){var e=this.tweens.getAllTweens();return!(!e||0===e.length)},n.disableInput=function(){this.input.enabled=!1,this.footer.pieces.allPieces.forEach((function(e){return e.cancelDrag()}))},n.enableInput=function(){this.input.enabled=!0},n.restartGame=function(){var e;null==(e=this.header.mainScoreBlock.addScore)||e.stop().remove(),this.header.mainScoreBlock.setScore(0),this.header.mainScoreBlock.setScoreText(0),this.isBestScoreScreenShowed=!1,this.levelManager.restart(),this.main.praise.listScore=[]},n.endGame=function(){var e=(0,O.A)(D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.handleShowInterstitialAd().catch(x.a0);case 2:this.storage.dispatch((0,oo.jw)()),this.resetRescued();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.handleUpdateScore=function(e){if(!this.tutorialManager.isRunning()){var t=this.getCurrentScoreByMode()+e;this.storage.dispatch((0,lo.f1)({score:t})),this.updateMatchData()}},n.handleAddScoreAnim=function(e){this.tutorialManager.isRunning(),this.header.mainScoreBlock.animAddScore(e)},n.getBestScore=function(){var e=this.storage.getState();return(0,fo.TW)(e).bestScore},n.bestScoreReached=function(){if(!this.isBestScoreScreenShowed&&!this.isGameOver)if((0,pa.BC)(this.storage.getState())!=ho.zA){var e=this.getBestScore(),t=this.getCurrentScoreByMode();!e||e>=t||(this.setPlayerBestScore(t),this.isBestScoreScreenShowed=!0,this.audio.playSound(ja.A.CONGRATULATION),this.bestScoreGlareEffect.playEffect())}else this.bestScoreReachedForTournament()},n.bestScoreReachedForTournament=function(){var e=this.getCurrentScoreByMode(),t=Cp.A.getCurrentTourPlayerScore();if(t&&!(t>=e)){this.isBestScoreScreenShowed=!0,this.audio.playSound(ja.A.CONGRATULATION),this.bestScoreGlareEffect.playEffect();var n=this.getBestScore();!n||n>=e||this.setPlayerBestScore(e)}},n.handleNextTargetScore=function(){if(!this.isGameOver&&!this.isShowedNextTargetScreen){this.isShowedNextTargetScreen=!0;var e=this.getLevelLogInfo(),t=e.level,n=e.score,i=e.levelName;this.analytics.levelComplete(t,n,i)}},n.getCurrentScoreByMode=function(){return this.header.mainScoreBlock.score},n.updateMatchData=function(){if(!this.tutorialManager.isRunning()){var e=this.getFen(),t=this.storage.getState(),n=(0,po.In)(t).data||{},i=(0,uo.qs)(t),s=(0,uo.wY)(t);if(!i||i===ho.Nu){var r=(0,po.N0)(t),o=(0,fo.TW)(t).score,c=void 0===o?0:o;console.log("Fennnnn ",e),this.storage.dispatch((0,co.iK)(r,{score:c,data:(0,a.A)({},n,{fen:e}),rescued:s,updateAt:Date.now()}))}}},n.nextLevel=function(){var e=this.getCurrentScoreByMode(),t=this.levelManager.updateCurrentLevelByScore(e);console.log("wwwwwwwwwwww ",e,t),this.isNextTarget=!0;var n=this.getLevelLogInfo(),i=n.level,a=n.levelName;this.analytics.levelStart(i,e,a)},n.update=function(e){this.input.enabled||this.checkAnimPlaying()?this.lastTimeInputEnabled=e:e-this.lastTimeInputEnabled>=3e3&&(this.enableInput(),this.lastTimeInputEnabled=e)},n.isFenGameOver=function(e,t){for(var n=[],i=0;i<t.length;i++){var a=t[i],s=a.type,r=a.direction,o=a.isReverse;switch(s){case bs:case Ps:case Cs:n.push({data:Hc.getData(s,r,o)});break;case ws:case Is:case xs:case ks:n.push({data:Wc.getData(s,r)});break;case Os:case _s:case Rs:n.push({data:Xc.getData(s)});break;case Ms:n.push({data:qc.getData(r)});break;case Bs:n.push({data:sl.getData(r)});break;case js:n.push({data:ol.getData(r)});break;case Ns:case Gs:case Fs:case Us:n.push({data:$c.getData(s,r)});break;case Ds:n.push({data:tl.getData(r)});break;case Ls:n.push({data:il.getData()})}}return gc(e,n)},n.handleDynamicFenSize=function(e){var t,n,i=0;if((n=e.length)&&(i=e[0].length),0===n||0===i)return e;var a=B()(t=[]).call(t,e);if(n>pA.rows)_a()(a).call(a,pA.rows,n-pA.rows);else if(i<pA.rows)for(var s=0;s<pA.rows-n;s++){var r;a.push(Da()(r=new Array(n)).call(r,{value:0,frame:mA.GEM_TRANSPARENT}))}return i>pA.cols?a.forEach((function(e){_a()(e).call(e,pA.cols,i-pA.cols)})):i<pA.cols&&a.forEach((function(e){for(var t=0;t<pA.cols-i;t++)e.push({value:0,frame:mA.GEM_TRANSPARENT})})),a},n.checkAndAddShortcut=function(){if(!this.game.player.getPlayer().isUserNew){var e=this.storage.getState();(0,pa.BC)(e)!=ho.zA&&this.facebook.attemptToAddShortcut()}},n.getLevelName=function(){var e,t=this.levelManager.getCurrentIndex()+1;return"target_"+Ba()(e=GameCore.Utils.Number).call(e,t,4,"0")},n.getLevelLogInfo=function(){return{level:this.levelManager.getCurrentIndex()+1,score:this.getCurrentScoreByMode(),levelName:this.getLevelName()}},n.resetRescued=function(){this.storage.dispatch((0,oo.Vj)())},n.showJourneyGameplay=function(){this.background.setTexture(Ga.A.BACKGROUND_TAB.KEY),this.background.setWorldSize(this.gameZone.width,this.gameZone.height),this.journeyGameplay.revive(),this.journeyGameplay.registerPiecesGlobalEvents(),this.main.kill(),this.main.unregisterPiecesGlobalEvents()},n.showNormalGameplay=function(){this.background.setTexture(Ga.A.BACKGROUND.KEY),this.background.setWorldSize(this.gameZone.width,this.gameZone.height),this.journeyGameplay.kill(),this.journeyGameplay.unregisterPiecesGlobalEvents(),this.main.revive(),this.main.registerPiecesGlobalEvents()},n.setLevelForCurrentSeason=function(e){var t=this.journeySeason.getSeasonKey(),n=this.player.getCustomData("levelOfSeasons"),i=(0,a.A)({},n);console.log("setLevelForCurrentSeason",t,e),i[t]=e,this.player.setCustomData("levelOfSeasons",i)},t}(vo.A);var vA=gA,yA=n(485),AA=GameCore.Configs.Notification.ApiUrl,EA=function(){var e=(0,O.A)(D().mark((function e(t){var n,i;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.playerId,e.next=3,(0,Je.b)("players/"+n,t,{},AA,10);case 3:return i=e.sent,e.abrupt("return",(null==i?void 0:i.data)||{});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),TA=[{id:"pass-levels",title:"Pass 10 Levels",require:{level:10},reward:{diamond:100}},{id:"collect-diamonds",title:"Collect 300 diamonds",require:{diamond:300},reward:{diamond:100}},{id:"invite-friends",title:"Invite 2 friends",require:{friend:2},reward:{diamond:200}},{id:"reach-score",title:"Reach Total Scores",require:{score:1e5},reward:{diamond:200}}],SA=function(){var e=(0,O.A)(D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",TA);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),bA=n(501),PA=(0,Te.Mz)([function(e){var t;return null==(t=e[di])?void 0:t.tasks}],(function(e){return e})),CA=(0,Te.Mz)([function(e){var t;return null==(t=e[di])?void 0:t.process}],(function(e){return e})),wA=(0,Te.Mz)([function(e){var t;return null==(t=e[di])?void 0:t.isRequesting}],(function(e){return e})),IA=((0,Te.Mz)([function(e){var t;return null==(t=e[di])?void 0:t.isNotice}],(function(e){return e})),GameCore.Configs.DailyTasks),xA=function(e){return function(t){t({type:fi,payload:{tasks:e}});var n=window.game.player.getCustomData("dailyTasks")||{},i=n.startedTime,a=void 0===i?0:i,s=n.logTasks,r=void 0===s?{}:s;t((Date.now()-a)/1e3>IA.Duration?kA(e):OA(r))}},kA=function(e){return function(t){var n={};e.forEach((function(e){var t=e.id,i=e.require;n[t]={},he()(i).forEach((function(e){var i;n[t]=((i={})[e]=0,i.rewarded=!1,i)}))})),window.game.player.setCustomData("dailyTasks",{logTasks:n,startedTime:Date.now()}),t(OA(n)),go.A.emit(bA.A.EVENTS.TASKS_RESET)}},OA=function(e){return{type:mi,payload:{process:e}}},_A=function(){var e=(window.game.player.getCustomData("dailyTasks")||{}).logTasks;return GameCore.Utils.Json.clone(e)},RA=function(){function e(e,t){var n=this;this.game=void 0,this.id=void 0,this.taskData=void 0,this.requireTypes=void 0,this.process=function(e){var t,i=e.type,a=e.value;if(!(a<1)&&(-1!==g()(t=n.requireTypes).call(t,i)&&!n.isPassRequiredTarget(i)&&n.processMore(e))){i=e.type,a=e.value;var s=n.getCorrectValue(i,a);n.game.storage.dispatch(function(e,t,n){return function(i){var a=_A();if(GameCore.Utils.Valid.isObject(a)){var s=a;GameCore.Utils.Object.hasOwn(s,e)&&(s[e].rewarded||(s[e][t]+=n,window.game.player.setCustomData("dailyTasks",{logTasks:s}),i({type:gi,payload:{id:e,type:t,value:n}})))}}}(n.id,i,s)),n.isTaskFinished(i)&&n.game.storage.dispatch(function(e){return function(t){t({type:vi,payload:{id:e}}),go.A.emit(bA.A.EVENTS.NOTICE_UPDATE)}}(n.id))}},this.game=e,this.id=t,this.init()}var t=e.prototype;return t.init=function(){var e=this,t=this.game.storage.getState(),n=PA(t)||[];if(!((null==n?void 0:n.length)<1)){var i=null==n?void 0:Re()(n).call(n,(function(t){return t.id===e.id}));i&&(this.taskData=i,this.requireTypes=he()(this.taskData.require),this.initEvents())}},t.getDataByType=function(e){var t=this.game.storage.getState(),n=CA(t),i={value:0,target:0};if(!n)return i;if(!GameCore.Utils.Object.hasOwn(n,this.taskData.id))return i;var a=n[this.taskData.id];if(GameCore.Utils.Valid.isObject(a)&&GameCore.Utils.Object.hasOwn(a,e)){var s=a[e];"number"===typeof s&&(i.value=s)}return i.target=this.taskData.require[e]||0,i},t.getCorrectValue=function(e,t){var n=this.getDataByType(e),i=n.value,a=n.target,s=t;return i+t>a&&(s=a-i),Math.round(s)},t.isPassRequiredTarget=function(e){var t=this.getDataByType(e);return t.value>=t.target},t.isTaskFinished=function(e){var t=this.getDataByType(e);return t.value>=t.target},e}(),DA=RA,MA=bA.A.COLLECT_DIAMONDS,BA=MA.ID,LA=MA.EVENTS,NA=function(e){function t(t){return e.call(this,t,BA)||this}(0,_.A)(t,e);var n=t.prototype;return n.initEvents=function(){go.A.off(LA.COLLECT_DIAMONDS,this.process),go.A.on(LA.COLLECT_DIAMONDS,this.process)},n.processMore=function(){return!0},t}(DA),GA=NA,FA=bA.A.INVITE_FRIENDS,UA=FA.ID,jA=FA.EVENTS,VA=function(e){function t(t){var n;return(n=e.call(this,t,UA)||this).invitedFriends=void 0,n.resetData=function(){n.invitedFriends=[]},n.resetData(),n}(0,_.A)(t,e);var n=t.prototype;return n.initEvents=function(){var e=this;go.A.off(jA.INVITED_FRIEND,this.process),go.A.on(jA.INVITED_FRIEND,this.process),go.A.on(bA.A.EVENTS.TASKS_RESET,(function(){e.resetData()}))},n.processMore=function(e){var t,n=e.opponentId;return!!n&&(-1===g()(t=this.invitedFriends).call(t,n)&&(this.invitedFriends.push(n),!0))},t}(DA),zA=VA,YA=bA.A.PASS_LEVELS,HA=YA.ID,KA=YA.EVENTS,WA=function(e){function t(t){return e.call(this,t,HA)||this}(0,_.A)(t,e);var n=t.prototype;return n.initEvents=function(){go.A.off(KA.PASS_LEVEL,this.process),go.A.on(KA.PASS_LEVEL,this.process)},n.processMore=function(){return!0},t}(DA),ZA=WA,XA=bA.A.REACH_SCORE,JA=XA.ID,qA=XA.EVENTS,QA=function(e){function t(t){var n;return(n=e.call(this,t,JA)||this).totalScore=void 0,n.lastUpdate=void 0,n.totalScore=0,n.lastUpdate=Date.now(),n}(0,_.A)(t,e);var n=t.prototype;return n.initEvents=function(){go.A.off(qA.ADD_SCORE,this.process),go.A.on(qA.ADD_SCORE,this.process)},n.processMore=function(e){var t=e.value,n=Date.now();return n-this.lastUpdate<3e3?(this.totalScore+=t,!1):(e.value+=this.totalScore,this.totalScore=0,this.lastUpdate=n,!0)},t}(DA),$A=QA,eE=function(){function e(e){var t=this;this.game=void 0,this.eventsListener=void 0,this.init=(0,O.A)(D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.eventsListener={},e.next=3,t.initData();case 3:t.initEvents();case 4:case"end":return e.stop()}}),e)}))),this.initData=(0,O.A)(D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.game.storage.dispatch(function(){var e=(0,O.A)(D().mark((function e(t,n){var i,a;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n(),!wA(i)){e.next=4;break}return e.abrupt("return");case 4:return t({type:pi,payload:{}}),e.next=7,SA();case 7:a=e.sent,t(xA(a));case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)}))),this.game=e,this.init()}var t=e.prototype;return t.getEventListener=function(e){return this.eventsListener[e]},t.initEvents=function(){this.eventsListener[bA.A.PASS_LEVELS.ID]=new ZA(this.game),this.eventsListener[bA.A.REACH_SCORE.ID]=new $A(this.game),this.eventsListener[bA.A.INVITE_FRIENDS.ID]=new zA(this.game),this.eventsListener[bA.A.COLLECT_DIAMONDS.ID]=new GA(this.game)},e}(),tE=eE,nE=[{name:"collect-red-gems",id:"collect-gems",require:{red:5},reward:50},{name:"collect-blue-gems",id:"collect-gems",require:{blue:5},reward:50},{name:"collect-pink-gems",id:"collect-gems",require:{pink:5},reward:50},{name:"collect-green-gems",id:"collect-gems",require:{green:5},reward:50},{name:"collect-yellow-gems",id:"collect-gems",require:{yellow:5},reward:50},{name:"collect-red-blue-gems",id:"collect-gems",require:{red:5,blue:5},reward:120},{name:"collect-red-pink-gems",id:"collect-gems",require:{red:5,pink:5},reward:120},{name:"collect-red-green-gems",id:"collect-gems",require:{red:5,green:5},reward:120},{name:"collect-red-yellow-gems",id:"collect-gems",require:{red:5,yellow:5},reward:120},{name:"collect-blue-pink-gems",id:"collect-gems",require:{blue:5,pink:5},reward:120},{name:"collect-blue-green-gems",id:"collect-gems",require:{blue:5,green:5},reward:120},{name:"collect-blue-yellow-gems",id:"collect-gems",require:{blue:5,yellow:5},reward:120},{name:"collect-pink-green-gems",id:"collect-gems",require:{pink:5,green:5},reward:120},{name:"collect-pink-yellow-gems",id:"collect-gems",require:{pink:5,yellow:5},reward:120},{name:"collect-green-yellow-gems",id:"collect-gems",require:{green:5,yellow:5},reward:120},{name:"collect-red-blue-pink-gems",id:"collect-gems",require:{red:5,blue:5,pink:5},reward:210},{name:"collect-red-blue-green-gems",id:"collect-gems",require:{red:5,blue:5,green:5},reward:210},{name:"collect-red-blue-yellow-gems",id:"collect-gems",require:{red:5,blue:5,yellow:5},reward:210},{name:"collect-red-pink-green-gems",id:"collect-gems",require:{red:5,pink:5,green:5},reward:210},{name:"collect-red-pink-yellow-gems",id:"collect-gems",require:{red:5,pink:5,yellow:5},reward:210},{name:"collect-red-green-yellow-gems",id:"collect-gems",require:{red:5,green:5,yellow:5},reward:210},{name:"collect-blue-pink-green-gems",id:"collect-gems",require:{blue:5,pink:5,green:5},reward:210},{name:"collect-blue-pink-yellow-gems",id:"collect-gems",require:{blue:5,pink:5,yellow:5},reward:210},{name:"collect-blue-green-yellow-gems",id:"collect-gems",require:{blue:5,green:5,yellow:5},reward:210},{name:"collect-pink-green-yellow-gems",id:"collect-gems",require:{pink:5,green:5,yellow:5},reward:210}],iE=function(){var e=(0,O.A)(D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",nE);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),aE=(0,Te.Mz)([function(e){var t;return null==(t=e[si])?void 0:t.missions}],(function(e){return e})),sE=(0,Te.Mz)([function(e){var t;return null==(t=e[si])?void 0:t.isRequesting}],(function(e){return e})),rE=((0,Te.Mz)([aE,function(e,t){return t.name}],(function(e,t){return e?"string"!==typeof t?null:GameCore.Utils.Object.hasOwn(e,t)?e[t]:null:null})),function(e){return{type:oi,payload:{missions:e}}}),oE={TYPES:{COLLECT_GEMS:"collect-gems",USE_ITEM:"use-item",COMBO:"combo"},EVENTS:{MISSION_START:"mission-start",MISSION_UPDATE:"mission-update",MISSION_FAILED:"mission-failed",MISSION_COMPLETED:"mission-completed"}},cE=(0,Te.Mz)([function(e){var t;return null==(t=e[si])?void 0:t.mission}],(function(e){return e})),lE=((0,Te.Mz)([cE],(function(e){return e?e.name:null})),function(){function e(e,t,n){var i=this;this.game=void 0,this.id=void 0,this.name=void 0,this.reward=void 0,this.process=function(e){var t=e.id,n=e.type,a=e.value;a<1||i.id===t&&i.isTypeRequired(n)&&i.processMore(e)&&(i.game.storage.dispatch(function(e,t,n){return{type:ci,payload:{name:e,type:t,value:n}}}(i.name,n,a)),i.isMissionComplete()&&(go.A.emit(oE.EVENTS.MISSION_COMPLETED,{name:i.name,reward:i.reward}),i.game.storage.dispatch(function(e){return{type:li,payload:{name:e}}}(i.name))))},this.id=t,this.name=n,this.game=e}var t=e.prototype;return t.start=function(){var e=this.game.storage.getState(),t=cE(e);t&&t.name===this.name&&(this.reward=t.reward,this.initEvents())},t.getMissionData=function(){var e=this.game.storage.getState(),t=cE(e);return t?t.name!==this.name?null:t:null},t.getDataByType=function(e){var t=this.getMissionData();if(!t)return null;var n=t.require[e];return{value:t.process[e],target:n}},t.isTypeRequired=function(e){var t=this.getDataByType(e);return!!t&&t.target>0},t.isMissionComplete=function(){var e=this.getMissionData();if(!e)return!0;var t=e.require,n=e.process,i=!0;return he()(t).forEach((function(e){if(i){var a=t[e];n[e]<a&&(i=!1)}})),i},e}()),hE=lE,uE=oE.EVENTS,dE=oE.TYPES,pE=function(e){function t(t,n){return e.call(this,t,dE.COLLECT_GEMS,n)||this}(0,_.A)(t,e);var n=t.prototype;return n.initEvents=function(){go.A.off(uE.MISSION_UPDATE,this.process),go.A.on(uE.MISSION_UPDATE,this.process)},n.processMore=function(){return!0},t}(hE),fE=pE,mE=oE.EVENTS,gE=oE.TYPES,vE=function(e){function t(t,n){return e.call(this,t,gE.COMBO,n)||this}(0,_.A)(t,e);var n=t.prototype;return n.initEvents=function(){go.A.off(mE.MISSION_UPDATE,this.process),go.A.on(mE.MISSION_UPDATE,this.process)},n.processMore=function(e){var t=this.getMissionData();if(!t)return!1;var n=e.type;return e.value>=t.require[n]},t}(hE),yE=vE,AE=oE.EVENTS,EE=oE.TYPES,TE=function(e){function t(t,n){return e.call(this,t,EE.USE_ITEM,n)||this}(0,_.A)(t,e);var n=t.prototype;return n.initEvents=function(){go.A.off(AE.MISSION_UPDATE,this.process),go.A.on(AE.MISSION_UPDATE,this.process)},n.processMore=function(e){return console.log("UseItem",{payload:e}),!0},t}(hE),SE=TE,bE=function(){function e(e){var t=this;this.game=void 0,this.listener=void 0,this.init=(0,O.A)(D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.initData();case 2:t.initListeners(),t.initEvents();case 4:case"end":return e.stop()}}),e)}))),this.initData=(0,O.A)(D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.game.storage.dispatch(function(){var e=(0,O.A)(D().mark((function e(t,n){var i,a;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n(),!sE(i)){e.next=4;break}return e.abrupt("return");case 4:return t({type:ri,payload:{}}),e.next=7,iE();case 7:a=e.sent,t(rE(a));case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)}))),this.startListener=function(e){t.listener[e]&&t.listener[e].start()},this.game=e,this.init()}var t=e.prototype;return t.initListeners=function(){var e=this;this.listener={};var t=this.game.storage.getState(),n=aE(t);n&&he()(n).forEach((function(t){switch(n[t].id){case oE.TYPES.COLLECT_GEMS:e.listener[t]=new fE(e.game,t);break;case oE.TYPES.COMBO:e.listener[t]=new yE(e.game,t);break;case oE.TYPES.USE_ITEM:e.listener[t]=new SE(e.game,t)}}))},t.initEvents=function(){go.A.off(oE.EVENTS.MISSION_START,this.startListener),go.A.on(oE.EVENTS.MISSION_START,this.startListener)},e}(),PE=bE,CE=(n(109),n(488)),wE={BACKGROUND:{KEY:"background",FILE:"./assets/music/bg_music.mp3"},EFFECTS:{board_end:"./assets/sounds/board_end.mp3",button_click:"./assets/sounds/button_click.mp3",congratulation:"./assets/sounds/congratulation.mp3",cool:"./assets/sounds/cool.mp3",daily_reward:"./assets/sounds/daily_reward.mp3",draw:"./assets/sounds/draw.mp3",eat_block:"./assets/sounds/eat_block.mp3",excellent:"./assets/sounds/excellent.mp3",game_over_scene:"./assets/sounds/game_over_scene.mp3",good:"./assets/sounds/good.mp3",lose:"./assets/sounds/lose.mp3",piece_drop:"./assets/sounds/piece_drop.mp3",piece_invalid_move:"./assets/sounds/piece_invalid_move.mp3",piece_pick:"./assets/sounds/piece_pick.mp3",popup_off:"./assets/sounds/popup_off.mp3",popup_show:"./assets/sounds/popup_show.mp3",reach_goal:"./assets/sounds/reach_goal.mp3",reach_score:"./assets/sounds/reach_score.mp3",rescue_timer:"./assets/sounds/rescue_timer.mp3",score_count:"./assets/sounds/score_count.mp3",wait_opponent:"./assets/sounds/wait_opponent.mp3",win:"./assets/sounds/win.mp3",bubble_in_the_hole:"./assets/sounds/bubble_in_the_hole.mp3",start_game:"./assets/sounds/start_game.mp3",well_done:"./assets/sounds/well_done.mp3",reach_goal_2:"./assets/sounds/reach_goal_2.mp3",star_progress_1:"./assets/sounds/star_progress_1.mp3",star_progress_2:"./assets/sounds/star_progress_2.mp3",star_progress_3:"./assets/sounds/star_progress_3.mp3",you_win:"./assets/sounds/you_win.mp3",unlock_level:"./assets/sounds/unlock_level.mp3",big_bubble_1:"./assets/sounds/big-bubble-1.mp3",magic_potion_bubble:"./assets/sounds/magic-potion-bubble.mp3"}},IE=n(675),xE=GameCore.Configs,kE=xE.AppId,OE=xE.Notification,_E=GameCore.Utils.Hash,RE=(_E.decodeLZWCompress,_E.lzwDecompress,function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=e.call.apply(e,B()(t=[this]).call(t,a))||this).isMusicLoaded=!1,n.handleFBInstantGameStarted=function(){window.__fbGameReady=!0,window.__fbPlatform=FBInstant.getPlatform(),n.player.requestConnectedPlayers(),setTimeout(n.subscribeBot,500)},n.processAfterUpdatePlayerProfile=function(){OE.Enable&&(n.updatePlayerProfileToNotificationService(),OE.DisableSendNotification||n.sendNotificationForNewUser())},n.startGame=function(){n.analytics.event(rn.o.APP_READY),n.storage.dispatch((0,CE.T)(ca.F7.LOAD_SCENE)),n.storage.dispatch((function(e,t){var n=window.game,i=(n.player,n.analytics,n.globalScene);try{return void i.events.emit(ca.yh.SWITCH,ca.F7.LEVEL_EDITOR_SCENE)}catch(a){e((0,oo.wi)()),console.warn(a)}}))},n.subscribeBot=function(){n.facebook.attemptToSubscribeBot().finally((function(){window.focus()}))},n.handleLoadMusicCompleted=function(){n.audio.initMusic(wE.BACKGROUND.KEY),!!n.game.player.getPlayerSetting("music")&&n.audio.playMusic()},n}(0,_.A)(t,e);var n=t.prototype;return n.preload=function(){var e=this;this.facebook.progressLoading.loadingProgressFbLoadScene(),this.analytics.event(rn.o.SCREEN_OPEN,{screen_name:"LoadScene"}),this.load.on("progress",(function(t){e.facebook.progressLoading.onProgress(t)})),this.load.on(Phaser.Loader.Events.FILE_LOAD_ERROR,(function(e){var t=new Uv("Load resources at LoadScene failed.");(0,x.o9)(t,{file:null==e?void 0:e.url})})),this.journeySeason.updateNewSeason(new Date),this.load.multiatlas(Fa.A.DEFAULT.KEY,Fa.A.DEFAULT.JSON,Fa.A.DEFAULT.URL),this.textStyler.addFont({type:"local",fontName:za.A.FONT_FAMILY,fontType:"opentype"}),this.loadJourneyLevels(),this.load.atlas({key:Fa.A.EFFECTS.KEY,textureURL:Fa.A.EFFECTS.PATH,atlasURL:Fa.A.EFFECTS.JSON}),this.load.atlas({key:Fa.A.GAMEPLAY_32.KEY,textureURL:Fa.A.GAMEPLAY_32.TEXTURE,atlasURL:Fa.A.GAMEPLAY_32.JSON}),this.load.multiatlas(Fa.A.GAMEPLAY.KEY,Fa.A.GAMEPLAY.JSON,Fa.A.GAMEPLAY.URL),this.load.bitmapFont(za.A.FONT_NUMBER.KEY,za.A.FONT_NUMBER.TEXTURE,za.A.FONT_NUMBER.DATA),this.load.image(Ga.A.BACKGROUND_TAB.KEY,Ga.A.BACKGROUND_TAB.FILE),this.world.isLandscape()?(this.load.image(Ga.A.BACKGROUND.KEY,Ga.A.BACKGROUND.FILE_LANDSCAPE),this.load.image(Ga.A.BACKGROUND_DARK.KEY,Ga.A.BACKGROUND_DARK.FILE_LANDSCAPE)):(this.load.image(Ga.A.BACKGROUND.KEY,Ga.A.BACKGROUND.FILE_PORTRAIT),this.load.image(Ga.A.BACKGROUND_DARK.KEY,Ga.A.BACKGROUND_DARK.FILE_PORTRAIT)),this.load.image(Ga.A.ICON_CROWN.KEY,Ga.A.ICON_CROWN.FILE),this.load.image(Ga.A.AVATAR.KEY,Ga.A.AVATAR.FILE),this.load.spine(yo.BEST_SCORE.KEY,yo.BEST_SCORE.JSON,yo.BEST_SCORE.ATLAS),GameCore.Utils.Valid.isDebugger()&&this.load.json("LEVEL-DEFAULT","assets/json/level-default.json"),this.player.updateData().then(this.processAfterUpdatePlayerProfile).catch(x.a0)},n.create=function(){IE.A.generateFont(this,"all-font-texture",[{fontStyle:{fontFamily:za.A.FONT_FAMILY,fontSize:10},fontKey:za.A.MIKADO.KEY,characters:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789.,;:?!-_'#\"\\/<>()[]{}@+ ",yOffset:0},{fontStyle:{fontFamily:za.A.FONT_FAMILY,fontSize:20},fontKey:za.A.FONT_TEXT_WHITE.KEY,characters:"Loadings.RetrmpUPDATINGEWVSly!,wYuhvcCOb;:?!-_'#\"\\/<>()[]{}@+ ",yOffset:2},{fontStyle:{fontFamily:za.A.FONT_FAMILY,fontSize:19},yOffset:-2,fontKey:za.A.MIKADO_YELLOW.KEY,characters:"DHfCgLYouhavecmpltdrnWwiTFs0123456789.,;:?!-_'#\"\\/<>()[]{}@+ ",tintFill:["#f9e74d","#efcc08"],layer3D:{font3DOffsetY:.65,tintFill3D:"#c47701",shadowFont3dOffsetY:3,shadow3DTintFill:"#050504"}},{fontStyle:{fontFamily:za.A.FONT_FAMILY,fontSize:86},yOffset:2,fontKey:za.A.MIKADO_YELLOW_BIG_NUMBER.KEY,characters:"0123456789",tintFill:["#f9e74d","#efcc08"],layer3D:{font3DOffsetY:2,tintFill3D:"#c47701",shadowFont3dOffsetY:3,shadow3DTintFill:"#050504"}},{fontStyle:{fontFamily:za.A.FONT_FAMILY,fontSize:22},fontKey:za.A.MIKADO_WHITE.KEY,characters:"Noturnamesvilb.xFPSAywkph?czd!YfGgq0123456789 ",tintFill:["#ffffff","#f2e8f1"],layer3D:{font3DOffsetY:1,tintFill3D:"#81678c",shadowFont3dOffsetY:3,shadow3DTintFill:"#050504"},yOffset:-2.5},{fontStyle:{fontFamily:za.A.FONT_FAMILY,fontSize:27},fontKey:za.A.MIKADO_WHITE_MEDIUM_NUMBER.KEY,characters:"0123456789 ",tintFill:["#ffffff","#f2e8f1"],layer3D:{font3DOffsetY:1,tintFill3D:"#81678c",shadowFont3dOffsetY:3,shadow3DTintFill:"#000000"},yOffset:-2},{fontStyle:{fontFamily:za.A.FONT_FAMILY,fontSize:25},fontKey:za.A.MIKADO_RED_STROKE.KEY,characters:"RetryEndGamSkipNO ",tintFill:["#fdfdfd","#f4d4cc"],layer3D:{font3DOffsetY:1,tintFill3D:"#ed6235",shadowFont3dOffsetY:1,shadow3DTintFill:"#910c0c"}},{fontStyle:{fontFamily:za.A.FONT_FAMILY,fontSize:21},fontKey:za.A.MIKADO_GREEN_STROKE.KEY,characters:"NewGamJoinPlyC turYES",tintFill:["#fdfdfd","#d9f3c9"],layer3D:{font3DOffsetY:.5,tintFill3D:"#63c02f",shadowFont3dOffsetY:1,shadow3DTintFill:"#099621"},yOffset:-1},{fontStyle:{fontFamily:za.A.FONT_FAMILY,fontSize:25},fontKey:za.A.MIKADO_BLUE_STROKE.KEY,characters:"Share",tintFill:["#fdfdfd","#cbeef4"],layer3D:{font3DOffsetY:1,tintFill3D:"#3991df",shadowFont3dOffsetY:1,shadow3DTintFill:"#054e91"}}]),this.audio.initSound(),this.audio.importSoundEffectKeys(wE.EFFECTS),this.analytics.event(rn.o.LOAD_COMPLETE),this.facebook.on("startgame",this.handleFBInstantGameStarted),this.facebook.gameStarted(),this.initModules(),this.setupGlobalScene(),this.checkReceiveLevelFromFb(),this.lazyLoadResource(),this.startGame()},n.updatePlayerProfileToNotificationService=function(){var e=this.player.getPlayer(),t=e.playerId,n=e.name,i=e.photo,a=e.locale,s=e.ASID,r={appId:kE,playerId:t,name:n,photo:i,locale:a,ASID:s};console.info("\ud83d\ude80 > profileData",r),EA(r)},n.sendNotificationForNewUser=function(){var e=(0,O.A)(D().mark((function e(){var t,n;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,this.player.getPlayerIsNew()){e.next=4;break}return e.abrupt("return");case 4:if(t=this.player.getPlayerASID()){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,FBInstant.player.getDataAsync(["isNotificationFirstSent"]);case 9:if(e.t0=e.sent,e.t0){e.next=12;break}e.t0={};case 12:if(n=e.t0,!0!==n.isNotificationFirstSent){e.next=16;break}return e.abrupt("return");case 16:this.facebook.sendNotificationAsync({message:"Hi @["+t+"] your friends are waiting to play with you, play now!",delayTime:3600}),FBInstant.player.setDataAsync({isNotificationFirstSent:!0}),e.next=23;break;case 20:e.prev=20,e.t1=e.catch(0),console.warn("\ud83d\ude80 > sendNotificationForNewUser",e.t1);case 23:case"end":return e.stop()}}),e,this,[[0,20]])})));return function(){return e.apply(this,arguments)}}(),n.setupGlobalScene=function(){var e=this.scene.get(ca.F7.GLOBAL_SCENE);e instanceof yA.A&&e.setup()},n.decompressJourneyLevels=function(){var e=this.journeySeason.getCurrentSeasonConfig(),t=this.cache.json.get(e.levelsKey);console.log("decompressJourneyLevels",t[0])},n.initModules=function(){new PE(this.game),new tE(this.game)},n.lazyLoadResource=function(){var e=this;setTimeout((function(){e.scene.wake(),e.loadSounds(),e.loadWideframesResource(),e.loadImages(),e.loadTexture32Bit(Fa.A.DEFAULT.KEY,Fa.A.DEFAULT.TEXTURE_32BIT),e.loadTexture32Bit(Fa.A.GAMEPLAY.KEY,Fa.A.GAMEPLAY.TEXTURE_32BIT),e.load.once(Phaser.Loader.Events.COMPLETE,(function(){e.scene.sleep()}))}),1500)},n.checkReceiveLevelFromFb=function(){var e=(0,O.A)(D().mark((function e(){var t,n;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=this.storage.getState(),!(0,po.IP)(t)){e.next=5;break}return e.abrupt("return");case 5:return n=this.journeySeason.getSeasonKeyByDate(new Date),e.next=8,this.storage.dispatch((0,co.Hd)(n));case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),(0,x.a0)(e.t0);case 13:case"end":return e.stop()}}),e,this,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),n.loadJourneyLevels=function(){var e=this.journeySeason.getCurrentSeasonConfig(),t=e.levelsKey,n=e.levelsUrl;console.log("loadJourneyLevels",t,n),this.load.json(t,n)},n.loadTexture32Bit=function(e,t){var n=this,i=[];t.forEach((function(e){var t=GameCore.Utils.String.generateObjectId();n.load.image(t,e),i.push(t)})),this.load.start();var a=0;this.textures.on(Phaser.Textures.Events.ADD,(function t(s){var r=g()(i).call(i,s);if(-1!==r){var o=n.textures.get(s),c=n.textures.get(e);console.log("key",e),c.source[r].glTexture=o.source[0].glTexture,c.source[r].glIndex=o.source[0].glIndex,c.source[r].glIndexCounter=o.source[0].glIndexCounter,++a===i.length&&n.textures.off(Phaser.Textures.Events.ADD,t)}}))},n.loadSounds=function(){this.loadSoundEffects(),this.loadMusic()},n.loadSoundEffects=function(){var e=this;he()(wE.EFFECTS).forEach((function(t){e.load.audio(t,wE.EFFECTS[t])}))},n.loadMusic=function(){if(!this.isMusicLoaded){this.isMusicLoaded=!0;var e=Phaser.Loader.Events.FILE_KEY_COMPLETE;this.load.once(e+"audio-"+wE.BACKGROUND.KEY,this.handleLoadMusicCompleted),this.load.audio(wE.BACKGROUND.KEY,wE.BACKGROUND.FILE)}},n.loadWideframesResource=function(){this.frameCapture.preload({"wide-frame-share":"./assets/wideframes/wide-frame-share.png","wide-frame-message-win":"./assets/wideframes/wide-frame-message-win.png","wide-frame-game-result":"./assets/wideframes/wide-frame-game-result.png"})},n.loadImages=function(){var e=this;Ga.A.IMAGES.KEY.forEach((function(t,n){e.load.image(t,Ga.A.IMAGES.FILE[n])}))},t}(Phaser.Scene)),DE=RE,ME=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=e.call.apply(e,B()(t=[this]).call(t,a))||this).isVisible=!0,n.browserPrefixes=["moz","ms","o","","webkit"],n.visibleCallbacks=[],n.hiddenCallbacks=[],n.handleVisibilityChange=function(e){if("boolean"===typeof e)return e?n.onVisibleEvent():n.onHiddenEvent();var t=n.getBrowserPrefix(),i=n.getHiddenPropertyName(t);return document[i]?n.onHiddenEvent():n.onVisibleEvent()},n}(0,_.A)(t,e);var n=t.prototype;return n.configure=function(){var e=this,t=this.getBrowserPrefix(),n=this.getVisibilityEvent(t);document.addEventListener(n,this.handleVisibilityChange,!1),document.addEventListener("focus",(function(){e.handleVisibilityChange(!0)}),!1),document.addEventListener("blur",(function(){e.handleVisibilityChange(!1)}),!1),window.addEventListener("focus",(function(){e.handleVisibilityChange(!0)}),!1),window.addEventListener("blur",(function(){e.handleVisibilityChange(!1)}),!1)},n.addEventVisible=function(e){this.visibleCallbacks.push(e)},n.addEventHidden=function(e){this.hiddenCallbacks.push(e)},n.isGameVisible=function(){return this.isVisible},n.getHiddenPropertyName=function(e){return e?e+"Hidden":"hidden"},n.getVisibilityEvent=function(e){return(e||"")+"visibilitychange"},n.getBrowserPrefix=function(){for(var e=0;e<this.browserPrefixes.length;e++)if(this.getHiddenPropertyName(this.browserPrefixes[e])in document)return this.browserPrefixes[e];return""},n.onVisibleEvent=function(){this.isVisible||(this.isVisible=!0,console.log("visible"),this.visibleCallbacks.forEach((function(e){e()})))},n.onHiddenEvent=function(){this.isVisible&&(this.isVisible=!1,console.log("hidden"),this.hiddenCallbacks.forEach((function(e){e()})))},t}(Phaser.Plugins.BasePlugin),BE=ME,LE=JSON.parse('[{"id":"journey-season-1","count":52,"startTime":"2024-01-01T17:00:00.000Z","endTime":"2024-01-08T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-1.json","levelsKey":"journey-season-1-levels"},{"id":"journey-season-2","count":52,"startTime":"2024-01-08T17:00:00.000Z","endTime":"2024-01-15T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-2.json","levelsKey":"journey-season-2-levels"},{"id":"journey-season-3","count":52,"startTime":"2024-01-15T17:00:00.000Z","endTime":"2024-01-22T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-3.json","levelsKey":"journey-season-3-levels"},{"id":"journey-season-4","count":52,"startTime":"2024-01-22T17:00:00.000Z","endTime":"2024-01-29T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-4.json","levelsKey":"journey-season-4-levels"},{"id":"journey-season-5","count":52,"startTime":"2024-01-29T17:00:00.000Z","endTime":"2024-02-05T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-5.json","levelsKey":"journey-season-5-levels"},{"id":"journey-season-6","count":52,"startTime":"2024-02-05T17:00:00.000Z","endTime":"2024-02-12T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-6.json","levelsKey":"journey-season-6-levels"},{"id":"journey-season-7","count":52,"startTime":"2024-02-12T17:00:00.000Z","endTime":"2024-02-19T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-7.json","levelsKey":"journey-season-7-levels"},{"id":"journey-season-8","count":52,"startTime":"2024-02-19T17:00:00.000Z","endTime":"2024-02-26T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-8.json","levelsKey":"journey-season-8-levels"},{"id":"journey-season-9","count":52,"startTime":"2024-02-26T17:00:00.000Z","endTime":"2024-03-05T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-9.json","levelsKey":"journey-season-9-levels"},{"id":"journey-season-10","count":52,"startTime":"2024-03-05T17:00:00.000Z","endTime":"2024-03-12T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-10.json","levelsKey":"journey-season-10-levels"},{"id":"journey-season-11","count":52,"startTime":"2024-03-12T17:00:00.000Z","endTime":"2024-03-19T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-11.json","levelsKey":"journey-season-11-levels"},{"id":"journey-season-12","count":52,"startTime":"2024-03-19T17:00:00.000Z","endTime":"2024-03-26T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-12.json","levelsKey":"journey-season-12-levels"},{"id":"journey-season-13","count":52,"startTime":"2024-03-26T17:00:00.000Z","endTime":"2024-04-02T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-13.json","levelsKey":"journey-season-13-levels"},{"id":"journey-season-14","count":52,"startTime":"2024-04-02T17:00:00.000Z","endTime":"2024-04-09T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-14.json","levelsKey":"journey-season-14-levels"},{"id":"journey-season-15","count":52,"startTime":"2024-04-09T17:00:00.000Z","endTime":"2024-04-16T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-15.json","levelsKey":"journey-season-15-levels"},{"id":"journey-season-16","count":52,"startTime":"2024-04-16T17:00:00.000Z","endTime":"2024-04-23T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-16.json","levelsKey":"journey-season-16-levels"},{"id":"journey-season-17","count":52,"startTime":"2024-04-23T17:00:00.000Z","endTime":"2024-04-30T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-17.json","levelsKey":"journey-season-17-levels"},{"id":"journey-season-18","count":52,"startTime":"2024-04-30T17:00:00.000Z","endTime":"2024-05-07T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-18.json","levelsKey":"journey-season-18-levels"},{"id":"journey-season-19","count":52,"startTime":"2024-05-07T17:00:00.000Z","endTime":"2024-05-14T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-19.json","levelsKey":"journey-season-19-levels"},{"id":"journey-season-20","count":52,"startTime":"2024-05-14T17:00:00.000Z","endTime":"2024-05-21T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-20.json","levelsKey":"journey-season-20-levels"},{"id":"journey-season-21","count":52,"startTime":"2024-05-21T17:00:00.000Z","endTime":"2024-05-28T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-21.json","levelsKey":"journey-season-21-levels"},{"id":"journey-season-22","count":52,"startTime":"2024-05-28T17:00:00.000Z","endTime":"2024-06-04T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-22.json","levelsKey":"journey-season-22-levels"},{"id":"journey-season-23","count":52,"startTime":"2024-06-04T17:00:00.000Z","endTime":"2024-06-11T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-23.json","levelsKey":"journey-season-23-levels"},{"id":"journey-season-24","count":52,"startTime":"2024-06-11T17:00:00.000Z","endTime":"2024-06-18T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-24.json","levelsKey":"journey-season-24-levels"},{"id":"journey-season-25","count":52,"startTime":"2024-06-18T17:00:00.000Z","endTime":"2024-06-25T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-25.json","levelsKey":"journey-season-25-levels"},{"id":"journey-season-26","count":52,"startTime":"2024-06-25T17:00:00.000Z","endTime":"2024-07-02T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-26.json","levelsKey":"journey-season-26-levels"},{"id":"journey-season-27","count":52,"startTime":"2024-07-02T17:00:00.000Z","endTime":"2024-07-09T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-27.json","levelsKey":"journey-season-27-levels"},{"id":"journey-season-28","count":52,"startTime":"2024-07-09T17:00:00.000Z","endTime":"2024-07-16T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-28.json","levelsKey":"journey-season-28-levels"},{"id":"journey-season-29","count":52,"startTime":"2024-07-16T17:00:00.000Z","endTime":"2024-07-23T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-29.json","levelsKey":"journey-season-29-levels"},{"id":"journey-season-30","count":52,"startTime":"2024-07-23T17:00:00.000Z","endTime":"2024-07-30T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-30.json","levelsKey":"journey-season-30-levels"},{"id":"journey-season-31","count":52,"startTime":"2024-07-30T17:00:00.000Z","endTime":"2024-08-06T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-31.json","levelsKey":"journey-season-31-levels"},{"id":"journey-season-32","count":52,"startTime":"2024-08-06T17:00:00.000Z","endTime":"2024-08-13T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-32.json","levelsKey":"journey-season-32-levels"},{"id":"journey-season-33","count":52,"startTime":"2024-08-13T17:00:00.000Z","endTime":"2024-08-20T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-33.json","levelsKey":"journey-season-33-levels"},{"id":"journey-season-34","count":52,"startTime":"2024-08-20T17:00:00.000Z","endTime":"2024-08-27T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-34.json","levelsKey":"journey-season-34-levels"},{"id":"journey-season-35","count":52,"startTime":"2024-08-27T17:00:00.000Z","endTime":"2024-09-03T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-35.json","levelsKey":"journey-season-35-levels"},{"id":"journey-season-36","count":52,"startTime":"2024-09-03T17:00:00.000Z","endTime":"2024-09-10T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-36.json","levelsKey":"journey-season-36-levels"},{"id":"journey-season-37","count":52,"startTime":"2024-09-10T17:00:00.000Z","endTime":"2024-09-17T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-37.json","levelsKey":"journey-season-37-levels"},{"id":"journey-season-38","count":52,"startTime":"2024-09-17T17:00:00.000Z","endTime":"2024-09-24T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-38.json","levelsKey":"journey-season-38-levels"},{"id":"journey-season-39","count":52,"startTime":"2024-09-24T17:00:00.000Z","endTime":"2024-10-01T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-39.json","levelsKey":"journey-season-39-levels"},{"id":"journey-season-40","count":52,"startTime":"2024-10-01T17:00:00.000Z","endTime":"2024-10-08T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-40.json","levelsKey":"journey-season-40-levels"},{"id":"journey-season-41","count":52,"startTime":"2024-10-08T17:00:00.000Z","endTime":"2024-10-15T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-41.json","levelsKey":"journey-season-41-levels"},{"id":"journey-season-42","count":52,"startTime":"2024-10-15T17:00:00.000Z","endTime":"2024-10-22T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-42.json","levelsKey":"journey-season-42-levels"},{"id":"journey-season-43","count":52,"startTime":"2024-10-22T17:00:00.000Z","endTime":"2024-10-29T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-43.json","levelsKey":"journey-season-43-levels"},{"id":"journey-season-44","count":52,"startTime":"2024-10-29T17:00:00.000Z","endTime":"2024-11-05T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-44.json","levelsKey":"journey-season-44-levels"},{"id":"journey-season-45","count":52,"startTime":"2024-11-05T17:00:00.000Z","endTime":"2024-11-12T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-45.json","levelsKey":"journey-season-45-levels"},{"id":"journey-season-46","count":52,"startTime":"2024-11-12T17:00:00.000Z","endTime":"2024-11-19T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-46.json","levelsKey":"journey-season-46-levels"},{"id":"journey-season-47","count":52,"startTime":"2024-11-19T17:00:00.000Z","endTime":"2024-11-26T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-47.json","levelsKey":"journey-season-47-levels"},{"id":"journey-season-48","count":52,"startTime":"2024-11-26T17:00:00.000Z","endTime":"2024-12-03T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-48.json","levelsKey":"journey-season-48-levels"},{"id":"journey-season-49","count":52,"startTime":"2024-12-03T17:00:00.000Z","endTime":"2024-12-10T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-49.json","levelsKey":"journey-season-49-levels"},{"id":"journey-season-50","count":52,"startTime":"2024-12-10T17:00:00.000Z","endTime":"2024-12-17T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-50.json","levelsKey":"journey-season-50-levels"},{"id":"journey-season-51","count":52,"startTime":"2024-12-17T17:00:00.000Z","endTime":"2024-12-24T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-51.json","levelsKey":"journey-season-51-levels"},{"id":"journey-season-52","count":52,"startTime":"2024-12-24T17:00:00.000Z","endTime":"2024-12-31T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-52.json","levelsKey":"journey-season-52-levels"},{"id":"journey-season-53","count":52,"startTime":"2024-12-24T17:00:00.000Z","endTime":"2024-12-31T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-53.json","levelsKey":"journey-season-53-levels"},{"id":"journey-season-1","count":52,"startTime":"2025-01-01T17:00:00.000Z","endTime":"2025-01-08T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-1.json","levelsKey":"journey-season-1-levels"},{"id":"journey-season-2","count":52,"startTime":"2025-01-08T17:00:00.000Z","endTime":"2025-01-15T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-2.json","levelsKey":"journey-season-2-levels"},{"id":"journey-season-3","count":52,"startTime":"2025-01-15T17:00:00.000Z","endTime":"2025-01-22T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-3.json","levelsKey":"journey-season-3-levels"},{"id":"journey-season-4","count":52,"startTime":"2025-01-22T17:00:00.000Z","endTime":"2025-01-29T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-4.json","levelsKey":"journey-season-4-levels"},{"id":"journey-season-5","count":52,"startTime":"2025-01-29T17:00:00.000Z","endTime":"2025-02-05T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-5.json","levelsKey":"journey-season-5-levels"},{"id":"journey-season-6","count":52,"startTime":"2025-02-05T17:00:00.000Z","endTime":"2025-02-12T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-6.json","levelsKey":"journey-season-6-levels"},{"id":"journey-season-7","count":52,"startTime":"2025-02-12T17:00:00.000Z","endTime":"2025-02-19T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-7.json","levelsKey":"journey-season-7-levels"},{"id":"journey-season-8","count":52,"startTime":"2025-02-19T17:00:00.000Z","endTime":"2025-02-26T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-8.json","levelsKey":"journey-season-8-levels"},{"id":"journey-season-9","count":52,"startTime":"2025-02-26T17:00:00.000Z","endTime":"2025-03-05T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-9.json","levelsKey":"journey-season-9-levels"},{"id":"journey-season-10","count":52,"startTime":"2025-03-05T17:00:00.000Z","endTime":"2025-03-12T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-10.json","levelsKey":"journey-season-10-levels"},{"id":"journey-season-11","count":52,"startTime":"2025-03-12T17:00:00.000Z","endTime":"2025-03-19T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-11.json","levelsKey":"journey-season-11-levels"},{"id":"journey-season-12","count":52,"startTime":"2025-03-19T17:00:00.000Z","endTime":"2025-03-26T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-12.json","levelsKey":"journey-season-12-levels"},{"id":"journey-season-13","count":52,"startTime":"2025-03-26T17:00:00.000Z","endTime":"2025-04-02T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-13.json","levelsKey":"journey-season-13-levels"},{"id":"journey-season-14","count":52,"startTime":"2025-04-02T17:00:00.000Z","endTime":"2025-04-09T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-14.json","levelsKey":"journey-season-14-levels"},{"id":"journey-season-15","count":52,"startTime":"2025-04-09T17:00:00.000Z","endTime":"2025-04-16T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-15.json","levelsKey":"journey-season-15-levels"},{"id":"journey-season-16","count":52,"startTime":"2025-04-16T17:00:00.000Z","endTime":"2025-04-23T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-16.json","levelsKey":"journey-season-16-levels"},{"id":"journey-season-17","count":52,"startTime":"2025-04-23T17:00:00.000Z","endTime":"2025-04-30T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-17.json","levelsKey":"journey-season-17-levels"},{"id":"journey-season-18","count":52,"startTime":"2025-04-30T17:00:00.000Z","endTime":"2025-05-07T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-18.json","levelsKey":"journey-season-18-levels"},{"id":"journey-season-19","count":52,"startTime":"2025-05-07T17:00:00.000Z","endTime":"2025-05-14T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-19.json","levelsKey":"journey-season-19-levels"},{"id":"journey-season-20","count":52,"startTime":"2025-05-14T17:00:00.000Z","endTime":"2025-05-21T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-20.json","levelsKey":"journey-season-20-levels"},{"id":"journey-season-21","count":52,"startTime":"2025-05-21T17:00:00.000Z","endTime":"2025-05-28T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-21.json","levelsKey":"journey-season-21-levels"},{"id":"journey-season-22","count":52,"startTime":"2025-05-28T17:00:00.000Z","endTime":"2025-06-04T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-22.json","levelsKey":"journey-season-22-levels"},{"id":"journey-season-23","count":52,"startTime":"2025-06-04T17:00:00.000Z","endTime":"2025-06-11T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-23.json","levelsKey":"journey-season-23-levels"},{"id":"journey-season-24","count":52,"startTime":"2025-06-11T17:00:00.000Z","endTime":"2025-06-18T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-24.json","levelsKey":"journey-season-24-levels"},{"id":"journey-season-25","count":52,"startTime":"2025-06-18T17:00:00.000Z","endTime":"2025-06-25T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-25.json","levelsKey":"journey-season-25-levels"},{"id":"journey-season-26","count":52,"startTime":"2025-06-25T17:00:00.000Z","endTime":"2025-07-02T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-26.json","levelsKey":"journey-season-26-levels"},{"id":"journey-season-27","count":52,"startTime":"2025-07-02T17:00:00.000Z","endTime":"2025-07-09T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-27.json","levelsKey":"journey-season-27-levels"},{"id":"journey-season-28","count":52,"startTime":"2025-07-09T17:00:00.000Z","endTime":"2025-07-16T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-28.json","levelsKey":"journey-season-28-levels"},{"id":"journey-season-29","count":52,"startTime":"2025-07-16T17:00:00.000Z","endTime":"2025-07-23T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-29.json","levelsKey":"journey-season-29-levels"},{"id":"journey-season-30","count":52,"startTime":"2025-07-23T17:00:00.000Z","endTime":"2025-07-30T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-30.json","levelsKey":"journey-season-30-levels"},{"id":"journey-season-31","count":52,"startTime":"2025-07-30T17:00:00.000Z","endTime":"2025-08-06T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-31.json","levelsKey":"journey-season-31-levels"},{"id":"journey-season-32","count":52,"startTime":"2025-08-06T17:00:00.000Z","endTime":"2025-08-13T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-32.json","levelsKey":"journey-season-32-levels"},{"id":"journey-season-33","count":52,"startTime":"2025-08-13T17:00:00.000Z","endTime":"2025-08-20T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-33.json","levelsKey":"journey-season-33-levels"},{"id":"journey-season-34","count":52,"startTime":"2025-08-20T17:00:00.000Z","endTime":"2025-08-27T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-34.json","levelsKey":"journey-season-34-levels"},{"id":"journey-season-35","count":52,"startTime":"2025-08-27T17:00:00.000Z","endTime":"2025-09-03T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-35.json","levelsKey":"journey-season-35-levels"},{"id":"journey-season-36","count":52,"startTime":"2025-09-03T17:00:00.000Z","endTime":"2025-09-10T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-36.json","levelsKey":"journey-season-36-levels"},{"id":"journey-season-37","count":52,"startTime":"2025-09-10T17:00:00.000Z","endTime":"2025-09-17T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-37.json","levelsKey":"journey-season-37-levels"},{"id":"journey-season-38","count":52,"startTime":"2025-09-17T17:00:00.000Z","endTime":"2025-09-24T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-38.json","levelsKey":"journey-season-38-levels"},{"id":"journey-season-39","count":52,"startTime":"2025-09-24T17:00:00.000Z","endTime":"2025-10-01T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-39.json","levelsKey":"journey-season-39-levels"},{"id":"journey-season-40","count":52,"startTime":"2025-10-01T17:00:00.000Z","endTime":"2025-10-08T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-40.json","levelsKey":"journey-season-40-levels"},{"id":"journey-season-41","count":52,"startTime":"2025-10-08T17:00:00.000Z","endTime":"2025-10-15T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-41.json","levelsKey":"journey-season-41-levels"},{"id":"journey-season-42","count":52,"startTime":"2025-10-15T17:00:00.000Z","endTime":"2025-10-22T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-42.json","levelsKey":"journey-season-42-levels"},{"id":"journey-season-43","count":52,"startTime":"2025-10-22T17:00:00.000Z","endTime":"2025-10-29T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-43.json","levelsKey":"journey-season-43-levels"},{"id":"journey-season-44","count":52,"startTime":"2025-10-29T17:00:00.000Z","endTime":"2025-11-05T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-44.json","levelsKey":"journey-season-44-levels"},{"id":"journey-season-45","count":52,"startTime":"2025-11-05T17:00:00.000Z","endTime":"2025-11-12T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-45.json","levelsKey":"journey-season-45-levels"},{"id":"journey-season-46","count":52,"startTime":"2025-11-12T17:00:00.000Z","endTime":"2025-11-19T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-46.json","levelsKey":"journey-season-46-levels"},{"id":"journey-season-47","count":52,"startTime":"2025-11-19T17:00:00.000Z","endTime":"2025-11-26T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-47.json","levelsKey":"journey-season-47-levels"},{"id":"journey-season-48","count":52,"startTime":"2025-11-26T17:00:00.000Z","endTime":"2025-12-03T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-48.json","levelsKey":"journey-season-48-levels"},{"id":"journey-season-49","count":52,"startTime":"2025-12-03T17:00:00.000Z","endTime":"2025-12-10T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-49.json","levelsKey":"journey-season-49-levels"},{"id":"journey-season-50","count":52,"startTime":"2025-12-10T17:00:00.000Z","endTime":"2025-12-17T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-50.json","levelsKey":"journey-season-50-levels"},{"id":"journey-season-51","count":52,"startTime":"2025-12-17T17:00:00.000Z","endTime":"2025-12-24T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-51.json","levelsKey":"journey-season-51-levels"},{"id":"journey-season-52","count":52,"startTime":"2025-12-24T17:00:00.000Z","endTime":"2025-12-31T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-52.json","levelsKey":"journey-season-52-levels"},{"id":"journey-season-53","count":52,"startTime":"2025-12-24T17:00:00.000Z","endTime":"2025-12-31T17:00:00.000Z","levelsUrl":"assets/levels/journey/season-53.json","levelsKey":"journey-season-53-levels"}]');function NE(e,t){var n="undefined"!==typeof ud()&&pd()(e)||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){var n;if(!e)return;if("string"===typeof e)return GE(e,t);var i=lt()(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return $l()(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return GE(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function GE(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}for(var FE="journey-season-",UE=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=e.call.apply(e,B()(t=[this]).call(t,a))||this).config=void 0,n.dateNowOffset=0,n.newSeasonUpdated=!1,n.updatedDate=new Date,n.seasonKey="",n}(0,_.A)(t,e);var n=t.prototype;return n.init=function(t){e.prototype.init.call(this,t);var n=this.getAllSeasonConfigs();this.config=n["journey-season-1"]},n.setCompleted=function(){var e=this.getCompletedJourneySeasonsData(),t=this.deepCopy(e),n=(0,Wl.hk)();n in t||(t[n]={}),t[n][this.config.id]=!0,this.game.player.setCustomData("completedJourneySeasons",t)},n.isCompleted=function(){var e=this.getCompletedJourneySeasonsData(),t=(0,Wl.hk)();return t in e&&!!e[t][this.config.id]},n.updateNewSeason=function(e){if(!this.newSeasonUpdated){this.newSeasonUpdated=!0;var t=this.getSeasonConfigPlayerCurrentlyIn(e);this.dateNowOffset=e.getTime()-Date.now(),this.config.id!==t.id&&(this.config=t)}},n.getSeasonConfigPlayerCurrentlyIn=function(e){var t=this.getAllSeasonConfigs(),n=(0,Wl.QW)(e);return t[FE+n]},n.getAllSeasonConfigs=function(){for(var e,t={},n=this.getYear(),i=NE(LE);!(e=i()).done;){var s=e.value,r=s.id,o=parseInt(r.split("-")[2]);t[r]=(0,a.A)({},s,{startTime:(0,Wl.Yz)(o,n),endTime:(0,Wl.H7)(o,n),decompressedData:[]})}return t},n.getCurrentSeasonConfig=function(){return this.config},n.getTimeStart=function(){return this.config.startTime.getTime()/1e3},n.getTimeEnd=function(){return this.config.endTime.getTime()/1e3},n.getJourneySeasonName=function(){var e=this.config.id.split("-");return"Journey Season "+e[e.length-1]},n.getDateNow=function(){return Date.now()+this.dateNowOffset},n.getCompletedJourneySeasonsData=function(){var e=this.game.player.getCustomData("completedJourneySeasons");return null!=e?e:{}},n.deepCopy=function(e){return Phaser.Utils.Objects.DeepCopy(e)},n.getYear=function(){return this.updatedDate.getFullYear()},n.getSeasonKey=function(){return this.seasonKey},n.getSeasonKeyByDate=function(e){var t=(0,Wl.QW)(e),n=this.getYear()+"-",i=FE+n+t;return this.seasonKey=i,this.seasonKey},t}(Phaser.Plugins.BasePlugin),jE=UE,VE=Fa.A.EDITOR,zE=VE.KEY,YE=VE.FRAME,HE=Fa.A.GAMEPLAY_32,KE=HE.KEY,WE=HE.FRAME,ZE=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t)||this).scene=void 0,s.row=void 0,s.col=void 0,s.bg=void 0,s.gemSprite=void 0,s.gemHighlight=void 0,s.items=[],s.itemSprites=[],s.scene=t,s.row=n,s.col=i,s.setSize(a,a),s.createBg(),s.createGemSprite(),s.createGemHighlight(),s.listenEvents(),t.add.existing((0,ka.A)(s)),s}(0,_.A)(t,e);var n=t.prototype;return n.createBg=function(){this.bg=this.scene.make.image({key:zE,frame:YE.BUBBLE_TRANSPARENT}),this.bg.setWorldSize(this.width,this.height),this.add(this.bg)},n.createGemSprite=function(){this.gemSprite=this.scene.make.image({key:zE,frame:YE.BUBBLE_TRANSPARENT}),this.gemSprite.setWorldSize(this.width,this.height),this.add(this.gemSprite)},n.createGemHighlight=function(){this.gemHighlight=this.scene.make.image({key:zE,frame:YE.BUBBLE_SELECTED}),this.gemHighlight.setWorldSize(this.width,this.height),this.gemHighlight.setVisible(!1),this.add(this.gemHighlight)},n.showHighlight=function(){this.gemHighlight.setVisible(!0)},n.hideHighlight=function(){this.gemHighlight.setVisible(!1)},n.listenEvents=function(){var e=this;this.setInteractive().on(Phaser.Input.Events.POINTER_OVER,(function(){var t;if(e.scene.isKeyDownCTRL&&e.scene.isPointerDown)return e.scene.listCellSelected.push(e),void e.showHighlight();if(!e.scene.panelEditCellOfPiece.visible&&!e.scene.enableChangeGemPiece&&!e.scene.enableSelectMultiCell&&(null==(t=e.scene.blockItemSelected)||t.hideHighlight(),!e.scene.isSetLevelName&&!e.scene.panelSelectCell.visible)){e.scene.blockItemSelected=e,e.showHighlight(),e.scene.setBoardPositionSelected({x:e.row,y:e.col});var n=e.getWorldPosition(),i=n.x,a=n.y;e.scene.panelEditCell.open(i,a-25)}})),this.setInteractive().on(Phaser.Input.Events.POINTER_DOWN,(function(){var t;if(e.scene.startPointPaste=e,e.scene.enableSelectMultiCell){if(e.scene.isKeyDownCTRL)return e.scene.listCellSelected.push(e),void e.showHighlight();e.scene.closeAllPanels()}if(!e.scene.enableChangeGemPiece){null==(t=e.scene.blockItemSelected)||t.hideHighlight(),e.scene.closeAllPanels(),e.scene.blockItemSelected=e,e.showHighlight(),e.scene.setBoardPositionSelected({x:e.row,y:e.col});var n=e.getWorldPosition(),i=n.x,a=n.y;e.scene.panelEditCell.open(i,a-25)}}))},n.spawnItemSprite=function(){var e,t=f()(e=this.itemSprites).call(e,(function(e){return!e.visible}));if(t&&t.length>0)return t[0];var n=this.scene.make.image({key:KE,frame:WE.GEM_BLUE});return n.setWorldSize(20,20),this.itemSprites.push(n),this.add(n),n},n.setGemFrame=function(e){this.gemSprite.setTexture(KE),this.gemSprite.setFrame(e),this.gemSprite.setWorldSize(this.width,this.height)},n.getGemFrame=function(){return this.gemSprite.frame.name},n.setItems=function(e){var t;if(!Kt()(t=this.items).call(t,e)){console.log("setItems",e),this.items.push(e);var n=this.spawnItemSprite();n.setFrame(e),n.setVisible(!0),n.setWorldSize(20,20)}},n.reset=function(){this.resetGemSprite(),this.resetItemSprites(),this.resetItems()},n.resetGemSprite=function(){this.gemSprite.setTexture(zE),this.gemSprite.setFrame(YE.BUBBLE_TRANSPARENT)},n.resetItemSprites=function(){for(var e=0;e<this.itemSprites.length;e++)this.itemSprites[e].setVisible(!1);this.itemSprites=[]},n.resetItems=function(){this.items=[]},t}(Phaser.GameObjects.Container),XE=ZE,JE=Fa.A.GAMEPLAY_32.FRAME,qE=[JE.GEM_BLUE,JE.GEM_GREEN,JE.GEM_ORANGE,JE.GEM_PINK,JE.GEM_RED,JE.GEM_VIOLET,JE.GEM_DISABLE,JE.BUBBLE_BLUE,JE.BUBBLE_GREEN,JE.BUBBLE_ORANGE,JE.BUBBLE_PINK,JE.BUBBLE_VIOLET,JE.BUBBLE_YELLOW],QE=[JE.BUBBLE_BLUE,JE.BUBBLE_GREEN,JE.BUBBLE_ORANGE,JE.BUBBLE_PINK,JE.BUBBLE_VIOLET,JE.BUBBLE_YELLOW],$E=function(e){switch(e){case JE.GEM:return 1;case JE.BUBBLE_BLUE:return 10;case JE.BUBBLE_GREEN:return 11;case JE.BUBBLE_ORANGE:return 12;case JE.BUBBLE_PINK:return 13;case JE.BUBBLE_VIOLET:return 14;case JE.BUBBLE_YELLOW:return 15}return 1},eT=function(e){switch(e){case 1:return JE.GEM_BLUE;case 11:return JE.BUBBLE_BLUE;case 12:return JE.BUBBLE_GREEN;case 13:return JE.BUBBLE_ORANGE;case 14:return JE.BUBBLE_PINK;case 15:return JE.BUBBLE_VIOLET;case 16:return JE.BUBBLE_YELLOW}return JE.GEM},tT={},nT=0;nT<QE.length;nT++){tT[QE[nT]]=nT}console.log("FRAME_ID ==================== ",tT);for(var iT={BOARD:{},GEM:{}},aT=0;aT<qE.length;aT++){var sT=qE[aT];iT.GEM[sT]=sT}var rT=[[1,0],[1,0],[1,1]],oT=[[0,1],[0,1],[1,1]],cT=[[1,0],[1,1]],lT=[[1,0,0],[1,0,0],[1,1,1]],hT=[[1,1,1],[1,0,0]],uT=[[1,1,1],[0,0,1]],dT=[[1,1],[1,0]],pT=[[1,1,1],[1,0,0],[1,0,0]],fT=[[1,1],[0,1],[0,1]],mT=[[1,1],[1,0],[1,0]],gT=[[1,1],[0,1]],vT=[[1,1,1],[0,0,1],[0,0,1]],yT=[[0,0,1],[1,1,1]],AT=[[1,0,0],[1,1,1]],ET=[[0,1],[1,1]],TT=[[0,0,1],[0,0,1],[1,1,1]],ST=[[1],[1]],bT=[[1,1]],PT=[[1],[1],[1]],CT=[[1,1,1]],wT=[[1],[1],[1],[1]],IT=[[1,1,1,1]],xT=[[1],[1],[1],[1],[1]],kT=[[1,1,1,1,1]],OT=[[1]],_T=[[1,1],[1,1]],RT=[[1,0],[1,1],[0,1]],DT=[[0,1],[1,1],[1,0]],MT=[[1,1,0],[0,1,1]],BT=[[0,1,1],[1,1,0]],LT=[[0,1],[1,1],[0,1]],NT=[[1,0],[1,1],[1,0]],GT=[[0,1,0],[1,1,1]],FT=[[1,1,1],[0,1,0]],UT=[[0,0,1],[1,1,1],[0,0,1]],jT=[[1,0,0],[1,1,1],[1,0,0]],VT=[[0,1,0],[0,1,0],[1,1,1]],zT=[[1,1,1],[0,1,0],[0,1,0]],YT=[[0,1,0],[1,1,1],[0,1,0]],HT=[[1,0],[0,1]],KT=[[0,1],[1,0]],WT=[[1,0,0],[0,1,0],[0,0,1]],ZT=[[0,0,1],[0,1,0],[1,0,0]],XT=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],JT=[[0,0,0,1],[0,0,1,0],[0,1,0,0],[1,0,0,0]],qT=[[1,0,0,0,0],[0,1,0,0,0],[0,0,1,0,0],[0,0,0,1,0],[0,0,0,0,1]],QT=[[0,0,0,0,1],[0,0,0,1,0],[0,0,1,0,0],[0,1,0,0,0],[1,0,0,0,0]],$T=[[1,1],[0,1],[1,1]],eS=[[1,0],[1,1],[1,0]],tS=[[1,0,1],[1,1,1]],nS=[[1,1,1],[1,0,1]],iS=[{name:"L_TOP",data:rT},{name:"L_TOP_REVERSE",data:oT},{name:"L_1_TOP",data:cT},{name:"L_3_TOP",data:lT},{name:"L_RIGHT",data:hT},{name:"L_RIGHT_REVERSE",data:uT},{name:"L_1_RIGHT",data:dT},{name:"L_3_RIGHT",data:pT},{name:"L_BOTTOM",data:fT},{name:"L_BOTTOM_REVERSE",data:mT},{name:"L_1_BOTTOM",data:gT},{name:"L_3_BOTTOM",data:vT},{name:"L_LEFT",data:yT},{name:"L_LEFT_REVERSE",data:AT},{name:"L_1_LEFT",data:ET},{name:"L_3_LEFT",data:TT},{name:"LINE_2_VERTICAL",data:ST},{name:"LINE_2_HORIZONTAL",data:bT},{name:"LINE_3_VERTICAL",data:PT},{name:"LINE_3_HORIZONTAL",data:CT},{name:"LINE_4_VERTICAL",data:wT},{name:"LINE_4_HORIZONTAL",data:IT},{name:"LINE_5_VERTICAL",data:xT},{name:"LINE_5_HORIZONTAL",data:kT},{name:"SQUARE_1",data:OT},{name:"SQUARE_2",data:_T},{name:"SQUARE_3",data:[[1,1,1],[1,1,1],[1,1,1]]},{name:"TRAPEZOID_VERTICAL_LEFT",data:RT},{name:"TRAPEZOID_VERTICAL_RIGHT",data:DT},{name:"TRAPEZOID_HORIZONTAL_LEFT",data:MT},{name:"TRAPEZOID_HORIZONTAL_RIGHT",data:BT},{name:"TRIANGLE_LEFT",data:LT},{name:"TRIANGLE_RIGHT",data:NT},{name:"TRIANGLE_TOP",data:GT},{name:"TRIANGLE_BOTTOM",data:FT},{name:"T_PIECE_LEFT",data:UT},{name:"T_PIECE_RIGHT",data:jT},{name:"T_PIECE_TOP",data:VT},{name:"T_PIECE_BOTTOM",data:zT},{name:"PLUS_PIECE_DATA",data:YT},{name:"CROSS_PIECE_LEFT_2_DATA",data:HT},{name:"CROSS_PIECE_RIGHT_2_DATA",data:KT},{name:"CROSS_PIECE_LEFT_3_DATA",data:WT},{name:"CROSS_PIECE_RIGHT_3_DATA",data:ZT},{name:"CROSS_PIECE_LEFT_4_DATA",data:XT},{name:"CROSS_PIECE_RIGHT_4_DATA",data:JT},{name:"CROSS_PIECE_LEFT_5_DATA",data:qT},{name:"CROSS_PIECE_RIGHT_5_DATA",data:QT},{name:"U_PIECE_LEFT",data:$T},{name:"U_PIECE_RIGHT",data:eS},{name:"U_PIECE_TOP",data:tS},{name:"U_PIECE_BOTTOM",data:nS}],aS=function(e){switch(e){case 2:default:return JE.GEM_BLUE;case 3:return JE.GEM_GREEN;case 4:return JE.GEM_ORANGE;case 5:return JE.GEM_PINK;case 6:return JE.GEM_RED;case 7:return JE.GEM_VIOLET;case 11:return JE.BUBBLE_BLUE;case 12:return JE.BUBBLE_GREEN;case 13:return JE.BUBBLE_ORANGE;case 14:return JE.BUBBLE_PINK;case 15:return JE.BUBBLE_VIOLET;case 16:return JE.BUBBLE_YELLOW}},sS=Fa.A.GAMEPLAY_32.FRAME,rS="vertical",oS="horizontal",cS="left",lS="right",hS="top",uS="bottom",dS="vertical_left",pS="vertical_right",fS="horizontal_left",mS="horizontal_right",gS="l",vS="l_1",yS="l_3",AS="line_2",ES="line_3",TS="line_4",SS="line_5",bS="square_1",PS="square_2",CS="square_3",wS="trapezoid",IS="triangle",xS="t_piece",kS="plus_piece",OS="cross_piece_2",_S="cross_piece_3",RS="cross_piece_4",DS="cross_piece_5",MS="u_piece",BS=[gS,vS,yS,AS,ES,TS,SS,bS,PS,CS,IS,wS,xS,kS,OS,_S,RS,DS,MS],LS=[{type:gS,rate:3},{type:vS,rate:4},{type:yS,rate:2},{type:AS,rate:16},{type:ES,rate:12},{type:TS,rate:8},{type:SS,rate:4},{type:bS,rate:16},{type:PS,rate:8},{type:IS,rate:4},{type:wS,rate:4},{type:xS,rate:2},{type:kS,rate:1},{type:OS,rate:4},{type:_S,rate:2},{type:RS,rate:1},{type:MS,rate:2}],NS=[[1,0],[1,0],[1,1]],GS=[[0,1],[0,1],[1,1]],FS=[[1,0],[1,1]],US=[[1,0,0],[1,0,0],[1,1,1]],jS=[[1,1,1],[1,0,0]],VS=[[1,1,1],[0,0,1]],zS=[[1,1],[1,0]],YS=[[1,1,1],[1,0,0],[1,0,0]],HS=[[1,1],[0,1],[0,1]],KS=[[1,1],[1,0],[1,0]],WS=[[1,1],[0,1]],ZS=[[1,1,1],[0,0,1],[0,0,1]],XS=[[0,0,1],[1,1,1]],JS=[[1,0,0],[1,1,1]],qS=[[0,1],[1,1]],QS=[[0,0,1],[0,0,1],[1,1,1]],$S=[[1],[1]],eb=[[1,1]],tb=[[1],[1],[1]],nb=[[1,1,1]],ib=[[1],[1],[1],[1]],ab=[[1,1,1,1]],sb=[[1],[1],[1],[1],[1]],rb=[[1,1,1,1,1]],ob=[[1]],cb=[[1,1],[1,1]],lb=[[1,1,1],[1,1,1],[1,1,1]],hb=[[1,0],[1,1],[0,1]],ub=[[0,1],[1,1],[1,0]],db=[[1,1,0],[0,1,1]],pb=[[0,1,1],[1,1,0]],fb=[[0,1],[1,1],[0,1]],mb=[[1,0],[1,1],[1,0]],gb=[[0,1,0],[1,1,1]],vb=[[1,1,1],[0,1,0]],yb=[[0,0,1],[1,1,1],[0,0,1]],Ab=[[1,0,0],[1,1,1],[1,0,0]],Eb=[[0,1,0],[0,1,0],[1,1,1]],Tb=[[1,1,1],[0,1,0],[0,1,0]],Sb=[[0,1,0],[1,1,1],[0,1,0]],bb=[[1,0],[0,1]],Pb=[[0,1],[1,0]],Cb=[[1,0,0],[0,1,0],[0,0,1]],wb=[[0,0,1],[0,1,0],[1,0,0]],Ib=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],xb=[[0,0,0,1],[0,0,1,0],[0,1,0,0],[1,0,0,0]],kb=[[1,0,0,0,0],[0,1,0,0,0],[0,0,1,0,0],[0,0,0,1,0],[0,0,0,0,1]],Ob=[[0,0,0,0,1],[0,0,0,1,0],[0,0,1,0,0],[0,1,0,0,0],[1,0,0,0,0]],_b=[[1,1],[0,1],[1,1]],Rb=[[1,1],[1,0],[1,1]],Db=[[1,0,1],[1,1,1]],Mb=[[1,1,1],[1,0,1]],Bb={1:sS.GEM,11:sS.BUBBLE_BLUE,12:sS.BUBBLE_GREEN,13:sS.BUBBLE_ORANGE,14:sS.BUBBLE_PINK,15:sS.BUBBLE_VIOLET,16:sS.BUBBLE_YELLOW},Lb={1:{type:bS,direction:null,isReverse:!1,data:ob},I2:{type:AS,direction:rS,isReverse:!1,data:$S},I3:{type:ES,direction:rS,isReverse:!1,data:tb},I4:{type:TS,direction:rS,isReverse:!1,data:ib},I5:{type:SS,direction:rS,isReverse:!1,data:sb},II2:{type:AS,direction:oS,isReverse:!1,data:eb},II3:{type:ES,direction:oS,isReverse:!1,data:nb},II4:{type:TS,direction:oS,isReverse:!1,data:ab},II5:{type:SS,direction:oS,isReverse:!1,data:rb},J1:{type:gS,direction:hS,isReverse:!0,data:NS},J2:{type:gS,direction:cS,isReverse:!0,data:JS},J3:{type:gS,direction:uS,isReverse:!0,data:KS},J4:{type:gS,direction:lS,isReverse:!0,data:VS},L1:{type:gS,direction:hS,isReverse:!1,data:NS},L2:{type:gS,direction:lS,isReverse:!1,data:jS},L3:{type:gS,direction:uS,isReverse:!1,data:HS},L4:{type:gS,direction:cS,isReverse:!1,data:XS},O:{type:PS,direction:null,isReverse:!1,data:cb},"polyplet-left-2":{type:OS,direction:cS,isReverse:!1,data:bb},"polyplet-left-3":{type:_S,direction:cS,isReverse:!1,data:Cb},"polyplet-left-4":{type:RS,direction:cS,isReverse:!1,data:Ib},"polyplet-left-5":{type:DS,direction:cS,isReverse:!1,data:kb},"polyplet-right-2":{type:OS,direction:lS,isReverse:!1,data:Pb},"polyplet-right-3":{type:_S,direction:lS,isReverse:!1,data:wb},"polyplet-right-4":{type:RS,direction:lS,isReverse:!1,data:xb},"polyplet-right-5":{type:DS,direction:lS,isReverse:!1,data:Ob},S1:{type:wS,direction:mS,isReverse:!1,data:pb},S2:{type:wS,direction:dS,isReverse:!1,data:hb},T1:{type:IS,direction:hS,isReverse:!1,data:gb},T2:{type:IS,direction:lS,isReverse:!1,data:mb},T3:{type:IS,direction:uS,isReverse:!1,data:vb},T4:{type:IS,direction:cS,isReverse:!1,data:fb},TT1:{type:xS,direction:uS,isReverse:!1,data:Tb},TT2:{type:xS,direction:cS,isReverse:!1,data:yb},TT3:{type:xS,direction:hS,isReverse:!1,data:Eb},TT4:{type:xS,direction:lS,isReverse:!1,data:Ab},U1:{type:MS,direction:hS,isReverse:!1,data:Db},U2:{type:MS,direction:lS,isReverse:!1,data:Rb},U3:{type:MS,direction:uS,isReverse:!1,data:Mb},U4:{type:MS,direction:cS,isReverse:!1,data:_b},V1:{type:vS,direction:lS,isReverse:!1,data:zS},V2:{type:vS,direction:uS,isReverse:!1,data:WS},V3:{type:vS,direction:hS,isReverse:!1,data:FS},V4:{type:vS,direction:cS,isReverse:!1,data:qS},VV1:{type:yS,direction:lS,isReverse:!1,data:YS},VV2:{type:yS,direction:uS,isReverse:!1,data:ZS},VV3:{type:yS,direction:hS,isReverse:!1,data:US},VV4:{type:yS,direction:cS,isReverse:!1,data:QS},X:{type:kS,direction:null,isReverse:!1,data:Sb},Z1:{type:wS,direction:fS,isReverse:!1,data:db},Z2:{type:wS,direction:pS,isReverse:!1,data:ub}},Nb="SET_BLOCK_ITEM",Gb="SET_BLOCK_ITEMS",Fb="SET_ITEM_BLOCK_ITEM",Ub="RESET_BLOCK_ITEM",jb="RESET_BLOCK_ITEMS",Vb="ADD_PIECE",zb="REMOVE_PIECE",Yb="CHANGE_PIECE",Hb=GameCore.Configs.Board,Kb=Hb.rows,Wb=Hb.cols,Zb=Fa.A.EDITOR,Xb=(Zb.KEY,Zb.FRAME,Fa.A.GAMEPLAY_32.FRAME),Jb=function(e){function t(t){var n;(n=e.call(this,t)||this).scene=void 0,n.dataBoard=[],n.addObjectButton=void 0,n.removeObjectButton=void 0,n.currentRows=Kb,n.currentCols=Wb,n.size=30,n.padding=2,n.fen=[],n.scene=t;var i=n.scene.gameZone,a=i.width,s=i.height;return n.setSize(a/3,s),n.createBackground(),n.createBoardUI(),t.add.existing((0,ka.A)(n)),n}(0,_.A)(t,e);var n=t.prototype;return n.createBackground=function(){var e=this.scene.make.image({key:Ga.A.BACKGROUND.KEY});this.add(e),e.setWorldSize(this.width,this.height)},n.createBoardUI=function(){for(var e=0,t=-(this.size+this.padding)*(this.currentRows+1)/2,n=0;n<this.currentRows;n++){e=-(this.size+this.padding)*(this.currentCols+1)/2,t+=this.size+this.padding,this.dataBoard[n]=[];for(var i=0;i<this.currentCols;i++){e+=this.size+this.padding;var a=new XE(this.scene,n,i,this.size);this.add(a),a.setPosition(e,t);var s={x:n,y:i,gemFrame:"",bubbleFrame:"",items:[],blockItem:a};this.dataBoard[n].push(s)}}console.log("this.dataBoard ==== ",this.dataBoard)},n.convertFrameToId=function(e){var t=tT[e];return console.log("convertFrameToId",e,t),t||0},n.getIdByFrame=function(e,t){var n=0;switch(e){case Xb.GEM:case Xb.GEM_BLUE:n+=2;break;case Xb.GEM_GREEN:n+=3;break;case Xb.GEM_ORANGE:n+=4;break;case Xb.GEM_PINK:n+=5;break;case Xb.GEM_RED:n+=6;break;case Xb.GEM_VIOLET:n+=7}switch(t){case Xb.BUBBLE_BLUE:n+=10;break;case Xb.BUBBLE_GREEN:n+=20;break;case Xb.BUBBLE_ORANGE:n+=30;break;case Xb.BUBBLE_PINK:n+=40;break;case Xb.BUBBLE_VIOLET:n+=50;break;case Xb.BUBBLE_YELLOW:n+=60}return n},n.setPickItemForBoardData=function(e,t){console.log("setPickItemForBoardData",e,t);var n,i=this.dataBoard[e.x][e.y];i&&("bubble-transparent"==t&&(i.gemFrame="",i.blockItem.reset()),t==Xb.GEM&&(i.gemFrame=t,i.blockItem.setGemFrame(t)),Kt()(t).call(t,"diamond")&&(this.scene.undoManager.receiveCommand({event:Nb,object:i,prevState:i.gemFrame,currentState:t}),i.gemFrame=t,i.blockItem.setGemFrame(t)),Kt()(t).call(t,"bubbles")&&(i.items.push(t),i.bubbleFrame=t,i.blockItem.setItems(t),this.scene.undoManager.receiveCommand({event:Fb,object:i,prevState:void 0,currentState:B()(n=[]).call(n,i.items)})))},n.convertDataBoardToMap=function(){for(var e=[],t=0;t<this.currentRows;t++)for(var n=0;n<this.currentCols;n++){var i=this.dataBoard[t][n],a=this.getIdByFrame(i.gemFrame,i.bubbleFrame);e.push(a)}return e},n.reset=function(){for(var e=0;e<this.currentRows;e++)for(var t=0;t<this.currentCols;t++)this.dataBoard[e][t].gemFrame="",this.dataBoard[e][t].items=[],this.dataBoard[e][t].blockItem.reset()},n.clearBoard=function(){for(var e=0;e<this.currentRows;e++)for(var t=0;t<this.currentCols;t++)this.dataBoard[e][t].gemFrame!=Xb.GEM&&this.fen.push({row:e,col:t,gemFrame:this.dataBoard[e][t].gemFrame}),this.dataBoard[e][t].items.length>0&&this.fen.push({row:e,col:t,gemFrame:this.dataBoard[e][t].gemFrame,items:this.dataBoard[e][t].items}),this.dataBoard[e][t].blockItem.destroy();console.log("clearBoard",this.fen)},n.updateBoard=function(){this.dataBoard=[],this.padding=18/(this.currentRows+1),this.size=(320-this.padding*(this.currentRows+1))/(this.currentRows+1),this.createBoardUI()},n.updateFen=function(){for(var e=this,t=function(){var t=e.fen[n],i=t.row,a=t.col,s=t.gemFrame,r=t.items;if(i>=e.currentRows||a>=e.currentCols)return 1;r?r.forEach((function(t){e.setPickItemForBoardData({x:i,y:a},t)})):e.setPickItemForBoardData({x:i,y:a},s)},n=0;n<this.fen.length;n++)t()},n.loadBoardByMap=function(){this.reset();for(var e=this.scene.mapManager.getTileMap().layers,t=e.length,n=0;n<t;n++)for(var i=e[0].data,a=0;a<i.length;a++)for(var s=i[a],r=0;r<s.length;r++){var o=s[r];if(!(o.index<0)){console.log("colItem.index",o.index),o.index>100&&(o.index=Math.floor(o.index/10));var c=this.getFrameByMapItemIndex(o.index);c&&c!==Xb.GEM_TRANSPARENT||(c=this.getFrameByMapItemIndex(1)),this.setPickItemForBoardData({x:a,y:r},c)}}},n.getFrameByMapItemIndex=function(e){return console.log("index === ",e),Bb[e]},n.loadTargetByMap=function(){var e=this.scene.mapManager.getTileMap().properties;this.scene.listTargetsDiamond[0].value=e[0].value,this.scene.header.updateCollectItems()},n.updateDataSegment=function(){var e=this.scene.mapManager.getTileMap(),t=e.layers,n=e.properties,i=t[0].properties,a={avgScore:0,score:0,piece1:"",piece5:"",pieceDistancePerGem:0};i.length>0&&(a=i[0].value);var s=a,r=(s.avgScore,s.score,s.piece1),o=s.piece5,c=(s.pieceDistancePerGem,this.getNumberInString(r)),l=(c[0],c[1],this.getNumberInString(o)),h=(l[0],l[1],this.getTargetInString(n[0].value));console.log("listTargets",h);var u=this.getTargetByListTargets(h);u.blue,u.green,u.pink,u.red,u.purple,u.yellow,n[1].value;this.scene.levelDataPanel.setData()},n.getNumberInString=function(e){var t;return sc()(t=e.replace("{"," ").replace("}"," ").replace("min: "," ").replace(", max: "," ")).call(t).split(" ")},n.getTargetInString=function(e){var t;return sc()(t=e.replace("{"," ").replace("}"," ")).call(t).split(",")},n.getTargetByListTargets=function(e){for(var t=0,n=0,i=0,a=0,s=0,r=0,o=0;o<e.length;o++){var c=e[o];console.log("element",sc()(c).call(c).split(": "));var l=sc()(c).call(c).split(": "),h=l[0],u=l[1];switch(h){case"11":t=parseInt(u),this.scene.levelDataPanel.targets[h]=parseInt(u);break;case"12":n=parseInt(u),this.scene.levelDataPanel.targets[h]=parseInt(u);break;case"13":i=parseInt(u),this.scene.levelDataPanel.targets[h]=parseInt(u);break;case"14":a=parseInt(u),this.scene.levelDataPanel.targets[h]=parseInt(u);break;case"15":s=parseInt(u),this.scene.levelDataPanel.targets[h]=parseInt(u);break;case"16":r=parseInt(u),this.scene.levelDataPanel.targets[h]=parseInt(u)}}return{blue:t,green:n,pink:i,red:a,purple:s,yellow:r}},n.loadBoardByPatternData=function(e){for(var t=0;t<this.currentRows;t++)for(var n=0;n<this.currentCols;n++)if(""!=e[t][n]){var i=Xb.GEM_BLUE;this.dataBoard[t][n].items.length>0&&this.fen.push({row:t,col:n,gemFrame:i,items:[]}),""!=e[t][n]&&("*"!=e[t][n]?(i=aS(parseInt(e[t][n])),this.setPickItemForBoardData({x:t,y:n},i)):this.setPickItemForBoardData({x:t,y:n},i))}else this.dataBoard[t][n].blockItem.reset()},n.getBlockItemsByPoints=function(e,t){if(e&&t){this.scene.listCellSelected=[];for(var n=0;n<this.currentRows;n++)for(var i=0;i<this.currentCols;i++){var a=this.dataBoard[n][i].blockItem,s=Phaser.Geom.Rectangle.FromXY(e.x,e.y,t.x,t.y);Phaser.Geom.Intersects.RectangleToRectangle(a.getBounds(),s)?(a.showHighlight(),this.scene.listCellSelected.push(a)):a.hideHighlight()}}},t}(Phaser.GameObjects.Container),qb=Jb,Qb=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.gemSprite=void 0,i.payload=void 0,i.scene=t,i.payload=n,i.setSize(18,18),i.createGem(),i.listenEvents(),i}(0,_.A)(t,e);var n=t.prototype;return n.createGem=function(){this.gemSprite=this.scene.make.image({key:this.payload.key,frame:this.payload.frame}),this.gemSprite.setWorldSize(this.width,this.height),this.add(this.gemSprite)},n.listenEvents=function(){this.setInteractive().on(Phaser.Input.Events.POINTER_DOWN,this.onClick)},n.onClick=function(){if(console.log("CLICK",this.payload),this.scene.enableSelectMultiCell){for(var e=0;e<this.scene.listCellSelected.length;e++){var t=this.scene.listCellSelected[e];this.scene.setBoardPositionSelected({x:t.row,y:t.col}),t.hideHighlight(),this.scene.pickGem(this.payload)}return this.scene.undoManager.receiveCommand({event:Gb,object:this.scene.listCellSelected,prevState:void 0,currentState:void 0}),this.scene.enableSelectMultiCell=!1,this.scene.listCellSelected=[],this.scene.panelEditCellOnPiece.close(),void this.scene.panelSelectCell.close()}this.scene.panelEditCellOnPiece.close(),this.scene.panelSelectCell.close(),this.scene.pickGem(this.payload)},t}(Phaser.GameObjects.Container),$b=Qb,eP=Fa.A.DEFAULT_TOOL,tP=eP.KEY,nP=eP.FRAME,iP=function(e){function t(t){var n;return(n=e.call(this,t,tP,nP.BUTTON_MINOR)||this).button.setWorldSize(62,53),n.setName("Clear"),n.createIcon(),n}return(0,_.A)(t,e),t.prototype.createIcon=function(){var e=this.scene.make.image({key:tP,frame:nP.ICON_CLEAN});e.setWorldSize(30,30),this.add(e),Phaser.Display.Align.In.Center(e,this,0,0)},t}(Va.A),aP=iP,sP=Fa.A.DEFAULT_TOOL,rP=sP.KEY,oP=sP.FRAME,cP=Fa.A.GAMEPLAY_32,lP=cP.KEY,hP=cP.FRAME,uP=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).scene=void 0,s.popup=void 0,s.title=void 0,s.buttonClose=void 0,s.contents=void 0,s.clearItemButton=void 0,s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.size=40,s.gemItems=[],s.gemItemOfBlock=[],s.handleClose=function(){s.runCloseAnimation()},s.handleClean=function(){var e=s.scene,t=e.boardPositionBlockSelected,n=e.board;t&&(n.dataBoard[t.x][t.y].blockItem.reset(),s.close())},s.scene=t,s.createPopup(),s.createTitle(),s.createTextGems(),s.createGems(),s.createButton(),s.createTextGemsPicked(),s.addItem(),s.createInput(),s.setDepth(Ua.Ae.POPUP),s.background.setAlpha(.5),s}(0,_.A)(t,e);var n=t.prototype;return n.open=function(){e.prototype.open.call(this),this.resetGemItemOfBlock(),this.showGemAndItemOfBlock(),this.runOpenAnimation()},n.createTextGems=function(){var e=this.scene.make.text({text:"Gems & Items",style:{fontFamily:za.A.FONT_FAMILY,fontSize:this.scene.fontSize(40)+"px",fontStyle:"700"},origin:{x:.5,y:.5}});this.popup.add(e),Phaser.Display.Align.In.LeftCenter(e,this,-60,-160)},n.createGems=function(){for(var e=0,t=-Math.floor(qE.length/6)/2*this.size,n=0;n<qE.length;n++){e=-6*this.size/2+this.size/2+this.size*n-6*Math.floor(n/6)*this.size,t=-Math.floor(qE.length/6)/2*this.size+Math.floor(n/6)*this.size;var i=new $b(this.scene,{key:Fa.A.GAMEPLAY_32.KEY,frame:qE[n]});this.gemItems.push(i),this.popup.add(i),Phaser.Display.Align.In.Center(i,this,e,t-80)}},n.createTextGemsPicked=function(){var e=this.scene.make.text({text:"Gems & Items of block",style:{fontFamily:za.A.FONT_FAMILY,fontSize:this.scene.fontSize(40)+"px",fontStyle:"700"},origin:{x:.5,y:.5}});this.popup.add(e),Phaser.Display.Align.In.LeftCenter(e,this,-60,0)},n.showGemAndItemOfBlock=function(){var e=this,t=this.scene,n=t.board,i=t.boardPositionBlockSelected;if(i){var a=-100,s=30,r=n.dataBoard[i.x][i.y].blockItem,o=r.items,c=this.spawnGemAndItem();c.setFrame(r.gemSprite.frame.name),c.setWorldSize(this.size,this.size),c.setVisible(!0),Phaser.Display.Align.In.Center(c,this.popup,a,s),o.forEach((function(t){var n=e.spawnGemAndItem();(a+=45)>100&&(a=-100,s+=50),n.setFrame(t),n.setWorldSize(e.size,e.size),n.setVisible(!0),Phaser.Display.Align.In.Center(n,e.popup,a,s)}))}},n.spawnGemAndItem=function(){var e,t=f()(e=this.gemItemOfBlock).call(e,(function(e){return!e.visible}));if(t&&t.length>0)return t[0];var n=this.scene.make.image({key:lP,frame:hP.GEM});return this.gemItemOfBlock.push(n),this.popup.add(n),n},n.resetGemItemOfBlock=function(){this.gemItemOfBlock.forEach((function(e){e.setVisible(!1)}))},n.createButton=function(){this.clearItemButton=new aP(this.scene),this.popup.add(this.clearItemButton),Phaser.Display.Align.In.BottomCenter(this.clearItemButton,this.popup,0,50)},n.createInput=function(){this.buttonClose.onClick=this.handleClose,this.clearItemButton.onClick=this.handleClean},n.createPopup=function(){this.popup=new xf(this.scene,0,0,286,426),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone,0,10)},n.createTitle=function(){this.buttonClose=new Va.A(this.scene,rP,oP.BUTTON_CLOSE,35,35),this.buttonClose.setName("Close"),this.popup.add([this.buttonClose]),Phaser.Display.Align.In.TopRight(this.buttonClose,this.popup,10,38)},n.addItem=function(){this.popup.add([]),this.contents=this.scene.add.group(),this.contents.addMultiple([])},n.arrangeItems=function(){Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.runOpenAnimation=function(){var e;null!=(e=this.popupShowUpAnimation)&&null!=(e=e.tween)&&e.isPlaying()||(this.scene.audio.playSound(ja.A.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300),this.runPopupContentEntrancesAnimation(200,300))},n.runCloseAnimation=function(){var e;null!=(e=this.popupFadeOutAnimation)&&null!=(e=e.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(e,t){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new Nh.A({targets:[this.popup],delay:e,duration:t,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(e,t){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new Lh.A({targets:this.contents.getChildren(),duration:t,delay:e,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(e,t){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new Bh.A({targets:[this.popup],delay:e,duration:t,props:{scale:0},ease:Phaser.Math.Easing.Back.In,onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(e,t){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new wo.A({targets:[this.background],delay:e,duration:t,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(e,t){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new Bh.A({targets:[this.background],delay:e,duration:t,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},t}(GameCore.Screen),dP=uP,pP=Fa.A.EDITOR,fP=pP.KEY,mP=pP.FRAME,gP=function(e){function t(t){var n;return(n=e.call(this,t)||this).background=void 0,n.copyButton=void 0,n.removeButton=void 0,n.createButton=void 0,n.saveButton=void 0,n.playButton=void 0,n.exitButton=void 0,n.separator1=void 0,n.separator2=void 0,n.prevLevelButton=void 0,n.nextLevelButton=void 0,n.textCurrentLevel=void 0,n.levelRectangle=void 0,n.levelRectangle2=void 0,n.levelScroller=void 0,n.isOpenCopy=!1,n.isOpenDelete=!1,n.changeToLevel=function(){var e=(0,O.A)(D().mark((function e(t){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.scene.game.globalScene.screen.open(Ua.R8.NOTIFY_SCREEN,{message:"Loading...",duration:0,loading:!0});try{FBInstant.player.setDataAsync({level:t}),n.scene.storage.dispatch((0,co.fA)(t)),n.scene.levelManager.setLevel(t),n.scene.levelManager.preloadLevel(t),n.scene.levelManager.loadLevelConfig(t),n.textCurrentLevel.setText("Level "+t),n.scene.game.globalScene.screen.close(Ua.R8.NOTIFY_SCREEN)}catch(i){n.scene.game.globalScene.screen.open(Ua.R8.NOTIFY_SCREEN,{message:"Action Error",duration:1500,loading:!1})}case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.removeLevelData=function(){if(!n.isOpenDelete){var e=document.createElement("button");e.id="delete-button",e.style.width="180px",e.style.height="25px",e.style.top="20px",e.style.left="50%",e.style.marginLeft="-90px",e.style.position="fixed";var t=document.createElement("button");t.id="cancel-delete-button",t.style.width="100px",t.style.height="25px",t.style.top="50px",t.style.left="50%",t.style.marginLeft="-50px",t.style.position="fixed",t.innerText="Cancel",t.style.zIndex="10000",t.onclick=function(){document.body.removeChild(e),document.body.removeChild(t),n.isOpenDelete=!1},document.body.appendChild(e),document.body.appendChild(t)}},n.saveLevelData=(0,O.A)(D().mark((function e(){var t,i;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.scene.game.globalScene.screen.closeAllScreens(),n.scene.registry.set("isEditLevel",!0),t=n.scene.storage.getState(),i=(0,po.IP)(t),e.next=6,n.scene.header.saveLevelData("level-"+i);case 6:n.scene.handlePlayTest();case 7:case"end":return e.stop()}}),e)}))),n.handleAddChangeLevel=function(){var e=n.scene.levelManager.getLevel(),t=n.scene.game.canvas.getBoundingClientRect(),i=n.scene.world.getWorldSize(),a=i.width,s=i.height,r=(n.prevLevelButton.getWorldPosition(),n.scene.levelManager.getLevel(),document.createElement("input"));r.id="row-input",r.style.width=t.width/a*56+"px",r.style.height=t.height/s*24+"px",r.style.bottom=15*t.height/s+"px",r.style.left=t.x+(n.background.width/2+n.levelRectangle.x)*(t.width/a)-t.width/a*31+"px",r.style.position="fixed",r.style.textAlign="center",r.style.fontSize=t.width/a*12+"px",r.type="number",r.style.zIndex="10000",r.value=""+e,r.min="1",r.style.marginLeft=a/2-75+"px",r.autofocus=!0;var o=document.createElement("button");o.id="cancel-add-row-button",o.style.width="75px",o.style.height="25px",o.style.bottom=50*t.height/s+"px",o.style.left=t.x+(n.background.width/2+n.levelRectangle.x)*(t.width/a)-t.width/a*40+"px",o.style.marginLeft=a/2-50+"px",o.style.position="fixed",o.innerText="Cancel",o.style.zIndex="10000";var c=function t(i){if("Enter"===i.key){document.removeEventListener("keypress",t),document.body.removeChild(o),document.body.removeChild(r);var a=parseInt(r.value);if(!n.scene.scene.isVisible(ca.F7.LEVEL_EDITOR_SCENE)||a<=0||a===e)return;n.changeToLevel(a)}};o.onclick=function(){document.body.removeChild(r),document.body.removeChild(o),document.removeEventListener("keypress",c)},document.addEventListener("keypress",c),document.body.appendChild(r),document.body.appendChild(o)},n.createUI(),n.algin(),n.alignLevelButton(),n.setSize(n.background.width,n.background.height),n.scene.add.existing((0,ka.A)(n)),n}(0,_.A)(t,e);var n=t.prototype;return n.createUI=function(){this.createBackground(),this.createButtons(),this.createNextLevelBtn(),this.createPrevLevelBtn(),this.createExitButton(),this.createSeparates(),this.createLevel()},n.updateLevel=function(){var e=this.scene.levelManager.getLevel();this.textCurrentLevel.setText("Level "+e),Phaser.Display.Align.In.Center(this.textCurrentLevel,this.levelRectangle)},n.createBackground=function(){this.background=this.scene.add.rectangle(0,0,375,60,0,.5),this.background.setOrigin(.5,.5),this.add(this.background)},n.createButtons=function(){var e=this;this.copyButton=new Va.A(this.scene,fP,mP.SWAP_ICON,30,30),this.removeButton=new Va.A(this.scene,fP,mP.REMOVE_ICON,30,30),this.playButton=new Va.A(this.scene,fP,mP.PLAY_ICON,30,30),this.createButton=new Va.A(this.scene,fP,mP.CREATE_ICON,30,30),this.saveButton=new Va.A(this.scene,fP,mP.SAVE_ICON,30,30),this.add([this.copyButton,this.removeButton,this.createButton,this.saveButton,this.playButton]),this.copyButton.onClick=function(){if(!e.isOpenCopy){e.isOpenCopy=!0;var t=document.createElement("input");t.id="level-copy-input",t.style.width="150px",t.style.height="25px",t.style.top="10px",t.style.left="50%",t.style.marginLeft="-75px",t.style.position="fixed",t.type="number",t.min="1",t.style.zIndex="10000",t.placeholder="Level to copy";var n=document.createElement("button");n.id="copy-button",n.style.width="75px",n.style.height="25px",n.style.top="50px",n.style.left="50%",n.style.marginLeft="-100px",n.style.position="fixed",n.innerText="Copy",n.style.zIndex="10000",n.onclick=(0,O.A)(D().mark((function a(){var s;return D().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,e.scene.game.globalScene.screen.open(Ua.R8.NOTIFY_SCREEN,{message:"Loading...",duration:0,loading:!0}),s=parseInt(t.value),a.next=5,e.scene.levelManager.loadCopyLevelConfig(s);case 5:e.scene.game.globalScene.screen.open(Ua.R8.NOTIFY_SCREEN,{message:"Action Successfully",duration:1500,loading:!1}),a.next=11;break;case 8:a.prev=8,a.t0=a.catch(0),e.scene.game.globalScene.screen.open(Ua.R8.NOTIFY_SCREEN,{message:"Action Error",duration:1500,loading:!1});case 11:document.body.removeChild(t),document.body.removeChild(n),document.body.removeChild(i),e.isOpenCopy=!1;case 15:case"end":return a.stop()}}),a,null,[[0,8]])})));var i=document.createElement("button");i.id="cancel-copy-button",i.style.width="75px",i.style.height="25px",i.style.top="50px",i.style.left="50%",i.style.marginLeft="25px",i.style.position="fixed",i.innerText="Cancel",i.style.zIndex="10000",i.onclick=function(){document.body.removeChild(t),document.body.removeChild(n),document.body.removeChild(i),e.isOpenCopy=!1},document.body.appendChild(t),document.body.appendChild(n),document.body.appendChild(i)}},this.createButton.onClick=(0,O.A)(D().mark((function t(){var n;return D().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.scene.levelManager.getLevel(),t.next=3,e.changeToLevel(n);case 3:case"end":return t.stop()}}),t)}))),this.removeButton.onClick=this.removeLevelData,this.saveButton.onClick=function(){return e.saveLevelData()},this.playButton.onClick=this.scene.handlePlayTest},n.createExitButton=function(){this.exitButton=new Va.A(this.scene,fP,mP.EXIT_ICON,30,30),this.add(this.exitButton),this.exitButton.onClick=this.scene.handleExit},n.createPrevLevelBtn=function(){var e=this;this.prevLevelButton=new Va.A(this.scene,fP,mP.BUTTON_PREV_LEVEL,23,29),this.add(this.prevLevelButton),this.prevLevelButton.onClick=function(){var t=e.scene.levelManager.getLevel();e.changeToLevel(t-1>0?t-1:1)}},n.createNextLevelBtn=function(){var e=this;this.nextLevelButton=new Va.A(this.scene,fP,mP.BUTTON_NEXT_LEVEL,23,29),this.add(this.nextLevelButton),this.nextLevelButton.onClick=function(){var t=e.scene.levelManager.getLevel();e.changeToLevel(t+1)}},n.createSeparates=function(){this.separator1=this.scene.make.image({key:fP,frame:mP.PANEL_SEPARATOR}),this.separator1.setWorldSize(2,19),this.separator2=this.scene.make.image({key:fP,frame:mP.PANEL_SEPARATOR}),this.separator2.setWorldSize(2,19),this.add([this.separator1,this.separator2])},n.createLevel=function(){var e=this,t=this.scene.levelManager.getLevel();this.levelRectangle=this.scene.add.rectangle(0,0,60,27,0,0),this.levelRectangle.setStrokeStyle(1,16777215,.5);var n="Level "+t;this.textCurrentLevel=this.scene.make.bitmapText({font:za.A.FONT_TEXT_WHITE.KEY,text:n,size:this.scene.fontSize(13)}),this.levelRectangle2=this.scene.add.graphics(),this.levelRectangle2.lineStyle(1,16777215,.5),this.levelRectangle2.strokeRoundedRect(0,0,60,20,{tl:2,tr:2,bl:2,br:2}),this.levelScroller=new Ud.A(this.scene,{width:150,height:300,marginBottom:0,marginTop:0});var i=this.scene.make.image({key:fP,frame:mP.BLANK,alpha:.5,tint:0});i.setTint(0),i.setWorldSize(150,300),this.levelScroller.add(i),this.levelScroller.sendToBack(i),this.levelScroller.createMask(),this.levelScroller.setEnable(!0),this.levelScroller.kill(),this.levelScroller.setPosition(-130,-180),this.levelRectangle.setInteractive(),this.levelRectangle.on(Phaser.Input.Events.POINTER_DOWN,(function(){e.handleAddChangeLevel()})),this.add(this.levelScroller),Phaser.Display.Align.In.Center(this.levelRectangle2,this.background),this.add([this.levelRectangle,this.textCurrentLevel,this.levelRectangle2])},n.algin=function(){Phaser.Display.Align.In.RightCenter(this.exitButton,this.background,-8),Phaser.Display.Align.To.LeftCenter(this.playButton,this.exitButton,16),Phaser.Display.Align.To.LeftCenter(this.saveButton,this.playButton,5),Phaser.Display.Align.To.LeftCenter(this.createButton,this.saveButton,5),Phaser.Display.Align.To.LeftCenter(this.removeButton,this.createButton,5),Phaser.Display.Align.To.LeftCenter(this.copyButton,this.removeButton,5),Phaser.Display.Align.In.LeftCenter(this.separator1,this.exitButton,8),Phaser.Display.Align.In.LeftCenter(this.separator2,this.copyButton,8)},n.alignLevelButton=function(){Phaser.Display.Align.In.LeftCenter(this.levelRectangle,this.background,-30),Phaser.Display.Align.In.Center(this.textCurrentLevel,this.levelRectangle),Phaser.Display.Align.To.LeftCenter(this.prevLevelButton,this.levelRectangle,5),Phaser.Display.Align.To.RightCenter(this.nextLevelButton,this.levelRectangle,5)},t}(Phaser.GameObjects.Container),vP=(function(e){function t(t,n){var i;(i=e.call(this,t,fP,mP.BLANK,80,25)||this).button.setTint(0);var a=t.make.bitmapText({font:za.A.FONT_TEXT_WHITE.KEY,text:"level "+n,size:t.fontSize(12),origin:{x:.5,y:.5}});return i.add(a),i}(0,_.A)(t,e)}(Va.A),gP),yP=Fa.A.GAMEPLAY_32,AP=yP.KEY,EP=yP.FRAME,TP=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.cell=void 0,n.scene=t,n.scene.add.existing((0,ka.A)(n)),n.createCell(),n}return(0,_.A)(t,e),t.prototype.createCell=function(){this.cell=this.scene.make.image({key:AP,frame:EP.GEM_BLUE}),this.cell.setWorldSize(13.5,13.5),this.add(this.cell),Phaser.Display.Align.In.Center(this.cell,this)},t}(Phaser.GameObjects.Container),SP=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.payload=void 0,i.hasEventOnClick=!1,n&&(i.payload=n),i.scene=t,i.scene.add.existing((0,ka.A)(i)),i.setSize(32,72),i}(0,_.A)(t,e);var n=t.prototype;return n.createCells=function(){var e,t=[],n=null==(e=this.payload)?void 0:e.data;if(n)for(var i=0;i<n.length;i++){t[i]=[];for(var a=0;a<n[i].length;a++)if(n[i][a]){var s=new TP(this.scene);this.add(s),s.setPosition(14*(a-(n[i].length-1)/2),14*(i-(n.length-1)/2))}}else this.setVisible(!1)},n.updateInfo=function(e){this.payload=e,this.removeAll(!0),this.createCells(),this.listenEvents()},n.listenEvents=function(){var e=this;this.hasEventOnClick||(this.hasEventOnClick=!0,this.setInteractive({useHandCursor:!0}),this.on(Phaser.Input.Events.POINTER_DOWN,(function(){e.onClickPiece()})))},n.onClickPiece=function(){this.scene.addPieceDataPicked({index:this.scene.listPiecesDataPicked.length-1,name:this.payload.name,data:this.getDeepCode2DArray(this.payload.data),item:this.getItemData(this.payload.data)}),this.scene.undoManager.receiveCommand({event:Vb,object:{index:this.scene.listPiecesDataPicked.length-1,name:this.payload.name,data:this.getDeepCode2DArray(this.payload.data),item:this.getItemData(this.payload.data)},prevState:void 0,currentState:void 0}),this.scene.piecesPicked.showPiecesPicked()},n.getItemData=function(e){return $l()(Array(e.length),(function(t){var n;return Da()(n=Array(e[0].length)).call(n,0)}))},n.getDeepCode2DArray=function(e){for(var t=[],n=0;n<e.length;n++){var i;t[n]=lt()(i=e[n]).call(i)}return t},t}(Phaser.GameObjects.Container),bP=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.listItem=void 0,n.scene=t,n.createItems(),n.scene.add.existing((0,ka.A)(n)),n}(0,_.A)(t,e);var n=t.prototype;return n.updateInfo=function(e){for(var t=0;t<this.listItem.length;t++)this.listItem[t].updateInfo(e.item[t])},n.createItems=function(){this.listItem=[];for(var e=0;e<3;e++)this.listItem.push(new SP(this.scene));var t=this.listItem[0].width,n=this.listItem[0].height;this.setSize(200,n),this.add(this.listItem);for(var i=(200-3*t-10)/2,a=t/2-100+5+i,s=0;s<this.listItem.length;s++)this.listItem[s].setPosition(a+s*t+(s-1)*i,0)},t}(Phaser.GameObjects.Container),PP=Fa.A.DEFAULT_TOOL,CP=PP.KEY,wP=PP.FRAME,IP=function(e){function t(t,n,i,a,s){var r;return(r=e.call(this,t,n,i)||this).top=void 0,r.mid=void 0,r.bottom=void 0,r.setSize(a,s),r.setDepth(Na.A.POPUP),r.createPopup(),r.scene.add.existing((0,ka.A)(r)),r}(0,_.A)(t,e);var n=t.prototype;return n.createPopup=function(){this.createPopupImages(),this.updatePopupSize(),this.alignPopupImages()},n.createPopupImages=function(){this.top=this.scene.add.image(0,0,CP,wP.POPUP_TOP_2),this.mid=this.scene.add.image(0,0,CP,wP.POPUP_MID_2),this.bottom=this.scene.add.image(0,0,CP,wP.POPUP_BOTTOM_2),this.add([this.top,this.mid,this.bottom])},n.updatePopupSize=function(){var e=this.width*this.top.height/this.top.width;this.top.setWorldSize(this.width,e),this.bottom.setWorldSize(this.width,this.width*this.bottom.height/this.bottom.width),this.mid.setWorldSize(this.width,this.height-this.top.displayHeight-this.bottom.displayHeight)},n.alignPopupImages=function(){Phaser.Display.Align.In.Center(this.top,this,0,-this.mid.displayHeight/2-this.top.displayHeight/2),Phaser.Display.Align.In.Center(this.mid,this),Phaser.Display.Align.In.Center(this.bottom,this,0,this.mid.displayHeight/2+this.bottom.displayHeight/2)},n.setFrameTop=function(e,t,n){t||(t=this.top.displayWidth),n||(n=this.top.displayHeight),this.top.setFrame(e),this.top.setWorldSize(t,n)},n.setSizePopup=function(e,t){this.top.destroy(),this.mid.destroy(),this.bottom.destroy(),this.setSize(e,t),this.createPopup()},(0,ve.A)(t,[{key:"onClose",set:function(e){this.setInteractive({useHandCursor:!0}),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,e)}}]),t}(Phaser.GameObjects.Container),xP=IP,kP=Fa.A.DEFAULT_TOOL,OP=kP.KEY,_P=kP.FRAME,RP=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).scene=void 0,s.popup=void 0,s.buttonClose=void 0,s.title=void 0,s.contents=void 0,s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.handleClose=function(){s.runCloseAnimation()},s.scene=t,s.createPopup(),s.createTitle(),s.createReuseScroller(),s.addItem(),s.createInput(),s.arrangeItems(),s.setDepth(Ua.Ae.POPUP),s.background.setAlpha(.5),s}(0,_.A)(t,e);var n=t.prototype;return n.open=function(){e.prototype.open.call(this),this.runOpenAnimation()},n.createReuseScroller=function(){var e=new jd(this.scene,{classType:bP,listConfigs:[],width:310,height:385,padding:0,marginTop:0,marginBottom:0});this.scene.renderer instanceof Phaser.Renderer.WebGL.WebGLRenderer&&e.createBound(Fa.A.DEFAULT.KEY,Fa.A.DEFAULT.FRAME.BLANK,40,16643027),e.setPosition(0,0),e.createMask(),this.popup.add(e);for(var t=[],n=[],i=0;i<iS.length;i++){var a=iS[i];n.push(a),(i+1)%3===0&&(t.push({item:n}),n=[])}e.updateConfig(t),e.setEnable(!0)},n.createInput=function(){this.buttonClose.onClick=this.handleClose},n.createPopup=function(){this.popup=new xP(this.scene,0,0,320,400),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone,0,10)},n.createTitle=function(){this.title=this.scene.add.container(),this.buttonClose=new Va.A(this.scene,OP,_P.BUTTON_CLOSE_2,19.5,19.5),this.buttonClose.setName("Close"),this.title.add([this.buttonClose]),this.popup.add(this.title),Phaser.Display.Align.In.Center(this.buttonClose,this.title,150,-10)},n.addItem=function(){this.popup.add([]),this.contents=this.scene.add.group(),this.contents.addMultiple([])},n.arrangeItems=function(){Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.runOpenAnimation=function(){var e;null!=(e=this.popupShowUpAnimation)&&null!=(e=e.tween)&&e.isPlaying()||(this.scene.audio.playSound(ja.A.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300),this.runPopupContentEntrancesAnimation(200,300))},n.runCloseAnimation=function(){var e;null!=(e=this.popupFadeOutAnimation)&&null!=(e=e.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(e,t){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new Nh.A({targets:[this.popup],delay:e,duration:t,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(e,t){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new Lh.A({targets:this.contents.getChildren(),duration:t,delay:e,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(e,t){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new Bh.A({targets:[this.popup],delay:e,duration:t,props:{scale:0},ease:Phaser.Math.Easing.Back.In,onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(e,t){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new wo.A({targets:[this.background],delay:e,duration:t,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(e,t){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new Bh.A({targets:[this.background],delay:e,duration:t,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},t}(GameCore.Screen),DP=RP,MP="vertical",BP="horizontal",LP="left",NP="right",GP="top",FP="bottom",UP="l",jP="l_1",VP="l_3",zP="line_2",YP="line_3",HP="line_4",KP="line_5",WP="trapezoid",ZP="triangle",XP="t_piece",JP="cross_piece_2",qP="cross_piece_3",QP="cross_piece_4",$P="cross_piece_5",eC="u_piece",tC={1:{type:"square_1",direction:null,isReverse:!1,data:OT},I2:{type:zP,direction:MP,isReverse:!1,data:ST},I3:{type:YP,direction:MP,isReverse:!1,data:PT},I4:{type:HP,direction:MP,isReverse:!1,data:wT},I5:{type:KP,direction:MP,isReverse:!1,data:xT},II2:{type:zP,direction:BP,isReverse:!1,data:bT},II3:{type:YP,direction:BP,isReverse:!1,data:CT},II4:{type:HP,direction:BP,isReverse:!1,data:IT},II5:{type:KP,direction:BP,isReverse:!1,data:kT},J1:{type:UP,direction:GP,isReverse:!0,data:oT},J2:{type:UP,direction:LP,isReverse:!0,data:AT},J3:{type:UP,direction:FP,isReverse:!0,data:mT},J4:{type:UP,direction:NP,isReverse:!0,data:uT},L1:{type:UP,direction:GP,isReverse:!1,data:rT},L2:{type:UP,direction:NP,isReverse:!1,data:hT},L3:{type:UP,direction:FP,isReverse:!1,data:fT},L4:{type:UP,direction:LP,isReverse:!1,data:yT},O:{type:"square_2",direction:null,isReverse:!1,data:_T},"polyplet-left-2":{type:JP,direction:LP,isReverse:!1,data:HT},"polyplet-left-3":{type:qP,direction:LP,isReverse:!1,data:WT},"polyplet-left-4":{type:QP,direction:LP,isReverse:!1,data:XT},"polyplet-left-5":{type:$P,direction:LP,isReverse:!1,data:qT},"polyplet-right-2":{type:JP,direction:NP,isReverse:!1,data:KT},"polyplet-right-3":{type:qP,direction:NP,isReverse:!1,data:ZT},"polyplet-right-4":{type:QP,direction:NP,isReverse:!1,data:JT},"polyplet-right-5":{type:$P,direction:NP,isReverse:!1,data:QT},S1:{type:WP,direction:"horizontal_right",isReverse:!1,data:BT},S2:{type:WP,direction:"vertical_left",isReverse:!1,data:RT},T1:{type:ZP,direction:GP,isReverse:!1,data:GT},T2:{type:ZP,direction:NP,isReverse:!1,data:NT},T3:{type:ZP,direction:FP,isReverse:!1,data:FT},T4:{type:ZP,direction:LP,isReverse:!1,data:LT},TT1:{type:XP,direction:FP,isReverse:!1,data:zT},TT2:{type:XP,direction:LP,isReverse:!1,data:UT},TT3:{type:XP,direction:GP,isReverse:!1,data:VT},TT4:{type:XP,direction:NP,isReverse:!1,data:jT},U1:{type:eC,direction:GP,isReverse:!1,data:tS},U2:{type:eC,direction:NP,isReverse:!1,data:eS},U3:{type:eC,direction:FP,isReverse:!1,data:nS},U4:{type:eC,direction:LP,isReverse:!1,data:$T},V1:{type:jP,direction:NP,isReverse:!1,data:dT},V2:{type:jP,direction:FP,isReverse:!1,data:gT},V3:{type:jP,direction:GP,isReverse:!1,data:cT},V4:{type:jP,direction:LP,isReverse:!1,data:ET},VV1:{type:VP,direction:NP,isReverse:!1,data:pT},VV2:{type:VP,direction:FP,isReverse:!1,data:vT},VV3:{type:VP,direction:GP,isReverse:!1,data:lT},VV4:{type:VP,direction:LP,isReverse:!1,data:TT},X:{type:"plus_piece",direction:null,isReverse:!1,data:YT},Z1:{type:WP,direction:"horizontal_left",isReverse:!1,data:MT},Z2:{type:WP,direction:"vertical_right",isReverse:!1,data:DT}},nC=Fa.A.GAMEPLAY_TOOL,iC=nC.KEY,aC=nC.FRAME,sC=Fa.A.GAMEPLAY_32.KEY,rC=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.imageGem=void 0,n.imageCheck=void 0,n.text=void 0,n.particle=void 0,n.emitter=void 0,n.currentPosition=void 0,n.imageGlow=void 0,n.tweenGlow=void 0,n.imageGlowCrop=void 0,n.tweenCropMaskTopDown=void 0,n.tweenCropMaskDownBottom=void 0,n.imageStar=void 0,n.tweenShowStar=void 0,n.tweenHideStar=void 0,n.tweenShowMe=void 0,n.scene=t,n.init(),n}(0,_.A)(t,e);var n=t.prototype;return n.init=function(){this.createImageGem(),this.createImageCheck(),this.createText(),this.createParticle(),this.createEmitter(),this.createGlow(),this.createTweenGlow(),this.createGlowCrop(),this.createStar(),this.createTweenStar(),this.createTweenShowMe()},n.createImageGem=function(){this.imageGem=this.scene.make.image({key:sC}),this.imageGem.setWorldSize(22,22),this.add(this.imageGem),Phaser.Display.Align.In.Center(this.imageGem,this,0,-7)},n.createImageCheck=function(){this.imageCheck=this.scene.make.image({key:iC,frame:aC.ICON_CHECK}),this.imageCheck.setWorldSize(22,17),this.imageCheck.setVisible(!1),this.add(this.imageCheck),Phaser.Display.Align.In.Center(this.imageCheck,this.imageGem)},n.createText=function(){this.text=this.scene.make.bitmapText({font:za.A.MIKADO_WHITE_MEDIUM_NUMBER.KEY,size:15,origin:{x:.5,y:.5}}),this.add(this.text),Phaser.Display.Align.In.Center(this.text,this.imageGem,0,21)},n.createParticle=function(){this.particle=this.scene.add.particles(iC).setDepth(Na.A.ON_TOP)},n.createEmitter=function(){var e=1.5/this.scene.world.getPixelRatio();this.emitter=this.particle.createEmitter({on:!1,angle:{start:0,end:360,steps:8},frame:[aC.DUST],lifespan:1e3,quantity:1,scale:{start:e,end:0,ease:"Quart.easeIn"},speed:50})},n.createGlow=function(){this.imageGlow=this.scene.make.image({key:iC,frame:aC.VIOLET_GLOW}),this.imageGlow.setVisible(!1).setScale(0).setAlpha(0),this.add(this.imageGlow),Phaser.Display.Align.In.Center(this.imageGlow,this.imageGem)},n.createTweenGlow=function(){var e=this;this.tweenGlow=this.scene.tweens.add({targets:[this.imageGlow],paused:!0,scale:{from:0,to:.6},alpha:{from:0,to:1},delay:100,duration:600,onComplete:function(){e.imageGlow.setVisible(!1).setScale(0).setAlpha(0),e.playAnimMaskCrop(),e.playAnimStar()}})},n.createGlowCrop=function(){this.imageGlowCrop=this.scene.make.image({key:iC,frame:aC.MASK}),this.imageGlowCrop.setVisible(!1),this.imageGlowCrop.setWorldSize(this.imageGem.displayWidth,this.imageGem.displayHeight),this.add(this.imageGlowCrop),Phaser.Display.Align.In.Center(this.imageGlowCrop,this.imageGem)},n.createStar=function(){this.imageStar=this.scene.make.image({key:iC,frame:aC.ICON_STAR_1}),this.imageStar.setVisible(!1).setScale(0).setAlpha(0),this.imageStar.setWorldSize(27,26),this.add(this.imageStar),Phaser.Display.Align.In.Center(this.imageStar,this.imageGem,-10,-10)},n.createTweenStar=function(){var e=this;this.tweenHideStar=this.scene.add.tween({paused:!0,targets:[this.imageStar],scale:{from:1,to:0},alpha:{from:1,to:0},delay:100,duration:500,onComplete:function(){e.imageStar.setVisible(!1).setScale(0).setAlpha(0)}}),this.tweenShowStar=this.scene.add.tween({paused:!0,targets:[this.imageStar],scale:{from:0,to:1},alpha:{from:0,to:1},delay:100,duration:500,onComplete:function(){e.tweenHideStar.play()}})},n.createTweenShowMe=function(){this.tweenShowMe=this.scene.add.tween({paused:!0,targets:[this],alpha:{from:0,to:1},duration:200})},n.cropTopDownImageGlow=function(){var e=this;if(!this.tweenCropMaskTopDown){var t=this.imageGlowCrop.displayHeight,n=this.imageGlowCrop.displayWidth,i=this.imageGlowCrop.scaleX,a=this.imageGlowCrop.scaleY;this.tweenCropMaskTopDown=this.scene.tweens.addCounter({from:0,to:1,delay:200,duration:300,paused:!0,onUpdate:function(s){var r=s.getValue(0)*t;e.imageGlowCrop.setCrop(0,0,n/i,r/a)},onComplete:function(){e.cropDownBottomImageGlow()}})}this.tweenCropMaskTopDown.play()},n.cropDownBottomImageGlow=function(){var e=this;if(!this.tweenCropMaskDownBottom){var t=this.imageGlowCrop.displayHeight,n=this.imageGlowCrop.displayWidth,i=this.imageGlowCrop.scaleX,a=this.imageGlowCrop.scaleY;this.tweenCropMaskDownBottom=this.scene.tweens.addCounter({from:0,to:1,delay:200,duration:300,paused:!0,onUpdate:function(s){var r=s.getValue(0)*t;e.imageGlowCrop.setCrop(0,r/a,n/i,t/a)}})}this.tweenCropMaskDownBottom.play()},n.playAnimStar=function(){this.imageStar.setVisible(!0),this.tweenShowStar.play()},n.playAnimMaskCrop=function(){this.imageGlowCrop.setVisible(!0).setCrop(0,0,0,0),this.cropTopDownImageGlow()},n.setFrame=function(e){this.imageGem.setFrame(e),this.imageGem.setWorldSize(22,22)},n.getFrame=function(){return this.imageGem.frame.name},n.setText=function(e,t){this.text.setText("x"+t)},n.completeMission=function(){this.imageGem.setAlpha(.3),this.text.setAlpha(.3),this.imageCheck.setVisible(!0)},n.reset=function(){this.imageGem.setAlpha(1),this.text.setAlpha(1),this.imageCheck.setVisible(!1)},n.updateCurrentPosition=function(e){this.currentPosition=e},n.runAnimCollectionItem=function(){var e=this.scene.gameZone.width/2;this.tweenGlow.play(),this.emitter.explode(8,e+this.currentPosition.x,this.currentPosition.y-25)},n.playAnimShowMe=function(){this.setVisible(!0).setAlpha(0),this.tweenShowMe.play()},t}(Phaser.GameObjects.Container),oC=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.target=void 0,n.targetKeys=[],n.jsonPosition={},n.jsonAmount={},n.jsonTarget={},n.jsonCollectItem={},n.background=void 0,n.listCollectItems=[],n.scene=t,n.createBackground(),n}(0,_.A)(t,e);var n=t.prototype;return n.createBackground=function(){this.background=this.scene.add.rectangle(0,0,187,48,0,.75),this.background.setOrigin(.5,.5),this.add(this.background),Phaser.Display.Align.In.Center(this.background,this,0,-1)},n.calcPosition=function(e){for(var t=[],n=200/(e+1),i=n*(e-1)/2,a=0;a<e;a++)t.push(n*a-i);return t},n.parseTargetToJson=function(){if(!(0,Fv.isObject)(this.target)){for(var e=JSON.parse(this.target),t=he()(e),n=this.calcPosition(t.length),i=0;i<t.length;i++){var a=t[i],s=Bb[a];this.targetKeys.push(s),this.jsonAmount[s]=0,this.jsonTarget[s]=e[a],this.jsonPosition[s]={x:n[i],y:68};var r=this.listCollectItems[i];r||(r=new rC(this.scene),this.add(r),this.listCollectItems.push(r)),r.updateCurrentPosition(this.jsonPosition[s]),r.setVisible(!0),r.setX(n[i]),r.setFrame(s),r.setText(0,e[a]),this.jsonCollectItem[s]=r}console.log("this.targetKeys === ",this.targetKeys)}},n.hideListCollectItems=function(){this.listCollectItems.forEach((function(e){e.setVisible(!1),e.reset()}))},n.showListCollectItems=function(){this.listCollectItems.forEach((function(e){e.reset(),e.playAnimShowMe()}))},n.showCollectItemByKey=function(e){var t,n=f()(t=this.listCollectItems).call(t,(function(t){return t.getFrame()===e}));n&&0!==n.length&&(this.jsonAmount[e]>=this.jsonTarget[e]?n[0].completeMission():n[0].reset(),n[0].playAnimShowMe())},n.start=function(){this.parseTargetToJson()},n.setTargets=function(e){var t,n;this.target=Vv()(t=Vv()(n=Vv()(e).call(e,"{",'{"')).call(n,", ",', "')).call(t,":",'":')},n.collectItem=function(e){if(e in this.jsonAmount){this.jsonAmount[e]++;var t=this.jsonAmount[e],n=this.jsonTarget[e];t===n&&this.jsonCollectItem[e].completeMission(),this.jsonCollectItem[e].setText(t,n)}},n.checkCompleteMission=function(){for(var e=he()(this.jsonTarget),t=0;t<e.length;t++){var n=e[t];if(this.jsonTarget[n]>this.jsonAmount[n])return!1}return!0},n.reset=function(){this.hideListCollectItems(),this.targetKeys=[],this.jsonAmount={},this.jsonTarget={},this.jsonCollectItem={},this.jsonPosition={}},n.getPositionCollectionItem=function(e){return this.jsonPosition[e]},n.getTargetKeys=function(){return this.targetKeys},n.getJsonAmount=function(){return this.jsonAmount},n.getJsonTarget=function(){return this.jsonTarget},n.getCollectItemByKey=function(e){return this.jsonCollectItem[e]},n.updateJsonAmountByFen=function(e){this.jsonAmount=JSON.parse(Yt()(e));for(var t=he()(this.jsonTarget),n=0;n<t.length;n++){var i=t[n],a=this.jsonCollectItem[i];this.jsonTarget[i]>this.jsonAmount[i]?a.reset():a.completeMission(),a.setText(this.jsonAmount[i],this.jsonTarget[i])}},n.resetTextAmount=function(){for(var e=he()(this.jsonTarget),t=0;t<e.length;t++){var n=e[t],i=this.listCollectItems[t];i&&i.setText(0,this.jsonTarget[n])}},t}(Phaser.GameObjects.Container),cC=Fa.A.DEFAULT_TOOL,lC=cC.KEY,hC=cC.FRAME,uC=function(e){function t(t){var n;return(n=e.call(this,t,lC,hC.BUTTON_MINOR)||this).button.setWorldSize(51,45),n.setName("Add Target"),n.createIcon(),n}return(0,_.A)(t,e),t.prototype.createIcon=function(){var e=this.scene.make.image({key:lC,frame:hC.ICON_TARGET});e.setWorldSize(25,25),this.add(e),Phaser.Display.Align.In.Center(e,this,0,-1.5)},t}(Va.A),dC=uC,pC=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.collectItems=void 0,n.targetScoreText=void 0,n.saveLevelData=function(){var e=(0,O.A)(D().mark((function e(t){var i,a,s;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.scene.game.globalScene.screen.open(Ua.R8.NOTIFY_SCREEN,{message:"Loading...",duration:0,loading:!0}),i=n.getFileMap(),console.log("saveLevelData",i),n.scene.mapJson=JSON.parse(i),e.prev=4,"https://vietdev.sunstudio.io/write",a="block-puzzle-ocean"+n.scene.modeToSave+"/"+t+".json",console.log("path",a),e.next=10,fetch("https://vietdev.sunstudio.io/write",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:Yt()({path:a,data:i})});case 10:s=e.sent,console.log("result",s),n.scene.game.globalScene.screen.open(Ua.R8.NOTIFY_SCREEN,{message:"Action Successfully",duration:1500,loading:!1}),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(4),console.log(e.t0),n.scene.game.globalScene.screen.open(Ua.R8.NOTIFY_SCREEN,{message:"Action Error",duration:1500,loading:!1});case 19:case"end":return e.stop()}}),e,null,[[4,15]])})));return function(t){return e.apply(this,arguments)}}(),n.scene=t,n.createCollectItems(),n.createTargetScore(),t.add.existing((0,ka.A)(n)),n}(0,_.A)(t,e);var n=t.prototype;return n.createAddTargetButton=function(){var e=new dC(this.scene);e.onClick=this.clickAddTargetButton.bind(this),this.add(e),Phaser.Display.Align.In.Center(e,this,150,0)},n.clickAddTargetButton=function(){this.scene.screen.open(Ua.R8.TARGET_GEM_SCREEN)},n.createCollectItems=function(){this.collectItems=new oC(this.scene),this.collectItems.setVisible(!1),this.add(this.collectItems),Phaser.Display.Align.In.Center(this.collectItems,this,0,0)},n.createTargetScore=function(){this.targetScoreText=this.scene.make.bitmapText({font:za.A.FONT_TEXT_WHITE.KEY,size:this.scene.fontSize(30),origin:{x:.5,y:.5}}),this.add(this.targetScoreText),Phaser.Display.Align.In.Center(this.targetScoreText,this,0,5)},n.updateCollectItems=function(){var e=this.scene.listTargetsDiamond[0].value,t=this.scene.listTargetsDiamond[1].value;if(console.log("type",t),console.log("value",e),this.collectItems.setVisible(!1),this.targetScoreText.setVisible(!1),"collect"==t){if(this.collectItems.setVisible(!0),this.collectItems.reset(),!e)return;this.collectItems.setTargets(e),this.collectItems.start()}"score"==t&&(this.targetScoreText.setVisible(!0),this.targetScoreText.setText(""+e))},n.covertDataPieceToMap=function(){for(var e=this.scene.listPiecesDataPicked,t=[],n=0;n<e.length;n++){var i=e[n],a=i.index,s=i.name,r=i.data,o=this.getInfoGemInPiece(r),c=this.getOriginDataPiece(r),l="";for(var h in tC){var u=tC[h].data;Yt()(c)===Yt()(u)&&(l=h)}var d={gid:-1,id:a,name:s,rotation:-1,type:l,visible:!0,width:-1,height:-1,x:-1,y:-1};o&&(d.properties=[{name:"gem_id",type:"string",value:o.value.toString()},{name:"gem_position",type:"string",value:o.index.toString()}]),t.push(d)}return t},n.getInfoGemInPiece=function(e){for(var t=0,n=0;n<e.length;n++)for(var i=0;i<e[n].length;i++){if(e[n][i]>1)return{index:t,value:e[n][i]};1==e[n][i]&&t++}return null},n.getOriginDataPiece=function(e){for(var t=0;t<e.length;t++)for(var n=0;n<e[t].length;n++)e[t][n]>1&&(e[t][n]=1);return e},n.getFileMap=function(){try{var e=this.scene.cache.json.get("LEVEL-DEFAULT"),t=this.scene.board.convertDataBoardToMap(),n=this.covertDataPieceToMap();return console.log("getFileMap",e.layers[0].data,t),e.layers[0].data=t,e.layers[1].objects=n,e.properties=this.scene.listTargetsDiamond,console.log("levelDefaultJson",e.layers[0].data,e.layers[1].objects,e),Yt()(e)}catch(i){return console.log("error getFileMap",i),""}},t}(Phaser.GameObjects.Container),fC=pC,mC=Fa.A.GAMEPLAY_32,gC=mC.KEY,vC=mC.FRAME,yC=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.index=void 0,n.row=void 0,n.col=void 0,n.item=void 0,n.cell=void 0,n.gemHighlight=void 0,n.hasEventOnClick=!1,n.scene=t,n.scene.add.existing((0,ka.A)(n)),n.setSize(23,23),n.createCell(),n.createGemHighlight(),n.createItem(),n.listenEvents(),n}(0,_.A)(t,e);var n=t.prototype;return n.createCell=function(){this.cell=this.scene.make.image({key:gC,frame:vC.GEM_BLUE}),this.cell.setWorldSize(23,23),this.add(this.cell),Phaser.Display.Align.In.Center(this.cell,this)},n.createGemHighlight=function(){this.gemHighlight=this.scene.make.image({key:gC,frame:vC.GEM_BLUE}),this.gemHighlight.setTintFill(16115807),this.gemHighlight.setWorldSize(this.width,this.height),this.gemHighlight.setVisible(!1),this.add(this.gemHighlight)},n.showHighlight=function(){this.cell.frame.name==vC.GEM&&this.gemHighlight.setVisible(!0)},n.hideHighlight=function(){this.gemHighlight.setVisible(!1)},n.createItem=function(){this.item=this.scene.make.image({key:gC}),this.item.setVisible(!1),this.add(this.item),Phaser.Display.Align.In.Center(this.item,this)},n.listenEvents=function(){var e=this;this.hasEventOnClick||(this.hasEventOnClick=!0,this.setInteractive({useHandCursor:!0}),this.on(Phaser.Input.Events.POINTER_OVER,(function(){e.onHoverCell()})))},n.onHoverCell=function(){var e;if(console.log("onClickCell"),null==(e=this.scene.cellOnPiece)||e.hideHighlight(),!this.scene.panelSelectCell.visible){this.scene.cellOnPiece=this;var t=this.getWorldPosition(),n=t.x,i=t.y;this.scene.panelEditCellOnPiece.open(n,i),this.showHighlight()}},n.setFrameCell=function(e){this.cell.setFrame(e)},n.setIndex=function(e){this.index=e},n.setPositionCellOnPiece=function(e,t){this.row=e,this.col=t},n.setFrameItem=function(e){e&&(this.item.setVisible(!0),this.item.setFrame(e),this.item.setWorldSize(20,20))},t}(Phaser.GameObjects.Container),AC=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.listCells=void 0,i.index=void 0,i.payload=void 0,n&&(i.payload=n),i.scene=t,i.scene.add.existing((0,ka.A)(i)),i.setSize(40,90),i}(0,_.A)(t,e);var n=t.prototype;return n.createCells=function(){var e,t,n=[],i=null==(e=this.payload)?void 0:e.data,a=null==(t=this.payload)?void 0:t.item;if(i)for(var s=0,r=0;r<i.length;r++){n[r]=[];for(var o=0;o<i[r].length;o++)if(i[r][o]){var c=eT(i[r][o]),l=(a[r][o],""),h=new yC(this.scene);h.setFrameCell(c),h.setFrameItem(l),this.add(h),this.listCells.push(h),h.setPosition(23.5*(o-(i[r].length-1)/2),23.5*(r-(i.length-1)/2)),h.setIndex(s),h.setPositionCellOnPiece(r,o),s++}}else this.setVisible(!1)},n.updateInfo=function(e){this.listCells=[],this.payload=e,this.index=e.index,console.log("updateInfo",this.index),this.removeAll(!0),this.createCells()},t}(Phaser.GameObjects.Container),EC=Fa.A.DEFAULT_TOOL,TC=EC.KEY,SC=EC.FRAME,bC=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).scene=void 0,s.popup=void 0,s.title=void 0,s.buttonClose=void 0,s.contents=void 0,s.piece=void 0,s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.handleClose=function(){s.runCloseAnimation()},s.scene=t,s.createPopup(),s.createTitle(),s.createPiece(),s.addItem(),s.createInput(),s.setDepth(Ua.Ae.POPUP),s.background.setAlpha(.5),s}(0,_.A)(t,e);var n=t.prototype;return n.open=function(t){e.prototype.open.call(this,t);var n=this.getData("index"),i=this.getData("name"),a=this.getData("data"),s={index:n,name:i,data:a,item:this.getItemData(a)};this.runOpenAnimation(),this.piece.updateInfo(s)},n.getItemData=function(e){return $l()(Array(e.length),(function(t){var n;return Da()(n=Array(e[0].length)).call(n,0)}))},n.createInput=function(){this.buttonClose.onClick=this.handleClose},n.createPiece=function(){this.piece=new AC(this.scene),this.popup.add(this.piece),Phaser.Display.Align.In.Center(this.piece,this.popup,0,0)},n.createPopup=function(){this.popup=new xf(this.scene,0,0,286,426),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone,0,10)},n.createTitle=function(){this.title=this.scene.add.container(),this.buttonClose=new Va.A(this.scene,TC,SC.BUTTON_CLOSE,35,35),this.buttonClose.setName("Close"),this.title.add([this.buttonClose]),this.popup.add(this.title),Phaser.Display.Align.In.Center(this.buttonClose,this.title,135,-18),Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.addItem=function(){this.popup.add([]),this.contents=this.scene.add.group(),this.contents.addMultiple([])},n.runOpenAnimation=function(){var e;null!=(e=this.popupShowUpAnimation)&&null!=(e=e.tween)&&e.isPlaying()||(this.scene.audio.playSound(ja.A.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300),this.runPopupContentEntrancesAnimation(200,300))},n.runCloseAnimation=function(){var e;null!=(e=this.popupFadeOutAnimation)&&null!=(e=e.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(e,t){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new Nh.A({targets:[this.popup],delay:e,duration:t,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(e,t){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new Lh.A({targets:this.contents.getChildren(),duration:t,delay:e,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(e,t){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new Bh.A({targets:[this.popup],delay:e,duration:t,props:{scale:0},ease:Phaser.Math.Easing.Back.In,onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(e,t){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new wo.A({targets:[this.background],delay:e,duration:t,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(e,t){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new Bh.A({targets:[this.background],delay:e,duration:t,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},t}(GameCore.Screen),PC=Fa.A.GAMEPLAY_32,CC=PC.KEY,wC=PC.FRAME,IC=function(e){function t(t){var n;return(n=e.call(this,t,CC,wC.GEM_HIGHT_LIGHT)||this).icon=void 0,n.button.setWorldSize(53,53),n.setName("Gem Block"),n.createText(),n.createIcon(),n}(0,_.A)(t,e);var n=t.prototype;return n.createText=function(){var e=this.scene.make.bitmapText({font:za.A.FONT_TEXT_WHITE.KEY,size:this.scene.fontSize(60),text:"?",origin:{x:.5,y:.5}});this.add(e),Phaser.Display.Align.In.Center(e,this,0,2)},n.createIcon=function(){this.icon=this.scene.make.image({key:CC}),this.icon.setVisible(!1),this.add(this.icon),Phaser.Display.Align.In.Center(this.icon,this,0,-1.5)},n.setFrameIcon=function(e){this.icon.setVisible(!0),this.icon.setFrame(e),this.icon.setWorldSize(30,30)},t}(Va.A),xC=Fa.A.DEFAULT_TOOL,kC=xC.KEY,OC=xC.FRAME,_C=Fa.A.GAMEPLAY_32,RC=_C.KEY,DC=_C.FRAME,MC=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.gemBlock=void 0,n.buttonDelete=void 0,n.payload=void 0,n.textAmountGem=void 0,n.gemTarget=void 0,n.amountGem=void 0,n.index=void 0,n.amountGem=0,n.scene=t,n.setSize(286,65),n.addButton(),n.createIconGemTarget(),n.createTextAmountGem(),n.createButtonArrowUp(),n.createButtonArrowDown(),n.createButtonDelete(),n}(0,_.A)(t,e);var n=t.prototype;return n.addButton=function(){this.gemBlock=new IC(this.scene),this.add(this.gemBlock),Phaser.Display.Align.In.Center(this.gemBlock,this,-70)},n.createIconGemTarget=function(){this.gemTarget=this.scene.make.image({key:RC,frame:DC.GEM}),this.gemTarget.setWorldSize(40,40),this.gemTarget.setVisible(!1),this.gemBlock.add(this.gemTarget)},n.createTextAmountGem=function(){this.textAmountGem=this.scene.make.bitmapText({font:za.A.FONT_TEXT_WHITE.KEY,size:this.scene.fontSize(80),origin:{x:.5,y:.5},text:this.amountGem.toString()}),this.add(this.textAmountGem),Phaser.Display.Align.In.Center(this.textAmountGem,this,-5,3)},n.createButtonArrowUp=function(){var e=new Va.A(this.scene,kC,OC.ICON_DOWNWARD_ARROW,32,32);e.onClick=this.increaseTextAmountGem.bind(this),e.button.setTintFill(16777215),e.button.setFlipY(!0),this.add(e),Phaser.Display.Align.In.Center(e,this,40,-10)},n.createButtonArrowDown=function(){var e=new Va.A(this.scene,kC,OC.ICON_DOWNWARD_ARROW,32,32);e.onClick=this.decreaseTextAmountGem.bind(this),e.button.setTintFill(16777215),this.add(e),Phaser.Display.Align.In.Center(e,this,40,10)},n.createButtonDelete=function(){this.buttonDelete=new Va.A(this.scene,kC,OC.BUTTON_CLOSE,32,32),this.buttonDelete.button.setTint(16515847),this.buttonDelete.onClick=this.clickButtonDelete.bind(this),this.add(this.buttonDelete),Phaser.Display.Align.In.Center(this.buttonDelete,this,100,0)},n.clickButtonDelete=function(){var e;_a()(e=this.scene.listGemBlockData).call(e,this.payload.index,1),this.parentContainer.updateConfig(this.scene.listGemBlockData),this.resetIndex()},n.resetIndex=function(){for(var e=0;e<this.scene.listGemBlockData.length;e++)this.scene.listGemBlockData[e].index=e},n.increaseTextAmountGem=function(){this.amountGem++,this.textAmountGem.setText(this.amountGem.toString()),this.scene.listGemBlockData[this.payload.index].amount=this.amountGem},n.decreaseTextAmountGem=function(){this.amountGem&&(this.amountGem--,this.textAmountGem.setText(this.amountGem.toString()),this.scene.listGemBlockData[this.payload.index].amount=this.amountGem)},n.setIndex=function(e){this.index=e},n.getIndex=function(){return this.index},n.setFrameIconGemTarget=function(e){""!=e?(this.scene.listGemBlockData[this.payload.index].frame=e,this.gemTarget.setVisible(!0),this.gemTarget.setFrame(e)):this.gemTarget.setVisible(!1)},n.hideIconGemTarget=function(){this.gemTarget.setVisible(!1),this.gemTarget.setFrame("")},n.getFrameIconGemTarget=function(){return this.gemTarget.frame.name},n.getAmountGem=function(){return this.amountGem},n.hasGemTarget=function(){return""!=this.gemTarget.frame.name&&this.gemTarget.frame.name!=DC.GEM},n.updateInfo=function(e){this.payload=e,this.setFrameIconGemTarget(this.payload.frame),this.amountGem=this.payload.amount,this.textAmountGem.setText(this.amountGem.toString()),this.setVisible(!0)},t}(Phaser.GameObjects.Container),BC=MC,LC=Fa.A.DEFAULT_TOOL,NC=LC.KEY,GC=LC.FRAME,FC=function(e){function t(t){var n;return(n=e.call(this,t,NC,GC.BUTTON_GREEN_BIG,120,54)||this).setName("Add Gem"),n.createText(),n}return(0,_.A)(t,e),t.prototype.createText=function(){var e=this.scene.make.bitmapText({font:za.A.FONT_TEXT_WHITE.KEY,size:this.scene.fontSize(40),text:"Target Gem",origin:{x:.5,y:.5}});this.add(e)},t}(Va.A);function UC(e,t){var n="undefined"!==typeof ud()&&pd()(e)||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){var n;if(!e)return;if("string"===typeof e)return jC(e,t);var i=lt()(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return $l()(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return jC(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function jC(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var VC=Fa.A.DEFAULT_TOOL,zC=VC.KEY,YC=VC.FRAME,HC=Fa.A.GAMEPLAY_32,KC=HC.KEY,WC=(HC.FRAME,Fa.A.EDITOR),ZC=WC.KEY,XC=WC.FRAME,JC=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).scene=void 0,s.gemBlockIndex=void 0,s.textTargetScore=void 0,s.popup=void 0,s.popupSelectTarget=void 0,s.buttonClose=void 0,s.buttonSetScore=void 0,s.buttonTargetGem=void 0,s.clearItemButton=void 0,s.targetScoreText=void 0,s.title=void 0,s.targetScoreContainer=void 0,s.contents=void 0,s.gemBlocksPool=[],s.scroller=void 0,s.gemBlockSelected=void 0,s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.clickButtonDelete=function(e){return function(){var t;s.gemBlocksPool[e].setVisible(!1),s.gemBlocksPool[e].hideIconGemTarget();var n=s.gemBlocksPool[e];_a()(t=s.gemBlocksPool).call(t,e,1),s.gemBlocksPool.push(n),s.alignGemBlocksPool()}},s.showPopupSelectTarget=function(e){return function(){s.gemBlockSelected=e,s.popupSelectTarget.setVisible(!0)}},s.handleClose=function(){s.runCloseAnimation(),s.updateListTargetsDiamond(),s.scene.header.updateCollectItems()},s.handleClean=function(){var e=s.scene,t=e.boardPositionBlockSelected,n=e.board;t&&(n.dataBoard[t.x][t.y].blockItem.reset(),s.close())},s.clickNumber=function(e){return function(){if("0"!=e||""!=s.textTargetScore){var t=s.textTargetScore;t+=e,s.textTargetScore=t,s.updateTargetScoreText()}}},s.clickGem=function(e){return function(){s.gemBlockSelected.setFrameIconGemTarget(e),s.popupSelectTarget.setVisible(!1)}},s.scene=t,s.textTargetScore="",s.createPopup(),s.createPopupSelectTarget(),s.createTargetsDiamond(),s.createButton(),s.createNumberScore(),s.createTextScore(),s.createTargetScore(),s.createTitle(),s.createGemBlocksPool(),s.createReuseScroller(),s.addItem(),s.createInput(),s.setDepth(Ua.Ae.POPUP),s.background.setAlpha(.5),s}(0,_.A)(t,e);var n=t.prototype;return n.open=function(){e.prototype.open.call(this);var t=this.scene.listTargetsDiamond[0].value,n=this.scene.listTargetsDiamond[1].value;t&&n||(this.clearGemBlock(),this.clearTargetScore()),this.runOpenAnimation()},n.createReuseScroller=function(){this.scroller=new jd(this.scene,{classType:BC,listConfigs:[],width:286,height:260,padding:0,marginTop:0,marginBottom:0}),this.scene.renderer instanceof Phaser.Renderer.WebGL.WebGLRenderer&&this.scroller.createBound(Fa.A.DEFAULT.KEY,Fa.A.DEFAULT.FRAME.BLANK,40,16643027),this.scroller.createMask(),this.scroller.setPosition(0,-25),this.popup.add(this.scroller)},n.updateData=function(){console.log("this.listGemBlockData",this.scene.listGemBlockData),this.scroller.updateConfig(this.scene.listGemBlockData),this.scroller.setEnable(!0),this.setEventGemBlock()},n.createTargetScore=function(){this.targetScoreText=this.scene.make.bitmapText({font:za.A.FONT_TEXT_WHITE.KEY,size:this.scene.fontSize(80),origin:{x:.5,y:.5}}),this.targetScoreText.setLetterSpacing(10),this.targetScoreText.setCenterAlign(),this.targetScoreText.setVisible(!1),this.popup.add(this.targetScoreText),Phaser.Display.Align.In.Center(this.targetScoreText,this.popup,0,-90)},n.updateTargetScoreText=function(){this.targetScoreText.setVisible(!0),this.targetScoreText.setText(this.textTargetScore),this.targetScoreText.setCenterAlign()},n.createButtonAdd=function(){this.buttonTargetGem=new FC(this.scene),this.buttonTargetGem.onClick=this.clickButtonTargetGem.bind(this),this.popup.add(this.buttonTargetGem),Phaser.Display.Align.In.Center(this.buttonTargetGem,this.popup,-70,150)},n.createButtonSetScore=function(){this.buttonSetScore=new Va.A(this.scene,zC,YC.BUTTON_DARK_BLUE_BIG,120,54),this.buttonSetScore.onClick=this.clickButtonTargetScore.bind(this);var e=this.scene.make.bitmapText({font:za.A.FONT_TEXT_WHITE.KEY,size:this.scene.fontSize(40),text:"Target Score",origin:{x:.5,y:.5}});this.buttonSetScore.add(e),this.popup.add(this.buttonSetScore),Phaser.Display.Align.In.Center(this.buttonSetScore,this.popup,70,150)},n.clickButtonTargetScore=function(){this.title.setText("Target Score"),this.scene.listGemBlockData=[],this.scroller.updateConfig(this.scene.listGemBlockData),this.clearGemBlock(),this.targetScoreContainer.setVisible(!0),this.targetScoreText.setVisible(!0)},n.clickButtonTargetGem=function(){this.title.setText("Target Gem"),this.clearTargetScore(),this.targetScoreContainer.setVisible(!1);var e=this.scene.listGemBlockData.length;this.scene.listGemBlockData.push({index:e,frame:"",amount:0}),this.updateData()},n.clearTargetScore=function(){this.targetScoreText.setVisible(!1),this.textTargetScore=""},n.createGemBlocksPool=function(){for(var e=0;e<6;e++){var t=new BC(this.scene);t.setIndex(this.gemBlocksPool.length),t.buttonDelete.onClick=this.clickButtonDelete(t.getIndex()),t.setVisible(!1),this.gemBlocksPool.push(t),this.popup.add(t)}this.alignGemBlocksPool()},n.clearGemBlock=function(){for(var e=0;e<this.gemBlocksPool.length;e++){this.gemBlocksPool[e].setVisible(!1)}this.scene.resetTarget()},n.alignGemBlocksPool=function(){for(var e=0,t=0;t<this.gemBlocksPool.length;t++){var n=this.gemBlocksPool[t];n.visible?n.setPosition(0,70*(t-e)-200):e++}},n.createButtonClear=function(){this.clearItemButton=new aP(this.scene),this.clearItemButton.setVisible(!1),this.popup.add(this.clearItemButton)},n.createButton=function(){this.createButtonAdd(),this.createButtonClear(),this.createButtonSetScore()},n.createInput=function(){this.buttonClose.onClick=this.handleClose,this.clearItemButton.onClick=this.handleClean},n.updateListTargetsDiamond=function(){if(this.targetScoreText.visible)return""==this.textTargetScore?(this.scene.listTargetsDiamond[0].value="",void(this.scene.listTargetsDiamond[1].value="")):(this.scene.listTargetsDiamond[0].value=this.textTargetScore,this.scene.listTargetsDiamond[1].value="score",void console.log("listTargetsDiamond",this.scene.listTargetsDiamond));for(var e,t="{",n=UC(this.getGemBlocks());!(e=n()).done;){var i=e.value;if(i.visible&&i){var a=i.getFrameIconGemTarget(),s=i.getAmountGem(),r=$E(a);0!=s&&i.hasGemTarget()&&(t+=r+": "+s+", ")}}if("{}"==(t=(t+="}").replace(", }","}")))return this.scene.listTargetsDiamond[0].value="",this.scene.listTargetsDiamond[1].value="",void console.log("listTargetsDiamond",this.scene.listTargetsDiamond);console.log("target",t),this.scene.listTargetsDiamond[0].value=t,this.scene.listTargetsDiamond[1].value="collect",console.log("listTargetsDiamond",this.scene.listTargetsDiamond)},n.getGemBlocks=function(){return this.scroller.getChildren()},n.createPopup=function(){this.popup=new xP(this.scene,0,0,286,423),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone,0,10)},n.createPopupSelectTarget=function(){this.popupSelectTarget=this.scene.add.container(),this.popupSelectTarget.setSize(286,90);var e=this.scene.make.image({key:ZC,frame:XC.POPUP});e.setTintFill(7696744),e.setWorldSize(286,90),e.setAlpha(.85),this.popupSelectTarget.add(e),this.popupSelectTarget.setVisible(!1);var t=new Va.A(this.scene,zC,YC.BUTTON_CLOSE_2,19.5,19.5);t.onClick=this.hidePopupSelectTarget.bind(this),t.setName("Close"),this.popupSelectTarget.add(t),this.add(this.popupSelectTarget),Phaser.Display.Align.In.TopRight(t,this.popupSelectTarget,0,10),Phaser.Display.Align.In.Center(this.popupSelectTarget,this.zone,0,0)},n.hidePopupSelectTarget=function(){this.popupSelectTarget.setVisible(!1)},n.createTextScore=function(){var e=new Va.A(this.scene,zC,YC.BUTTON_CIRCLE,30,30),t=this.scene.make.bitmapText({font:za.A.FONT_TEXT_WHITE.KEY,size:this.scene.fontSize(40),text:"X",origin:{x:.5,y:.5}});t.setTint(16515847),e.onClick=this.clickDelete.bind(this),e.add(t),Phaser.Display.Align.In.Center(t,e,0,2),this.targetScoreContainer.add(e),Phaser.Display.Align.In.Center(e,this.popup,0,85)},n.createNumberScore=function(){this.targetScoreContainer=this.scene.add.container();for(var e=0,t=100,n=0;n<10;n++){var i=new Va.A(this.scene,zC,YC.BUTTON_CIRCLE,30,30),a=this.scene.make.bitmapText({font:za.A.FONT_TEXT_WHITE.KEY,size:this.scene.fontSize(40),text:n.toString(),origin:{x:.5,y:.5}});n>4&&(e=50,t=350),i.onClick=this.clickNumber(n.toString()),i.add(a),Phaser.Display.Align.In.Center(a,i,0,2),this.targetScoreContainer.add(i),i.setPosition(50*n-t,e)}this.targetScoreContainer.setVisible(!1),this.popup.add(this.targetScoreContainer)},n.clickDelete=function(){var e=this.textTargetScore;e=lt()(e).call(e,0,-1),this.textTargetScore=e,this.updateTargetScoreText()},n.createTargetsDiamond=function(){for(var e=0;e<QE.length;e++){var t=QE[e],n=new Va.A(this.scene,KC,t,30,30);n.onClick=this.clickGem(t),this.popupSelectTarget.add(n),n.setPosition(40*e-100,0)}},n.setEventGemBlock=function(){for(var e,t=UC(this.scroller.getChildren());!(e=t()).done;){var n=e.value;n.gemBlock.onClick=this.showPopupSelectTarget(n)}},n.createTitle=function(){this.title=this.scene.make.bitmapText({font:za.A.FONT_TEXT_WHITE.KEY,size:this.scene.fontSize(65),origin:{x:.5,y:.5},text:"Select Target"}),this.title.setTintFill(16777215),this.buttonClose=new Va.A(this.scene,zC,YC.BUTTON_CLOSE_2,19.5,19.5),this.buttonClose.setName("Close"),this.popup.add([this.title,this.buttonClose]),Phaser.Display.Align.In.TopCenter(this.title,this.popup),Phaser.Display.Align.In.TopRight(this.buttonClose,this.popup,0,20)},n.addItem=function(){this.popup.add([]),this.contents=this.scene.add.group(),this.contents.addMultiple([])},n.runOpenAnimation=function(){var e;null!=(e=this.popupShowUpAnimation)&&null!=(e=e.tween)&&e.isPlaying()||(this.scene.audio.playSound(ja.A.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300),this.runPopupContentEntrancesAnimation(200,300))},n.runCloseAnimation=function(){var e;null!=(e=this.popupFadeOutAnimation)&&null!=(e=e.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(e,t){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new Nh.A({targets:[this.popup],delay:e,duration:t,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(e,t){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new Lh.A({targets:this.contents.getChildren(),duration:t,delay:e,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(e,t){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new Bh.A({targets:[this.popup],delay:e,duration:t,props:{scale:0},ease:Phaser.Math.Easing.Back.In,onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(e,t){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new wo.A({targets:[this.background],delay:e,duration:t,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(e,t){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new Bh.A({targets:[this.background],delay:e,duration:t,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},t}(GameCore.Screen),qC=Fa.A.DEFAULT_TOOL,QC=qC.KEY,$C=qC.FRAME,ew=function(e){function t(t){var n;return(n=e.call(this,t,QC,$C.BUTTON_MINOR)||this).button.setWorldSize(62,53),n.setName("Setting"),n.createIcon(),n}return(0,_.A)(t,e),t.prototype.createIcon=function(){var e=this.scene.make.image({key:QC,frame:$C.ICON_RETRY});e.setWorldSize(30,30),this.add(e),Phaser.Display.Align.In.Center(e,this,0,-1.5)},t}(Va.A),tw=ew,nw=Fa.A.DEFAULT_TOOL,iw=nw.KEY,aw=nw.FRAME,sw=function(e){function t(t){var n;return(n=e.call(this,t,iw,aw.BUTTON_MINOR)||this).button.setWorldSize(62,53),n.setName("Setting"),n.createIcon(),n}return(0,_.A)(t,e),t.prototype.createIcon=function(){var e=this.scene.make.image({key:iw,frame:aw.ICON_DOWNLOAD});e.setWorldSize(30,30),this.add(e),Phaser.Display.Align.In.Center(e,this,0,-1.5)},t}(Va.A),rw=sw,ow=Fa.A.DEFAULT_TOOL,cw=ow.KEY,lw=ow.FRAME,hw=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).scene=void 0,s.popup=void 0,s.title=void 0,s.buttonClose=void 0,s.contents=void 0,s.refreshButton=void 0,s.exportButton=void 0,s.addTargetButton=void 0,s.levelNumberContainer=void 0,s.levelText=void 0,s.textLevel="",s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.handleClose=function(){s.runCloseAnimation()},s.clickNumber=function(e){return function(){if("0"!=e||""!=s.textLevel){var t=s.textLevel;t+=e,s.textLevel=t,s.levelText.setText("level-"+s.textLevel)}}},s.scene=t,s.createPopup(),s.createTitle(),s.createButtons(),s.createLevelNumberInput(),s.addItem(),s.arrangeItems(),s.createInput(),s.setDepth(Ua.Ae.POPUP),s.background.setAlpha(.5),s}(0,_.A)(t,e);var n=t.prototype;return n.open=function(){e.prototype.open.call(this),this.runOpenAnimation()},n.createInput=function(){this.buttonClose.onClick=this.handleClose},n.createPopup=function(){this.popup=new xf(this.scene,0,0,290,250),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone)},n.createTitle=function(){this.title=this.scene.add.container();var e=this.scene.make.image({key:cw,frame:lw.TEXT_SETTING});e.setWorldSize(141,23),this.buttonClose=new Va.A(this.scene,cw,lw.BUTTON_CLOSE,35,35),this.buttonClose.setName("Close"),this.title.add([e,this.buttonClose]),Phaser.Display.Align.In.Center(e,this.title,0,11),Phaser.Display.Align.In.Center(this.buttonClose,this.title,135,-14)},n.createButtons=function(){var e=this.scene.make.bitmapText({font:za.A.FONT_TEXT_WHITE.KEY,size:this.scene.fontSize(30),origin:{x:.5,y:.5},text:"Add Target"}),t=this.scene.make.bitmapText({font:za.A.FONT_TEXT_WHITE.KEY,size:this.scene.fontSize(30),origin:{x:.5,y:.5},text:"Refresh"}),n=this.scene.make.bitmapText({font:za.A.FONT_TEXT_WHITE.KEY,size:this.scene.fontSize(30),origin:{x:.5,y:.5},text:"Save"});this.exportButton=new rw(this.scene),this.exportButton.onClick=this.clickExportButton.bind(this),this.refreshButton=new tw(this.scene),this.refreshButton.onClick=this.clickResetButton.bind(this),this.addTargetButton=new dC(this.scene),this.addTargetButton.onClick=this.clickAddTargetButton.bind(this),this.popup.add([this.refreshButton,this.exportButton,this.addTargetButton]),this.popup.add([e,t,n]),Phaser.Display.Align.In.Center(this.refreshButton,this,0),Phaser.Display.Align.In.Center(this.exportButton,this,80),Phaser.Display.Align.In.Center(this.addTargetButton,this,-80),Phaser.Display.Align.In.Center(t,this,0,40),Phaser.Display.Align.In.Center(n,this,80,40),Phaser.Display.Align.In.Center(e,this,-80,40)},n.clickResetButton=function(){this.scene.board.reset(),this.scene.resetPieces(),this.scene.resetTarget()},n.clickAddTargetButton=function(){this.close(),this.scene.screen.open(Ua.R8.TARGET_GEM_SCREEN)},n.clickExportButton=function(){var e=(0,O.A)(D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.checkValidData()){e.next=3;break}return this.scene.game.globalScene.screen.open(Ua.R8.NOTIFY_SCREEN,{message:"Data Incorrect",duration:1500,loading:!1}),e.abrupt("return");case 3:return this.levelNumberContainer.setVisible(!0),this.scene.isSetLevelName=!0,e.abrupt("return");case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.checkValidData=function(){var e=this.scene.listTargetsDiamond[0].value,t=this.scene.listTargetsDiamond[1].value;if(!e||!t)return!1;if("score"==t)return!0;var n=this.scene.board.convertDataBoardToMap(),i=!1;return n.forEach((function(e){0!=e&&(i=!0)})),!!i},n.createLevelNumberInput=function(){this.levelNumberContainer=this.scene.add.container();var e=new xf(this.scene,0,0,300,350);this.levelNumberContainer.add(e);var t=-10,n=100;this.levelText=this.scene.make.bitmapText({font:za.A.FONT_TEXT_WHITE.KEY,size:this.scene.fontSize(100),text:"level-",origin:{x:.5,y:.5}}),this.levelNumberContainer.add(this.levelText);for(var i=0;i<10;i++){var a=new Va.A(this.scene,cw,lw.BUTTON_CIRCLE,30,30),s=this.scene.make.bitmapText({font:za.A.FONT_TEXT_WHITE.KEY,size:this.scene.fontSize(40),text:i.toString(),origin:{x:.5,y:.5}});i>4&&(t=40,n=350),a.onClick=this.clickNumber(i.toString()),a.add(s),Phaser.Display.Align.In.Center(s,a,0,2),this.levelNumberContainer.add(a),a.setPosition(50*i-n,t)}var r=new Va.A(this.scene,cw,lw.BUTTON_CIRCLE,30,30),o=this.scene.make.bitmapText({font:za.A.FONT_TEXT_WHITE.KEY,size:this.scene.fontSize(40),text:"X",origin:{x:.5,y:.5}});o.setTint(16515847),r.onClick=this.clickDelete.bind(this),r.add(o),Phaser.Display.Align.In.Center(o,r,0,2),this.levelNumberContainer.add(r),Phaser.Display.Align.In.Center(r,this.levelNumberContainer,0,85),this.levelNumberContainer.setVisible(!1).setDepth(Na.A.ON_TOP),this.popup.add(this.levelNumberContainer),this.createTitlePopup(),Phaser.Display.Align.In.Center(this.levelText,this.levelNumberContainer,0,-75);var c=new Va.A(this.scene,cw,lw.BUTTON_MINOR,41,35.5),l=this.scene.make.bitmapText({font:za.A.FONT_TEXT_WHITE.KEY,size:this.scene.fontSize(40),text:"OK",origin:{x:.5,y:.5}});c.onClick=this.clickButtonOK.bind(this),c.add(l),this.levelNumberContainer.add(c),Phaser.Display.Align.In.Center(c,this.levelNumberContainer,0,125),Phaser.Display.Align.In.Center(this.levelNumberContainer,this.popup,0,0)},n.createTitlePopup=function(){var e=this.scene.make.bitmapText({font:za.A.FONT_TEXT_WHITE.KEY,size:this.scene.fontSize(65),origin:{x:.5,y:.5},text:"Input Number Level"}),t=new Va.A(this.scene,cw,lw.BUTTON_CLOSE,35,35);t.setName("Close"),t.onClick=this.closeLevelNumberContainer.bind(this),this.levelNumberContainer.add([e,t]),Phaser.Display.Align.In.Center(e,this.levelNumberContainer,0,-160),Phaser.Display.Align.In.Center(t,this.levelNumberContainer,145,-185)},n.closeLevelNumberContainer=function(){this.scene.isSetLevelName=!1,this.levelNumberContainer.setVisible(!1)},n.clickDelete=function(){if(""!=this.textLevel){var e=this.textLevel;e=lt()(e).call(e,0,-1),this.textLevel=e,this.levelText.setText("level-"+this.textLevel)}},n.clickButtonOK=function(){var e=(0,O.A)(D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.scene.header.saveLevelData(this.levelText.text);case 2:this.closeLevelNumberContainer();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.addItem=function(){this.popup.add([this.title]),this.contents=this.scene.add.group(),this.contents.addMultiple([])},n.arrangeItems=function(){Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.runOpenAnimation=function(){var e;null!=(e=this.popupShowUpAnimation)&&null!=(e=e.tween)&&e.isPlaying()||(this.scene.audio.playSound(ja.A.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300),this.runPopupContentEntrancesAnimation(200,300))},n.runCloseAnimation=function(){var e;null!=(e=this.popupFadeOutAnimation)&&null!=(e=e.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(e,t){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new Nh.A({targets:[this.popup],delay:e,duration:t,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(e,t){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new Lh.A({targets:this.contents.getChildren(),duration:t,delay:e,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(e,t){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new Bh.A({targets:[this.popup],delay:e,duration:t,props:{scale:0},onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(e,t){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new wo.A({targets:[this.background],delay:e,duration:t,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(e,t){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new Bh.A({targets:[this.background],delay:e,duration:t,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},t}(GameCore.Screen),uw=hw,dw=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.payload=void 0,i.hasEventOnClick=!1,n&&(i.payload=n),i.scene=t,i.scene.add.existing((0,ka.A)(i)),i.setSize(40,90),i}(0,_.A)(t,e);var n=t.prototype;return n.createCells=function(){var e,t=[],n=null==(e=this.payload)?void 0:e.data;if(n)for(var i=0;i<n.length;i++){t[i]=[];for(var a=0;a<n[i].length;a++)if(n[i][a]){var s=new TP(this.scene);this.add(s),s.setPosition(14*(a-(n[i].length-1)/2),14*(i-(n.length-1)/2))}}else this.setVisible(!1)},n.updateInfo=function(e){this.payload=e,this.removeAll(!0),this.createCells(),this.listenEvents()},n.listenEvents=function(){var e=this;this.hasEventOnClick||(this.hasEventOnClick=!0,this.setInteractive({useHandCursor:!0}),this.on(Phaser.Input.Events.POINTER_DOWN,(function(){e.onClickPiece()})))},n.onClickPiece=function(){this.scene.panelChangePiece.close(),this.scene.undoManager.receiveCommand({event:Yb,object:void 0,prevState:{index:this.scene.indexPiece,name:this.scene.listPiecesDataPicked[this.scene.indexPiece].name,data:this.scene.listPiecesDataPicked[this.scene.indexPiece].data,item:this.scene.listPiecesDataPicked[this.scene.indexPiece].item},currentState:{index:this.scene.indexPiece,name:this.payload.name,data:this.getDeepCode2DArray(this.payload.data),item:this.getItemData(this.payload.data)}}),this.scene.listPiecesDataPicked[this.scene.indexPiece].name=this.payload.name,this.scene.listPiecesDataPicked[this.scene.indexPiece].data=this.getDeepCode2DArray(this.payload.data),this.scene.listPiecesDataPicked[this.scene.indexPiece].item=this.getItemData(this.payload.data),this.scene.piecesPicked.showPiecesPicked()},n.getItemData=function(e){return $l()(Array(e.length),(function(t){var n;return Da()(n=Array(e[0].length)).call(n,0)}))},n.getDeepCode2DArray=function(e){for(var t=[],n=0;n<e.length;n++){var i;t[n]=lt()(i=e[n]).call(i)}return t},t}(Phaser.GameObjects.Container),pw=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.listItem=void 0,n.scene=t,n.createItems(),n.scene.add.existing((0,ka.A)(n)),n}(0,_.A)(t,e);var n=t.prototype;return n.updateInfo=function(e){for(var t=0;t<this.listItem.length;t++)this.listItem[t].updateInfo(e.item[t])},n.createItems=function(){this.listItem=[];for(var e=0;e<3;e++)this.listItem.push(new dw(this.scene));var t=this.listItem[0].width,n=this.listItem[0].height;this.setSize(200,n),this.add(this.listItem);for(var i=(200-3*t-10)/2,a=t/2-100+5+i,s=0;s<this.listItem.length;s++)this.listItem[s].setPosition(a+s*t+(s-1)*i,0)},t}(Phaser.GameObjects.Container),fw=Fa.A.DEFAULT_TOOL,mw=fw.KEY,gw=fw.FRAME,vw=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).scene=void 0,s.popup=void 0,s.buttonClose=void 0,s.title=void 0,s.contents=void 0,s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.handleClose=function(){s.scene.piecesPicked.showPiecesPicked(),s.runCloseAnimation()},s.scene=t,s.createPopup(),s.createTitle(),s.createReuseScroller(),s.addItem(),s.createInput(),s.arrangeItems(),s.setDepth(Ua.Ae.POPUP),s.background.setAlpha(.5),s}(0,_.A)(t,e);var n=t.prototype;return n.open=function(t){e.prototype.open.call(this,t);var n=this.getData("index");this.runOpenAnimation(),console.log("open",this.scene.listPiecesDataPicked[n])},n.createReuseScroller=function(){var e=new jd(this.scene,{classType:pw,listConfigs:[],width:310,height:385,padding:0,marginTop:0,marginBottom:0});this.scene.renderer instanceof Phaser.Renderer.WebGL.WebGLRenderer&&e.createBound(Fa.A.DEFAULT.KEY,Fa.A.DEFAULT.FRAME.BLANK,40,16643027),e.setPosition(0,0),e.createMask(),this.popup.add(e);for(var t=[],n=[],i=0;i<iS.length;i++){var a=iS[i];n.push(a),(i+1)%3===0&&(t.push({item:n}),n=[])}e.updateConfig(t),e.setEnable(!0)},n.createInput=function(){this.buttonClose.onClick=this.handleClose},n.createPopup=function(){this.popup=new xP(this.scene,0,0,320,400),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone,0,10)},n.createTitle=function(){this.title=this.scene.add.container(),this.buttonClose=new Va.A(this.scene,mw,gw.BUTTON_CLOSE_2,19.5,19.5),this.buttonClose.setName("Close"),this.title.add([this.buttonClose]),this.popup.add(this.title),Phaser.Display.Align.In.Center(this.buttonClose,this.title,150,-11)},n.addItem=function(){this.popup.add([]),this.contents=this.scene.add.group(),this.contents.addMultiple([])},n.arrangeItems=function(){Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.runOpenAnimation=function(){var e;null!=(e=this.popupShowUpAnimation)&&null!=(e=e.tween)&&e.isPlaying()||(this.scene.audio.playSound(ja.A.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300),this.runPopupContentEntrancesAnimation(200,300))},n.runCloseAnimation=function(){var e;null!=(e=this.popupFadeOutAnimation)&&null!=(e=e.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(e,t){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new Nh.A({targets:[this.popup],delay:e,duration:t,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(e,t){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new Lh.A({targets:this.contents.getChildren(),duration:t,delay:e,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(e,t){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new Bh.A({targets:[this.popup],delay:e,duration:t,props:{scale:0},ease:Phaser.Math.Easing.Back.In,onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(e,t){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new wo.A({targets:[this.background],delay:e,duration:t,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(e,t){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new Bh.A({targets:[this.background],delay:e,duration:t,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},t}(GameCore.Screen),yw=vw,Aw=Fa.A.EDITOR,Ew=Aw.KEY,Tw=Aw.FRAME,Sw=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.addObjectButton=void 0,n.removeButton=void 0,n.onAddObject=void 0,n.onAddSubObject=void 0,n.onChangeColor=void 0,n.onRemove=void 0,n.onMovingKey=void 0,n.scene=t,n.createAddObjectButton(),n.createRemoveButton(),n.setVisible(!1),n.scene.add.existing((0,ka.A)(n)),n}(0,_.A)(t,e);var n=t.prototype;return n.createAddObjectButton=function(){var e=this;this.addObjectButton=new Va.A(this.scene,Ew,Tw.EDIT_BUTTON,20,20),this.addObjectButton.setPosition(-12,0),this.addObjectButton.onClick=function(){e.scene.panelSelectCell.open(e.x+69,e.y-44),e.close()},this.add(this.addObjectButton)},n.createRemoveButton=function(){var e=this;this.removeButton=new Va.A(this.scene,Ew,Tw.REMOVE_BUTTON,20,20),this.removeButton.setPosition(12,0),this.removeButton.onClick=function(){if(e.scene.enableSelectMultiCell){for(var t=0;t<e.scene.listCellSelected.length;t++){var n=e.scene.listCellSelected[t];e.scene.setBoardPositionSelected({x:n.row,y:n.col}),n.hideHighlight(),e.scene.undoManager.receiveCommand({event:Ub,object:e.scene.board.dataBoard[n.row][n.col],prevState:{frame:e.scene.board.dataBoard[n.row][n.col].gemFrame,items:e.scene.board.dataBoard[n.row][n.col].items},currentState:void 0}),n.reset()}return e.scene.undoManager.receiveCommand({event:jb,object:e.scene.listCellSelected,prevState:void 0,currentState:void 0}),e.scene.enableSelectMultiCell=!1,e.scene.listCellSelected=[],void e.close()}if(e.scene.boardPositionBlockSelected){var i=e.scene.boardPositionBlockSelected,a=i.x,s=i.y;e.scene.undoManager.receiveCommand({event:Ub,object:e.scene.board.dataBoard[a][s],prevState:{frame:e.scene.board.dataBoard[a][s].gemFrame,items:e.scene.board.dataBoard[a][s].items},currentState:void 0}),e.scene.board.dataBoard[a][s].gemFrame="",e.scene.board.dataBoard[a][s].blockItem.reset(),e.close()}},this.add(this.removeButton)},n.open=function(e,t){console.log("open PanelEditCell");var n=this.scene.gameZone.width;this.scene.panelEditPiece.close(),this.setVisible(!0),this.setPosition(e,t);this.x<30&&(this.x=30),this.x>n-30&&(this.x=n-30)},n.close=function(){console.log("close PanelEditCell"),this.setVisible(!1)},t}(Phaser.GameObjects.Container),bw=Sw,Pw=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.background=void 0,n.size=24,n.scene=t,n.setAlpha(.85),n.createBackground(),n.createGems(),n.setVisible(!1),n.scene.add.existing((0,ka.A)(n)),n}(0,_.A)(t,e);var n=t.prototype;return n.createBackground=function(){var e=this.size,t=this.size;this.background=this.scene.add.rectangle(0,0,4.5*e,4.5*t,0,.95),this.background.setOrigin(.5,.5),this.add(this.background),this.setSize(4.5*e,4.5*t),this.add(this.background)},n.createGems=function(){for(var e=0,t=-Math.floor(qE.length/4)/2*this.size,n=0;n<qE.length;n++){e=-4*this.size/2+this.size/2+this.size*n-4*Math.floor(n/4)*this.size,t=-Math.floor(qE.length/4)/2*this.size+Math.floor(n/4)*this.size;var i=new $b(this.scene,{key:Fa.A.GAMEPLAY_32.KEY,frame:qE[n]});this.add(i),Phaser.Display.Align.In.Center(i,this,e,t)}},n.open=function(e,t){console.log("open PanelSelectCell"),this.setVisible(!0),this.setPosition(e,t);this.x<90&&(this.x=90),this.y<90&&(this.y=90);var n=this.scene.gameZone.width;this.x>n-90&&(this.x=n-90),this.background.setInteractive(),this.bringToTop(this),this.scene.input.setTopOnly(!0)},n.close=function(){console.log("close PanelSelectCell"),this.setVisible(!1);for(var e=0;e<this.scene.listCellSelected.length;e++){this.scene.listCellSelected[e].hideHighlight()}this.scene.enableSelectMultiCell=!1,this.scene.listCellSelected=[]},t}(Phaser.GameObjects.Container),Cw=Pw,ww=Fa.A.EDITOR,Iw=ww.KEY,xw=ww.FRAME,kw=Fa.A.DEFAULT_TOOL,Ow=kw.KEY,_w=kw.FRAME,Rw=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.editObjectButton=void 0,n.addObjectButton=void 0,n.removeButton=void 0,n.onAddObject=void 0,n.onAddSubObject=void 0,n.onChangeColor=void 0,n.onRemove=void 0,n.onMovingKey=void 0,n.scene=t,n.createEditObjectButton(),n.createAddObjectButton(),n.createRemoveButton(),n.setVisible(!1),n.scene.add.existing((0,ka.A)(n)),n}(0,_.A)(t,e);var n=t.prototype;return n.createEditObjectButton=function(){var e=this;this.editObjectButton=new Va.A(this.scene,Iw,xw.EDIT_BUTTON,20,20),this.editObjectButton.setPosition(-20,0),this.editObjectButton.onClick=function(){e.scene.panelSelectCell.close(),e.scene.panelEditCellOfPiece.open(e.x,e.y-50),e.close()},this.add(this.editObjectButton)},n.createAddObjectButton=function(){var e=this;this.addObjectButton=new Va.A(this.scene,Ow,_w.CHANGE_BUTTON,20,20),this.addObjectButton.setPosition(0,0),this.addObjectButton.onClick=function(){var t=e.scene.listPiecesDataPicked[e.scene.pieceSelectedIndex],n=t.index;t.name,t.data;e.scene.indexPiece=n;var i=e.scene.piecesPicked.getWorldPosition().x;e.scene.panelChangePiece.open(i,e.scene.gameZone.height/2),e.close()},this.add(this.addObjectButton)},n.createRemoveButton=function(){var e=this;this.removeButton=new Va.A(this.scene,Iw,xw.REMOVE_BUTTON,20,20),this.removeButton.setPosition(20,0),this.removeButton.onClick=function(){var t,n=_a()(t=e.scene.listPiecesDataPicked).call(t,e.scene.pieceSelectedIndex,1);e.scene.undoManager.receiveCommand({event:zb,object:n[0],prevState:e.scene.pieceSelectedIndex,currentState:void 0}),e.scene.piecesPicked.showPiecesPicked(),e.close()},this.add(this.removeButton)},n.open=function(e,t){if(console.log("open PanelEditPiece"),this.scene.panelEditCell.close(),!this.scene.panelEditCellOfPiece.visible&&(!this.scene.panelEditCellOfPiece.visible||!this.scene.enableChangeGemPiece)){this.setVisible(!0),this.setPosition(e,t);this.x<45&&(this.x=45);var n=this.scene.gameZone.width;this.x>n-45&&(this.x=n-45)}},n.close=function(){console.log("close PanelEditPiece"),this.setVisible(!1)},t}(Phaser.GameObjects.Container),Dw=Rw,Mw=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.piece=void 0,n.background=void 0,n.onAddObject=void 0,n.onAddSubObject=void 0,n.onChangeColor=void 0,n.onRemove=void 0,n.onMovingKey=void 0,n.scene=t,n.createBackground(),n.createPiece(),n.setVisible(!1),n.scene.add.existing((0,ka.A)(n)),n}(0,_.A)(t,e);var n=t.prototype;return n.createBackground=function(){this.background=new xP(this.scene,0,0,0,0),this.background.setAlpha(.85),this.add(this.background)},n.createPiece=function(){this.piece=new AC(this.scene),this.add(this.piece),Phaser.Display.Align.In.Center(this.piece,this,0,0)},n.open=function(e,t){console.log("open PanelEditCellOfPiece",e,t),this.scene.enableChangeGemPiece=!0;var n=this.scene.listPiecesDataPicked[this.scene.pieceSelectedIndex],i=n.data;this.background.setSizePopup(25*i[0].length+10,25*i.length+10),this.piece.updateInfo(n),this.setVisible(!0),this.setPosition(e,t);var a=13*i.length;this.x<50&&(this.x=50),this.y<a&&(this.y=a);var s=this.scene.gameZone.width;this.x>s-50&&(this.x=s-50),this.background.setInteractive(),this.bringToTop(this),this.scene.input.setTopOnly(!0)},n.close=function(){console.log("close PanelEditCellOfPiece"),this.setVisible(!1)},t}(Phaser.GameObjects.Container),Bw=Mw,Lw=Fa.A.GAMEPLAY_32,Nw=Lw.KEY,Gw=Lw.FRAME,Fw=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.cell=void 0,n.item=void 0,n.scene=t,n.scene.add.existing((0,ka.A)(n)),n.createCell(),n.createItem(),n}(0,_.A)(t,e);var n=t.prototype;return n.createCell=function(){this.cell=this.scene.make.image({key:Nw,frame:Gw.GEM_BLUE}),this.cell.setWorldSize(15,15),this.add(this.cell),Phaser.Display.Align.In.Center(this.cell,this)},n.createItem=function(){this.item=this.scene.make.image({key:Nw}),this.item.setVisible(!1),this.add(this.item),Phaser.Display.Align.In.Center(this.item,this)},n.setFrameCell=function(e){this.cell.setFrame(e)},n.setFrameItem=function(e){e&&(this.item.setVisible(!0),this.item.setFrame(e),this.item.setWorldSize(15,15))},t}(Phaser.GameObjects.Container),Uw=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.payload=void 0,i.hasEventOnClick=!1,n&&(i.payload=n),i.scene=t,i.scene.add.existing((0,ka.A)(i)),i.setSize(70,70),i.createCells(),i.listenEvents(),i}(0,_.A)(t,e);var n=t.prototype;return n.createCells=function(){var e,t,n=[],i=null==(e=this.payload)?void 0:e.data,a=null==(t=this.payload)?void 0:t.item;if(i)for(var s=0;s<i.length;s++){n[s]=[];for(var r=0;r<i[s].length;r++)if(i[s][r]){var o=eT(i[s][r]),c=(a[s][r],""),l=new Fw(this.scene);l.setFrameCell(o),l.setFrameItem(c),this.add(l),l.setPosition(16*(r-(i[s].length-1)/2),16*(s-(i.length-1)/2))}}},n.updateInfo=function(e){e&&(this.payload=e,console.log("index: ",e.index,e),this.removeAll(!0),this.createCells())},n.listenEvents=function(){var e=this;this.hasEventOnClick||(this.hasEventOnClick=!0,this.setInteractive({useHandCursor:!0}),this.on(Phaser.Input.Events.POINTER_OVER,(function(){if(!e.scene.enableSelectMultiCell&&e.payload){e.scene.pieceSelectedIndex=e.payload.index;var t=e.getWorldPosition(),n=t.x,i=t.y;e.scene.panelEditPiece.open(n,i-35)}})),this.on(Phaser.Input.Events.POINTER_DOWN,(function(){if(e.scene.panelEditCellOfPiece.close(),e.scene.panelEditCellOnPiece.close(),e.payload){e.scene.pieceSelectedIndex=e.payload.index;var t=e.getWorldPosition(),n=t.x,i=t.y;e.scene.panelEditPiece.open(n,i-35)}})))},t}(Phaser.GameObjects.Container),jw=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.listPiece=void 0,n.scene=t,n.scene.add.existing((0,ka.A)(n)),n.setSize(250,70),n.createPieces(),n}(0,_.A)(t,e);var n=t.prototype;return n.createPieces=function(){this.listPiece=[];for(var e=0;e<3;e++)this.listPiece.push(new Uw(this.scene));for(var t=0;t<this.listPiece.length;t++)this.listPiece[t].setPosition(110*t-110,0);this.add(this.listPiece)},n.updateInfo=function(e){for(var t=0;t<this.listPiece.length;t++)this.listPiece[t].updateInfo(e.listPieceData[t])},t}(Phaser.GameObjects.Container),Vw=Fa.A.DEFAULT_TOOL,zw=Vw.KEY,Yw=Vw.FRAME,Hw=function(e){function t(t){var n;return(n=e.call(this,t,zw,Yw.BLANK,30,27)||this).icon=void 0,n.text=void 0,n.button.setVisible(!1),n.createIcon(),n.createText(),n}(0,_.A)(t,e);var n=t.prototype;return n.createIcon=function(){this.icon=this.scene.make.image({key:zw}),this.add(this.icon)},n.createText=function(){this.text=this.scene.make.bitmapText({font:za.A.FONT_TEXT_WHITE.KEY,size:this.scene.fontSize(30),origin:{x:.5,y:.5}}),this.text.setVisible(!1),this.add(this.text),Phaser.Display.Align.In.Center(this.text,this,0,30)},n.setFrameIcon=function(e,t,n,i){void 0===i&&(i=16777215),this.icon.setTint(16250357),this.icon.setFrame(e),this.icon.setWorldSize(t,n),this.icon.setTintFill(i)},n.setKey=function(e){this.icon.setTexture(e)},n.setText=function(e){this.text.setText(e)},t}(Va.A),Kw=Hw,Ww=Fa.A.GAMEPLAY_32,Zw=Ww.KEY,Xw=Ww.FRAME,Jw=function(e){function t(n,i,a){var s;return(s=e.call(this,n)||this).scene=void 0,s.type=void 0,s.direction=void 0,s.isReverse=!1,s.data=[],s.matrixData=void 0,s.texture=void 0,s.frame=void 0,s.maxHeight=void 0,s.originalData=void 0,s.isSetDrag=!1,s.isCreateCell=!1,s.wrap=void 0,s.wrapPiece=void 0,s.isDragEnd=!1,s.isActive=!0,s.isVisible=!0,s.pointerY=void 0,s.parentHeight=void 0,s.index=void 0,s.props=void 0,s.cells=[],s.parent=void 0,s.moveTopNumber=30,s.backupPx=void 0,s.backupPy=void 0,s.animMoveTopAndScaleUp=void 0,s.animMoveDownAndScaleDown=void 0,s.animScaleUp=void 0,s.animScaleDown=void 0,s.distancePY=void 0,s.isCanMove=void 0,s.correctAlpha=1,s.props=a,s.type=a.type,s.matrixData=a.matrixData,s.data=t.buildData(s.matrixData),s.direction=a.direction||null,s.parentHeight=a.parentHeight||0,s.isReverse=a.isReverse||!1,s.parent=i,s.scene=n,s.scene.add.existing((0,ka.A)(s)),s.createWrapPiece(),s}(0,_.A)(t,e);var n=t.prototype;return n.createWrapPiece=function(){var e=this.scene.gameZone.width/3;this.wrapPiece=this.scene.make.image({key:Zw,frame:Xw.GEM_TRANSPARENT}),this.wrapPiece.setWorldSize(e,e)},n.updatePositionWrapPiece=function(e,t){this.wrapPiece.setPosition(e+this.wrapPiece.displayWidth/2,t-20)},n.setIndex=function(e){this.index=e},n.updateDataPiece=function(e){this.data=e},n.setInteractiveContainer=function(){var e=this.scene.gameZone.width/3;this.wrapPiece.setInteractive().input.hitArea.setTo(0,0,e/this.wrapPiece.scale,180/this.wrapPiece.scale),this.scene.input.setDraggable(this.wrapPiece)},n.hide=function(){this.setVisible(!1),this.wrapPiece.setVisible(!1)},n.show=function(){this.setVisible(!0),this.wrapPiece.setVisible(!0)},n.playAnimShow=function(){this.setAlpha(0).setScale(0),this.show(),this.animScaleUp.play()},t.buildData=function(e){for(var t=[],n=0;n<e.length;n++){t[n]=[];for(var i=0;i<e[n].length;i++){var a=1===e[n][i]?Xw.GEM:null;t[n][i]={x:i,y:n,texture:a}}}return t},n.getPaddingCell=function(){return this.height/this.data.length/40},n.createAnimShow=function(){var e=this,t=140*this.index;this.animScaleUp=this.scene.tweens.add({delay:t,paused:!0,duration:163,targets:this,alpha:{from:0,to:this.alpha},scale:{from:0,to:1.2},ease:Phaser.Math.Easing.Linear,onComplete:function(){e.animScaleDown.play()}}),this.animScaleDown=this.scene.tweens.add({delay:83,paused:!0,duration:150,targets:this,scale:1,ease:Phaser.Math.Easing.Linear})},n.updateCells=function(){for(var e=0;e<this.data.length;e++)for(var t=0;t<this.data[e].length;t++)if(this.data[e][t].texture&&"x"!==this.data[e][t].texture){var n=this.cells[e][t];n.setFrame(this.data[e][t].texture),n.setVisible(!0),this.cells[e][t]=n}},n.setCanMove=function(e){this.isCanMove=e,this.correctAlpha=e?1:.4,this.setAlpha(this.correctAlpha)},n.reset=function(){this.setVisible(!1),this.setScale(1),this.wrapPiece.disableInteractive(),this.data=t.buildData(this.matrixData)},n.getScore=function(){if(!this.matrixData)return 0;for(var e=0,t=0;t<this.matrixData.length;t++)for(var n=0;n<this.matrixData[0].length;n++)1===this.matrixData[t][n]&&e++;return e},t}(Phaser.GameObjects.Container),qw=function(e){function t(n,i,s){return e.call(this,n,i,(0,a.A)({},s,{matrixData:t.getMatrixData(s.type,s.direction,s.isReverse)}))||this}return(0,_.A)(t,e),t.getMatrixData=function(e,t,n){void 0===n&&(n=!1);var i=[];switch(t){case cS:n?i=JS:(i=XS,e===vS&&(i=qS),e===yS&&(i=QS));break;case lS:n?i=VS:(i=jS,e===vS&&(i=zS),e===yS&&(i=YS));break;case hS:if(n){i=GS;break}i=NS,e===vS&&(i=FS),e===yS&&(i=US);break;case uS:n?i=KS:(i=HS,e===vS&&(i=WS),e===yS&&(i=ZS))}return i},t.getData=function(e,n,i){return void 0===i&&(i=!1),t.buildData(t.getMatrixData(e,n,i))},t}(Jw),Qw=qw,$w=function(e){function t(n,i,s){return e.call(this,n,i,(0,a.A)({},s,{matrixData:t.getMatrixData(s.type,s.direction)}))||this}return(0,_.A)(t,e),t.getMatrixData=function(e,t){var n=[];switch(e){case SS:n=t===rS?sb:rb;break;case TS:n=t===rS?ib:ab;break;case AS:n=t===rS?$S:eb;break;case ES:n=t===rS?tb:nb}return n},t.getData=function(e,n){return t.buildData(t.getMatrixData(e,n))},t}(Jw),eI=$w,tI=function(e){function t(n,i,s){return e.call(this,n,i,(0,a.A)({},s,{matrixData:t.getMatrixData(s.type)}))||this}return(0,_.A)(t,e),t.getMatrixData=function(e){var t=[];switch(e){case bS:t=ob;break;case PS:t=cb;break;case CS:t=lb}return t},t.getData=function(e){return t.buildData(t.getMatrixData(e))},t}(Jw),nI=tI,iI=function(e){function t(n,i,s){return e.call(this,n,i,(0,a.A)({},s,{matrixData:t.getMatrixData(s.direction)}))||this}return(0,_.A)(t,e),t.getMatrixData=function(e){var t=[];switch(e){case cS:t=fb;break;case lS:t=mb;break;case hS:t=gb;break;case uS:t=vb;break;default:t=fb}return t},t.getData=function(e){return t.buildData(t.getMatrixData(e))},t}(Jw),aI=iI,sI=function(e){function t(n,i,s){return e.call(this,n,i,(0,a.A)({},s,{matrixData:t.getMatrixData(s.direction)}))||this}return(0,_.A)(t,e),t.getMatrixData=function(e){var t=[];switch(e){case dS:t=hb;break;case pS:t=ub;break;case mS:t=pb;break;case fS:t=db;break;default:t=hb}return t},t.getData=function(e){return t.buildData(t.getMatrixData(e))},t}(Jw),rI=sI,oI=function(e){function t(n,i,s){return e.call(this,n,i,(0,a.A)({},s,{matrixData:t.getMatrixData(s.direction)}))||this}return(0,_.A)(t,e),t.getMatrixData=function(e){var t=[];switch(e){case cS:t=yb;break;case lS:t=Ab;break;case hS:t=Eb;break;case uS:t=Tb;break;default:t=yb}return t},t.getData=function(e){return t.buildData(t.getMatrixData(e))},t}(Jw),cI=oI,lI=function(e){function t(n,i,s){return e.call(this,n,i,(0,a.A)({},s,{matrixData:t.getMatrixData()}))||this}return(0,_.A)(t,e),t.getMatrixData=function(){return Sb},t.getData=function(){return t.buildData(t.getMatrixData())},t}(Jw),hI=lI,uI=function(e){function t(n,i,s){return e.call(this,n,i,(0,a.A)({},s,{matrixData:t.getMatrixData(s.type,s.direction)}))||this}return(0,_.A)(t,e),t.getDataByDirectionCross2=function(e){var t=[];switch(e){case cS:t=bb;break;case lS:t=Pb;break;default:t=bb}return t},t.getDataByDirectionCross3=function(e){var t=[];switch(e){case cS:t=Cb;break;case lS:t=wb;break;default:t=Cb}return t},t.getDataByDirectionCross4=function(e){var t=[];switch(e){case cS:t=Ib;break;case lS:t=xb;break;default:t=Ib}return t},t.getDataByDirectionCross5=function(e){var t=[];switch(e){case cS:t=kb;break;case lS:t=Ob;break;default:t=kb}return t},t.getMatrixData=function(e,n){var i=[];switch(e){case OS:i=t.getDataByDirectionCross2(n);break;case _S:i=t.getDataByDirectionCross3(n);break;case RS:i=t.getDataByDirectionCross4(n);break;case DS:i=t.getDataByDirectionCross5(n)}return i},t.getData=function(e,n){return t.buildData(t.getMatrixData(e,n))},t}(Jw),dI=uI,pI=function(e){function t(n,i,s){return e.call(this,n,i,(0,a.A)({},s,{matrixData:t.getMatrixData(s.direction)}))||this}return(0,_.A)(t,e),t.getMatrixData=function(e){var t=[];switch(e){case cS:t=_b;break;case lS:t=Rb;break;case hS:t=Db;break;case uS:t=Mb;break;default:t=_b}return t},t.getData=function(e){return t.buildData(t.getMatrixData(e))},t}(Jw),fI=pI,mI=function(){function e(){}return e.create=function(e,t,n){var i;switch(n.type){case gS:case vS:case yS:i=new Qw(e,t,n);break;case AS:case ES:case TS:case SS:i=new eI(e,t,n);break;case bS:case PS:case CS:i=new nI(e,t,n);break;case IS:i=new aI(e,t,n);break;case xS:i=new cI(e,t,n);break;case MS:i=new fI(e,t,n);break;case kS:i=new hI(e,t,n);break;case OS:case _S:case RS:case DS:i=new dI(e,t,n);break;case wS:i=new rI(e,t,n);break;default:i=new nI(e,t,n)}return i},e}(),gI=mI,vI=GameCore.Configs.Board,yI=(vI.cols,vI.rows,function(e){var t=e;switch(e){case"gem/gem":t="g";break;case"gem/diamond/diamond-10":t="d10";break;case"gem/diamond/diamond-11":t="d11";break;case"gem/diamond/diamond-12":t="d12";break;case"gem/diamond/diamond-13":t="d13";break;case"gem/diamond/diamond-14":t="d14";break;case"gem/diamond/diamond-15":t="d15";break;case"gem/ruby/ruby-20":t="r20";break;case"gem/sapphire/sapphire-30":t="s30";break;case gS:t="l";break;case vS:t="l1";break;case yS:t="l3";break;case AS:t="e2";break;case ES:t="e3";break;case TS:t="e4";break;case SS:t="e5";break;case bS:t="s1";break;case PS:t="s2";break;case CS:t="s3";break;case wS:t="tz";break;case IS:t="ta";break;case kS:t="pl";break;case xS:t="tp";break;case OS:t="cr2";break;case _S:t="cr3";break;case RS:t="cr4";break;case DS:t="cr5";break;case MS:t="up";break;case hS:t="dt";break;case cS:t="dl";break;case lS:t="dr";break;case uS:t="db";break;case rS:t="v";break;case oS:t="h";break;case dS:t="vl";break;case pS:t="vr";break;case fS:t="hl";break;case mS:t="hr"}return t});function AI(e,t){var n="undefined"!==typeof ud()&&pd()(e)||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){var n;if(!e)return;if("string"===typeof e)return EI(e,t);var i=lt()(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return $l()(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return EI(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function EI(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var TI=Fa.A.GAMEPLAY_32,SI=TI.KEY,bI=TI.FRAME,PI=GameCore.Configs,CI=PI.Gameplay,wI=PI.Match,II=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.allPieces=[],n.cellSize=void 0,n.canCaptureLines=void 0,n.allPiecesGroup=[],n.piecesActive=[],n.listPieceMap=[],n.amountPieceContainGem=0,n.hasPieceContainGem=void 0,n.segmentAmountPiece1Min=0,n.segmentAmountPiece1Max=0,n.segmentAmountPiece1Cur=0,n.segmentAmountPiece5Min=0,n.segmentAmountPiece5Max=0,n.segmentAmountPiece5Cur=0,n.segmentAvgScore=0,n.segmentTotalPieceScore=0,n.segmentTotalPiece=0,n.segmentTotalScore=0,n.segmentPieceDistancePerGem=0,n.segmentPieceRandomGem=!1,n.index=void 0,t.add.existing((0,ka.A)(n)),n.scene=t,n.createAllPieces(),n.createAllPiecesGroup(),n}(0,_.A)(t,e);var n=t.prototype;return n.createAllPieces=function(){for(var e=this.cellSize,t=[],n=0;n<BS.length;n++){var i=this.getDirectionsByType(BS[n]);if(i.length<=0)t.push({type:BS[n]});else{for(var s=0;s<i.length;s++)t.push({type:BS[n],direction:i[s]});if(gS===BS[n])for(var r=0;r<i.length;r++)t.push({type:BS[n],direction:i[r],isReverse:!0})}}for(var o=0;o<t.length;o++){var c=(0,a.A)({},t[o],{texture:SI,frame:bI.GEM_BLUE,x:Math.floor(this.x),y:Math.floor(this.y),width:Math.floor(e/2),height:Math.floor(e/2),cellLength:Math.floor(e/2),parentHeight:this.height,wrap:{x:Math.floor(this.x),y:Math.floor(this.y),width:Math.floor(e/2),height:Math.floor(e/2)}}),l=gI.create(this.scene,this,c);l.hide(),this.allPieces.push({piece:l,isUsed:!1})}},n.createAllPiecesGroup=function(){for(var e=0;e<this.allPieces.length;e++){var t=this.allPieces[e].piece;this.allPiecesGroup[t.type]||(this.allPiecesGroup[t.type]=[]),this.allPiecesGroup[t.type].push(e)}},n.getDirectionsByType=function(e){if([bS,PS,CS].some((function(t){return t===e})))return[];var t=[];switch(e){case gS:case vS:case yS:t=[hS,cS,lS,uS];break;case AS:case ES:case TS:case SS:t=[rS,oS];break;case IS:t=[hS,cS,lS,uS];break;case wS:t=[dS,pS,fS,mS];break;case xS:case MS:t=[hS,cS,lS,uS];break;case kS:t=[];break;case OS:case _S:case RS:case DS:t=[cS,lS]}return t},n.buildPiecesByMap=function(){if(this.scene.segmentValue){var e=this.scene.segmentValue,t=e.avgScore,n=e.score,i=e.pieceDistancePerGem;console.log("pieceDistancePerGem === ",i,t,n);var a=this.scene.segmentValue,s=a.piece1,r=a.piece5;s=s.replace("min",'"min"').replace("max",'"max"'),r=r.replace("min",'"min"').replace("max",'"max"');var o=JSON.parse(s),c=JSON.parse(r);this.segmentAvgScore=t,this.segmentAmountPiece1Min=o.min,this.segmentAmountPiece1Max=o.max,this.segmentAmountPiece5Min=c.min,this.segmentAmountPiece5Max=c.max,this.segmentTotalScore=n,this.segmentPieceDistancePerGem=i,this.segmentTotalPieceScore=0,this.segmentTotalPiece=0,this.listPieceMap=[],this.scene.listPiecesDataPicked=[],this.index=0,console.log("Test",this.segmentAvgScore,this.segmentAmountPiece1Max,this.segmentAmountPiece5Max,this.segmentTotalScore,this.segmentPieceDistancePerGem),this.buildObjectPieces(),console.log("listttttttt ",this.listPieceMap),console.log("listPiecesDataPicked ===",this.scene.listPiecesDataPicked)}},n.buildObjectPieces=function(){for(;this.checkAverageScore();)this.buildObjectPiece()},n.checkAverageScore=function(){return 0===this.segmentTotalPiece||0===this.segmentTotalPieceScore||!(this.segmentTotalPiece>wI.PieceRandoms.maxPiece)&&!(this.segmentTotalPieceScore/this.segmentTotalPiece<=this.segmentAvgScore+wI.PieceRandoms.measureError&&this.segmentTotalPieceScore/this.segmentTotalPiece>=this.segmentAvgScore-wI.PieceRandoms.measureError&&this.segmentTotalPieceScore>=this.segmentTotalScore)},n.buildObjectPiece=function(){var e=this.getPieceByAvgScore();if(e)if(this.checkPieceMaxAmountConfig(e)){var t="";if(Math.floor((this.segmentTotalPiece-1)/3)%this.segmentPieceDistancePerGem===0){var n=Phaser.Math.Between(0,1);if((this.segmentTotalPiece-1)%3===0&&1===this.segmentPieceDistancePerGem&&(this.segmentPieceRandomGem=!1),n&&!this.segmentPieceRandomGem||!this.segmentPieceRandomGem&&this.segmentTotalPiece%3===2){var i=this.getRandomPieceData(e.data);i&&(e.updateDataPiece(i),t=this.getFenDataPiece(e)),this.segmentPieceRandomGem=!0}}else this.segmentPieceRandomGem=!1;this.listPieceMap.push({type:e.type,direction:e.direction,isReverse:e.isReverse,fenPiece:t});for(var a,s="",r=AI(iS);!(a=r()).done;){var o=a.value,c=o.data;Yt()(e.matrixData)===Yt()(c)&&(s=o.name)}e.matrixData&&this.scene.listPiecesDataPicked.push({index:this.index,name:s,data:this.getDeepCode2DArray(e.matrixData),item:this.getItemData(e.matrixData)}),this.index++}else this.buildObjectPiece()},n.getItemData=function(e){return $l()(Array(e.length),(function(t){var n;return Da()(n=Array(e[0].length)).call(n,0)}))},n.getDeepCode2DArray=function(e){for(var t=[],n=0;n<e.length;n++){var i;t[n]=lt()(i=e[n]).call(i)}return t},n.getFenDataPiece=function(e){for(var t=e.data,n=t.length,i=t[0].length,a="",s=0;s<n;s++){for(var r="",o=0;o<i;o++)r+=","+yI(t[s][o].texture);a+="/"+r.substring(1)}return a.substring(1)},n.checkPieceMaxAmountConfig=function(e){var t=e.getScore();switch(t){case 1:if(this.segmentAmountPiece1Max<=this.segmentAmountPiece1Cur)return!1;this.segmentAmountPiece1Cur++;break;case 5:if(this.segmentAmountPiece5Max<=this.segmentAmountPiece5Cur)return!1;this.segmentAmountPiece5Cur++}return this.segmentTotalPiece++,this.segmentTotalPieceScore+=t,!0},n.getPieceByAvgScore=function(){var e=this;if(this.segmentTotalPieceScore<this.segmentTotalScore){var t=this.buildPieceRates(),n=t[Math.floor(Math.random()*t.length)];if(!this.allPiecesGroup[n])return null;var i=Math.floor(Math.random()*this.allPiecesGroup[n].length),a=this.allPiecesGroup[n][i];return this.allPieces[a].piece}if(this.segmentTotalPieceScore/this.segmentTotalPiece<=this.segmentAvgScore){var s,r=f()(s=this.allPieces).call(s,(function(t){return t.piece.getScore()<=e.segmentAvgScore}));return r&&0!==r.length?r[Phaser.Math.Between(0,r.length-1)].piece:null}if(this.segmentTotalPieceScore/this.segmentTotalPiece>this.segmentAvgScore){var o,c=f()(o=this.allPieces).call(o,(function(t){return t.piece.getScore()>e.segmentAvgScore}));return c&&0!==c.length?c[Phaser.Math.Between(0,c.length-1)].piece:null}return null},n.getRandomPieceData=function(e){var t=this.scene.listTargetsDiamond[1].value;if(!t||0===t.length)return null;for(var n=0,i=e.length,a=e[0].length,s=0;s<i;s++)for(var r=0;r<a;r++){var o=this.countDataGem(e[s]);if(e[s][r].texture&&(Phaser.Math.Between(0,1)||n||r+1===o)){var c=bI.GEM;if(n<CI.MaxGemInPiece)c=t[Phaser.Math.Between(0,t.length-1)];e[s][r]={x:s,y:r,texture:c},n++}}return e},n.countDataGem=function(e){for(var t=0,n=0;n<e.length;n++)e[n].texture&&t++;return t},n.buildPieceRates=function(){for(var e=[],t=0;t<LS.length;t++)e.push((0,a.A)({},LS[t]));for(var n=[],i=0;i<e.length;i++)for(var s=e[i],r=s.type,o=s.rate,c=0;c<o;c++)n.push(r);return n},t}(Phaser.GameObjects.Container),xI=Fa.A.EDITOR,kI=xI.KEY,OI=xI.FRAME,_I=function(e){function t(t){var n;(n=e.call(this,t)||this).scene=void 0,n.newPieceButton=void 0,n.listPieces=[],n.pieces=void 0,n.scene=t;var i=n.scene.gameZone,a=i.width,s=i.height;return n.setSize(a/3,s),n.buttonClear(),n.createButtonAddNewPiece(),n.showPiecesPicked(),n.createPieces(),t.add.existing((0,ka.A)(n)),n}(0,_.A)(t,e);var n=t.prototype;return n.buttonClear=function(){var e=this,t=new Va.A(this.scene,kI,OI.REMOVE_ICON,38,38);this.add(t),t.onClick=function(){e.scene.listPiecesDataPicked=[],e.showPiecesPicked()},Phaser.Display.Align.In.TopLeft(t,this,0,-130)},n.showPiecesPicked=function(){this.resetListPieces();for(var e=[],t=[],n=this.scene.listPiecesDataPicked,i=0;i<n.length;i++){var a=n[i];a.index=i,t.push(a),(i+1)%3===0&&(e.push({listPieceData:t}),t=[])}n.length%3>0&&e.push({listPieceData:t});for(var s=0;s<e.length;s++){var r=new jw(this.scene),o=e[s];r.updateInfo(o),this.add(r),this.listPieces.push(r),r.setY(90*s-120)}this.alignButton(e.length)},n.resetListPieces=function(){for(var e=0;e<this.listPieces.length;e++){this.listPieces[e].destroy()}},n.createButtonAddNewPiece=function(){this.newPieceButton=new Kw(this.scene),this.newPieceButton.setKey(kI),this.newPieceButton.setFrameIcon(OI.CREATE_ICON,50,50,0),this.newPieceButton.setText("Add Pieces"),this.newPieceButton.onClick=this.clickNewPieceButton.bind(this),this.add(this.newPieceButton)},n.clickNewPieceButton=function(){var e=this.scene.gameZone.height,t=this.newPieceButton.getWorldPosition().x;this.scene.panelPickPieces.open(t,e/2)},n.alignButton=function(e){this.newPieceButton.setY(90*e-150)},n.createPieces=function(){this.pieces=new II(this.scene)},n.loadPiecesByMapConfig=function(){this.scene.listPiecesDataPicked=[];for(var e=this.scene.mapManager.getTileMap().getObjectLayer("spawnOrder"),t=0;t<e.objects.length;t++){var n=e.objects[t],i=this.getPieceDataByType(n.type);if(this.scene.listPiecesDataPicked.push({index:t,name:i.type,data:this.getDeepCode2DArray(i.data),item:this.getItemData(i.data)}),null!=n&&n.properties)for(var a=this.scene.listPiecesDataPicked[this.scene.listPiecesDataPicked.length-1].data,s=0,r=0;r<a.length;r++)for(var o=0;o<a[0].length;o++){1==a[r][o]&&(s==(null==n?void 0:n.properties[1].value)&&(a[r][o]=parseInt(null==n?void 0:n.properties[0].value)),s++)}}this.showPiecesPicked()},n.getPieceDataByType=function(e){return Lb[e]},n.getItemData=function(e){return $l()(Array(e.length),(function(t){var n;return Da()(n=Array(e[0].length)).call(n,0)}))},n.getDeepCode2DArray=function(e){for(var t=[],n=0;n<e.length;n++){var i;t[n]=lt()(i=e[n]).call(i)}return t},t}(Phaser.GameObjects.Container),RI=_I,DI=Fa.A.EDITOR,MI=DI.KEY,BI=DI.FRAME,LI=Fa.A.GAMEPLAY_32.FRAME,NI=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.addObjectButton=void 0,n.removeButton=void 0,n.onAddObject=void 0,n.onAddSubObject=void 0,n.onChangeColor=void 0,n.onRemove=void 0,n.onMovingKey=void 0,n.scene=t,n.createAddObjectButton(),n.createRemoveButton(),n.setVisible(!1),n.scene.add.existing((0,ka.A)(n)),n}(0,_.A)(t,e);var n=t.prototype;return n.createAddObjectButton=function(){var e=this;this.addObjectButton=new Va.A(this.scene,MI,BI.EDIT_BUTTON,20,20),this.addObjectButton.setPosition(-12,0),this.addObjectButton.onClick=function(){console.log("Open Panel Select Cell"),e.scene.panelSelectCell.open(e.x,e.y-100),e.close()},this.add(this.addObjectButton)},n.createRemoveButton=function(){var e=this;this.removeButton=new Va.A(this.scene,MI,BI.REMOVE_BUTTON,20,20),this.removeButton.setPosition(12,0),this.removeButton.onClick=function(){e.scene.cellOnPiece&&(e.scene.clearFrameCellOnPiece(LI.GEM),e.close())},this.add(this.removeButton)},n.open=function(e,t){console.log("open PanelEditCellOnPiece"),this.setVisible(!0),this.setPosition(e,t);this.x<30&&(this.x=30);var n=this.scene.gameZone.width;this.x>n-30&&(this.x=n-30)},n.close=function(){console.log("close PanelEditCell"),this.setVisible(!1)},t}(Phaser.GameObjects.Container),GI=NI,FI=n(234),UI=n(240),jI=function(){function e(e){var t=this;this.scene=void 0,this.pane=void 0,this.element=void 0,this.isEnable=void 0,this.patternData=void 0,this.patternFolder=void 0,this.viewPattern=[],this.savePatternButton=void 0,this.addPatternButton=void 0,this.editPatternButton=void 0,this.confirmPatternButton=void 0,this.data={blue:0,green:0,orange:0,pink:0,purple:0,yellow:0},this.collectionItemsBlade=[],this.targets={11:0,12:0,13:0,14:0,15:0,16:0},this.patternSelected=void 0,this.getNumberByText=function(e){switch(e){case"Blue":return 11;case"Green":return 12;case"Orange":return 13;case"Pink":return 14;case"Purple":return 15;case"Yellow":return 16}return 1},this.savePatternData=function(){var e=(0,O.A)(D().mark((function e(n){var i,a,s,r;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.scene.game.globalScene.screen.open(Ua.R8.NOTIFY_SCREEN,{message:"Loading...",duration:0,loading:!0}),i=t.scene.panelEditPattern.getValueBoard(),!n){e.next=14;break}a=0;case 4:if(!(a<t.patternData.value.length)){e.next=12;break}if(t.patternData.value[a].name!=n){e.next=9;break}return t.patternData.value[a].data=i,e.abrupt("break",12);case 9:a++,e.next=4;break;case 12:e.next=15;break;case 14:t.patternData.value.push({name:"pattern-"+t.patternData.value.length,data:i});case 15:return console.log("this.patternData",t.patternData),s=Yt()(t.patternData),console.log("mapJson",s),e.prev=18,"https://vietdev.sunstudio.io/write","block-puzzle-ocean/pattern/pattern.json",e.next=23,fetch("https://vietdev.sunstudio.io/write",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:Yt()({path:"block-puzzle-ocean/pattern/pattern.json",data:s})});case 23:r=e.sent,console.log("result",r),t.scene.game.globalScene.screen.open(Ua.R8.NOTIFY_SCREEN,{message:"Action Successfully",duration:1500,loading:!1}),e.next=32;break;case 28:e.prev=28,e.t0=e.catch(18),console.log(e.t0),t.scene.game.globalScene.screen.open(Ua.R8.NOTIFY_SCREEN,{message:"Action Error",duration:1500,loading:!1});case 32:case"end":return e.stop()}}),e,null,[[18,28]])})));return function(t){return e.apply(this,arguments)}}(),this.loadPatternData=(0,O.A)(D().mark((function e(){var n;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.scene.game.globalScene.screen.open(Ua.R8.NOTIFY_SCREEN,{message:"Loading...",duration:0,loading:!0}),"https://vietdev.sunstudio.io/files/api/","block-puzzle-ocean/pattern/pattern.json",e.prev=3,e.next=6,fetch("https://vietdev.sunstudio.io/files/api/block-puzzle-ocean/pattern/pattern.json",{method:"GET"});case 6:return n=e.sent,e.next=9,n.json();case 9:t.patternData=e.sent,console.log("this.patternData === ",t.patternData),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),console.log("loadPatternData Error === ",e.t0);case 16:return e.prev=16,t.scene.game.globalScene.screen.close(Ua.R8.NOTIFY_SCREEN),t.initDataPatternPane(),e.finish(16);case 20:case"end":return e.stop()}}),e,null,[[3,13,16,20]])}))),this.scene=e,this.loadPatternData()}var t=e.prototype;return t.createPane=function(){var e=this.scene.levelManager.getLevel();this.pane=new FI.Pane({title:"Level "+e,expanded:!0}),this.pane.registerPlugin(UI),this.element=this.pane.element,this.initPaneConfig()},t.initPaneConfig=function(){var e=this,t={opacity:.8,x:-8,y:-8,width:324};this.element.parentElement&&(this.element.parentElement.style.top=-t.y+"px",this.element.parentElement.style.left=-t.x+"px",this.element.parentElement.style.width=t.width+"px"),this.element.style.opacity=""+t.opacity,this.element.onwheel=function(n){var i=n.deltaY;t.y<=-8&&i<0||t.y>=e.element.clientHeight-document.body.clientHeight-8&&i>0||(t.y+=i/2,e.element.parentElement&&(e.element.parentElement.style.top=-t.y+"px"))}.bind(this)},t.initLevelDataConfig=function(){for(var e=this,t=this.pane.addFolder({title:"Target",expanded:!0}),n=[{text:"Blue",value:1},{text:"Green",value:2},{text:"Orange",value:3},{text:"Pink",value:4},{text:"Purple",value:5},{text:"Yellow",value:6}],i=function(){var i=n[a],s={};s[i.text]=!1;var r=0;e.data[i.text.toLowerCase()]&&(s[i.text]=!0,r=e.data[i.text.toLowerCase()]);var o=t.addInput(s,i.text).on("change",(function(t){if(t.value)l.disabled=!1;else{var n=e.getNumberByText(i.text);e.targets[n]=0,e.scene.listTargetsDiamond[0].value=e.formatTargets(),e.scene.header.updateCollectItems(),l.disabled=!0}})),c=e.getNumberByText(i.text);e.targets[c]=r;var l=t.addInput({number:r},"number",{min:0,max:50,step:1}).on("change",(function(t){if(console.log("e",o.label,t.value),o.label){var n=e.getNumberByText(o.label);e.targets[n]=t.value,console.log("formatTargets",e.formatTargets()),e.scene.listTargetsDiamond[0].value=e.formatTargets(),e.scene.header.updateCollectItems()}}));l.disabled=!0,s[i.text]&&(l.disabled=!1),e.collectionItemsBlade.push(o),e.collectionItemsBlade.push(l)},a=0;a<n.length;a++)i();this.scene.listTargetsDiamond[1].value="collect",this.scene.header.updateCollectItems(),this.collectionItemsBlade.forEach((function(e){e.hidden=!1}))},t.formatTargets=function(){var e="{";for(var t in this.targets)console.log(t+": "+this.targets[t]),0!=this.targets[t]&&(e+=t+": "+this.targets[t]+", ");return"{}"==(e=(e+="}").replace(", }","}"))?"":e},t.initPatternPane=function(){console.log("initPatternPane",this.patternData),this.patternFolder=this.pane.addFolder({title:"Pattern",expanded:!0})},t.initDataPatternPane=function(){var e=this,t=[];if(console.log("initDataPatternPane",this.patternData),this.patternData){this.patternData.value.forEach((function(e){t.push({text:e.name,value:e.name})}));var n=this.scene.gameZone.height;this.patternFolder.addBlade({view:"list",label:"choosePattern",options:t,value:{}}).on("change",(function(t){e.spawnViewPattern(t.value),e.hideAllViewPattern(),e.showViewPattern(t.value),e.patternSelected=t.value})),console.log("this.viewPattern ==== ",this.viewPattern),this.addPatternButton=this.patternFolder.addButton({title:"Add pattern"}).on("click",(function(){e.scene.panelEditPattern.open(370,n/2+30),e.addPatternButton.hidden=!0,e.savePatternButton.hidden=!1})),this.savePatternButton=this.patternFolder.addButton({title:"Save pattern"}).on("click",(function(){e.savePatternData(),e.scene.panelEditPattern.close(),e.addPatternButton.hidden=!1,e.savePatternButton.hidden=!0,e.viewPattern=[],e.pane.remove(e.patternFolder),e.initPatternPane(),e.initDataPatternPane()})),this.savePatternButton.hidden=!0,this.editPatternButton=this.patternFolder.addButton({title:"Edit pattern"}).on("click",(function(){var t;if(e.patternSelected){var i=f()(t=e.patternData.value).call(t,(function(t){return t.name===e.patternSelected}));i&&0!==i.length&&(e.scene.panelEditPattern.open(370,n/2+30,i),e.editPatternButton.hidden=!0,e.confirmPatternButton.hidden=!1)}})),this.confirmPatternButton=this.patternFolder.addButton({title:"Confirm"}).on("click",(function(){e.savePatternData(e.patternSelected),e.scene.panelEditPattern.close(),e.editPatternButton.hidden=!1,e.confirmPatternButton.hidden=!0,e.viewPattern=[],e.pane.remove(e.patternFolder),e.initPatternPane(),e.initDataPatternPane()})),this.confirmPatternButton.hidden=!0;this.patternFolder.addButton({title:"Apply Pattern"}).on("click",(function(){var t;if(console.log("this.patternSelected",e.patternSelected),e.patternSelected){var n=f()(t=e.patternData.value).call(t,(function(t){return t.name===e.patternSelected}));e.scene.board.loadBoardByPatternData(n[0].data),console.log("filterPatternData",n)}}))}},t.spawnViewPattern=function(e){var t,n,i=f()(t=this.patternData.value).call(t,(function(t){return t.name===e})),a=f()(n=this.viewPattern).call(n,(function(t){return t.name===e}));if(i&&0!==i.length&&!(a&&a.length>0)){var s=i[0];console.log("spawnViewPattern",s.data[0].length,s.data.length,s,this.patternFolder.addBlade);var r=this.patternFolder.addBlade({view:"buttongrid",size:[s.data[0].length,s.data.length],cells:function(e,t){return{title:s.data[t][e]}},label:"viewPattern"});this.viewPattern.push({name:s.name,viewPattern:r})}},t.hideAllViewPattern=function(){this.viewPattern.forEach((function(e){e.viewPattern.hidden=!0}))},t.showViewPattern=function(e){var t,n=f()(t=this.viewPattern).call(t,(function(t){return t.name===e}));n&&0!==n.length&&(n[0].viewPattern.hidden=!1)},t.hide=function(){this.setEnable(!1)},t.show=function(){this.setEnable(!0)},t.toggleEnable=function(){this.setEnable(!this.isEnable)},t.setEnable=function(e){void 0===e&&(e=!0),this.isEnable=e,this.pane.hidden=!e},t.setData=function(){this.pane&&(this.pane.remove(this.pane),this.pane.hidden=!0),this.createPane(),this.initLevelDataConfig(),this.initPatternPane(),this.initDataPatternPane()},e}(),VI=jI,zI=function(){function e(e){this.scene=void 0,this.currentLevel=void 0,this.scene=e,this.init()}var t=e.prototype;return t.init=function(){var e=this.scene.storage.getState(),t=(0,po.Ai)(e)||1;this.currentLevel=t},t.setLevel=function(e){this.currentLevel=e||1},t.getLevel=function(){return this.currentLevel||1},t.getLevelConfig=function(){},t.getNextLevel=function(){return this.currentLevel+1},t.increaseLevel=function(){this.currentLevel++},t.preloadLevel=function(){var e=(0,O.A)(D().mark((function e(t){var n,i,a;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"../assets/json/levels-test/",i="level-"+t+".json",e.prev=2,e.next=5,fetch("../assets/json/levels-test/"+i,{method:"GET"});case 5:return a=e.sent,e.next=8,a.json();case 8:n=e.sent,e.next=14;break;case 11:return e.prev=11,e.t0=e.catch(2),e.abrupt("return",void 0);case 14:return e.abrupt("return",n);case 15:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(t){return e.apply(this,arguments)}}(),t.loadLevelConfig=function(){var e=(0,O.A)(D().mark((function e(t){var n,i;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{"../assets/json/levels-test/",n="level-"+t,i="../assets/json/levels-test/"+("level-"+t+".json"),this.currentLevel=t,console.log("loadLevelConfig",this.currentLevel,{key:n,mapJson:i}),this.scene.cache.tilemap.exists(n)&&this.scene.cache.tilemap.remove(n),this.scene.load.tilemapTiledJSON(n,i),this.scene.load.start(),this.scene.load.off(Phaser.Loader.Events.COMPLETE),this.scene.load.once(Phaser.Loader.Events.COMPLETE,this.handleLoadCurrentMapComplete.bind(this))}catch(a){(0,x.a0)(a)}case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.handleLoadCurrentMapComplete=function(){this.scene.mapManager.reloadMap(this.currentLevel),this.scene.footer.textCurrentLevel.setText("Level "+this.currentLevel),this.scene.board.loadBoardByMap(),this.scene.board.loadTargetByMap(),this.scene.board.updateDataSegment(),this.scene.piecesPicked.loadPiecesByMapConfig(),this.scene.undoManager.reset()},t.loadCopyLevelConfig=function(){var e=(0,O.A)(D().mark((function e(t){var n,i,a;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{"../assets/json/levels-test/",n="level-"+t+".json",i="level-"+this.currentLevel,a="../assets/json/levels-test/"+n,console.log("loadLevelConfig",this.currentLevel,{key:i,mapJson:a}),this.scene.cache.tilemap.exists(i)&&this.scene.cache.tilemap.remove(i),this.scene.load.tilemapTiledJSON(i,a),this.scene.load.start(),this.scene.load.off(Phaser.Loader.Events.COMPLETE),this.scene.load.once(Phaser.Loader.Events.COMPLETE,this.handleLoadCurrentMapComplete.bind(this))}catch(s){(0,x.a0)(s)}case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),e}(),YI=function(){function e(e){this.scene=void 0,this.map=void 0,this.scene=e}var t=e.prototype;return t.getTileMap=function(){return Be()(this)},t.reloadMap=function(e){var t,n="level-"+e;console.log("reloadMap === ",n,this.scene.cache),null==(t=Be()(this))||t.destroy(),this.map=this.scene.make.tilemap({key:n})},e}(),HI=Fa.A.DEFAULT,KI=HI.KEY,WI=HI.FRAME,ZI=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.background=void 0,n.scene=t,n.setAlpha(.85),n.createBackground(),n.createReuseScroller(),n.createButtonClose(),n.setVisible(!1),n.scene.add.existing((0,ka.A)(n)),n}(0,_.A)(t,e);var n=t.prototype;return n.createBackground=function(){this.background=this.scene.add.rectangle(0,0,230,300,0,.95),this.background.setOrigin(.5,.5),this.setSize(230,300),this.add(this.background)},n.createReuseScroller=function(){var e=new jd(this.scene,{classType:bP,listConfigs:[],width:220,height:285,padding:0,marginTop:0,marginBottom:0});e.setPosition(0,0),e.createMask(),this.add(e);for(var t=[],n=[],i=0;i<iS.length;i++){var a=iS[i];n.push(a),(i+1)%3===0&&(t.push({item:n}),n=[])}e.updateConfig(t),e.setEnable(!0)},n.createButtonClose=function(){var e=this,t=new Va.A(this.scene,KI,WI.BUTTON_CLOSE,21,30);t.onClick=function(){e.close()},this.add(t),Phaser.Display.Align.In.TopCenter(t,this,115,5)},n.open=function(e,t){console.log("open PanelPickPieces"),this.setVisible(!0),this.setPosition(e,t);var n=125;this.x<n&&(this.x=n);var i=this.scene.gameZone.width;this.x>i-n&&(this.x=i-n),this.background.setInteractive(),this.bringToTop(this),this.scene.input.setTopOnly(!0)},n.close=function(){console.log("close PanelPickPieces"),this.setVisible(!1)},t}(Phaser.GameObjects.Container),XI=ZI,JI=Fa.A.EDITOR,qI=JI.KEY,QI=JI.FRAME,$I=Fa.A.GAMEPLAY_32.KEY,ex=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t)||this).scene=void 0,s.row=void 0,s.col=void 0,s.bg=void 0,s.gemSprite=void 0,s.gemHighlight=void 0,s.removeButton=void 0,s.scene=t,s.row=n,s.col=i,s.setSize(a,a),s.createBg(),s.createGemSprite(),s.createGemHighlight(),s.createRemoveButton(),s.listenEvents(),t.add.existing((0,ka.A)(s)),s}(0,_.A)(t,e);var n=t.prototype;return n.listenEvents=function(){var e=this;this.setInteractive().on(Phaser.Input.Events.POINTER_DOWN,(function(){if(e.scene.panelEditPattern.removeButtonShowing&&e.scene.panelEditPattern.removeButtonShowing.setVisible(!1),""!=e.scene.panelEditPattern.dataBoard[e.row][e.col].value)return e.scene.panelEditPattern.removeButtonShowing=e.removeButton,void e.removeButton.setVisible(!0);var t=e.scene.panelEditPattern.getWorldPosition(),n=t.x,i=t.y;e.scene.panelSelectCellPattern.open(n,i,e.row,e.col)}))},n.createBg=function(){this.bg=this.scene.make.image({key:qI,frame:QI.BUBBLE_TRANSPARENT}),this.bg.setWorldSize(this.width,this.height),this.add(this.bg)},n.createGemSprite=function(){this.gemSprite=this.scene.make.image({key:qI,frame:QI.BUBBLE_TRANSPARENT}),this.gemSprite.setWorldSize(this.width,this.height),this.add(this.gemSprite)},n.createRemoveButton=function(){var e=this;this.removeButton=new Va.A(this.scene,qI,QI.REMOVE_BUTTON,10,10),this.removeButton.setPosition(0,-5),this.removeButton.onClick=function(){e.scene.panelEditPattern.dataBoard[e.row][e.col].value="",e.reset(),e.removeButton.setVisible(!1)},this.removeButton.setVisible(!1),this.add(this.removeButton)},n.createGemHighlight=function(){this.gemHighlight=this.scene.make.image({key:qI,frame:QI.BUBBLE_SELECTED}),this.gemHighlight.setWorldSize(this.width,this.height),this.gemHighlight.setVisible(!1),this.add(this.gemHighlight)},n.showHighlight=function(){this.gemHighlight.setVisible(!0)},n.hideHighlight=function(){this.gemHighlight.setVisible(!1)},n.setGemFrame=function(e){this.gemSprite.setTexture($I),this.gemSprite.setFrame(e),this.gemSprite.setWorldSize(this.width,this.height)},n.reset=function(){this.resetGemSprite(),this.hideHighlight()},n.resetGemSprite=function(){this.gemSprite.setTexture(qI),this.gemSprite.setFrame(QI.BUBBLE_TRANSPARENT)},t}(Phaser.GameObjects.Container),tx=ex,nx=Fa.A.GAMEPLAY_32,ix=(nx.KEY,nx.FRAME),ax=GameCore.Configs.Board,sx=ax.rows,rx=ax.cols,ox=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.background=void 0,n.currentRows=sx,n.currentCols=rx,n.size=20,n.padding=2,n.removeButtonShowing=void 0,n.dataBoard=[],n.scene=t,n.setAlpha(.85),n.createBackground(),n.setVisible(!1),n.scene.add.existing((0,ka.A)(n)),n}(0,_.A)(t,e);var n=t.prototype;return n.createBackground=function(){this.background=this.scene.add.rectangle(0,0,20*(this.currentRows+1)+5,20*(this.currentRows+1)+5,0,.95),this.background.setOrigin(.5,.5),this.add(this.background),this.setSize(20*(this.currentRows+1)+5,20*(this.currentRows+1)+5),this.add(this.background)},n.createBoard=function(){for(var e=0,t=-(this.size+this.padding)*(this.currentRows+1)/2,n=0;n<this.currentRows;n++){e=-(this.size+this.padding)*(this.currentCols+1)/2,t+=this.size+this.padding,this.dataBoard[n]=[];for(var i=0;i<this.currentCols;i++){e+=this.size+this.padding;var a=new tx(this.scene,n,i,this.size);this.add(a),a.setPosition(e,t);var s={x:n,y:i,gemFrame:ix.GEM_TRANSPARENT,items:[],cell:a,value:""};this.dataBoard[n].push(s)}}},n.getValueBoard=function(){for(var e=[],t=0;t<this.currentRows;t++){e[t]=[];for(var n=0;n<this.currentCols;n++){var i=this.dataBoard[t][n].value;e[t].push(i)}}return console.log("data",e),e},n.clearBoard=function(){if(!(this.dataBoard.length<1))for(var e=0;e<this.currentRows;e++)for(var t=0;t<this.currentCols;t++){var n=this.dataBoard[e][t].cell;n&&n.destroy()}},n.loadPattern=function(e){if(!(e.length<1)){console.log("loadPattern",e);for(var t=0;t<this.currentRows;t++)for(var n=0;n<this.currentCols;n++){var i=this.dataBoard[t][n].cell,a=ix.GEM_BLUE;""!=e[t][n]&&("*"!=e[t][n]?(a=aS(parseInt(e[t][n])),this.scene.panelEditPattern.dataBoard[t][n].value=e[t][n],i.setGemFrame(a)):(this.scene.panelEditPattern.dataBoard[t][n].value="2",i.setGemFrame(a)))}}},n.open=function(e,t,n){console.log("open PanelEditPattern"),this.setVisible(!0),this.setPosition(e,t),this.clearBoard(),this.createBoard(),n&&this.loadPattern(n[0].data);var i=150;this.x<i&&(this.x=i);var a=this.scene.gameZone.width;this.x>a-i&&(this.x=a-i),this.background.setInteractive(),this.bringToTop(this),this.scene.input.setTopOnly(!0)},n.close=function(){console.log("close PanelEditPattern"),this.scene.levelDataPanel.addPatternButton.hidden=!1,this.scene.levelDataPanel.savePatternButton.hidden=!0,this.scene.levelDataPanel.editPatternButton.hidden=!1,this.scene.levelDataPanel.confirmPatternButton.hidden=!0,this.setVisible(!1)},t}(Phaser.GameObjects.Container),cx=ox,lx=Fa.A.DEFAULT_TOOL,hx=lx.KEY,ux=lx.FRAME,dx=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.background=void 0,n.scene=t,n.setAlpha(.85),n.createBackground(),n.createReuseScroller(),n.createButtonClose(),n.setVisible(!1),n.scene.add.existing((0,ka.A)(n)),n}(0,_.A)(t,e);var n=t.prototype;return n.createBackground=function(){this.background=this.scene.add.rectangle(0,0,230,300,0,.95),this.background.setOrigin(.5,.5),this.setSize(230,300),this.add(this.background)},n.createReuseScroller=function(){var e=new jd(this.scene,{classType:pw,listConfigs:[],width:220,height:285,padding:0,marginTop:0,marginBottom:0});this.scene.renderer,Phaser.Renderer.WebGL.WebGLRenderer,e.setPosition(0,0),e.createMask(),this.add(e);for(var t=[],n=[],i=0;i<iS.length;i++){var a=iS[i];n.push(a),(i+1)%3===0&&(t.push({item:n}),n=[])}e.updateConfig(t),e.setEnable(!0)},n.createButtonClose=function(){var e=this,t=new Va.A(this.scene,hx,ux.BUTTON_CLOSE_2,19.5,19.5);t.onClick=function(){e.close()},this.add(t),Phaser.Display.Align.In.TopCenter(t,this,115,5)},n.open=function(e,t){console.log("open PanelChangePiece"),this.setVisible(!0),this.setPosition(e,t);var n=125;this.x<n&&(this.x=n);var i=this.scene.gameZone.width;this.x>i-n&&(this.x=i-n),this.background.setInteractive(),this.bringToTop(this),this.scene.input.setTopOnly(!0)},n.close=function(){console.log("close PanelChangePiece"),this.setVisible(!1)},t}(Phaser.GameObjects.Container),px=dx,fx=function(){function e(e){this.scene=void 0,this.listCommands=[],this.listUndoCommands=[],this.scene=e}var t=e.prototype;return t.receiveCommand=function(e){console.log("receiveCommand",e),this.listCommands.push(e)},t.undoCommand=function(){var e,t,n,i=this.listCommands.pop();if(i)switch(Kt()(e=[Gb,jb]).call(e,i.event)||this.listUndoCommands.push(i),console.log("undoCommand",i),i.event){case Nb:if(""==i.prevState)return i.object.gemFrame="",void i.object.blockItem.reset();i.object.gemFrame=i.prevState,i.object.blockItem.setGemFrame(i.prevState);break;case Fb:var a=B()(t=[]).call(t,i.currentState);a.pop(),i.object.blockItem.resetItemSprites(),i.object.blockItem.resetItems(),a.forEach((function(e){i.object.blockItem.setItems(e)}));break;case Gb:for(var s=0;s<i.object.length;s++)this.undoCommand();this.listUndoCommands.push(i);break;case Ub:i.object.gemFrame=i.prevState.frame,i.object.blockItem.setGemFrame(i.prevState.frame),i.prevState.items.forEach((function(e){i.object.blockItem.setItems(e)}));break;case jb:for(var r=0;r<i.object.length;r++)this.undoCommand();this.listUndoCommands.push(i);break;case Vb:this.scene.listPiecesDataPicked.pop(),this.scene.piecesPicked.showPiecesPicked();break;case zb:_a()(n=this.scene.listPiecesDataPicked).call(n,i.prevState,0,i.object),this.scene.piecesPicked.showPiecesPicked();break;case Yb:this.scene.listPiecesDataPicked[i.prevState.index]=i.prevState,this.scene.piecesPicked.showPiecesPicked()}},t.redoCommand=function(){var e,t,n=this.listUndoCommands.pop();if(n)switch(Kt()(e=[Gb,jb]).call(e,n.event)||this.listCommands.push(n),console.log("redoCommand",n),n.event){case Nb:if(""==n.currentState)return n.object.gemFrame="",void n.object.blockItem.reset();n.object.gemFrame=n.currentState,n.object.blockItem.setGemFrame(n.currentState);break;case Fb:n.object.blockItem.resetItemSprites(),n.object.blockItem.resetItems(),n.currentState.forEach((function(e){n.object.blockItem.setItems(e)}));break;case Gb:for(var i=0;i<n.object.length;i++)this.redoCommand();this.listCommands.push(n);break;case Ub:n.object.gemFrame="",n.object.blockItem.reset();break;case jb:for(var a=0;a<n.object.length;a++)this.redoCommand();this.listCommands.push(n);break;case Vb:this.scene.listPiecesDataPicked.push(n.object),this.scene.piecesPicked.showPiecesPicked();break;case zb:_a()(t=this.scene.listPiecesDataPicked).call(t,n.prevState,1),this.scene.piecesPicked.showPiecesPicked();break;case Yb:this.scene.listPiecesDataPicked[n.prevState.index]=n.currentState,this.scene.piecesPicked.showPiecesPicked()}},t.reset=function(){this.listCommands=[],this.listUndoCommands=[]},e}(),mx=Fa.A.GAMEPLAY_32.FRAME,gx=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.gemSprite=void 0,i.payload=void 0,i.scene=t,i.payload=n,i.setSize(18,18),i.createGem(),i.listenEvents(),i}(0,_.A)(t,e);var n=t.prototype;return n.createGem=function(){this.gemSprite=this.scene.make.image({key:this.payload.key,frame:this.payload.frame}),this.gemSprite.setWorldSize(this.width,this.height),this.add(this.gemSprite)},n.listenEvents=function(){this.setInteractive().on(Phaser.Input.Events.POINTER_DOWN,this.onClick)},n.onClick=function(){console.log("CLICK",this.payload);var e=this.scene.panelSelectCellPattern,t=e.row,n=e.col,i=this.getIdByFrame(this.gemSprite.frame.name);this.scene.panelEditPattern.dataBoard[t][n].value=i.toString(),this.scene.panelEditPattern.dataBoard[t][n].cell.setGemFrame(this.gemSprite.frame.name),this.scene.panelSelectCellPattern.close()},n.getIdByFrame=function(e){switch(e){case mx.GEM_BLUE:return 2;case mx.GEM_GREEN:return 3;case mx.GEM_ORANGE:return 4;case mx.GEM_PINK:return 5;case mx.GEM_RED:return 6;case mx.GEM_VIOLET:return 7;case mx.BUBBLE_BLUE:return 11;case mx.BUBBLE_GREEN:return 12;case mx.BUBBLE_ORANGE:return 13;case mx.BUBBLE_PINK:return 14;case mx.BUBBLE_VIOLET:return 15;case mx.BUBBLE_YELLOW:return 16}return 0},t}(Phaser.GameObjects.Container),vx=gx,yx=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.background=void 0,n.size=24,n.row=void 0,n.col=void 0,n.scene=t,n.setAlpha(.85),n.createBackground(),n.createGems(),n.setVisible(!1),n.scene.add.existing((0,ka.A)(n)),n}(0,_.A)(t,e);var n=t.prototype;return n.createBackground=function(){var e=this.size,t=this.size;this.background=this.scene.add.rectangle(0,0,4.5*e,4.5*t,0,.95),this.background.setOrigin(.5,.5),this.add(this.background),this.setSize(4.5*e,4.5*t),this.add(this.background)},n.createGems=function(){for(var e=0,t=-Math.floor(qE.length/4)/2*this.size,n=0;n<qE.length;n++){e=-4*this.size/2+this.size/2+this.size*n-4*Math.floor(n/4)*this.size,t=-Math.floor(qE.length/4)/2*this.size+Math.floor(n/4)*this.size;var i=new vx(this.scene,{key:Fa.A.GAMEPLAY_32.KEY,frame:qE[n]});this.add(i),Phaser.Display.Align.In.Center(i,this,e,t)}},n.open=function(e,t,n,i){console.log("open PanelSelectCellPattern"),this.setVisible(!0),this.setPosition(e,t),this.row=n,this.col=i;this.x<90&&(this.x=90),this.y<90&&(this.y=90);var a=this.scene.gameZone.width;this.x>a-90&&(this.x=a-90),this.background.setInteractive(),this.bringToTop(this),this.setDepth(Na.A.ON_TOP),this.scene.input.setTopOnly(!0)},n.close=function(){console.log("close PanelSelectCellPattern"),this.setVisible(!1)},t}(Phaser.GameObjects.Container),Ax=yx,Ex=Fa.A.EDITOR,Tx=Ex.KEY,Sx=Ex.FRAME,bx=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=e.call.apply(e,B()(t=[this]).call(t,a))||this).header=void 0,n.board=void 0,n.footer=void 0,n.piecesPicked=void 0,n.gemSelectedItem=void 0,n.boardPositionBlockSelected=void 0,n.listPiecesDataPicked=[],n.listTargetsDiamond=[{name:"target",type:"string",value:""},{name:"typeLevel",type:"string",value:"collect"}],n.segmentValue={avgScore:0,piece1:"{min: 0, max: 0}",piece5:"{min: 0, max: 0}",pieceDistancePerGem:0,score:0},n.listGemBlockData=[],n.targetItem=void 0,n.enableChangeGemPiece=!1,n.indexPiece=void 0,n.cellOnPiece=void 0,n.scroller=void 0,n.pieceSelectedIndex=void 0,n.blockItemSelected=void 0,n.isSetLevelName=!1,n.heightDashboardItem=[100,230,250],n.indexDashboardItem=0,n.panelEditCell=void 0,n.panelSelectCell=void 0,n.panelSelectCellPattern=void 0,n.panelEditPiece=void 0,n.panelEditCellOfPiece=void 0,n.panelEditCellOnPiece=void 0,n.panelPickPieces=void 0,n.panelEditPattern=void 0,n.panelChangePiece=void 0,n.levelDataPanel=void 0,n.levelManager=void 0,n.mapManager=void 0,n.undoManager=void 0,n.modeToSave="",n.enableSelectMultiCell=!1,n.isKeyDownCTRL=!1,n.isKeyDownSHIFT=!1,n.listCellSelected=[],n.startPoint=void 0,n.endPoint=void 0,n.listDataCopy=[],n.startPointPaste=void 0,n.isPointerDown=!1,n.mapJson=void 0,n.run=(0,O.A)(D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.levelDataPanel.setData(),n.header.updateCollectItems(),n.levelDataPanel.setEnable(!0);case 3:case"end":return e.stop()}}),e)}))),n.handlePlayTest=function(){n.loadLevelConfig()},n.handleLoadCurrentMapComplete=function(){console.log("handleLoadCurrentMapComplete",n.cache.tilemap),n.scene.switch(ca.F7.GAME_SCENE)},n.handleExit=function(){n.levelDataPanel.setEnable(!1)},n}(0,_.A)(t,e);var n=t.prototype;return n.preload=function(){var e=this;this.load.atlas({key:Tx,textureURL:Fa.A.EDITOR.TEXTURE,atlasURL:Fa.A.EDITOR.JSON}),this.events.on(Phaser.Scenes.Events.WAKE,this.run),this.events.on(Phaser.Scenes.Events.CREATE,this.run),this.input.keyboard.on("keydown-ESC",this.handleExit),this.input.keyboard.on("keydown-CTRL",(function(){var t;null==(t=e.blockItemSelected)||t.hideHighlight(),e.panelEditCell.close(),e.blockItemSelected=void 0,e.enableSelectMultiCell=!0,e.isKeyDownCTRL=!0,console.log("keydown-CTRL")})),this.input.keyboard.on("keyup-CTRL",(function(){if(e.isKeyDownCTRL=!1,0!=e.listCellSelected.length){var t=e.listCellSelected[e.listCellSelected.length-1].getWorldPosition(),n=t.x,i=t.y;e.panelEditCell.open(n,i),console.log("keyup-CTRL",e.listCellSelected)}else e.enableSelectMultiCell=!1})),this.input.keyboard.on("keydown-SHIFT",(function(){var t;null==(t=e.blockItemSelected)||t.hideHighlight(),e.panelEditCell.close(),e.blockItemSelected=void 0,e.enableSelectMultiCell=!0,e.isKeyDownSHIFT=!0,console.log("keydown-SHIFT")})),this.input.keyboard.on("keyup-SHIFT",(function(){if(e.isKeyDownSHIFT=!1,0!=e.listCellSelected.length){var t=e.listCellSelected[e.listCellSelected.length-1].getWorldPosition(),n=t.x,i=t.y;e.panelEditCell.open(n,i),console.log("keyup-SHIFT",e.listCellSelected)}else e.enableSelectMultiCell=!1})),this.input.on(Phaser.Input.Events.POINTER_DOWN,(function(t){e.isPointerDown=!0,e.isKeyDownSHIFT&&(e.startPoint={x:t.worldX,y:t.worldY},console.log("POINTER_DOWN",t.worldX,t.worldY))})),this.input.on(Phaser.Input.Events.POINTER_MOVE,(function(t){e.isKeyDownSHIFT&&e.startPoint&&(e.board.getBlockItemsByPoints(e.startPoint,{x:t.worldX,y:t.worldY}),console.log("POINTER_MOVE",t.worldX,t.worldY))})),this.input.on(Phaser.Input.Events.POINTER_UP,(function(){console.log("POINTER_UP"),e.isPointerDown=!1,e.startPoint=void 0})),this.input.keyboard.on("keydown-Z",(function(){e.isKeyDownCTRL&&(e.undoManager.undoCommand(),console.log("keydown-Z"))})),this.input.keyboard.on("keydown-Y",(function(){e.isKeyDownCTRL&&(e.undoManager.redoCommand(),console.log("keydown-Y"))})),this.input.keyboard.on("keydown-C",(function(){if(e.isKeyDownCTRL){e.listDataCopy=[];for(var t=0;t<e.listCellSelected.length;t++){var n=e.listCellSelected[t],i=n.row,a=n.col,s=n.items,r=e.listCellSelected[t].getGemFrame();console.log({row:i,col:a,items:s,frame:r}),e.listDataCopy.push({row:i,col:a,items:s,frame:r})}e.closeAllPanels(),console.log("keydown-C")}})),this.input.keyboard.on("keydown-V",(function(){if(e.isKeyDownCTRL&&(console.log("keydown-V"),!(e.listDataCopy.length<1)&&e.startPointPaste))for(var t=e.startPointPaste,n=t.row,i=t.col,a=e.listDataCopy[0],s=a.row,r=a.col,o=function(){var t=e.listDataCopy[c],a=t.row,o=t.col,l=t.items,h=t.frame,u=a-s+n,d=o-r+i;return u>e.board.currentRows-1||d>e.board.currentCols||u<0||d<0?0:(e.board.setPickItemForBoardData({x:u,y:d},h),void(l.length>0&&l.forEach((function(t){e.board.setPickItemForBoardData({x:u,y:d},t)}))))},c=0;c<e.listDataCopy.length;c++)o()}))},n.create=function(){e.prototype.create.call(this),this.createPiecesPicked(),this.createScroller(),this.createBoard(),this.createHeader(),this.createLevelManager(),this.createMapManager(),this.createUndoManager(),this.createFooter(),this.createScreen(),this.createPanels()},n.createHeader=function(){this.header=new fC(this),Phaser.Display.Align.In.Center(this.header,this.gameZone,0,-200)},n.createBoard=function(){this.board=new qb(this),Phaser.Display.Align.In.Center(this.board,this.gameZone,0,0)},n.createLevelManager=function(){this.levelManager=new zI(this)},n.createMapManager=function(){this.mapManager=new YI(this)},n.createUndoManager=function(){this.undoManager=new fx(this)},n.createFooter=function(){this.footer=new vP(this),Phaser.Display.Align.In.BottomCenter(this.footer,this.gameZone)},n.createPiecesPicked=function(){this.piecesPicked=new RI(this),this.piecesPicked.showPiecesPicked()},n.createScroller=function(){var e=this,t=this.gameZone,n=t.width,i=t.height,a=new Ud.A(this,{width:n,height:30*i,marginBottom:0,marginTop:0,scrollingBackRate:0}),s=this.make.image({key:Tx,frame:Sx.BLANK,alpha:0,tint:0});s.setTint(0),s.setWorldSize(n,i),a.add(s),a.sendToBack(s),a.createMask(),a.setEnable(!0),a.addItem(this.piecesPicked),this.add.existing(a),Phaser.Display.Align.In.Center(this.piecesPicked,a,n/3,-130),Phaser.Display.Align.In.Center(a,this.gameZone),a.on(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,(function(){console.log("GAMEOBJECT_POINTER_UP"),e.closeAllPanels()}))},n.createPanels=function(){this.createPanelEditCellOfPiece(),this.createPanelEditCell(),this.createPanelSelectCell(),this.createPanelSelectCellPattern(),this.createPanelEditPiece(),this.createPanelEditCellONPiece(),this.createLevelDataPanel(),this.createPanelPickPieces(),this.createPanelEditPattern(),this.createPanelChangePiece()},n.createPanelEditCell=function(){this.panelEditCell=new bw(this)},n.createPanelSelectCell=function(){this.panelSelectCell=new Cw(this)},n.createPanelSelectCellPattern=function(){this.panelSelectCellPattern=new Ax(this)},n.createPanelEditPiece=function(){this.panelEditPiece=new Dw(this)},n.createPanelEditCellOfPiece=function(){this.panelEditCellOfPiece=new Bw(this)},n.createPanelEditCellONPiece=function(){this.panelEditCellOnPiece=new GI(this)},n.createLevelDataPanel=function(){this.levelDataPanel=new VI(this)},n.createPanelPickPieces=function(){this.panelPickPieces=new XI(this)},n.createPanelEditPattern=function(){this.panelEditPattern=new cx(this)},n.createPanelChangePiece=function(){this.panelChangePiece=new px(this)},n.loadLevelConfig=function(){try{var e="level-test";this.cache.tilemap.exists(e)&&this.cache.tilemap.remove(e),this.load.once(Phaser.Loader.Events.COMPLETE,this.handleLoadCurrentMapComplete),this.load.tilemapTiledJSON(e,this.mapJson),this.load.start()}catch(t){(0,x.a0)(t)}},n.createScreen=function(){this.createPickGemScreen(),this.createPickPiecesScreen(),this.createCustomPieceScreen(),this.createTargetGemScreen(),this.createSettingScreen(),this.createChangePieceScreen()},n.createPickGemScreen=function(){this.screen.add(Ua.R8.PICK_GEM_SCREEN,dP)},n.createPickPiecesScreen=function(){this.screen.add(Ua.R8.PICK_PIECES_SCREEN,DP)},n.createCustomPieceScreen=function(){this.screen.add(Ua.R8.CUSTOM_PIECE_SCREEN,bC)},n.createTargetGemScreen=function(){this.screen.add(Ua.R8.TARGET_GEM_SCREEN,JC)},n.createSettingScreen=function(){this.screen.add(Ua.R8.SETTINGS_SCREEN,uw)},n.createChangePieceScreen=function(){this.screen.add(Ua.R8.CHANGE_PIECE_SCREEN,yw)},n.setGemSelected=function(e){this.gemSelectedItem=e},n.setBoardPositionSelected=function(e){this.boardPositionBlockSelected=e},n.clearBoardPositionSelected=function(){this.boardPositionBlockSelected=null},n.pickGem=function(e){console.log("payloadddddddd =====",e),this.checkEnableChangeGemPiece(e)||this.boardPositionBlockSelected&&this.board.setPickItemForBoardData(this.boardPositionBlockSelected,e.frame)},n.checkEnableChangeGemPiece=function(e){if(this.enableChangeGemPiece){var t=this.cellOnPiece.parentContainer;t.listCells[this.cellOnPiece.index].setFrameCell(e.frame);var n=$E(e.frame),i=(e.frame,0),a=this.cellOnPiece,s=a.row,r=a.col;return console.log("checkEnableChangeGemPiece",s,r,t.index,n),1==n?(this.listPiecesDataPicked[t.index].item[s][r]=i,t.updateInfo(this.listPiecesDataPicked[t.index])):this.listPiecesDataPicked[t.index].data[s][r]=n,this.piecesPicked.showPiecesPicked(),!0}return!1},n.clearFrameCellOnPiece=function(e){var t=this.cellOnPiece.parentContainer;t.listCells[this.cellOnPiece.index].setFrameCell(e);var n=$E(e),i=this.cellOnPiece,a=i.row,s=i.col;this.listPiecesDataPicked[t.index].data[a][s]=n,this.listPiecesDataPicked[t.index].item[a][s]=0,t.updateInfo(this.listPiecesDataPicked[t.index]),this.piecesPicked.showPiecesPicked()},n.addPieceDataPicked=function(e){this.listPiecesDataPicked.push(e),console.log("this.listPiecesDataPicked",this.listPiecesDataPicked)},n.resetTarget=function(){this.listTargetsDiamond[0].value="",this.listTargetsDiamond[1].value=""},n.resetPieces=function(){this.listPiecesDataPicked=[],this.piecesPicked.showPiecesPicked()},n.closeAllPanels=function(){var e;console.log("closeAllPanels",this.enableChangeGemPiece),this.enableChangeGemPiece||this.panelEditCellOfPiece.close(),null==(e=this.cellOnPiece)||e.hideHighlight(),this.panelEditCell.close(),this.panelEditPiece.close(),this.panelSelectCell.close(),this.panelEditPattern.close(),this.panelEditCellOfPiece.close(),this.panelEditCellOnPiece.close()},t}(vo.A),Px=bx,Cx=["Enable"],wx=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=e.call.apply(e,B()(t=[this]).call(t,a))||this).renderOnDemand=!0,n}(0,_.A)(t,e);var i=t.prototype;return i.boot=function(){var t=(0,O.A)(D().mark((function t(){return D().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.prototype.boot.call(this),this.addExtraGameObjectMethods(),this.addExtraFBInstantFunctions(),this.addPlugins(),t.next=6,this.addDevPlugins();case 6:return t.next=8,this.initAds();case 8:this.addScenes(),this.addDevScenes(),this.initWorld(),this.initStorage(),this.initVisibilityChangeHandler(),this.initUtils(),this.initRollbar(),this.initConsole(),this.initDebugger(),this.initStatistics(),this.initParticleEditor(),this.initAdaptivePerformance(),this.initProfilerPlugin(),this.initCanvasRecorderPlugin();case 22:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),i.start=function(){e.prototype.start.call(this)},i.updateFps=function(e){void 0===e&&(e=60),this.getFps()!==e&&this.setFps(e)},i.getFps=function(){return this.scene.game&&this.scene.game.loop&&this.scene.game.loop.raf?this.scene.game.loop.raf.fps:5},i.setFps=function(e){this.scene.game&&this.scene.game.loop&&this.scene.game.loop.raf&&"function"===typeof this.scene.game.loop.raf.updateFps&&this.scene.game.loop.raf.updateFps(e)},i.addExtraGameObjectMethods=function(){var e=new U(this);e.addKillRevive(),e.addKillReviveGroup(),e.addDrawDebugBox(),e.addSetWorldSize(),e.addSetWorldSizeForContainer(),e.addGetWorldPosition(),e.addHighQuality(),e.addSetLineHeightForBitmapText()},i.addExtraFBInstantFunctions=function(){var e=new G.A(this.facebook);this.facebook.shareAsync=e.shareAsync,this.facebook.inviteAsync=e.inviteAsync,this.facebook.switchAsync=e.switchAsync,this.facebook.chooseAsync=e.chooseAsync,this.facebook.createAsync=e.createAsync,this.facebook.sendMessage=e.sendMessage,this.facebook.getContextID=e.getContextID,this.facebook.getPlayerToken=e.getPlayerToken,this.facebook.matchPlayerAsync=e.matchPlayerAsync,this.facebook.getContextPlayers=e.getContextPlayers,this.facebook.setLoadingProgress=e.setLoadingProgress,this.facebook.attemptToAddShortcut=e.attemptToAddShortcut,this.facebook.attemptToSubscribeBot=e.attemptToSubscribeBot,this.facebook.postSessionScoreAsync=e.postSessionScoreAsync,this.facebook.getRewardedVideoAsync=e.getRewardedVideoAsync,this.facebook.getInterstitialAdAsync=e.getInterstitialAdAsync,this.facebook.postSessionScoreAsync=e.postSessionScoreAsync,this.facebook.sendNotificationAsync=e.sendNotificationAsync,this.facebook.isSupportedAPI=e.isSupportedAPI,e.injectTournament(),this.facebook.progressLoading=new xa(this)},i.addPlugins=function(){this.plugins.install("Storage",Di,!0,"storage"),this.plugins.install("Rollbar",nn,!0,"rollbar"),this.plugins.install("AdsManager",ie,!0,"ads"),this.plugins.install("AuthManager",Ie,!0,"auth"),this.plugins.install("AudioManager",ge,!0,"audio"),this.plugins.install("WorldManager",zi,!0,"world"),this.plugins.install("PlayerManager",Dt,!0,"player"),this.plugins.install("ProfileManager",Vt,!0,"profile"),this.plugins.install("AnalyticsManager",re,!0,"analytics"),this.plugins.install("AdaptivePerformance",ba,!0,"performance"),this.plugins.install("VisibilityChangeHandler",BE,!0,"visibility"),this.plugins.install("JourneySeasonManager",jE,!0,"journeySeason"),this.plugins.installScenePlugin("textStyler",Fi,"textStyler"),this.plugins.installScenePlugin("ScreenManager",dn,"screen"),this.plugins.installScenePlugin("FrameCapture",Oe,"frameCapture"),window.SpinePlugin&&this.plugins.installScenePlugin("SpinePlugin",SpinePlugin,"spine"),this.storage=this.plugins.get("Storage"),this.rollbar=this.plugins.get("Rollbar"),this.ads=this.plugins.get("AdsManager"),this.auth=this.plugins.get("AuthManager"),this.audio=this.plugins.get("AudioManager"),this.world=this.plugins.get("WorldManager"),this.player=this.plugins.get("PlayerManager"),this.profile=this.plugins.get("ProfileManager"),this.analytics=this.plugins.get("AnalyticsManager"),this.performance=this.plugins.get("AdaptivePerformance"),this.visibility=this.plugins.get("VisibilityChangeHandler"),this.journeySeason=this.plugins.get("JourneySeasonManager")},i.addDevPlugins=function(){var e=(0,O.A)(D().mark((function e(){var t,i,a,s,r,o;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(GameCore.Utils.Valid.isDebugger()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Promise.all([n.e(51),n.e(852)]).then(n.bind(n,676));case 4:return t=e.sent.default,e.next=7,Promise.all([n.e(667),n.e(973)]).then(n.bind(n,677));case 7:return i=e.sent.default,e.next=10,n.e(914).then(n.bind(n,678));case 10:return a=e.sent.default,e.next=13,n.e(853).then(n.bind(n,679));case 13:return s=e.sent.default,e.next=16,n.e(222).then(n.bind(n,680));case 16:return r=e.sent.default,e.next=19,Promise.all([n.e(404),n.e(115)]).then(n.bind(n,681));case 19:o=e.sent.default,this.plugins.install("Console",t,!0,"console"),this.plugins.install("Debugger",i,!0,"debugger"),this.plugins.install("Statistics",a,!0,"statistics"),this.plugins.install("ParticleEditor",s,!0,"particle-editor"),this.plugins.install("Profiler",r,!0,"profiler"),this.plugins.install("CanvasRecorder",o,!0,"canvasRecorder"),this.eruda=this.plugins.get("Console"),this.debugger=this.plugins.get("Debugger"),this.statistics=this.plugins.get("Statistics"),this.particleEditor=this.plugins.get("ParticleEditor"),this.profiler=this.plugins.get("Profiler"),this.canvasRecorder=this.plugins.get("CanvasRecorder");case 32:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),i.addScenes=function(){this.scene.add(ca.F7.BOOT_SCENE,va,!0),this.scene.add(ca.F7.LOAD_SCENE,DE,!1),this.scene.add(ca.F7.GAME_SCENE,vA,!1),this.scene.add(ca.F7.LEVEL_EDITOR_SCENE,Px,!1),this.scene.add(ca.F7.GLOBAL_SCENE,yA.A,!1)},i.addDevScenes=function(){var e=(0,O.A)(D().mark((function e(){var t,i;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(GameCore.Utils.Valid.isDebugger()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,n.e(116).then(n.bind(n,682));case 4:return t=e.sent.default,e.next=7,n.e(654).then(n.bind(n,683));case 7:i=e.sent.default,this.scene.add(ca.F7.TEST_SCENE,t,!1),this.scene.add(ca.F7.ANIMATIONS_SCENE,i,!1);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),i.initAds=function(){var e=(0,O.A)(D().mark((function e(){var t,i,a;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=GameCore.Configs.Ads,Pa.A.setGame(this),i=Pa.A,!t.Mockup.Enable){e.next=8;break}return e.next=6,n.e(756).then(n.bind(n,684));case 6:a=e.sent.default,i=a;case 8:this.ads.configure(i,{enabled:t.Enabled,interstitialPID:t.InterstitialPlacementId,rewardedVideoPID:t.VideoRewardsPlacementId,interstitialAdOptions:t.InterstitialAdOptions,bannerPID:t.BannerPlacementId,bannerReloadPeriod:t.BannerReloadPeriod});case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),i.initWorld=function(){var e=GameCore.Configs.Game,t=e.AutoResize,n=e.PortraitRatio,i=e.PortraitWidth,a=e.PortraitHeight,s=e.LandscapeRatio,r=e.LandscapeWidth,o=e.LandscapeHeight,c=t,l=e.DisableLandscape,h=e.FullSizeOnLandscape,u=n,d=i,p=a,f=s,m=r,g=o;console.info("\ud83d\ude80 > portraitRatio",u),console.info("\ud83d\ude80 > landscapeRatio",f),this.world.configure({autoResize:c,portraitRatio:u,portraitWidth:d,portraitHeight:p,landscapeRatio:f,landscapeWidth:m,landscapeHeight:g,disableLandscape:l,fullSizeOnLandscape:h}),this.world.resize(e.ForcePixelRatio)},i.initStorage=function(){var e=new oa(this);this.storage.setInitiator(e)},i.initVisibilityChangeHandler=function(){this.visibility.configure()},i.initUtils=function(){this.handlePauseAudio(),this.removeUnusedPipelines()},i.initConsole=function(){GameCore.Utils.Valid.isDebugger()&&(GameCore.Configs.Debugger.ShowConsole&&this.eruda.configure({tool:["console","info"],defaults:{theme:"Dark"}}))},i.initDebugger=function(){if(GameCore.Utils.Valid.isDebugger()){var e=GameCore.Configs.Debugger,t=e.ShowInspector,n=e.ShowMonitoring;(t||n)&&this.debugger.configure(GameCore.Configs.Debugger)}},i.initStatistics=function(){GameCore.Utils.Valid.isDebugger()&&(GameCore.Configs.Statistics.Enable&&this.statistics.configure(GameCore.Configs.Statistics))},i.initParticleEditor=function(){GameCore.Utils.Valid.isDebugger()&&(GameCore.Configs.ParticleEditor.Enable&&this.particleEditor.configure(GameCore.Configs.ParticleEditor))},i.initProfilerPlugin=function(){GameCore.Utils.Valid.isDebugger()&&(GameCore.Configs.ProfilerPlugin.Enable&&this.profiler.configure())},i.initAdaptivePerformance=function(){var e=GameCore.Configs.Performance,t=e.Enable,n=(0,k.A)(e,Cx);if(t){var i=this.world.getPixelRatio();this.performance.configure((0,a.A)({pixelRatio:i},n)),this.performance.active()}},i.initCanvasRecorderPlugin=function(){var e=this;if(GameCore.Utils.Valid.isDebugger()){var t=GameCore.Configs.CanvasRecorder;if(t.Enable){var n=t.Options,i=n.Type,a=n.Quality,s=n.RecordFps,r=n.SyncFps;this.canvasRecorder.configure({type:i,quality:a,syncFps:r,recordFps:s});var o=document.querySelector("canvas");if(!o)return console.error("Canvas not found");this.canvasRecorder.setCanvas(o);var c=this.canvasRecorder.getOptions(),l=this.canvasRecorder.waitNextFrame;this.canvasRecorder.waitNextFrame=(0,O.A)(D().mark((function t(){return D().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!c.syncFps){t.next=5;break}return e.loop.sleep(),t.abrupt("return",new(N())((function(t){e.events.once(Phaser.Core.Events.POST_RENDER,t),e.loop.lastTime=1e3/c.recordFps,e.loop.step()})));case 5:return e.loop.wake(),t.abrupt("return",l.call(e.canvasRecorder));case 7:case"end":return t.stop()}}),t)})))}}},i.initRollbar=function(){var e=GameCore.Configs.Rollbar.Enable;console.warn({isRollbarEnabled:e}),e&&this.rollbar.setup()},i.handlePauseAudio=function(){var e=this;this.sound.pauseOnBlur=!1,this.visibility.addEventVisible((function(){e.audio.playMusic(),e.audio.resumeAllSounds()})),this.visibility.addEventHidden((function(){e.audio.pauseMusic(),e.audio.pauseAllSounds()}))},i.removeUnusedPipelines=function(){var e=this.renderer;if(e instanceof Phaser.Renderer.WebGL.WebGLRenderer){var t=e.pipelines,n=Phaser.Renderer.WebGL.Pipelines;[n.ROPE_PIPELINE,n.LIGHT_PIPELINE,n.POSTFX_PIPELINE,n.POINTLIGHT_PIPELINE,n.BITMAPMASK_PIPELINE].forEach((function(e){var n;null==(n=t.get(e))||n.destroy(),t.remove(e)}))}},t}(Phaser.Game),Ix=wx,xx=GameCore.Configs.Debugger.ShowInspector,kx={parent:"app",type:Phaser.AUTO,width:0,height:0,scale:{autoRound:!0},dom:{createContainer:!1},loader:{maxParallelDownloads:6,crossOrigin:"no-cros"},input:{gamepad:!1,keyboard:xx,touch:{capture:!0},smoothFactor:1,activePointers:1,windowEvents:!1},disableContextMenu:!0,fps:{},render:{pixelArt:!1,antialias:!0,transparent:!1,desynchronized:!1,powerPreference:"high-performance",clearBeforeRender:!1,roundPixels:!1},plugins:{global:[]}};window.GameCore=I,(0,x.ig)();var Ox=setInterval((function(){window.__analyticsInitiated&&(window.__fbGameReady=!1,clearInterval(Ox),clearInterval(window.__fbInstantLoadingTimer),FBInstant.setLoadingProgress(30),gtag("event","app_initialize",{send_to:["GA"]}),function(){try{var e=new Ix(kx);window.game=e}catch(t){(0,x.a0)(t)}}())}),50)},501:function(e,t){"use strict";t.A={PASS_LEVELS:{ID:"pass-levels",EVENTS:{PASS_LEVEL:"pass-level"}},COLLECT_DIAMONDS:{ID:"collect-diamonds",EVENTS:{COLLECT_DIAMONDS:"collect-diamonds"}},INVITE_FRIENDS:{ID:"invite-friends",EVENTS:{INVITED_FRIEND:"INVITED_FRIEND"}},REACH_SCORE:{ID:"reach-score",EVENTS:{ADD_SCORE:"add-score"}},EVENTS:{TASKS_RESET:"tasks-reset",NOTICE_UPDATE:"notice-update"}}},227:function(e,t,n){"use strict";n.d(t,{Kv:function(){return g},bO:function(){return v},bl:function(){return A},iD:function(){return y}});var i=n(23),a=n(20),s=n.n(a),r=n(136),o=n(497),c=GameCore.Configs,l=c.OtherHost,h=c.LeadersBoard,u=h.Prefix,d=h.LeaderboardId,p=u+"/"+d+"/leaders",f=u+"/"+d+"/players",m=function(e){var t="";return d?(e===o.n?t=p:e===o.A&&(t=f),t):t},g=function(){var e=(0,i.A)(s().mark((function e(t){var n,i,a,c,h;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t={}),n=[],i=m(o.n)){e.next=5;break}return e.abrupt("return",n);case 5:return a=GameCore.Utils.String.params(t),e.next=8,(0,r.J)(i+"?"+a,{},l);case 8:if(c=e.sent,!((h=(null==c?void 0:c.data)||[]).length<1)){e.next=12;break}return e.abrupt("return",n);case 12:return n=h,e.abrupt("return",n);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=(0,i.A)(s().mark((function e(t){var n,i,a,c,h;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t={}),n=[],i=m(o.A)){e.next=5;break}return e.abrupt("return",n);case 5:return a=GameCore.Utils.String.params(t),e.next=8,(0,r.J)(i+"?"+a,{},l);case 8:if(c=e.sent,!((h=(null==c?void 0:c.data)||[]).length<1)){e.next=12;break}return e.abrupt("return",n);case 12:return n=h,e.abrupt("return",n);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=(0,i.A)(s().mark((function e(t){var n,i,a,c,h;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=null,t){e.next=3;break}return e.abrupt("return",n);case 3:if(i=m(o.A)){e.next=6;break}return e.abrupt("return",n);case 6:return a=GameCore.Utils.String.params({playerIds:t}),e.next=9,(0,r.J)(i+"?"+a,{},l);case 9:if(c=e.sent,!((h=(null==c?void 0:c.data)||[]).length<1)){e.next=13;break}return e.abrupt("return",n);case 13:return n=h[0],e.abrupt("return",n);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),A=function(){var e=(0,i.A)(s().mark((function e(t,n){var i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,r.b)("leaderboards/"+d+"/players/"+t,{score:n},{},l);case 2:return i=e.sent,e.abrupt("return",(null==i?void 0:i.data)||{});case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},497:function(e,t,n){"use strict";n.d(t,{A:function(){return a},n:function(){return i}});var i="global",a="friend"},496:function(e,t,n){"use strict";n.d(t,{kw:function(){return J},ry:function(){return X},JJ:function(){return ee},El:function(){return Z},jw:function(){return te},Vj:function(){return ce},V8:function(){return H},oE:function(){return $},nv:function(){return q},nK:function(){return Q},wi:function(){return W},mX:function(){return K},Gd:function(){return se},ST:function(){return re},nd:function(){return oe}});var i=n(57),a=n(23),s=n(75),r=n.n(s),o=n(72),c=n.n(o),l=n(40),h=n.n(l),u=n(20),d=n.n(u),p=n(48),f=n(109),m=n(691),g=n(222),v=n(70),y=n(226),A=n(227),E=n(4),T=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="NewScoreIsBad",i.message=t||"The new score is bad",i.payload=n,i}return(0,E.A)(t,e),t}((0,n(30).A)(Error)),S=n(498),b=n(483),P=n(500),C=n(692),w=n(144),I=n(232),x=n(47),k=n(138),O=n(110),_=n(503),R=n(228),D=n(111),M=n(143),B=n(504),L=n(505),N=n(499),G=n(230),F=n(506),U=GameCore.Configs.Match,j=function(e){var t=e.contextId;if(""===t||"string"!==typeof t)throw new m.A(null,{contextId:t})},V=null,z=function(e){clearTimeout(V),V=setTimeout((function(){window.game.globalScene.screen.close(v.R8.NOTIFY_SCREEN)}),e)},Y=function(){return{type:k.uf,payload:{}}},H=function(e){return{type:k.ad,payload:{stateShowMiniJourney:e}}},K=function(e){return function(){var t=(0,a.A)(d().mark((function t(n){var i,a,s,r,o,c,l,h;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n((0,B.f_)()),i=e.getPayload(),a=e.getID(),!i){t.next=27;break}return s=JSON.parse(i),r=s.leaderboardId,n((0,S.Ub)(a.toString(),r)),o=0,t.prev=9,c=window.FBInstant.player.getID(),t.next=13,(0,G.hJ)(c,r);case 13:if(t.t0=t.sent,t.t0){t.next=16;break}t.t0={};case 16:l=t.t0,h=l.score,o=parseInt(void 0===h?0:h),t.next=24;break;case 21:t.prev=21,t.t1=t.catch(9),console.warn(t.t1);case 24:return t.prev=24,F.A.setCurrentTourPlayerScore(o),t.finish(24);case 27:n(ie(O.zA,null)),t.next=33;break;case 30:t.prev=30,t.t2=t.catch(0),(0,x.a0)(t.t2);case 33:case"end":return t.stop()}}),t,null,[[0,30],[9,21,24,27]])})));return function(e){return t.apply(this,arguments)}}()},W=function(){return function(){var e=(0,a.A)(d().mark((function e(t){var n;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t((0,B.OI)()),t((0,B.f_)()),!(n=window.FBInstant.context.getID())||"SOLO"===n){e.next=12;break}return e.prev=5,e.next=8,window.game.facebook.switchAsync("SOLO");case 8:e.next=12;break;case 10:e.prev=10,e.t0=e.catch(5);case 12:t(ie(O.Nu)),e.next=18;break;case 15:e.prev=15,e.t1=e.catch(0),(0,x.a0)(e.t1);case 18:case"end":return e.stop()}}),e,null,[[0,15],[5,10]])})));return function(t){return e.apply(this,arguments)}}()},Z=function(){return function(){var e=(0,a.A)(d().mark((function e(t,n){var a,s,o,c,l,h;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,s=n(),o=(0,R.qs)(s),c=(0,D.In)(s),!r()(a=[O.Nu,O.zA]).call(a,o)){e.next=11;break}return t((0,B.f_)()),(l={})[U.SingleMatchStore]=(0,i.A)({},c,{data:"",rescued:0,score:0}),e.next=10,window.FBInstant.player.setDataAsync(l);case 10:t((0,B.SZ)());case 11:return h=null,o===O.QT&&(h=(0,D.sp)(s),t((0,B.OI)())),t((0,L._D)()),e.next=16,t(ie(o,h,!1));case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(0),(0,x.a0)(e.t0);case 21:return e.prev=21,e.finish(21);case 23:case"end":return e.stop()}}),e,null,[[0,18,21,23]])})));return function(t,n){return e.apply(this,arguments)}}()},X=function(){return function(e,t){try{var n,i=t(),a=(0,R.qs)(i);r()(n=[O.Nu,O.zA]).call(n,a)&&(e((0,B.f_)()),e((0,B.SZ)())),a===O.QT&&e((0,B.OI)()),e((0,L._D)())}catch(s){(0,x.a0)(s)}}},J=function(e,t){return void 0===e&&(e="10"),void 0===t&&(t=!1),function(n){try{n(q("reset",e,t))}catch(i){(0,x.a0)(i)}}},q=function(e,t,n){return void 0===t&&(t="10"),void 0===n&&(n=!1),function(){var n=(0,a.A)(d().mark((function n(i){var a,s,r,o,c,l,h,u,p,g,y,A,E,T,S,P,C;return d().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,a=window.game,s=a.player,r=a.facebook,a.globalScene.screen.open(v.R8.NOTIFY_SCREEN,{message:"Loading...",loading:!0}),o=e,c=r.contextType,t||(l=GameCore.Configs.PlayerIdMock,h=GameCore.Configs.PlayerIdMock2,t=s.getPlayerId()===l?h:l),e){n.next=30;break}return n.next=9,r.chooseAsync();case 9:if(!1!==(o=n.sent)){n.next=16;break}return n.next=13,se();case 13:return n.next=15,i(W());case 15:return n.abrupt("return");case 16:return n.prev=16,n.next=19,r.getTournamentAsync();case 19:return u=n.sent,n.next=22,i(K(u));case 22:return n.abrupt("return");case 25:n.prev=25,n.t0=n.catch(16),console.log("chooseAsyncJoinTournament",n.t0);case 28:n.next=43;break;case 30:if(!t||t===f.A.playerId){n.next=41;break}return n.next=33,r.createAsync(t);case 33:if(!1!==(o=n.sent)){n.next=40;break}return n.next=37,se();case 37:return n.next=39,i(W());case 39:return n.abrupt("return");case 40:o||"reset"===e||(o=e);case 41:c=r.contextType,i((0,b.cj)(o,c));case 43:return j({contextId:o}),p=s.getPlayerId(),g=s.getConnectedPlayers(),n.next=48,r.getContextPlayers(p);case 48:return y=n.sent,A=f.A,t!==A.playerId&&g[t]?A=g[t]:1===y.length&&(A=y[0]),i((0,L._D)()),T=(E=A).playerId,S=E.name,P=E.photo,C={playerId:T,name:S,photo:P},n.next=56,i(ie(O.QT,C));case 56:i((0,b.cj)(o,c)),n.next=68;break;case 59:if(n.prev=59,n.t1=n.catch(0),!(n.t1 instanceof m.A)){n.next=63;break}return n.abrupt("return");case 63:if("USER_INPUT"!==(null==n.t1?void 0:n.t1.code)){n.next=65;break}return n.abrupt("return");case 65:if("INVALID_OPERATION"!==(null==n.t1?void 0:n.t1.code)){n.next=67;break}return n.abrupt("return");case 67:(0,x.a0)(n.t1);case 68:return n.prev=68,z(1e3),n.finish(68);case 71:case"end":return n.stop()}}),n,null,[[0,59,68,71],[16,25]])})));return function(e){return n.apply(this,arguments)}}()},Q=function(e){return function(){var t=(0,a.A)(d().mark((function t(n){var i,a,s,r;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i=window.game,a=i.facebook,i.globalScene.screen.open(v.R8.NOTIFY_SCREEN,{message:"Loading...",loading:!0}),s=a.contextID,r=a.contextType,j({contextId:s}),n((0,L._D)()),n((0,B.OI)()),t.next=10,n(ie(O.QT,e));case 10:n((0,b.cj)(s,r)),z(100),t.next=20;break;case 14:if(t.prev=14,t.t0=t.catch(0),z(100),!(t.t0 instanceof m.A)){t.next=19;break}return t.abrupt("return");case 19:(0,x.a0)(t.t0);case 20:return t.prev=20,t.finish(20);case 22:case"end":return t.stop()}}),t,null,[[0,14,20,22]])})));return function(e){return t.apply(this,arguments)}}()},$=function(e){return function(){var t=(0,a.A)(d().mark((function t(n){var i,a,s,r,o;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i=window.game,a=i.facebook,s=i.globalScene,r=i.analytics,s.screen.open(v.R8.NOTIFY_SCREEN,{message:"Loading...",loading:!0}),o=a.getContextID(),j({contextId:o}),r.event(p.o.JOIN_GROUP,{group_id:o}),t.next=8,n(ie(O.Ee,e));case 8:t.next=17;break;case 10:if(t.prev=10,t.t0=t.catch(0),!(t.t0 instanceof m.A)){t.next=14;break}return t.abrupt("return");case 14:if("INVALID_OPERATION"!==(null==t.t0?void 0:t.t0.code)){t.next=16;break}return t.abrupt("return");case 16:(0,x.a0)(t.t0);case 17:return t.prev=17,z(1e3),t.finish(17);case 20:case"end":return t.stop()}}),t,null,[[0,10,17,20]])})));return function(e){return t.apply(this,arguments)}}()},ee=function(e,t){return function(){var n=(0,a.A)(d().mark((function n(i,a){var s,r,o,c,l,h,u,p,m,y,A,E,T,S,P;return d().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,s=window.game,r=s.player,o=s.profile,c=s.facebook,(l=s.globalScene).screen.open(v.R8.NOTIFY_SCREEN,{message:"Loading...",loading:!0}),h=a(),u=r.getPlayerId(h),!((p=r.getConnectedPlayers(h)).length>0)||p[t]){n.next=9;break}return l.events.emit(g.yh.SWITCH,g.F7.DASHBOARD_SCENE),n.abrupt("return");case 9:return m=f.A,n.next=12,c.getContextPlayers(u);case 12:if(y=n.sent,t===u||t===m.playerId||!p[t]){n.next=17;break}m=p[t],n.next=25;break;case 17:if(1!==y.length){n.next=21;break}m=y[0],n.next=25;break;case 21:return n.next=23,o.requestProfiles([t]);case 23:(A=o.getProfiles())[t]&&(m=A[t]);case 25:return n.next=27,i((0,B.Iq)(e,m));case 27:if(h=a(),(0,D.Hp)(h,{playerId:u})!==f.A.playerId){n.next=32;break}return n.next=32,i((0,B.N3)(e));case 32:if(h=a(),(0,D.Hp)(h,{playerId:u})===u||!p[t]){n.next=37;break}return i(J(t,!0)),n.abrupt("return");case 37:if((0,D.G_)(h)===e){n.next=41;break}return l.events.emit(g.yh.SWITCH,g.F7.DASHBOARD_SCENE),n.abrupt("return");case 41:if(E=(0,D.xV)(h),T=(0,D.pr)(h,{playerId:u}),i(re({mode:O.QT,status:E})),S=c.getContextID(),P=c.contextType,i((0,b.cj)(S,P)),!T){n.next=52;break}return n.next=50,r.requestConnectedPlayers();case 50:return l.events.emit(g.yh.SWITCH,g.F7.GAME_SCENE),n.abrupt("return");case 52:l.events.emit(g.yh.SWITCH,g.F7.GAME_SCENE),n.next=58;break;case 55:n.prev=55,n.t0=n.catch(0),(0,x.a0)(n.t0);case 58:return n.prev=58,z(1e3),n.finish(58);case 61:case"end":return n.stop()}}),n,null,[[0,55,58,61]])})));return function(e,t){return n.apply(this,arguments)}}()},te=function(){return function(){var e=(0,a.A)(d().mark((function e(t,n){var i,a,s,r,o,c,l,h,u,m,g,y,A,E,T,S,b,C,w,I,k,_,B,L,N;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=window.game,a=i.analytics,s=i.facebook,i.globalScene.screen.open(v.R8.NOTIFY_SCREEN,{message:"Loading...",loading:!0}),r=n(),o=(0,R.qs)(r),c=(0,M.TW)(r),l=c.score,h=void 0===l?0:l,u=c.level,m=void 0===u?0:u,t(ne(h)),e.next=9,t(ae(o,{score:h}));case 9:r=n(),g=(0,R.yU)(r),y=(0,R.FE)(r),A=Math.floor((y-g)/1e3),a.event(p.o.MATCH_END,{game_mode:GameCore.Utils.String.toUpperCamelCase(o),level:m,level_name:"level_"+m,time_played:A}),E=s.getContextID(),o===O.Ee&&E&&t((0,P.RE)()),E&&o===O.QT&&(T=(0,D.sp)(r),S=T.playerId,b=(0,D.VQ)(r),S&&S!==f.A.playerId||(C=window.game.player.getPlayerId(),b.whitePlayerId===C&&(S=b.blackPlayerId),b.blackPlayerId===C&&(S=b.whitePlayerId)),w=(0,M.ix)(r),I=w[S]||{},k=I.score,_=void 0===k?0:k,B=b._id,L=b.whitePlayerFinish,N=b.blackPlayerFinish,t(L&&N?h>_?(0,P.wp)(S,{matchId:B,contextId:E}):(0,P.$8)(S,{matchId:B,contextId:E}):(0,P.Ll)(S,{matchId:B,contextId:E,score:h}))),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(0),(0,x.a0)(e.t0);case 22:return e.prev=22,z(300),e.finish(22);case 25:case"end":return e.stop()}}),e,null,[[0,19,22,25]])})));return function(t,n){return e.apply(this,arguments)}}()},ne=function(e){return function(t){try{var n=window.game.player,i=n.getPlayerId();(0,A.bl)(i,e).catch((function(e){(0,x.a0)(new Error(e))}));var a=n.getPlayerData(),s=a.score,r=void 0===s?0:s,o=a.level;r<e&&n.setBestScore(e);var c={score:e,level:o};t((0,L.aQ)(i,c)),t((0,L.f1)(c))}catch(l){if(l instanceof T)return;(0,x.a0)(l)}}},ie=function(e,t,n){return void 0===t&&(t=null),void 0===n&&(n=!0),function(){var i=(0,a.A)(d().mark((function i(a,s){var o,c,l,h,u,f,m,A,E,T,S,I,R,M,N,G,F,U;return d().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,c=window.game,l=c.player,h=c.analytics,u=c.facebook,f=c.globalScene,m=u.getContextID(),A=0,E=s(),h.event(p.o.MATCH_START,{game_mode:GameCore.Utils.String.toUpperCamelCase(e),level:1,level_name:"level_1"}),a(Y()),!r()(o=[O.Nu,O.zA]).call(o,e)){i.next=16;break}return i.next=10,a((0,B.Lr)());case 10:if(E=s(),(0,D.N0)(E)){i.next=15;break}return i.next=15,a((0,B.SZ)());case 15:A=(0,D.u$)(E);case 16:if(e===O.Ee&&a((0,B.do)(t)),e!==O.QT){i.next=26;break}return i.next=20,a((0,B.t3)(t));case 20:E=s(),T=(0,D.G_)(E),S=(0,D.sp)(E),I=S.playerId,m||(m=window.FBInstant.context.getID()),R=(0,C.p)(E,{opponentId:I}),m&&I&&!R&&a((0,P.DX)(I,{contextId:m,matchId:T}));case 26:e===O.ez&&a((0,B.xd)()),E=s(),M=l.getPlayerData(E),N=M.score,G=void 0===N?0:N,F=(0,D.In)(E),U=F.rescued,a((0,L.f1)({score:A,bestScore:G})),a({type:k.M9,payload:{mode:e,contextId:m,rescued:U}}),a((0,b.os)(e)),f.events.emit(g.yh.SWITCH,g.F7.GAME_SCENE),n&&w.A.emit(y.A.START_GAME),i.next=45;break;case 38:if(i.prev=38,i.t0=i.catch(0),!(i.t0 instanceof _.A)){i.next=44;break}return window.game.globalScene.screen.open(v.R8.NOTIFY_SCREEN,{message:"Sorry!, you can not\ncreate this match now!",duration:2500,loading:!1}),i.abrupt("return");case 44:(0,x.a0)(i.t0);case 45:return i.prev=45,z(0),i.finish(45);case 48:case"end":return i.stop()}}),i,null,[[0,38,45,48]])})));return function(e,t){return i.apply(this,arguments)}}()},ae=function(e,t){return function(){var n=(0,a.A)(d().mark((function n(i,a){var s,o,c,l,h,u,p,f,m,g,v;return d().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=window.game.player,c=t.score,l=void 0===c?0:c,h=t.level,u=void 0===h?0:h,p=a(),!r()(s=[O.Nu,O.zA]).call(s,e)){n.next=7;break}return f=(0,D.N0)(p),n.next=7,i((0,B.VJ)(f));case 7:if(e!==O.zA){n.next=12;break}if(!(m=(0,N.pT)(p))){n.next=12;break}return n.next=12,(0,G.t4)(m,o.getPlayerId(),l);case 12:if(e===O.Ee&&(i((0,B.Gl)()),g=o.getPlayerId(),i((0,L.aQ)(g,t))),e!==O.QT){n.next=17;break}return v=(0,D.G_)(p),n.next=17,i((0,B.cV)(v,l,{level:u}));case 17:i({type:k.N5,payload:{mode:e}}),w.A.emit(y.A.GAME_OVER);case 19:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}()},se=function(){var e=(0,a.A)(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("SOLO"!=window.FBInstant.context.getType()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,new(c())((function(e){try{if("SOLO"==window.FBInstant.context.getType())return e();var t=setInterval((function(){"SOLO"==window.FBInstant.context.getType()&&(clearInterval(t),e())}),200),n=function(){var n=(0,a.A)(d().mark((function n(){return d().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,window.FBInstant.context.switchAsync("SOLO",!0);case 3:window.game.analytics.event(p.o.SWITCH_SOLO_CONTEXT,{success:!0}),n.next=11;break;case 6:n.prev=6,n.t0=n.catch(0),window.game.analytics.event(p.o.SWITCH_SOLO_CONTEXT,{success:!1}),clearInterval(t),e();case 11:case"end":return n.stop()}}),n,null,[[0,6]])})));return function(){return n.apply(this,arguments)}}();n()}catch(i){console.log("same context"),e()}})).then((function(){}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),re=function(e){return function(t){var n=e.mode,i=e.status;t({type:k.RK,payload:{mode:n,status:i}}),(0,x.SJ)("game-mode",n)}},oe=function(){return function(e,t){var n=t(),i=(0,M.TW)(n).level,a=void 0===i?0:i,s=(0,R.qs)(n);window.game.analytics.event(p.o.MATCH_RESCUE,{game_mode:GameCore.Utils.String.toUpperCamelCase(s),level:a,level_name:"level_"+a}),e({type:k.Pt,payload:{}})}},ce=function(){return function(e,t){e({type:k.pQ,payload:{}});var n=t(),a=(0,D.In)(n);a=(0,i.A)({},a,{data:le(a.data)});var s={};s[U.SingleMatchStore]=(0,i.A)({},a,{rescued:0}),window.FBInstant.player.setDataAsync(s),(0,I.AD)(U.SingleMatchStore,{rescued:0})}},le=function(e){try{return GameCore.Utils.Hash.stringToHash(h()(e))}catch(t){return""}}},504:function(e,t,n){"use strict";n.d(t,{OI:function(){return ae},f_:function(){return q},Cs:function(){return Q},Iq:function(){return te},t3:function(){return $},do:function(){return se},xd:function(){return oe},SZ:function(){return H},cV:function(){return ne},Gl:function(){return re},VJ:function(){return X},Lr:function(){return K},N3:function(){return ee},Hd:function(){return le},u_:function(){return Z},fA:function(){return ue},RF:function(){return he},iK:function(){return W}});var i=n(57),a=n(23),s=n(20),r=n.n(s),o=n(40),c=n.n(o),l=n(73),h=n.n(l),u=n(74),d=n.n(u),p=n(70),f=n(232),m=n(47),g=n(136),v=GameCore.Configs.ApiHost,y=(function(){var e=(0,a.A)(r().mark((function e(t){var n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"single-matches",e.next=3,(0,g.b)("single-matches",t,{},v);case 3:return n=e.sent,e.abrupt("return",(null==n?void 0:n.data)||{});case 5:case"end":return e.stop()}}),e)})))}(),function(){var e=(0,a.A)(r().mark((function e(){var t;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"single-matches/active",e.next=3,(0,g.J)("single-matches/active",{},v);case 3:return t=e.sent,e.abrupt("return",(null==t?void 0:t.data)||{});case 5:case"end":return e.stop()}}),e)})))}(),function(){var e=(0,a.A)(r().mark((function e(t,n){var i,a;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i="single-matches/"+t+"/move",e.next=3,(0,g.b)(i,n,{},v);case 3:return a=e.sent,e.abrupt("return",(null==a?void 0:a.data)||{});case 5:case"end":return e.stop()}}),e)})))}(),function(){var e=(0,a.A)(r().mark((function e(t){var n,i;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="single-matches/"+t+"/finish",e.next=3,(0,g.b)(n,{},{},v);case 3:return i=e.sent,e.abrupt("return",(null==i?void 0:i.data)||{});case 5:case"end":return e.stop()}}),e)})))}(),function(){var e=(0,a.A)(r().mark((function e(t){var n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"matches",e.next=3,(0,g.b)("matches",{opponentPlayerId:t},{},v);case 3:return n=e.sent,e.abrupt("return",(null==n?void 0:n.data)||{});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),A=function(){var e=(0,a.A)(r().mark((function e(t){var n,i;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="matches/"+t+"/join",e.next=3,(0,g.b)(n,{},{},v);case 3:return i=e.sent,e.abrupt("return",(null==i?void 0:i.data)||{});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),E=function(){var e=(0,a.A)(r().mark((function e(t){var n,i;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="matches/"+t,e.next=3,(0,g.J)(n,{},v);case 3:return i=e.sent,e.abrupt("return",(null==i?void 0:i.data)||{});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=(0,a.A)(r().mark((function e(t,n,i,a){var s,o;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s="matches/"+t+"/finish",e.next=3,(0,g.b)(s,{matchId:t,score:n,level:i,extraData:a},{},v);case 3:return o=e.sent,e.abrupt("return",(null==o?void 0:o.data)||{});case 5:case"end":return e.stop()}}),e)})));return function(t,n,i,a){return e.apply(this,arguments)}}(),S=n(138),b=n(139),P=n(503),C=n(4),w=n(30),I=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidMatchStatus",i.message=t||"The match status is not valid",i.payload=n,i}return(0,C.A)(t,e),t}((0,w.A)(Error)),x=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidOpponentId",i.message=t||"Invalid opponent id",i.payload=n,i}return(0,C.A)(t,e),t}((0,w.A)(Error)),k=n(482),O=n(111),_=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidBlackPlayerId",i.message=t||"Invalid black player id",i.payload=n,i}return(0,C.A)(t,e),t}((0,w.A)(Error)),R=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidRequestedMatchId",i.message=t||"The matchId in match data not matched with requested matchId",i.payload=n,i}return(0,C.A)(t,e),t}((0,w.A)(Error)),D=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidScore",i.message=t||"The score is not valid",i.payload=n,i}return(0,C.A)(t,e),t}((0,w.A)(Error)),M=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidWhitePlayerId",i.message=t||"Invalid white player id",i.payload=n,i}return(0,C.A)(t,e),t}((0,w.A)(Error)),B=function(e){var t=e.matchId,n=e.score;if(""===t||"string"!==typeof t)throw new P.A(null,{matchId:t});if("number"!==typeof n)throw new D(null,{score:n})},L=function(e){var t=e.matchId,n=e.currentMatchId;if(""===t||"string"!==typeof t)throw new P.A(null,{matchId:t});if(""===n||"string"!==typeof n)throw new P.A(null,{currentMatchId:n});if(t!==n)throw new R(null,{matchId:t,currentMatchId:n})},N=function(e){var t=e.matchId,n=e.currentMatchId;if(""===t||"string"!==typeof t)throw new P.A(null,{matchId:t});if(""===n||"string"!==typeof n)throw new P.A(null,{currentMatchId:n});if(t!==n)throw new R(null,{matchId:t,currentMatchId:n})},G=function(e){var t=e.playerId,n=e.match,i=n._id,a=n.playerId,s=n.status;if(""===i||"string"!==typeof i)throw new P.A(null,{matchId:i});if("finished"===s||"string"!==typeof s)throw new I("This match is finished",{status:s});if(a!==t)throw new k.A(null,{playerId:a,currentPlayerId:t})},F=function(e){var t=e.opponentId;if(""===t||"string"!==typeof t)throw new x(null,{opponentId:t})},U=function(e){var t=e.matchId;if(""===t||"string"!==typeof t)throw new P.A(null,{matchId:t})},j=function(e){var t=e.match,n=t._id,i=t.whitePlayerId,a=t.blackPlayerId;if(""===n||"string"!==typeof n)throw new P.A(null,{matchId:n});if(""===i||"string"!==typeof i)throw new M(null,{whitePlayerId:i});if(""===a||"string"!==typeof a)throw new _(null,{blackPlayerId:a})},V=GameCore.Configs.Match,z=function(e){try{return GameCore.Utils.Hash.stringToHash(c()(e))}catch(t){return""}},Y=function(e){try{return JSON.parse(GameCore.Utils.Hash.hashToString(e))}catch(t){return""}},H=function(){return function(){var e=(0,a.A)(r().mark((function e(t){var n,a,s,o;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,n=window.game.player,t({type:S._p,payload:{}}),a=n.getPlayerId(),s=(0,i.A)({},V.LocalSingleMatchDefault,{status:"active",playerId:a,startedAt:Date.now(),rescued:0}),G({playerId:a,match:s}),t(J(s)),(o={})[V.SingleMatchStore]=s,window.FBInstant.player.setDataAsync(o),(0,f.AD)(V.SingleMatchStore,s),e.next=21;break;case 13:if(e.prev=13,e.t0=e.catch(0),t(J(null)),!(e.t0 instanceof P.A)){e.next=18;break}return e.abrupt("return");case 18:if(!(e.t0 instanceof I)){e.next=20;break}return e.abrupt("return");case 20:(0,m.a0)(e.t0);case 21:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t){return e.apply(this,arguments)}}()},K=function(){return function(){var e=(0,a.A)(r().mark((function e(t){var n,a,s,o,c,l;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=window.game.player,t({type:S.vw,payload:{}}),a=n.getPlayerId(),s=(0,f.$V)(V.SingleMatchStore)||{},e.next=7,window.FBInstant.player.getDataAsync([V.SingleMatchStore]);case 7:if(e.t0=e.sent,e.t0){e.next=10;break}e.t0={};case 10:e.t1=V.SingleMatchStore,(o=e.t0[e.t1])&&(o.updateAt||0)>=(s.updateAt||0)&&(s=o),c=(0,i.A)({},s),l=c.data,c.data=Y(l),G({playerId:a,match:c}),t(J(c)),e.next=30;break;case 20:if(e.prev=20,e.t2=e.catch(0),t(J(null)),!(e.t2 instanceof P.A)){e.next=25;break}return e.abrupt("return");case 25:if(!(e.t2 instanceof k.A)){e.next=27;break}return e.abrupt("return");case 27:if(!(e.t2 instanceof I)){e.next=29;break}return e.abrupt("return");case 29:(0,m.a0)(e.t2);case 30:case"end":return e.stop()}}),e,null,[[0,20]])})));return function(t){return e.apply(this,arguments)}}()},W=function(e,t){return function(n,a){try{B((0,i.A)({matchId:e},t));var s=a(),r=(0,O.N0)(s),o=(0,O.In)(s);L({matchId:e,currentMatchId:r}),n({type:S.lM,payload:{match:t}});var c=t.data;t.data=z(c);var l={};l[V.SingleMatchStore]=(0,i.A)({},o,t,{_id:r}),window.FBInstant.player.setDataAsync(l),(0,f.AD)(V.SingleMatchStore,t)}catch(h){if(h instanceof P.A)return;(0,m.a0)(h)}}},Z=function(e,t){return function(n,a){try{B((0,i.A)({matchId:e},t));var s=a(),r=(0,O.jI)(s),o=(0,O._p)(s);L({matchId:e,currentMatchId:r}),n({type:S.p3,payload:{match:t}});var c=t.data;t.data=z(c);var l=window.game.player,h={};h[V.JourneyMatchStore+"-"+l.getPlayerId()]=(0,i.A)({},o,t,{_id:r}),window.FBInstant.player.setDataAsync(h),(0,f.AD)(V.JourneyMatchStore+"-"+l.getPlayerId(),t)}catch(u){if(u instanceof P.A)return;(0,m.a0)(u)}}},X=function(e){return function(){var t=(0,a.A)(r().mark((function t(n,a){var s,o,c,l,h,u,d,p,g;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,s=window.game.player,U({matchId:e}),o=a(),c=(0,O.N0)(o),l=s.getPlayerId(),N({matchId:e,currentMatchId:c}),n({type:S.Pv,payload:{matchId:e}}),h=(0,O.In)(o),G({playerId:l,match:h}),u=(0,i.A)({},V.LocalSingleMatchDefault,h,{_id:e,status:"finished",playerId:l,finishAt:Date.now()}),n(J(u)),d=u.data,(p=(0,i.A)({},u)).data=z(d),(g={})[V.SingleMatchStore]=p,window.FBInstant.player.setDataAsync(g),(0,f.AD)(V.SingleMatchStore,p),t.next=29;break;case 21:if(t.prev=21,t.t0=t.catch(0),n(J(null)),!(t.t0 instanceof P.A)){t.next=26;break}return t.abrupt("return");case 26:if(!(t.t0 instanceof I)){t.next=28;break}return t.abrupt("return");case 28:(0,m.a0)(t.t0);case 29:case"end":return t.stop()}}),t,null,[[0,21]])})));return function(e,n){return t.apply(this,arguments)}}()},J=function(e){return{type:S.cC,payload:{match:e}}},q=function(){return{type:S.it,payload:{}}},Q=function(){return{type:S.Zh,payload:{}}},$=function(e){return function(){var t=(0,a.A)(r().mark((function t(n){var i,a,s,o;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i=window.game,a=i.profile,i.globalScene.screen.open(p.R8.NOTIFY_SCREEN,{message:"Loading...",loading:!0}),s=e.playerId,F({opponentId:s}),n({type:S.Li,payload:{opponentInfo:e}}),t.next=8,y(s);case 8:return o=t.sent,j({match:o}),t.next=12,a.requestProfiles([s]);case 12:n(ie(o)),t.next=23;break;case 15:if(t.prev=15,t.t0=t.catch(0),n(ie(null)),!(t.t0 instanceof P.A)){t.next=20;break}return t.abrupt("return");case 20:if(!(t.t0 instanceof x)){t.next=22;break}return t.abrupt("return");case 22:(0,m.a0)(t.t0);case 23:case"end":return t.stop()}}),t,null,[[0,15]])})));return function(e){return t.apply(this,arguments)}}()},ee=function(e){return function(){var t=(0,a.A)(r().mark((function t(n){var i,a,s,o,c,l,h,u,d;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i=window.game,a=i.player,s=i.profile,i.globalScene.screen.open(p.R8.NOTIFY_SCREEN,{message:"Loading...",loading:!0}),U({matchId:e}),n({type:S.nA,payload:{matchId:e}}),t.next=7,A(e);case 7:if(o=t.sent,j({match:o}),c=o.status,l=o.whitePlayerId,h=o.blackPlayerId,c!==b.yS){t.next=16;break}return u=a.getPlayerId(),d=u===l?h:l,t.next=16,s.requestProfiles([d]);case 16:n(ie(o)),t.next=25;break;case 19:if(t.prev=19,t.t0=t.catch(0),n(ie(null)),!(t.t0 instanceof P.A)){t.next=24;break}return t.abrupt("return");case 24:(0,m.a0)(t.t0);case 25:case"end":return t.stop()}}),t,null,[[0,19]])})));return function(e){return t.apply(this,arguments)}}()},te=function(e,t,n){return void 0===n&&(n=!0),function(){var i=(0,a.A)(r().mark((function i(a){var s,o,c,l,h,u,d,f,g,v;return r().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,s=window.game,o=s.player,c=s.globalScene,n&&c.screen.open(p.R8.NOTIFY_SCREEN,{message:"Loading...",loading:!0}),U({matchId:e}),a({type:S.KV,payload:{matchId:e,opponentInfo:t}}),i.next=7,E(e);case 7:l=i.sent,j({match:l}),h=l.whitePlayerId,u=l.whitePlayerScore,d=l.blackPlayerScore,f=o.getPlayerId(),g=o.getPlayerData(),v=g.score,a(ie(l,{score:f===h?u:d,bestScore:v})),i.next=23;break;case 17:if(i.prev=17,i.t0=i.catch(0),a(ie(null)),!(i.t0 instanceof P.A)){i.next=22;break}return i.abrupt("return");case 22:(0,m.a0)(i.t0);case 23:case"end":return i.stop()}}),i,null,[[0,17]])})));return function(e){return i.apply(this,arguments)}}()},ne=function(e,t,n){return function(){var i=(0,a.A)(r().mark((function i(a){var s,o;return r().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,window.game.globalScene.screen.open(p.R8.NOTIFY_SCREEN,{message:"Loading...",loading:!0}),U({matchId:e}),a({type:S.KG,payload:{matchId:e,score:t,extraData:n}}),s=n.level,i.next=8,T(e,t,s,n);case 8:return o=i.sent,j({match:o}),i.next=12,a(ie(o));case 12:i.next=20;break;case 14:if(i.prev=14,i.t0=i.catch(0),a(ie(null)),!(i.t0 instanceof P.A)){i.next=19;break}return i.abrupt("return");case 19:(0,m.a0)(i.t0);case 20:case"end":return i.stop()}}),i,null,[[0,14]])})));return function(e){return i.apply(this,arguments)}}()},ie=function(e,t,n){return void 0===n&&(n=null),{type:S.nb,payload:{match:e,opponentInfo:t,current:n}}},ae=function(){return{type:S.TI,payload:{}}},se=function(e){return{type:S.XJ,payload:{opponentInfo:e}}},re=function(){return{type:S.YA,payload:{}}},oe=function(){return function(){var e=(0,a.A)(r().mark((function e(t){var n,i,a,s,o,c,l,u;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=window.game.player,s=a.getPlayer(),o=s.playerId,c=s.name,l=s.photo,t({type:S.pf,payload:{playerId:o}}),u={},h()(n=d()(i=new Array(20)).call(i,null)).call(n,(function(e,t){var n="0"+(t+1);u[n]={playerId:n,name:"MPlayer "+n,photo:"./assets/images/others/avatar.png"}})),u[o]={playerId:o,name:c,photo:l},t(ce("mock",u));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},ce=function(e,t){return{type:S.Bi,payload:{matchId:e,players:t}}},le=function(e){return function(){var t=(0,a.A)(r().mark((function t(n){var a,s,o,c,l,h,u,d,p,f,m,g;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=window.game.player,s=a.getPlayer(),o=s.playerId,t.prev=2,n({type:S.vw,payload:{}}),c=V.JourneyMatchStore+"-"+o,t.next=7,window.FBInstant.player.getDataAsync([c]);case 7:l=t.sent,h=window.game.player.getCustomData("levelOfSeasons"),u=1,GameCore.Utils.Object.hasOwn(h,e)&&(u=h[e]),d=l[c]||{},console.log("dataFBAsync",l),console.log("seasonKey",e),console.log("level",u),p=d.data,f=d.level,d.data=Y(p),u!==f&&(d.data={}),m=u||1,g=(0,i.A)({},d,{level:m,playerId:o,levelOfSeasons:h}),n({type:S.p3,payload:{match:g}}),t.next=26;break;case 23:t.prev=23,t.t0=t.catch(2),console.log("Erorrrrr = ",t.t0);case 26:case"end":return t.stop()}}),t,null,[[2,23]])})));return function(e){return t.apply(this,arguments)}}()},he=function(e){return{type:S.Mk,payload:{score:e}}},ue=function(e){return{type:S.oo,payload:{level:e}}}},505:function(e,t,n){"use strict";n.d(t,{_D:function(){return a},aQ:function(){return s},f1:function(){return r}});var i=n(138),a=function(e){return{type:i.T9,payload:{playerId:e}}},s=function(e,t){return{type:i.RM,payload:{playerId:e,stats:t}}},r=function(e){return{type:i.oR,payload:{stats:e}}}},138:function(e,t,n){"use strict";n.d(t,{Bi:function(){return F},KG:function(){return R},KV:function(){return D},Li:function(){return _},M9:function(){return a},Mk:function(){return x},N5:function(){return s},Pt:function(){return o},Pv:function(){return v},QT:function(){return S},RK:function(){return r},RM:function(){return u},SA:function(){return p},T9:function(){return h},TI:function(){return B},X:function(){return V},XJ:function(){return L},YA:function(){return N},Yz:function(){return f},Zh:function(){return T},_m:function(){return U},_p:function(){return m},aY:function(){return j},ad:function(){return l},cC:function(){return A},it:function(){return E},iw:function(){return b},lM:function(){return y},nA:function(){return O},nb:function(){return M},oR:function(){return d},oo:function(){return k},p3:function(){return P},pQ:function(){return c},pf:function(){return G},q3:function(){return w},sh:function(){return C},tH:function(){return I},uf:function(){return i},vw:function(){return g}});var i="MATCH_GAMEPLAY_INITIALIZE",a="MATCH_GAMEPLAY_START",s="MATCH_GAMEPLAY_FINISH",r="MATCH_GAMEPLAY_UPDATE",o="MATCH_GAMEPLAY_RESCUE",c="MATCH_GAMEPLAY_RESET_RESCUE",l="MATCH_GAMEPLAY_SHOW_MINI_JOURNEY",h="MATCH_STATS_DATA_CLEAR",u="MATCH_STATS_DATA_UPDATE",d="MATCH_STATS_CURRENT_UPDATE",p="MATCH_STATS_CONTEXT_REQUEST",f="MATCH_STATS_CONTEXT_RECEIVED",m="MATCH_SINGLE_CREATE_REQUEST",g="MATCH_SINGLE_DETAIL_REQUEST",v="MATCH_SINGLE_FINISH_REQUEST",y="MATCH_SINGLE_MOVE_UPDATED",A="MATCH_SINGLE_DATA_RECEIVED",E="MATCH_SINGLE_DATA_CLEAR",T="MATCH_SINGLE_FEN_CLEAR",S="MATCH_JOURNEY_CREATE_REQUEST",b="MATCH_JOURNEY_DATA_CLEAR",P="MATCH_JOURNEY_MOVE_UPDATED",C="MATCH_JOURNEY_DATA_RECEIVED",w="MATCH_JOURNEY_DAILY_CHALLENGE_START",I="MATCH_JOURNEY_DAILY_CHALLENGE_COMPLETED",x="MATCH_JOURNEY_SCORE_RECEIVED",k="MATCH_JOURNEY_LEVEL_RECEIVED",O="MATCH_CHALLENGE_JOIN_REQUEST",_="MATCH_CHALLENGE_CREATE_REQUEST",R="MATCH_CHALLENGE_FINISH_REQUEST",D="MATCH_CHALLENGE_CONTINUE_REQUEST",M="MATCH_CHALLENGE_DATA_RECEIVED",B="MATCH_CHALLENGE_DATA_CLEAR",L="MATCH_GROUP_CREATE_REQUEST",N="MATCH_GROUP_FINISH_REQUEST",G="MATCH_ONLINE_CREATE_REQUEST",F="MATCH_ONLINE_DATA_RECEIVED",U="MATCH_ONLINE_STATS_UPDATE",j="MATCH_ONLINE_FINISH_REQUEST",V="MATCH_ONLINE_DATA_CLEAR"},110:function(e,t,n){"use strict";n.d(t,{Ee:function(){return s},Nu:function(){return i},QT:function(){return a},ez:function(){return o},zA:function(){return r}});var i="single",a="challenge-friends",s="matching-group",r="tournaments",o="online"},139:function(e,t,n){"use strict";n.d(t,{Sr:function(){return i},Ux:function(){return s},yS:function(){return a}});var i="open",a="active",s="finished"},478:function(e,t,n){"use strict";n.d(t,{L:function(){return i}});var i="match"},503:function(e,t,n){"use strict";var i=n(4),a=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidMatchId",i.message=t||"Invalid match id",i.payload=n,i}return(0,i.A)(t,e),t}((0,n(30).A)(Error));t.A=a},482:function(e,t,n){"use strict";var i=n(4),a=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidPlayerId",i.message=t||"The playerId is not valid",i.payload=n,i}return(0,i.A)(t,e),t}((0,n(30).A)(Error));t.A=a},228:function(e,t,n){"use strict";n.d(t,{FE:function(){return c},hX:function(){return l},qs:function(){return s},wY:function(){return r},yU:function(){return o}});var i=n(58),a=n(229),s=(0,i.Mz)([function(e){return(0,a.G)(e).gameplay.mode}],(function(e){return e})),r=((0,i.Mz)([function(e){return(0,a.G)(e).gameplay.status}],(function(e){return e})),(0,i.Mz)([function(e){return(0,a.G)(e).gameplay.rescued}],(function(e){return e}))),o=(0,i.Mz)([function(e){return(0,a.G)(e).gameplay.startAt}],(function(e){return e})),c=(0,i.Mz)([function(e){return(0,a.G)(e).gameplay.finishAt}],(function(e){return e})),l=(0,i.Mz)([function(e){return(0,a.G)(e).gameplay.showMiniJourney}],(function(e){return e}))},229:function(e,t,n){"use strict";n.d(t,{G:function(){return a}});var i=n(478),a=function(e){return e[i.L]}},111:function(e,t,n){"use strict";n.d(t,{$j:function(){return b},Ai:function(){return h},Bx:function(){return y},G_:function(){return d},Hp:function(){return g},IP:function(){return S},In:function(){return o},N0:function(){return c},Ou:function(){return P},Ug:function(){return A},VQ:function(){return u},_p:function(){return E},eo:function(){return m},jI:function(){return T},pr:function(){return v},sp:function(){return f},u$:function(){return l},xV:function(){return p}});var i=n(109),a=n(58),s=n(229),r=function(e,t){return t.playerId},o=((0,a.Mz)([function(e){return(0,s.G)(e).match.isRequesting}],(function(e){return e})),(0,a.Mz)([function(e){return(0,s.G)(e).match.single}],(function(e){return e}))),c=(0,a.Mz)([function(e){return(0,s.G)(e).match.single._id}],(function(e){return e})),l=(0,a.Mz)([function(e){return(0,s.G)(e).match.single.score}],(function(e){return e||0})),h=(0,a.Mz)([function(e){return(0,s.G)(e).match.single.level}],(function(e){return e||0})),u=((0,a.Mz)([function(e){var t;return null==(t=(0,s.G)(e).match.single.data)?void 0:t.diamond}],(function(e){return e||0})),(0,a.Mz)([function(e){var t;return null==(t=(0,s.G)(e).match.single.data)?void 0:t.fen}],(function(e){return e||null})),(0,a.Mz)([function(e){return(0,s.G)(e).match.single.status}],(function(e){return e})),(0,a.Mz)([function(e){return(0,s.G)(e).match.single.playerId}],(function(e){return e})),(0,a.Mz)([function(e){return(0,s.G)(e).match.single.guideWareHouseShowed}],(function(e){return e})),(0,a.Mz)([function(e){return(0,s.G)(e).match.challenge}],(function(e){return e}))),d=(0,a.Mz)([function(e){return(0,s.G)(e).match.challenge._id}],(function(e){return e})),p=(0,a.Mz)([function(e){return(0,s.G)(e).match.challenge.status}],(function(e){return e})),f=(0,a.Mz)([function(e){return(0,s.G)(e).match.challenge.opponentInfo}],(function(e){return e})),m=((0,a.Mz)([function(e){return(0,s.G)(e).match.challenge.whitePlayerId}],(function(e){return e})),(0,a.Mz)([function(e){return(0,s.G)(e).match.challenge.blackPlayerId}],(function(e){return e}))),g=((0,a.Mz)([u,r],(function(e,t){var n=e.whitePlayerId,i=e.blackPlayerId;return n!==t&&i===t?n:i!==t&&n===t?i:""})),(0,a.Mz)([u,r],(function(e,t){var n=e.whitePlayerId,a=e.blackPlayerId;return n===t?n:a===t?a:i.A.playerId}))),v=(0,a.Mz)([u,r],(function(e,t){var n=e.whitePlayerId,i=e.blackPlayerId,a=e.whitePlayerFinish,s=e.blackPlayerFinish;return t&&n===t?a:!(!t||i!==t)&&s})),y=(0,a.Mz)([u,function(e,t){return t.opponentId}],(function(e,t){var n=e.whitePlayerId,i=e.blackPlayerId,a=e.whitePlayerFinish,s=e.blackPlayerFinish;return t&&n===t?a:!(!t||i!==t)&&s})),A=(0,a.Mz)([function(e){return(0,s.G)(e).match.group.opponentInfo}],(function(e){return e})),E=((0,a.Mz)([function(e){return(0,s.G)(e).match.online.players}],(function(e){return e})),(0,a.Mz)([function(e){return(0,s.G)(e).match.journey}],(function(e){return e}))),T=(0,a.Mz)([function(e){return(0,s.G)(e).match.journey._id}],(function(e){return e})),S=(0,a.Mz)([function(e){return(0,s.G)(e).match.journey.level}],(function(e){return e})),b=(0,a.Mz)([function(e){return(0,s.G)(e).match.journey.challengeMode}],(function(e){return e})),P=(0,a.Mz)([function(e){return(0,s.G)(e).match.journey.score}],(function(e){return e}));(0,a.Mz)([function(e){return(0,s.G)(e).match.journey.guideWareHouseShowed}],(function(e){return e}))},143:function(e,t,n){"use strict";n.d(t,{TW:function(){return r},ix:function(){return s}});var i=n(58),a=n(229),s=(0,i.Mz)([function(e){return(0,a.G)(e).stats.data}],(function(e){return e})),r=(0,i.Mz)([function(e){return(0,a.G)(e).stats.current}],(function(e){return e}));(0,i.Mz)([function(e){return(0,a.G)(e).stats.isRequesting}],(function(e){return e}))},498:function(e,t,n){"use strict";n.d(t,{UG:function(){return T},Ub:function(){return E},bj:function(){return b},oN:function(){return D}});var i=n(23),a=n(20),s=n.n(a),r=n(40),o=n.n(r),c=n(75),l=n.n(c),h=n(48),u=n(108),d=n(110),p=n(228),f=n(47),m=n(230),g=n(481),v=n(499),y=n(70),A=GameCore.Configs.Tournament.UseLeaderboard,E=function(e,t){return void 0===t&&(t=""),{type:g.fX,payload:{tournamentId:e,leaderboardId:t}}},T=function(e){return function(){var t=(0,i.A)(s().mark((function t(n){var i,a,r,c,l,u,d,p,g,v,y;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=window.game,a=i.facebook,r=i.analytics,c=e.playerId,l=e.playerName,u=e.score,d=e.autoStartGame,t.prev=2,p=l+"'s Tournament",g=GameCore.Utils.String.generateObjectId(),t.next=7,a.tournament.createAsync({initialScore:u,config:{title:p,tournamentTitle:p},data:{playerId:c,playerName:l,leaderboardId:g}});case 7:return v=t.sent,y=v.getID(),d&&n(E(y,g)),t.next=12,(0,m.oN)({_id:g,createdBy:c,name:y,description:o()({contextID:y,tournamentID:y}),type:"tournament_leaderboard",expireTime:604800});case 12:if(t.sent._id!==g){t.next=16;break}return t.next=16,(0,m.t4)(g,c,u);case 16:r.event(h.o.TOURNAMENT_CREATE,{success:!0}),t.next=23;break;case 19:t.prev=19,t.t0=t.catch(2),r.event(h.o.TOURNAMENT_CREATE,{success:!1}),(0,f.a0)(t.t0);case 23:case"end":return t.stop()}}),t,null,[[2,19]])})));return function(e){return t.apply(this,arguments)}}()},S=function(e){return(0,i.A)(s().mark((function t(){var n,i,a,r,o;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=window.game.facebook,i=e.playerId,a=e.playerName,r=e.score,o={score:r,data:{type:u.ES,playerId:i,playerName:a}},t.next=5,n.tournament.shareAsync(o);case 5:case"end":return t.stop()}}),t)})))},b=(function(){var e=(0,i.A)(s().mark((function e(){var t,n,i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=window.game.facebook,e.next=4,t.getTournamentAsync();case 4:return n=e.sent,i=JSON.parse(n.getPayload()||"{}"),e.abrupt("return",i.leaderboardId);case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",null);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))}(),function(){var e=(0,i.A)(s().mark((function e(){var t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=window.game.facebook,e.next=4,t.getTournamentAsync();case 4:return e.abrupt("return",e.sent);case 7:return e.prev=7,e.t0=e.catch(0),console.warn("getCurrentTournament ~ error",e.t0),e.abrupt("return",null);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))}(),function(e){return function(){var t=(0,i.A)(s().mark((function t(n,i){var a,r,o,c;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=window.game.globalScene,o=i(),c=(0,p.qs)(o),l()(a=[d.Nu,d.zA]).call(a,c)){t.next=5;break}return t.abrupt("return");case 5:if(n({type:g.gJ,payload:{}}),r.screen.open(y.R8.NOTIFY_SCREEN,{message:"Loading...",loading:!0}),!A){t.next=12;break}return t.next=10,x(e,o);case 10:t.next=14;break;case 12:return t.next=14,_(e);case 14:r.screen.close(y.R8.NOTIFY_SCREEN),n(R(e));case 16:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}),P=0,C=!1,w=0,I=!1,x=function(){var e=(0,i.A)(s().mark((function e(t,n){var i,a,r,o,c,l,u,d,p,f,m;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=window.game,a=i.player,r=i.facebook,o=i.analytics,c=a.getPlayer(),l=c.playerId,u=c.name,d=a.getBestScore(),e.prev=3,e.next=6,r.getTournamentAsync();case 6:if(p=(0,v.pT)(n),!O(t,d)){e.next=15;break}return P+=1,f={playerId:l,playerName:u,score:t,leaderboardId:p},e.next=12,window.game.storage.dispatch(S(f)).then((function(){C=!0,o.event(h.o.TOURNAMENT_SHARE,{success:!0})}));case 12:C=!0,e.next=17;break;case 15:return e.next=17,r.tournament.postScoreAsync(t);case 17:e.next=28;break;case 19:if(e.prev=19,e.t0=e.catch(3),"TOURNAMENT_NOT_FOUND"!==(null==e.t0?void 0:e.t0.code)){e.next=28;break}if(k(t,d)){e.next=24;break}return e.abrupt("return");case 24:return w+=1,m={playerId:l,playerName:u,score:t,autoStartGame:!1},e.next=28,window.game.storage.dispatch(T(m)).then((function(){I=!0})).catch((function(){}));case 28:return e.prev=28,window.focus(),e.finish(28);case 31:case"end":return e.stop()}}),e,null,[[3,19,28,31]])})));return function(t,n){return e.apply(this,arguments)}}(),k=function(e,t){return!window.game.player.getPlayerIsNew()&&e>t||!(I||w>1)&&Math.random()<.5},O=function(){return!(C||P>1)},_=function(){var e=(0,i.A)(s().mark((function e(t){var n,i,a,r,o,c,l;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=window.game,i=n.player,a=n.facebook,r=n.analytics,o=i.getBestScore(),e.prev=2,e.next=5,a.getTournamentAsync();case 5:if(!O(t,o)){e.next=13;break}return P+=1,e.next=9,a.tournament.shareAsync({score:t});case 9:C=!0,r.event(h.o.TOURNAMENT_SHARE,{success:!0}),e.next=15;break;case 13:return e.next=15,a.tournament.postScoreAsync(t);case 15:e.next=26;break;case 17:if(e.prev=17,e.t0=e.catch(2),"TOURNAMENT_NOT_FOUND"!==e.t0.code){e.next=26;break}if(k(t,o)){e.next=22;break}return e.abrupt("return");case 22:return w+=1,c=i.getPlayer(),l=c.name,e.next=26,a.tournament.createAsync({initialScore:t,config:{tournamentTitle:l+"'s Tournament"}}).then((function(){I=!0,r.event(h.o.TOURNAMENT_CREATE,{success:!0})})).catch((function(e){r.event(h.o.TOURNAMENT_CREATE,{success:!1})}));case 26:return e.prev=26,window.focus(),e.finish(26);case 29:case"end":return e.stop()}}),e,null,[[2,17,26,29]])})));return function(t){return e.apply(this,arguments)}}(),R=function(e){return{type:g.ii,payload:{score:e}}},D=function(){var e=(0,i.A)(s().mark((function e(t){var n,i,a,r,o,c,u,f,m,g,A,E;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=window.game,a=i.player,r=i.analytics,o=i.globalScene,c=window.game.storage.getState(),u=(0,p.qs)(c),l()(n=[d.zA]).call(n,u)){e.next=5;break}return e.abrupt("return");case 5:return e.prev=5,o.screen.open(y.R8.NOTIFY_SCREEN,{message:"Loading...",loading:!0}),f=a.getPlayer(),m=f.playerId,g=f.name,A=(0,v.pT)(c),E={playerId:m,playerName:g,score:t,leaderboardId:A},e.next=12,window.game.storage.dispatch(S(E)).then((function(){C=!0,r.event(h.o.TOURNAMENT_SHARE,{success:!0})}));case 12:o.screen.close(y.R8.NOTIFY_SCREEN),e.next=21;break;case 15:if(e.prev=15,e.t0=e.catch(5),"USER_INPUT"!==e.t0.code){e.next=20;break}return o.screen.close(y.R8.NOTIFY_SCREEN),e.abrupt("return");case 20:o.screen.open(y.R8.NOTIFY_SCREEN,{message:"Sorry, you can not share right now!",loading:!1,duration:2500});case 21:case"end":return e.stop()}}),e,null,[[5,15]])})));return function(t){return e.apply(this,arguments)}}()},230:function(e,t,n){"use strict";n.d(t,{oN:function(){return A},L5:function(){return b},Kv:function(){return E},iF:function(){return S},hJ:function(){return P},t4:function(){return T}});var i=n(57),a=n(23),s=n(73),r=n.n(s),o=n(74),c=n.n(o),l=n(20),h=n.n(l),u=n(136),d=n(4),p=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="LeaderboardNotFound",i.message=t||"Leaderboard not found",i.payload=n,i}return(0,d.A)(t,e),t}((0,n(30).A)(Error)),f=n(135),m=GameCore.Configs,g=m.AppId,v=m.OtherHost,y=m.LeadersBoard,A=function(){var e=(0,a.A)(h().mark((function e(t){var n,a;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n={appId:g,resetScore:0,numberOfLeaders:15,timezone:"utc+0",sortOrder:"desc",statistics:"max",resettable:"manually",description:"no description"},!y.UseMock){e.next=5;break}return e.next=4,(0,f.QN)(1e3);case 4:return e.abrupt("return",(0,i.A)({},n,t,{_id:y.LeaderboardId,type:"app_leaderboard",description:"mockup_leaderboard",createdAt:new Date(Date.now()).toISOString(),updatedAt:new Date(Date.now()).toISOString()}));case 5:return"leaderboards",e.next=8,(0,u.b)("leaderboards",(0,i.A)({},n,t),{},v);case 8:return a=e.sent,e.abrupt("return",(null==a?void 0:a.data)||{});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),E=function(){var e=(0,a.A)(h().mark((function e(t,n){var i,a,s,o,l,d,p,m,g,A,E,T;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===n&&(n={}),i=[],!y.UseMock){e.next=7;break}return e.next=5,(0,f.QN)(1e3);case 5:return l=(o=n).limit,d=void 0===l?10:l,p=o.offset,m=void 0===p?0:p,e.abrupt("return",r()(a=c()(s=new Array(d)).call(s,null)).call(a,(function(e,t){var n=(t+1)*(m+1),i=y.MockOptions.PlayerEntryIndex===t,a={playerId:"player-0"+n,name:"MPlayer "+n,photo:"./assets/images/others/avatar.jpg",rank:n,score:Math.floor(1e5/n+1e4*Math.random()).toString()};if(i){var s=window.game.player.getPlayer(),r=s.playerId,o=s.name,c=s.photo;a.playerId=r,a.name=o,a.photo=c}return a})));case 7:return g=GameCore.Utils.String.params(n),A="leaderboards/"+t+"/leaders",e.next=11,(0,u.J)(A+"?"+g,{},v);case 11:if((E=e.sent)&&(null==E||!E.error)){e.next=14;break}throw new Error((null==E?void 0:E.error)||"Leaderboard not found");case 14:if(!((T=(null==E?void 0:E.data)||[]).length<1)){e.next=17;break}return e.abrupt("return",i);case 17:return i=T,e.abrupt("return",i);case 19:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),T=function(){var e=(0,a.A)(h().mark((function e(t,n,i){var a;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,u.b)("leaderboards/"+t+"/players/"+n,{score:i},{},v);case 2:return a=e.sent,e.abrupt("return",(null==a?void 0:a.data)||{});case 4:case"end":return e.stop()}}),e)})));return function(t,n,i){return e.apply(this,arguments)}}(),S=function(){var e=(0,a.A)(h().mark((function e(t){var n,i,a;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="leaderboards/"+t,e.next=3,(0,u.J)(n,{},v);case 3:if((i=e.sent)&&(null==i||!i.error)){e.next=6;break}throw new Error((null==i?void 0:i.error)||"Leaderboard not found");case 6:return a=(null==i?void 0:i.data)||{},e.abrupt("return",a.amountPlayer||0);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=(0,a.A)(h().mark((function e(){var t,n,i,a,s,o,l,d,m,g,A,E,T;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!y.UseMock){e.next=5;break}return e.next=3,(0,f.QN)(2e3*Math.random());case 3:return i=Math.floor(3),e.abrupt("return",r()(t=c()(n=new Array(i)).call(n,null)).call(t,(function(e,t){var n=t+1;return{id:n,title:n.toString(),type:"worldwide",endTime:Math.round(Date.now()/1e3+100*Math.random()),contextID:n,amountPlayer:Math.floor(1e4*Math.random()),payload:{playerId:"",playerName:"",leaderboardId:n}}})));case 5:return a=GameCore.Utils.String.params({limit:100,type:"world_tournament_leaderboard"}),"leaderboards",e.next=9,(0,u.J)("leaderboards?"+a,{},v);case 9:if(s=e.sent,console.log("result=========================== ",s),s&&(null==s||!s.error)){e.next=13;break}throw new p;case 13:o=(null==s?void 0:s.data)||[],l=[],d=0;case 16:if(!(d<o.length)){e.next=36;break}m=null,e.prev=18,m=JSON.parse(o[d].description),e.next=25;break;case 22:return e.prev=22,e.t0=e.catch(18),e.abrupt("continue",33);case 25:if(g=o[d].amountPlayer,A=new Date(o[d].expireAt).getTime(),E=Math.round(A/1e3),!(1e3*E-Date.now()<=0)){e.next=31;break}return e.abrupt("continue",33);case 31:T={id:m.tournamentID,title:o[d].name,endTime:E,type:"worldwide",amountPlayer:g,contextID:m.contextID,payload:{playerId:"",playerName:"",leaderboardId:o[d]._id}},l.push(T);case 33:d++,e.next=16;break;case 36:return e.abrupt("return",l);case 37:case"end":return e.stop()}}),e,null,[[18,22]])})));return function(){return e.apply(this,arguments)}}(),P=function(){var e=(0,a.A)(h().mark((function e(t,n){var i,a,s,r,o;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=null,t){e.next=3;break}return e.abrupt("return",i);case 3:if(a=y.Prefix+"/"+n+"/players"){e.next=6;break}return e.abrupt("return",i);case 6:return s=GameCore.Utils.String.params({playerIds:t}),e.next=9,(0,u.J)(a+"?"+s,{},v);case 9:if(r=e.sent,!((o=(null==r?void 0:r.data)||[]).length<1)){e.next=13;break}return e.abrupt("return",i);case 13:return i=o[0],e.abrupt("return",i);case 15:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},481:function(e,t,n){"use strict";n.d(t,{fX:function(){return i},gJ:function(){return a},ii:function(){return s}});var i="TOURNAMENT_ACTIVE",a="TOURNAMENT_REQUEST",s="TOURNAMENT_RECEIVED"},480:function(e,t,n){"use strict";n.d(t,{L:function(){return i}});var i="tournament"},499:function(e,t,n){"use strict";n.d(t,{pT:function(){return r}});var i=n(58),a=n(480),s=function(e){return e[a.L]},r=((0,i.Mz)([function(e){return s(e).active}],(function(e){return e})),(0,i.Mz)([function(e){return s(e).tournamentId}],(function(e){return e})),(0,i.Mz)([function(e){return s(e).bestSessionScore}],(function(e){return e})),(0,i.Mz)([function(e){return s(e).isRequesting}],(function(e){return e})),(0,i.Mz)([function(e){return s(e).leaderboardId}],(function(e){return e})))},48:function(e,t,n){"use strict";n.d(t,{o:function(){return i}});var i={BUTTON_CLICK:"button_click",SCREEN_OPEN:"screen_open",LOAD_START:"load_start",LOAD_COMPLETE:"load_complete",APP_READY:"app_ready",TUTORIAL_BEGIN:"tutorial_begin",TUTORIAL_STEP:"tutorial_step",TUTORIAL_COMPLETE:"tutorial_complete",MATCH_START:"match_start",MATCH_RESCUE:"match_rescue",MATCH_END:"match_end",LEVEL_START:"level_start",LEVEL_RESCUE:"level_rescue",LEVEL_END:"level_end",LEVEL_FAST_END:"level_fast_end",SHARE:"share",MESSAGE:"message",INVITE:"invite",SHORTCUT_CREATE:"shortcut_create",SHORTCUT_CREATE_POPUP:"shortcut_create_popup",BOT_SUBSCRIBE:"bot_subscribe",BOT_SUBSCRIBE_POPUP:"bot_subscribe_popup",AD_LOAD:"ad_load",AD_LOAD_FAILED:"ad_load_failed",AD_SHOW:"ad_show",AD_SHOW_FAILED:"ad_show_failed",MISSING_AD_SHOW:"missing_ad_show",NEW_USER:"new_user",AD_IMPRESSION:"ad_impression",JOIN_GROUP:"join_group",SWITCH_SOLO_CONTEXT:"switch_solo_context",TOURNAMENT_SHARE:"tournament_share",TOURNAMENT_CREATE:"tournament_create",TOURNAMENT_POST_SCORE:"tournament_post_score",DAILY_CHALLENGE_BEGIN:"daily_challenge_begin",DAILY_CHALLENGE_FAIL:"daily_challenge_fail",DAILY_CHALLENGE_END:"daily_challenge_end"}},221:function(e,t,n){"use strict";var i=n(89),a=function(){function e(e,t,n,a){this.playerId=void 0,this.name=void 0,this.photo=void 0,this.locale=void 0,this.playerId=e,this.name=t,this.photo=n||i.A.AVATAR.FILE,this.locale=a||"en_US"}return e.prototype.toObject=function(){return{playerId:this.playerId,name:this.name,photo:this.photo,locale:this.locale}},e}();t.A=a},476:function(e,t){"use strict";t.A={RESIZE:"resize",CHANGE_LAYOUT:"change-layout"}},483:function(e,t,n){"use strict";n.d(t,{cj:function(){return m},hP:function(){return f},os:function(){return v},vM:function(){return g}});var i=n(23),a=n(20),s=n.n(a),r=n(59),o=n.n(r),c=n(137),l=n(108),h=n(109),u=n(110),d=n(47),p=n(484),f=function(e,t,n){return{type:c.Y8,payload:{contextId:e,contextType:t,entryPointData:n}}},m=function(e,t){return{type:c.xn,payload:{contextId:e,contextType:t}}},g=function(){return function(){var e=(0,i.A)(s().mark((function e(t,n){var i,a,r,c,d,f,m,g,y,A,E,T,S,b,P,C;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n(),r=(0,p.SD)(a),c=window.game.player,d=c.getPlayerId(),f=r.contextId,m=r.entryPointData,y=(g=m||{}).type,A=g.matchId,E=g.playerId,T=g.opponentId,S=void 0===T?h.A.playerId:T,b=d===E,P=S===h.A.playerId||o()(i=[S,E]).call(i,d)>=0,C=u.Nu,e.prev=9,e.next=12,window.game.facebook.getTournamentAsync();case 12:C=u.zA,e.next=17;break;case 15:e.prev=15,e.t0=e.catch(9);case 17:f&&y===l.cD&&!b&&(C=u.QT),A&&f&&P&&y===l.xg&&(C=u.QT),f&&y===l.CS&&(C=u.Ee),t(v(C));case 21:case"end":return e.stop()}}),e,null,[[9,15]])})));return function(t,n){return e.apply(this,arguments)}}()},v=function(e){return function(t){t({type:c.ow,payload:{gameMode:e}}),(0,d.SJ)("game-mode",e)}}},500:function(e,t,n){"use strict";n.d(t,{Aq:function(){return I},wp:function(){return _},$8:function(){return O},RE:function(){return D},DX:function(){return k},Ll:function(){return R}});var i=n(23),a=n(20),s=n.n(a),r=n(137),o=n(48),c=n(108),l=n(109),h=n(691),u=n(4),d=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidOpponentId",i.message=t||"This opponentId is not valid",i.payload=n,i}return(0,u.A)(t,e),t}((0,n(30).A)(Error)),p=n(231),f=n(501),m=n(139),g=n(111),v=n(143),y=n(692),A=n(144),E=n(47),T=n(502),S=function(e){var t=e.contextId;if(""===t||"string"!==typeof t)throw new h.A(null,{contextId:t})},b=function(e){var t=e.opponentId,n=e.contextId;if(""===t||"string"!==typeof t)throw new d(null,{opponentId:t});if(""===n||"string"!==typeof n)throw new h.A(null,{contextId:n})},P=function(e){if(null===e.imageShare)throw new p.A},C=function(e,t){return void 0===t&&(t=!0),function(n,i){var a,s=i(),r=(0,y.V)(s);if(t){var o;if(null!=(o=r[e])&&o.sent)return;n(w(e))}null!=(a=r[e])&&a.sent&&n(I(e))}},w=function(e){return{type:r.K6,payload:{opponentId:e}}},I=function(e){return{type:r.fD,payload:{opponentId:e}}},x=function(){var e=(0,i.A)(s().mark((function e(t,n){var i,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,i=window.game.facebook,b({opponentId:t,contextId:n}),(a=FBInstant.context.getID())!==n||""===n){e.next=6;break}return e.abrupt("return",a);case 6:if("10"!==t||""===n){e.next=8;break}return e.abrupt("return",n);case 8:if(!n){e.next=12;break}return e.next=11,i.switchAsync(n);case 11:return e.abrupt("return",FBInstant.context.getID());case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),(0,E.a0)(e.t0);case 17:return e.abrupt("return","");case 18:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t,n){return e.apply(this,arguments)}}(),k=function(e,t){return function(){var n=(0,i.A)(s().mark((function n(i,a){var r,l,h,u,d,p,g,v,y,b,w,I;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=window.game,l=r.player,h=r.analytics,u=r.facebook,n.prev=1,d=t.matchId,p=t.contextId,n.next=5,x(e,p);case 5:return g=n.sent,S({contextId:g}),v=a(),n.next=10,(0,T.LI)(v);case 10:return y=n.sent,P({imageShare:y}),b=l.getPlayer(),w=b.name,I=b.playerId,n.next=15,u.sendMessage({cta:{default:"Play",localizations:{en_US:"Play",vi_VN:"Ch\u01a1i ngay"}},text:{default:w+" challenges you",localizations:{en_US:w+" challenges you",vi_VN:w+" th\u1eed th\xe1ch b\u1ea1n trong tr\u1eadn \u0111\u1ea5u n\xe0y. Ch\u01a1i ngay!"}},image:y||"",template:"challenge",data:{type:c.xg,matchId:d,playerId:I,opponentId:e,status:m.yS}});case 15:i(C(e)),h.event(o.o.MESSAGE,{message_content_type:"Invite",success:!0}),A.A.emit(f.A.INVITE_FRIENDS.EVENTS.INVITED_FRIEND,{type:"friend",value:1,opponentId:e}),n.next=24;break;case 20:n.prev=20,n.t0=n.catch(1),h.event(o.o.MESSAGE,{message_content_type:"Invite",success:!1}),(0,E.a0)(n.t0);case 24:case"end":return n.stop()}}),n,null,[[1,20]])})));return function(e,t){return n.apply(this,arguments)}}()},O=function(e,t){return function(){var n=(0,i.A)(s().mark((function n(i,a){var r,l,h,u,d,p,f,g,v,y,A,b;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=window.game,l=r.player,h=r.analytics,u=r.facebook,n.prev=1,d=t.matchId,p=t.contextId,n.next=5,x(e,p);case 5:return f=n.sent,S({contextId:f}),g=a(),n.next=10,(0,T.LI)(g);case 10:return v=n.sent,P({imageShare:v}),y=l.getPlayer(),A=y.name,b=y.playerId,n.next=15,u.sendMessage({cta:{default:"See result",localizations:{en_US:"See result",vi_VN:"Xem k\u1ebft qu\u1ea3"}},text:{default:A+" just finished. Check them now.",localizations:{en_US:A+" just finished. Check them now.",vi_VN:A+" v\u1eeba ho\xe0n th\xe0nh m\xe0n ch\u01a1i. Nh\u1ea5n \u0111\u1ec3 xem k\u1ebft qu\u1ea3 tr\u1eadn \u0111\u1ea5u."}},image:v||"",template:"finished",data:{type:c.xg,matchId:d,playerId:b,opponentId:e,status:m.Ux}});case 15:i(C(e)),h.event(o.o.MESSAGE,{message_content_type:"FinishMatch",success:!0}),n.next=23;break;case 19:n.prev=19,n.t0=n.catch(1),h.event(o.o.MESSAGE,{message_content_type:"FinishMatch",success:!1}),(0,E.a0)(n.t0);case 23:case"end":return n.stop()}}),n,null,[[1,19]])})));return function(e,t){return n.apply(this,arguments)}}()},_=function(e,t){return function(){var n=(0,i.A)(s().mark((function n(i,a){var r,l,h,u,d,p,f,g,y,A,b,w,I,k,O,_;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=window.game,l=r.player,h=r.analytics,u=r.facebook,n.prev=1,d=t.matchId,p=t.contextId,n.next=5,x(e,p);case 5:return f=n.sent,S({contextId:f}),g=a(),n.next=10,(0,T.LI)(g);case 10:return y=n.sent,P({imageShare:y}),A=l.getPlayer(),b=A.name,w=A.playerId,I=(0,v.ix)(g),k=I[w]||{},O=k.score,_=void 0===O?0:O,n.next=17,u.sendMessage({cta:{default:"See result",localizations:{en_US:"See result",vi_VN:"Xem k\u1ebft qu\u1ea3"}},text:{default:b+" beat your high score. Their score: "+_,localizations:{en_US:b+" beat your high score. Their score: "+_,vi_VN:b+" \u0111\xe3 v\u01b0\u1ee3t qua \u0111i\u1ec3m s\u1ed1 c\u1ee7a b\u1ea1n, v\u1edbi "+_+" \u0111i\u1ec3m!"}},image:y||"",template:"pass_score",data:{type:c.xg,matchId:d,playerId:w,opponentId:e,status:m.Ux}});case 17:i(C(e)),h.event(o.o.MESSAGE,{message_content_type:"BestScore",success:!0}),n.next=25;break;case 21:n.prev=21,n.t0=n.catch(1),h.event(o.o.MESSAGE,{message_content_type:"BestScore",success:!1}),(0,E.a0)(n.t0);case 25:case"end":return n.stop()}}),n,null,[[1,21]])})));return function(e,t){return n.apply(this,arguments)}}()},R=function(e,t){return function(){var n=(0,i.A)(s().mark((function n(i,a){var r,l,u,d,p,f,g,v,y,A,b,w,I;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=window.game,l=r.player,u=r.analytics,d=r.facebook,n.prev=1,p=t.matchId,f=t.contextId,g=t.score,n.next=5,x(e,f);case 5:return v=n.sent,S({contextId:v}),y=a(),n.next=10,(0,T.LI)(y);case 10:return A=n.sent,P({imageShare:A}),b=l.getPlayer(),w=b.name,I=b.playerId,n.next=15,d.sendMessage({cta:{default:"Play",localizations:{en_US:"Play",vi_VN:"Ch\u01a1i ngay"}},text:{default:w+" got "+g+" scores. So easy! Can you?",localizations:{en_US:w+" got "+g+" scores. So easy! Can you?",vi_VN:w+" \u0111\xe3 \u0111\u1ea1t "+g+" \u0111i\u1ec3m! Nh\u1ea5n Ch\u01a1i \u0111\u1ec3 so t\xe0i!"}},image:A||"",template:"play_turn",data:{type:c.xg,matchId:p,playerId:I,opponentId:e,status:m.yS}});case 15:i(C(e)),u.event(o.o.MESSAGE,{message_content_type:"FinishTurn",success:!0}),n.next=25;break;case 19:if(n.prev=19,n.t0=n.catch(1),u.event(o.o.MESSAGE,{message_content_type:"FinishTurn",success:!1}),!(n.t0 instanceof h.A)){n.next=24;break}return n.abrupt("return");case 24:(0,E.a0)(n.t0);case 25:case"end":return n.stop()}}),n,null,[[1,19]])})));return function(e,t){return n.apply(this,arguments)}}()},D=function(){return function(){var e=(0,i.A)(s().mark((function e(t,n){var i,a,r,c,h,u,d,p,f;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=window.game.analytics,e.prev=1,a=FBInstant.context.getID(),S({contextId:a}),r=n(),c=(0,g.Ug)(r),h=c.playerId,u=c.score,d=(0,v.TW)(r),p=d.score,!h||h===l.A.playerId){e.next=25;break}if(!(p>u)){e.next=18;break}return e.next=13,(0,T.F8)(r);case 13:return f=e.sent,e.next=16,M(f,r);case 16:e.next=23;break;case 18:return e.next=20,(0,T.Tl)(r);case 20:return f=e.sent,e.next=23,B(f,r);case 23:e.next=30;break;case 25:return e.next=27,(0,T.Tl)(r);case 27:return f=e.sent,e.next=30,B(f,r);case 30:P({imageShare:f}),i.event(o.o.MESSAGE,{message_content_type:"InviteGroup",success:!0}),e.next=38;break;case 34:e.prev=34,e.t0=e.catch(1),i.event(o.o.MESSAGE,{message_content_type:"InviteGroup",success:!0}),(0,E.a0)(e.t0);case 38:case"end":return e.stop()}}),e,null,[[1,34]])})));return function(t,n){return e.apply(this,arguments)}}()},M=function(){var e=(0,i.A)(s().mark((function e(t,n){var i,a,r,o,l,h,u,d,p,f;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=window.game,a=i.player,r=i.facebook,o=a.getPlayer(),l=o.playerId,h=o.name,u=o.photo,d=(0,v.TW)(n),p=d.score,f={type:c.CS,playerId:l,playerName:h,playerPhoto:u,playerScore:p},e.next=7,r.sendMessage({cta:{default:"Play",localizations:{en_US:"Play",vi_VN:"Ch\u01a1i"}},text:{default:h+" beats your high score. Their score: "+p+".",localizations:{en_US:h+" beats your high score. Their score: "+p+".",vi_VN:h+" v\u1eeba v\u01b0\u1ee3t \u0111i\u1ec3m s\u1ed1 cao nh\u1ea5t c\u1ee7a b\u1ea1n! Ch\u01a1i l\u1ea7n n\u1eefa ch\u1ee9?"}},image:t||"",template:"play_turn",data:f});case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),(0,E.a0)(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t,n){return e.apply(this,arguments)}}(),B=function(){var e=(0,i.A)(s().mark((function e(t,n){var i,a,r,o,l,h,u,d,p,f;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=window.game,a=i.player,r=i.facebook,e.prev=1,o=a.getPlayer(),l=o.playerId,h=o.name,u=o.photo,d=(0,v.TW)(n),p=d.score,f={type:c.CS,playerId:l,playerName:h,playerPhoto:u,playerScore:p},e.next=7,r.sendMessage({cta:{default:"Play",localizations:{en_US:"Play",vi_VN:"Ch\u01a1i ngay"}},text:{default:h+" got "+p+" scores. So easy! Can you?",localizations:{en_US:h+" got "+p+" scores. So easy! Can you?",vi_VN:h+" \u0111\xe3 \u0111\u1ea1t "+p+" \u0111i\u1ec3m! Qu\xe1 d\u1ec5 lu\xf4n. Ch\u01a1i l\u1ea1i n\xe0o!"}},image:t||"",template:"play_turn",data:f});case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),(0,E.a0)(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,n){return e.apply(this,arguments)}}()},488:function(e,t,n){"use strict";n.d(t,{T:function(){return a}});var i=n(137),a=function(e){return{type:i.N0,payload:{sceneKey:e}}}},502:function(e,t,n){"use strict";n.d(t,{F8:function(){return w},LI:function(){return C},M8:function(){return x},N_:function(){return O},Qp:function(){return S},Tl:function(){return E},kF:function(){return A},yM:function(){return y}});var i=n(23),a=n(279),s=n.n(a),r=n(20),o=n.n(r),c=n(48),l=n(108),h=n(231),u=n(89),d=n(70),p=n(227),f=n(111),m=n(143),g=n(47),v=function(e){if("string"!==typeof e||!e)throw new h.A(null,{imageShare:e})},y=function(){return(0,i.A)(o().mark((function e(){var t,n,i,a,s,r,h,u,p,f;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.game,n=t.player,i=t.analytics,a=t.facebook,s=t.globalScene,e.prev=1,s.screen.open(d.R8.NOTIFY_SCREEN,{message:"Loading...",loading:!0}),e.next=5,A();case 5:return r=e.sent,v(r),h=n.getPlayer(),u=h.playerId,p=h.name,f=h.photo,e.next=10,a.shareAsync({text:"Great! I have a best score!",intent:"SHARE",image:r||"",data:{playerId:u,playerName:p,playerPhoto:f,type:l.cD}});case 10:i.event(c.o.SHARE,{share_content_type:"BestScore",success:!0}),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),i.event(c.o.SHARE,{share_content_type:"BestScore",success:!1}),(0,g.a0)(e.t0);case 17:return e.prev=17,s.screen.close(d.R8.NOTIFY_SCREEN),e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[1,13,17,20]])})))},A=function(){var e=(0,i.A)(o().mark((function e(){var t,n,i,a,s,r,c,l,h,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=window.game,n=t.player,i=t.globalScene,a=n.getPlayer(),s=a.playerId,r=a.photo,c=a.data,l=(c||{}).score,h=T({playerId:s,playerPhoto:r,playerScore:l})){e.next=7;break}return console.warn("getRenderOptionsBestScore"),e.abrupt("return");case 7:return u={name:"share-best-score",width:952,height:492,renderOptions:h},e.next=10,i.frameCapture.capture(u);case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),E=function(){var e=(0,i.A)(o().mark((function e(t){var n,i,a,s,r,c,l,h,u,d,p,f;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=window.game,i=n.player,a=n.globalScene,s=(0,m.TW)(t),r=(0,m.ix)(t),c=i.getPlayer(),l=c.playerId,h=c.photo,u=r[l]||{},d=u.score,s.bestScore>d&&(d=s.bestScore),p=T({playerId:l,playerPhoto:h,playerScore:d})){e.next=10;break}return console.warn("getRenderOptionsCurrentScore"),e.abrupt("return");case 10:return f={name:"share-current-score",width:952,height:492,renderOptions:p},e.next=13,a.frameCapture.capture(f);case 13:return e.abrupt("return",e.sent);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=function(e){var t=e.playerId,n=void 0===t?"10":t,i=e.playerPhoto,a=void 0===i?"":i,s=e.playerScore,r=void 0===s?0:s;return"string"!==typeof n||"string"!==typeof a||"number"!==typeof r?null:{avatar:{name:""+n,type:"image",x:625,y:125,image:a,width:215,height:215,fallbackWithImage:u.A.AVATAR.KEY},wideFrame:{name:"wide-frame-message-win",type:"image",x:0,y:0,image:"./assets/wideframes/wide-frame-message-win.png",width:952,height:492},playerScoreShadow:{type:"text",x:740,y:437,font:"600 70px",fillStyle:"#c4683f",text:""+r,textAlign:"center"},playerScore:{type:"text",x:740,y:437,font:"600 70px",fillStyle:"#f2a62e",text:""+r,textAlign:"center"}}},S=function(){return(0,i.A)(o().mark((function e(){var t,n,i,a,s,r,h,u,p,f;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.game,n=t.player,i=t.analytics,a=t.facebook,s=t.globalScene,e.prev=1,s.screen.open(d.R8.NOTIFY_SCREEN,{message:"Loading...",loading:!0}),e.next=5,b();case 5:return r=e.sent,v(r),h=n.getPlayer(),u=h.playerId,p=h.name,f=h.photo,e.next=10,a.shareAsync({text:"A ha, I'm the best!",intent:"CHALLENGE",image:r||"",data:{playerId:u,playerName:p,playerPhoto:f,type:l.cD}});case 10:i.event(c.o.SHARE,{share_content_type:"Leaderboard",success:!0}),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),i.event(c.o.SHARE,{share_content_type:"Leaderboard",success:!1}),(0,g.a0)(e.t0);case 17:return e.prev=17,s.screen.close(d.R8.NOTIFY_SCREEN),e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[1,13,17,20]])})))},b=function(){var e=(0,i.A)(o().mark((function e(){var t,n,i,a,r,c,l,h,u,d,f,m,g,v,y,A,E,T,S,b;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.game,n=t.player,i=t.profile,a=t.globalScene,r=n.getPlayer(),c=r.playerId,l=r.name,h=r.photo,(u=n.getConnectedPlayerIds(99,0)).push(c),d=[],e.next=7,(0,p.bO)({playerIds:GameCore.Utils.Array.unique(u),limit:u.length});case 7:f=e.sent,m=GameCore.Utils.Object.keyBy(f,"playerId"),g={playerId:c,name:l,photo:h,score:0},GameCore.Utils.Object.hasOwn(m,c)&&(g=m[c]),d.push(g),e.t0=s()(o()).call(o(),m);case 14:if((e.t1=e.t0()).done){e.next=27;break}if(v=e.t1.value,!GameCore.Utils.Object.hasOwn(m,v)){e.next=25;break}if(y=m[v],3!==d.length){e.next=20;break}return e.abrupt("break",27);case 20:if(y.playerId!==c){e.next=22;break}return e.abrupt("continue",14);case 22:if(!(Number(y.score)>Number(g.score))){e.next=24;break}return e.abrupt("continue",14);case 24:d.push(y);case 25:e.next=14;break;case 27:return A=GameCore.Utils.Array.unique(u),e.next=30,i.requestProfiles(A);case 30:if(E=i.getProfiles(),d.forEach((function(e,t){var n=e.playerId;if(GameCore.Utils.Object.hasOwn(E,n)){var i=E[n],a=i.name,s=i.photo;d[t].name=a,d[t].photo=s}})),d.length<3)for(T=0;T<=3-d.length;)d.push({playerId:"bot"+T,name:"???",score:0,photo:"./assets/images/others/avatar.png"}),T++;if(S=P({playerId:c,playerName:l,playerPhoto:h,listLeaders:d})){e.next=37;break}return console.warn("getRenderOptionsLeaderboard"),e.abrupt("return");case 37:return b={name:"share-leaderboard",width:1500,height:2e3,renderOptions:S},e.next=40,a.frameCapture.capture(b);case 40:return e.abrupt("return",e.sent);case 41:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),P=function(e){var t=e.playerId,n=void 0===t?"10":t,i=e.playerPhoto,a=void 0===i?"":i,s=e.listLeaders,r=void 0===s?[]:s;if(!Array.isArray(r))return null;if("string"!==typeof n)return null;if("string"!==typeof a)return null;var o={avatar:{name:""+n,type:"image",x:490,y:250,image:a,width:525,height:525,fallbackWithImage:u.A.AVATAR.KEY}};return r.forEach((function(e,t){var n=e.playerId,i=e.photo;o["photo_"+n]={name:""+n,type:"image",x:460,y:1160+230*t,image:i,width:130,height:130,fallbackWithImage:u.A.AVATAR.KEY}})),o.wideFrame={name:"wide-frame-share",type:"image",x:0,y:0,image:"./assets/wideframes/wide-frame-share.png",width:1500,height:2e3},r.forEach((function(e,t){var n=e.playerId,i=e.name,a=e.score;o["name_"+n]={type:"text",x:690,y:1250+226*t,font:"600 60px",text:i,fillStyle:"#b18151"},o["score_"+n]={type:"text",x:1070,y:1250+226*t,font:"600 55px",text:a,fillStyle:"#b18151"}})),o},C=function(){var e=(0,i.A)(o().mark((function e(t){var n,i,a,s,r,c,l,h,u,d,p,g,v,y,A,E,T,S,b;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=window.game,i=n.player,a=n.globalScene,s=(0,m.ix)(t),r=i.getPlayer(),c=r.photo,l=r.playerId,h=(0,f.sp)(t),u=h.playerId,d=(0,f.sp)(t),p=d.photo,"10"===u&&(u=(0,f.eo)(t)),g=(0,f.pr)(t,{playerId:l}),v=(0,f.Bx)(t,{opponentId:u}),y=s[l]||{},A=y.score,E=s[u]||{},T=E.score,S=I({playerId:l,playerPhoto:c,playerScore:A,opponentId:u,opponentPhoto:p,opponentScore:T,isPlayerFinished:g,isOpponentFinished:v})){e.next=14;break}return console.warn("getRenderOptionsLeaderboard"),e.abrupt("return");case 14:return b={name:"share-game-result",width:952,height:492,renderOptions:S},e.next=17,a.frameCapture.capture(b);case 17:return e.abrupt("return",e.sent);case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),w=function(){var e=(0,i.A)(o().mark((function e(t){var n,i,a,s,r,c,l,h,u,d,p,g,v,y,A;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=window.game,i=n.player,a=n.globalScene,s=(0,m.ix)(t),r=i.getPlayer(),c=r.photo,l=r.playerId,h=(0,f.Ug)(t),u=h.playerId,d=h.photo,p=h.score,g=s[l]||{},v=g.score,y=I({playerId:l,playerPhoto:c,playerScore:v,opponentId:u,opponentPhoto:d,opponentScore:p})){e.next=9;break}return console.warn("getRenderOptionsGroupResult"),e.abrupt("return");case 9:return A={name:"share-group-match-result",width:952,height:492,renderOptions:y},e.next=12,a.frameCapture.capture(A);case 12:return e.abrupt("return",e.sent);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I=function(e){var t=e.playerId,n=void 0===t?"10":t,i=e.playerPhoto,a=void 0===i?"":i,s=e.playerScore,r=void 0===s?0:s,o=e.opponentId,c=void 0===o?"20":o,l=e.opponentPhoto,h=void 0===l?"":l,d=e.opponentScore,p=void 0===d?0:d,f=e.isPlayerFinished,m=e.isOpponentFinished;if("string"!==typeof n)return null;if("string"!==typeof a)return null;if("number"!==typeof r)return null;if("string"!==typeof c)return null;if("string"!==typeof h)return null;if("number"!==typeof p)return null;if("boolean"!==typeof f)return null;if("boolean"!==typeof m)return null;var g=r===p,v=r>p,y=f||m,A=f&&m,E={leftPhoto:{name:""+n,type:"image",x:42,y:168,image:a,width:190,height:190,fallbackWithImage:u.A.AVATAR.KEY},rightPhoto:{name:""+c,type:"image",x:722,y:168,image:h,width:190,height:190,fallbackWithImage:u.A.AVATAR.KEY},wideFrame:{name:"wide-frame-game-result",type:"image",x:0,y:0,image:"./assets/wideframes/wide-frame-game-result.png",width:952,height:492}};return y&&(E.leftScoreShadow={type:"text",x:135,y:443,font:"600 70px",fillStyle:"#c4683f",text:f?""+r:"???",textAlign:"center"},E.leftScore={type:"text",x:135,y:443,font:"600 70px",fillStyle:"#f2a62e",text:f?""+r:"???",textAlign:"center"},E.rightScoreShadow={type:"text",x:825,y:443,font:"600 70px",fillStyle:"#c4683f",text:m?""+p:"???",textAlign:"center"},E.rightScore={type:"text",x:825,y:443,font:"600 70px",fillStyle:"#f2a62e",text:m?""+p:"???",textAlign:"center"}),!g&&A&&(v?E.leftCrown={name:"crown-icon",type:"image",x:80,y:95,image:"./assets/images/others/crown-icon.png",width:106,height:78}:E.rightCrown={name:"crown-icon",type:"image",x:765,y:95,image:"./assets/images/others/crown-icon.png",width:106,height:78}),E},x=function(){return function(){var e=(0,i.A)(o().mark((function e(t){var n,i,a,s,r,h,u,p,f,m;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=window.game,i=n.player,a=n.analytics,s=n.facebook,r=n.globalScene,e.prev=1,r.screen.open(d.R8.NOTIFY_SCREEN,{message:"Loading...",loading:!0}),e.next=5,k();case 5:return h=e.sent,console.log(h),v(h),u=i.getPlayer(),p=u.playerId,f=u.name,m=u.photo,e.next=11,s.shareAsync({text:"Great! I have a score!",intent:"SHARE",image:h||"",data:{playerId:p,playerName:f,playerPhoto:m,type:l.cD}});case 11:a.event(c.o.SHARE,{share_content_type:"Score",success:!0}),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(1),a.event(c.o.SHARE,{share_content_type:"Score",success:!1}),(0,g.a0)(e.t0);case 18:return e.prev=18,r.screen.close(d.R8.NOTIFY_SCREEN),e.finish(18);case 21:case"end":return e.stop()}}),e,null,[[1,14,18,21]])})));return function(t){return e.apply(this,arguments)}}()},k=function(){var e=(0,i.A)(o().mark((function e(){var t,n,i,a,s,r,c,l,h;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=window.game,n=t.player,i=t.globalScene,a=n.getPlayer(),s=a.playerId,r=a.photo,c=n.getBestScore(),l=R({playerId:s,playerPhoto:r,playerScore:c})){e.next=7;break}return console.warn("getRenderOptionsBestScore"),e.abrupt("return");case 7:return h={name:"share-score",width:952,height:492,renderOptions:l},e.next=10,i.frameCapture.capture(h);case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),O=function(e){return function(){var t=(0,i.A)(o().mark((function t(n){var i,a,s,r,h,u,p,f,m,y;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=window.game,a=i.player,s=i.analytics,r=i.facebook,h=i.globalScene,t.prev=1,h.screen.open(d.R8.NOTIFY_SCREEN,{message:"Loading...",loading:!0}),t.next=5,_(e);case 5:return u=t.sent,console.log(u),v(u),p=a.getPlayer(),f=p.playerId,m=p.name,y=p.photo,t.next=11,r.shareAsync({text:"Great! I have a score!",intent:"SHARE",image:u||"",data:{playerId:f,playerName:m,playerPhoto:y,type:l.cD}});case 11:s.event(c.o.SHARE,{share_content_type:"Score",success:!0}),t.next=18;break;case 14:t.prev=14,t.t0=t.catch(1),s.event(c.o.SHARE,{share_content_type:"Score",success:!1}),(0,g.a0)(t.t0);case 18:return t.prev=18,h.screen.close(d.R8.NOTIFY_SCREEN),t.finish(18);case 21:case"end":return t.stop()}}),t,null,[[1,14,18,21]])})));return function(e){return t.apply(this,arguments)}}()},_=function(){var e=(0,i.A)(o().mark((function e(t){var n,i,a,s,r,c,l,h;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=window.game,i=n.player,a=n.globalScene,s=i.getPlayer(),r=s.playerId,c=s.photo,l=R({playerId:r,playerPhoto:c,playerScore:t})){e.next=7;break}return console.warn("getRenderOptionsBestScore"),e.abrupt("return");case 7:return h={name:"share-score",width:952,height:492,renderOptions:l},e.next=10,a.frameCapture.capture(h);case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),R=function(e){var t=e.playerId,n=void 0===t?"10":t,i=e.playerPhoto,a=void 0===i?"":i,s=e.playerScore,r=void 0===s?0:s;return"string"!==typeof n||"string"!==typeof a||"number"!==typeof r?null:{avatar:{name:""+n,type:"image",x:625,y:125,image:a,width:215,height:215,fallbackWithImage:u.A.AVATAR.KEY},wideFrame:{name:"wide-frame-message-win",type:"image",x:0,y:0,image:"./assets/wideframes/wide-frame-message-win.png",width:952,height:492},playerScoreShadow:{type:"text",x:740,y:437,font:"600 70px",fillStyle:"#c4683f",text:""+r,textAlign:"center"},playerScore:{type:"text",x:740,y:437,font:"600 70px",fillStyle:"#f2a62e",text:""+r,textAlign:"center"}}}},484:function(e,t,n){"use strict";n.d(t,{BC:function(){return s},SD:function(){return a}});var i=n(58),a=(0,i.Mz)([function(e){return e.context}],(function(e){return e})),s=((0,i.Mz)([function(e){return e.context.contextId}],(function(e){return e})),(0,i.Mz)([function(e){return e.context.contextType}],(function(e){return e})),(0,i.Mz)([function(e){return e.context.processed}],(function(e){return e})),(0,i.Mz)([function(e){return e.context.currentGameMode}],(function(e){return e})))},692:function(e,t,n){"use strict";n.d(t,{V:function(){return a},p:function(){return s}});var i=n(58),a=(0,i.Mz)([function(e){return e.messages.data}],(function(e){return e})),s=(0,i.Mz)([a,function(e,t){return t.opponentId}],(function(e,t){return!!GameCore.Utils.Valid.isString(t)&&(!!GameCore.Utils.Object.hasOwn(e,t)&&e[t].sent)}))},135:function(e,t,n){"use strict";n.d(t,{H7:function(){return l},QN:function(){return s},QW:function(){return o},Yz:function(){return c},eu:function(){return r},hk:function(){return h}});var i=n(72),a=n.n(i),s=(n(51),function(e){return new(a())((function(t){return setTimeout(t,e)}))}),r=function(e){var t=new Date(e),n=new Date;return t.getDate()===n.getDate()&&t.getMonth()===n.getMonth()&&t.getFullYear()===n.getFullYear()},o=function(e){var t=new Date(e);t.setHours(0,0,0,0);var n=new Date(t.getFullYear(),0,1);return t.setDate(t.getDate()+4-(t.getDay()||7)),Math.ceil(((t.valueOf()-n.valueOf())/864e5+1)/7)},c=function(e,t){var n=new Date(t,0,1),i=7*(e-1),a=new Date(n);return a.setDate(n.getDate()+i-n.getDay()+1),a},l=function(e,t){var n=c(e,t),i=new Date(n);return i.setDate(n.getDate()+7),i.getFullYear()>t||53===e?new Date(t+1,0,1):i},h=function(){return(new Date).getFullYear()}},47:function(e,t,n){"use strict";n.d(t,{SJ:function(){return s},Tm:function(){return r},a0:function(){return l},ig:function(){return a},o9:function(){return c}});n(473),n(146),n(40),n(59);var i=!1,a=function(){var e=setInterval((function(){window.Sentry&&(clearInterval(e),console.warn({isSentryEnabled:i}))}),100)},s=function(e,t){window.Sentry&&window.Sentry.addBreadcrumb({category:e,message:t})},r=function(e){window.Sentry&&window.Sentry.setUser(e)},o=function(e){console.error(e)},c=function(e,t){e&&window.Sentry.withScope((function(n){n.setExtras(t),o(e)}))},l=function(e){e&&o(e)}},675:function(e,t,n){"use strict";n.d(t,{A:function(){return p}});var i,a=n(662),s=n.n(a),r=n(57),o={fontSize:"14px",fontFamily:"sans-serif"};function c(e){var t=(0,r.A)({},o,e),n=[];return t.fontStyle&&n.push(t.fontStyle),t.fontVariant&&n.push(t.fontVariant),t.fontWeight&&n.push(t.fontWeight),GameCore.Utils.Valid.isNumber(t.fontSize)?t.fontSize=t.fontSize+"px":t.fontSize=o.fontSize,t.lineHeight?n.push(t.fontSize+"/"+t.lineHeight):n.push(t.fontSize),n.push(t.fontFamily),n.join(" ")}function l(e,t,n){if(void 0===n&&(i||(i=document.createElement("canvas")),i.width=1,i.height=1,!(n=i.getContext("2d")||void 0)))throw new Error("Get context 2d failed.");var a=c(t);n.font=a,n.textAlign="left",n.textBaseline="bottom";var s,r,o=n.measureText(e);if("undefined"===typeof o.actualBoundingBoxLeft)return{text:e,letter:e,width:o.width,height:parseInt(""+(null!=(s=t.fontSize)?s:"14"),10),fontWidth:o.width,fontHeight:parseInt(""+(null!=(r=t.fontSize)?r:"14"),10),trimOffsetTop:0,trimOffsetLeft:0};n.textAlign="right",n.textBaseline="top";var l=n.measureText(e),h=Math.ceil(o.actualBoundingBoxLeft),u=Math.ceil(l.actualBoundingBoxAscent),d=h+Math.ceil(o.actualBoundingBoxRight),p=Math.ceil(o.actualBoundingBoxDescent)+Math.ceil(o.actualBoundingBoxAscent),f=Math.ceil(o.width),m=o.actualBoundingBoxAscent-l.actualBoundingBoxAscent;return"M"===e&&console.log({text:e,letter:e,width:d,height:p,fontWidth:f,fontHeight:m,trimOffsetTop:u,trimOffsetLeft:h}),{text:e,letter:e,width:d,height:p,fontWidth:f,fontHeight:m,trimOffsetTop:u,trimOffsetLeft:h}}var h=n(664);function u(e){return s()(e)%1===0?e:Math.pow(2,Math.ceil(s()(e)))}var d=function(){function e(){}return e.generateFont=function(e,t,n){for(var i=this,a=Math.max(2.88,e.world.getZoomRatio()),s=new h.Kt(2048,2048,2,{smart:!0,pot:!1,square:!1,allowRotation:!1,tag:!1,border:0}),r={},o=0;o<n.length;o++){for(var d=n[o],p=d.fontStyle,f=d.characters,m=(d.fontKey,d.xOffset,d.yOffset,d.strokeThickness),g=void 0===m?0:m,v=d.shadow,y=void 0===v?{}:v,A=d.layer3D,E=void 0===A?{}:A,T=y.shadowOffsetY,S=void 0===T?0:T,b=E.font3DOffsetY,P=void 0===b?0:b,C=E.shadowFont3dOffsetY,w=void 0===C?0:C,I=Math.max(S,P+w),x=[],k=l("@",p).trimOffsetTop,O={},_=0;_<f.length;_++){var R=f[_],D=l(R,p),M=(D.width+2*g)*a,B=(D.height+2*g+I)*a;x.push({name:R,x:0,y:0,width:M,height:B,config:d,trimOffsetTopHighestChar:k,letterSize:D}),O[R]=D}s.addArray(x)}s.next(),s.bins.forEach((function(n,s){var o=0,l=0;n.rects.forEach((function(e){var t=e.x,n=e.y,i=e.width,a=e.height;t+i>o&&(o=t+i),n+a>l&&(l=n+a)})),o=u(o),l=u(l);var h=e.textures.get(t);if(h.key!==t&&(h=e.textures.createCanvas(t,o,l)),h.source.length<=s){var d=Phaser.Display.Canvas.CanvasPool.create(e,o,l);h.source.push(new Phaser.Textures.TextureSource(h,d,o,l))}var p=h.source[s].source,f=p.getContext("2d");if(!f)return!1;f.clearRect(0,0,o,l),n.rects.forEach((function(e){var t=e.name,n=t.charCodeAt(0);f.save();var u,d=e.config,p=d.fontStyle,m=d.fontKey,g=d.xOffset,v=void 0===g?0:g,y=d.yOffset,A=void 0===y?0:y,E=d.strokeThickness,T=void 0===E?0:E,S=d.tintFill,b=void 0===S?"#fff":S,P=d.shadow,C=void 0===P?{}:P,w=d.layer3D,I=void 0===w?{}:w,x=C.shadowOffsetY,k=void 0===x?0:x,O=C.shadowTintFill,_=void 0===O?"#ffffff":O,R=(I.shadow3DTintFill,I.font3DOffsetY),D=void 0===R?0:R,M=I.shadowFont3dOffsetY,B=void 0===M?0:M,L=I.tintFill3D,N=void 0===L?"#bbbbbb":L,G=Math.max(k,D+B),F=p.fontSize,U=void 0===F?14:F;u=GameCore.Utils.Valid.isNumber(U)?U*a:parseInt(U)*a,u=Math.round(u);var j=e.letterSize,V=e.trimOffsetTopHighestChar;f.font=c(p),f.textAlign="left",f.textBaseline="top",f.scale(a,a);var z=e.x,Y=e.y,H=e.width,K=e.height,W=z/a+T+j.trimOffsetLeft,Z=Y/a+T+j.trimOffsetTop,X=z/a,J=Y/a,q=z/a,Q=Y/a+K/a;D&&(B&&(f.shadowColor="rgba(5, 5, 4, 1)",f.shadowBlur=4,f.shadowOffsetY=B),Array.isArray(N)?i.setTintFillGradient(f,N,X,J,q,Q):f.fillStyle=N,f.fillText(t,W,Z+D),B&&(f.shadowColor="transparent",f.shadowBlur=0,f.shadowOffsetX=0,f.shadowOffsetY=0)),T&&(f.strokeStyle="#ffffff",f.lineWidth=T,f.lineJoin="round"),T&&f.strokeText(t,W,Z),k&&(f.fillStyle=_,f.fillText(t,W,Z+k)),Array.isArray(b)?i.setTintFillGradient(f,b,X,J,q,Q):f.fillStyle=b,f.fillText(t,W,Z),f.restore();var $=z/o,ee=Y/l,te=(z+H)/o,ne=(Y+K)/l;r[m]||(r[m]={chars:{},font:m,lineHeight:u,size:u}),r[m].chars[n]={x:z,y:Y,width:H,height:K,centerX:Math.floor(H/2),centerY:Math.floor(K/2),xOffset:(-j.trimOffsetLeft+v-T)*a,yOffset:(-j.trimOffsetTop+V+A-T+G)*a,xAdvance:j.fontWidth*a,data:{},kerning:{},u0:$,v0:ee,u1:te,v1:ne};var ie=h.add(m+"_"+t,s,z,Y,H,K);ie&&ie.setUVs(H,K,$,ee,te,ne)})),h.source[s].update(),Phaser.Display.Canvas.CanvasPool.remove(p),f.restore()}));for(var L=0;L<n.length;L++){var N=n[L],G=N.fontStyle,F=N.fontKey,U=(N.xOffset,N.yOffset,N.strokeThickness,G.fontSize),j=void 0===U?14:U,V=void 0;V=GameCore.Utils.Valid.isNumber(j)?j*a:parseInt(j)*a,V=Math.round(V),e.sys.cache.bitmapFont.add(F,{data:r[F],texture:t,frame:null,size:V,lineHeight:V})}},e.setTintFillGradient=function(e,t,n,i,a,s){var r=e.createLinearGradient(n,i,a,s);t.forEach((function(e,n){r.addColorStop(n/(t.length-1),e)})),e.fillStyle=r},e}(),p=d},144:function(e,t,n){"use strict";var i=n(444),a=new(n.n(i)());t.A=a},471:function(e,t,n){"use strict";n.d(t,{A:function(){return Ve}});var i=n(112),a=n.n(i),s=n(51),r=n.n(s),o=function(e,t){return void 0===t&&(t=1),a()({length:Math.ceil(e.length/t)},(function(n,i){return r()(e).call(e,i*t,i*t+t)}))},c=n(91),l=n.n(c),h=n(75),u=n.n(h),d=function(e,t){return l()(e).call(e,(function(e){return!u()(t).call(t,e)}))},p=function(e){for(var t=e.length-1;t>0;t--){var n=Math.floor(Math.random()*(t+1)),i=[e[n],e[t]];e[t]=i[0],e[n]=i[1]}},f=n(59),m=n.n(f),g=function(e,t,n){return m()(n).call(n,e)===t&&null!==e&&void 0!==e},v=function(e){return l()(e).call(e,g)},y={chunk:o,difference:d,shuffle:p,unique:v},A=n(74),E=n.n(A),T=n(350),S=n.n(T),b=S()((function(e,t){if("string"===typeof e){var n=t[e.toLowerCase()];if("string"===typeof n)return n}return"?"})),P=S()((function(e){for(var t=null,n=[],i=/:([A-Z0-9?]+)/gm;null!==(t=i.exec(e));)n.push(t[1]);return n})),C=S()((function(e){for(var t=null,n=[],i=/([0-9]+[A-Z?]{1}|[A-Z?]{1})/gm;null!==(t=i.exec(e));){var a=t[0];if(a.length>=2){var s,o=a.length,c=r()(a).call(a,0,o-1),l=a[o-1],h=E()(s=new Array(+c)).call(s,l);n.push.apply(n,h)}else n.push(a)}return n})),w=function(e,t){var n=e,i=GameCore.Utils.Object.invert(t),a={},s=0,r=0;return P(n).forEach((function(e){s=0,r++,a[r]||(a[r]={}),C(e).forEach((function(e){s++,a[r][s]=b(e,i)}))})),a},I=S()((function(e,t){var n=t[e];return"string"===typeof n?""+n.toUpperCase():"?"})),x=function e(t,n,i){void 0===i&&(i=!1);var a="";if(!GameCore.Utils.Valid.isObject(t))return a;var s="",o=1;for(var c in t)if(GameCore.Utils.Object.hasOwn(t,c)){var l=t[c];if(GameCore.Utils.Valid.isObject(l))a+=":"+e(l,n,!0);else if(GameCore.Utils.Valid.isString(l)){var h=I(l,n);h===s?(o++,a=r()(a).call(a,0,-2)):o=1,a+=""+o+h,s=h}}return a=a.replace(/1([A-Z])/g,"$1")},k=function(e,t){try{if(!e)return"";if(t){var n=atob(e),i=btoa(t);return n=n.replace(i,"="),atob(n)}return atob(e)}catch(a){return console.warn("Error in hashToString",a),""}},O=function(e,t){try{if(!e)return"";if(t){var n=btoa(e),i=btoa(t);return n=n.replace("=",i),btoa(n)}return btoa(e)}catch(a){return console.warn("Error in stringToHash",a),""}},_=function(){var e={},t=0;e["="]=t++,e["["]=t++,e["]"]=t++,e[","]=t++,e['"']=t++,e[":"]=t++,e["{"]=t++,e["}"]=t++;for(var n=48;n<=57;n++)e[String.fromCharCode(n)]=t++;e['suits":["']=t++,e.clubs=t++,e.diamonds=t++,e.hearts=t++,e.spades=t++,e.id=t++,e['piles":']=t++,e['type":"prebuilt"']=t++,e['type":"dynamic"']=t++,e['difficulty":"random"']=t++,e['difficulty":"easy"']=t++,e['difficulty":"medium"']=t++,e['difficulty":"hard"']=t++,e['mainMissions":{']=t++,e.win=t++;for(var i=1;i<=8;i++)e["finish"+i+"Run"]=t++;for(var a=1;a<=9;a++)e["clear"+a+"Column"]=t++;e['foundations":']=t++,e['startingCards":']=t++,e['startingLayout":"']=t++,e['difficulty":"dynamic"']=t++,e['type":"journey"']=t++,e['journeyData":{']=t++,e['stock":"']=t++,e['pileData":{']=t++;for(var s=0;s<=9;s++)e["pile"+s+'":"']=t++;e.NoStock=t++,e['info":']=t++,e['extra":{']=t++,e['move":']=t++,e['time":']=t++,e['foundationData":{']=t++;for(var r=0;r<=9;r++)e["foundation"+r+'":"']=t++;return e['min":']=t++,e['max":']=t++,e}(),R=function(){for(var e={},t=5,n=["c","d","h","s"],i=1;i<=13;i++)for(var a=0;a<4;a++)e[""+i+n[a]]=t++,e[","+i+n[a]]=t++;for(var s=1;s<=13;s++)for(var r=0;r<4;r++)e["-"+s+n[r]]=t++,e[",-"+s+n[r]]=t++;return e}(),D=function(){var e=[];e.push('startingLayout":"'),e.push('stock":"');for(var t=0;t<=9;t++)e.push("pile"+t+'":"');for(var n=0;n<=9;n++)e.push("foundation"+n+'":"');return e}(),M=function(e){for(var t=!1,n="",i=[],a=0;a<e.length;a++){var s=e[a],r=n+s;'"'===s&&t&&(t=!1);var o=t?R:_;o[r]?(i.push(o[r]),u()(D).call(D,r)&&(t=!0),n=""):n=r}return i},B=n(148),L=n.n(B),N=n(92),G=n.n(N),F=function(e){var t;return L()(t=G()(e)).call(t,(function(t,n){return t[e[n]]=n,t}),{})},U=F(R),j=F(_),V=function(e){for(var t=j,n=U,i=!1,a="",s=0;s<e.length;s++){var r=e[s];4===e[s]&&i&&(i=!1);var o=i?n:t;if(!o[r]){console.warn("Invalid code in LZW decompression: ",r);break}a+=o[r],u()(D).call(D,o[r])&&(i=!0)}return a},z=n(73),Y=n.n(z),H={decodeMap:w,encodeMap:x,hashToString:k,stringToHash:O,lzwCompress:M,lzwDecompress:V,encodeLZWCompress:function(e){return Y()(e).call(e,(function(e){return String.fromCharCode(e+48)})).join("")},decodeLZWCompress:function(e){for(var t=[],n=0;n<e.length;n++)t.push(e.charCodeAt(n)-48);return t}},K=function(e){try{return JSON.parse(e)}catch(t){return null}},W=n(40),Z=n.n(W),X=function(e){try{return Z()(e,null,0)}catch(t){return""}},J=function(e){return K(X(e))},q={clone:J,decode:K,encode:X},Q=function(e){var t="object"===typeof e||"function"===typeof e,n=Array.isArray(e);return null!==e&&t&&!n},$=function(e){return void 0===e||null===e},ee=function e(t){if(!Q(t))return t;for(var n in t){$(t[n])&&delete t[n];var i=t[n];Q(i)&&(t[n]=e(i))}return t},te=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},ne=function(e){var t={};return G()(e).forEach((function(n){if(te(e,n)){var i=e[n];"string"===typeof i&&(t[i]=n)}})),t},ie=function(e,t){if(!Array.isArray(e))return{};var n={};return e.forEach((function(e){if(te(e,t)){var i=e[t];"string"===typeof i&&(n[i]=e)}})),n},ae={clear:ee,hasOwn:te,invert:ne,keyBy:ie},se=function(e){return e?e[0].toUpperCase()+r()(e).call(e,1):e},re=function(e){var t=0;if(0==e.length)return t;for(var n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n),t&=t}return t},oe=function(e){var t;return L()(t=G()(e)).call(t,(function(t,n){var i=e[n];return void 0!==i&&t.push(n+"="+i),t}),[]).join("&")},ce=function(e){void 0===e&&(e="0x");for(var t=e,n=0;n<6;n++)t+="0123456789ABCDEF"[Math.floor(16*Math.random())];return t},le=function(e,t){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789*#%&!",i="",a=e;void 0!=t&&(a-=t.length,i+=t);for(var s=0;s<a;s++){var r=Math.floor(67*Math.random());i+=n.charAt(r)}return i},he=function(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[\u0111\u0110]/g,(function(e){return"\u0111"===e?"d":"D"}))},ue=n(71),de=n.n(ue),pe=n(332),fe=n.n(pe),me=function(e,t){var n,i=e.split(" "),a=(i.length<=1?de()(n=[]).call(n,i):[i[0],i.pop()]).join(" "),s=fe()(a).call(a," ")||0,r=s>=0?s:t;return(a.length>t?a.substring(0,r):a).substring(0,t)},ge=n(266),ve=n.n(ge),ye={capitalize:se,hashCode:re,params:oe,toCamelCase:function(e){var t=e.replace(/[-_\s.]+(.)?/g,(function(e,t){return t?t.toUpperCase():""}));return t.substr(0,1).toLowerCase()+t.substr(1)},toUpperCamelCase:function(e){var t=e.replace(/[-_\s.]+(.)?/g,(function(e,t){return t?t.toUpperCase():""}));return t.substr(0,1).toUpperCase()+t.substr(1)},randomColor:ce,random:le,removeDiacritics:he,getShortName:me,generateObjectId:function(e){void 0===e&&(e=16);var t=function(t){return Math.floor(t).toString(e)};return t(Date.now()/1e3)+ve()(" ").call(" ",e).replace(/./g,(function(){return t(Math.random()*e)}))},replaceVariables:function(e,t){if(0==t.length)return e;for(var n=e,i=0;i<t.length;i++)n=n.replace(/{}/,""+t[i]);return n}},Ae=function(e){return"boolean"===typeof e},Ee=function(){return true},Te=function(e){return"function"===typeof e},Se=function(e){return"number"===typeof e},be=function(e){var t;return m()(t=["string","number","symbol"]).call(t,typeof e)>-1},Pe=function(e){return"string"===typeof e},Ce=n(72),we=n.n(Ce),Ie=function(e,t,n){var i=n||{},a=i.timeout,s=void 0===a?1e3:a,r=i.checkInterval,o=void 0===r?100:r;return new(we())((function(n){var i=setInterval((function(){("function"===typeof e?e():e)===("function"===typeof t?t():t)&&(clearInterval(i),n(!0))}),o);s>0&&setTimeout((function(){clearInterval(i),n(!1)}),s)}))},xe={isBoolean:Ae,isDebugger:Ee,isFunction:Te,isNumber:Se,isObject:Q,isPropertyKey:be,isString:Pe,isValueChangeAsync:Ie},ke=function(e){var t=e.scene,n=e.key,i=e.newKey,a=t.textures.get(n).getSourceImage();if(!a)return!1;var s=Math.min(a.width,a.height);i||t.textures.removeKey(n);var r=t.textures.createCanvas(i||n,s,s),o=r.context;return o.beginPath(),o.arc(s/2,s/2,s/2,0,2*Math.PI,!1),o.clip(),r.draw((a.width-s)/2,(a.height-s)/2,a),!0},Oe=function(e){var t=e.scene,n=e.key,i=e.newKey,a=e.radius,s=e.width,r=e.height,o=t.textures.get(n).getSourceImage();if(!o)return!1;s||(s=o.width),r||(r=o.height),i||t.textures.removeKey(n);var c=t.textures.createCanvas(i||n,s,r),l=c.context,h=Math.min(s,r)/100*a/2;return l.beginPath(),l.moveTo(0+h,0),l.lineTo(0+s-h,0),l.quadraticCurveTo(0+s,0,0+s,0+h),l.lineTo(0+s,0+r-h),l.quadraticCurveTo(0+s,0+r,0+s-h,0+r),l.lineTo(0+h,0+r),l.quadraticCurveTo(0,0+r,0,0+r-h),l.lineTo(0,0+h),l.quadraticCurveTo(0,0,0+h,0),l.closePath(),l.clip(),c.draw(0,0,o),!0},_e=function(){return GameCore.Utils.Device.isDesktop()||GameCore.Utils.Device.pixelRatio()>1?2:1},Re=function(e,t){var n=e.split(","),i=n[0].match(/:(.*?);/);if(!i)return null;for(var a=i[1],s=atob(n[n.length-1]),r=s.length,o=new Uint8Array(r);r--;)o[r]=s.charCodeAt(r);return new File([o],t,{type:a})},De=n(147),Me=n.n(De),Be=new Image,Le=function(e,t){return void 0===t&&(t=!0),new(we())((function(n){t&&(Be=new Image),Be.onload=function(){n(Be)},Be.onerror=function(){n(null)},Be.src=Me().createObjectURL(e)}))},Ne=n(23),Ge=n(20),Fe=n.n(Ge),Ue=function(){var e=(0,Ne.A)(Fe().mark((function e(t,n){var i;return Fe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t).then((function(e){return e.blob()})).catch((function(){return null}));case 2:if(i=e.sent){e.next=5;break}return e.abrupt("return",null);case 5:return e.abrupt("return",new File([i],n));case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),je=function(e){if(m()(e).call(e,".")<0)return e;for(var t=e.length-1;t>=0;t--){if("."==e[t])return e.substring(0,t);if("0"!=e[t])return e.substring(0,t+1)}return e},Ve={Array:y,Hash:H,Json:q,Object:ae,String:ye,Valid:xe,Image:{drawCircle:ke,drawBorder:Oe,getImageScale:_e,base64ToFile:Re,blobToHtmlImage:Le,blobUrlToFile:Ue},Number:{toAbbreviatedString:function(e,t){var n=t||{},i=n.fractionalDigits,a=void 0===i?0:i,s=n.startAbbreviate,r=void 0===s?1e3:s,o=n.abbreviateStep,c=void 0===o?3:o,l=n.maxLength,h=void 0===l?-1:l,u=n.removeLastZero,d=void 0===u||u,p=n.suffixes,f=void 0===p?["","k","m","b","t","q"]:p,m=-1===h?99999999:h;if(e>=r){var g=Math.floor(e/Math.pow(10,c)),v=Math.floor((g.toString().length-1)/c)+1,y=(e/Math.pow(Math.pow(10,c),v)).toFixed(a),A=m-f[v].length,E=y.substring(0,A);return(d?je(E):E)+f[v]}var T=e.toFixed(a),S=m-f[0].length,b=T.substring(0,S);return d?je(b):b+f[0]},padStart:function(e,t,n){void 0===n&&(n="0");for(var i=e.toString(),a=i.length,s=0;s<t-a;s++)i=n+i;return i},padEnd:function(e,t,n){void 0===n&&(n="0");for(var i=e.toString(),a=i.length,s=0;s<t-a;s++)i+=n;return i}},Device:{isDesktop:function(){return!/Android|iPhone|iPad|iPod/i.test(navigator.userAgent)},isMobile:function(){return/Android|iPhone|iPad|iPod/i.test(navigator.userAgent)},isAndroid:function(){return window.__fbPlatform?"ANDROID"===window.__fbPlatform:/Android/i.test(navigator.userAgent)},isIOS:function(){return window.__fbPlatform?"IOS"===window.__fbPlatform:/iPhone|iPad|iPod/i.test(navigator.userAgent)},isMobileWeb:function(){return window.__fbPlatform?"MOBILE_WEB"===window.__fbPlatform:/mobile/i.test(navigator.userAgent)},pixelRatio:function(){return Math.round(window.devicePixelRatio)||1}},Time:{isToday:function(e){var t=new Date(e),n=new Date;return t.getDate()===n.getDate()&&t.getMonth()===n.getMonth()&&t.getFullYear()===n.getFullYear()},sleepAsync:function(e){return new(we())((function(t){return setTimeout(t,e)}))}}}},232:function(e,t,n){"use strict";n.d(t,{$V:function(){return a},AD:function(){return s}});var i=n(134),a=function(e){try{var t=localStorage.getItem(e);return null===t?null:GameCore.Utils.Json.decode(t)}catch(n){return null}},s=function(e,t){try{var n=a(e),s={};GameCore.Utils.Valid.isObject(n)&&(s=n);var r=GameCore.Utils.Json.clone(t);if(!GameCore.Utils.Valid.isObject(r))return!1;var o=GameCore.Utils.Object.clear(r),c=(0,i.h1)(s,o),l=GameCore.Utils.Json.encode(c);return localStorage.setItem(e,l),!0}catch(h){return!1}}},475:function(e,t,n){"use strict";n.d(t,{K:function(){return i}});var i=function(){return GameCore.Utils.Device.isDesktop()||GameCore.Utils.Device.pixelRatio()>1?2:1}}},t={};function n(i){var a=t[i];if(void 0!==a)return a.exports;var s=t[i]={id:i,loaded:!1,exports:{}};return e[i].call(s.exports,s,s.exports,n),s.loaded=!0,s.exports}n.m=e,n.amdO={},function(){var e=[];n.O=function(t,i,a,s){if(!i){var r=1/0;for(h=0;h<e.length;h++){i=e[h][0],a=e[h][1],s=e[h][2];for(var o=!0,c=0;c<i.length;c++)(!1&s||r>=s)&&Object.keys(n.O).every((function(e){return n.O[e](i[c])}))?i.splice(c--,1):(o=!1,s<r&&(r=s));if(o){e.splice(h--,1);var l=a();void 0!==l&&(t=l)}}return t}s=s||0;for(var h=e.length;h>0&&e[h-1][2]>s;h--)e[h]=e[h-1];e[h]=[i,a,s]}}(),n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.f={},n.e=function(e){return Promise.all(Object.keys(n.f).reduce((function(t,i){return n.f[i](e,t),t}),[]))},n.u=function(e){return e+".bundle.js"},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.hmd=function(e){return(e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={},t="game-core:";n.l=function(i,a,s,r){if(e[i])e[i].push(a);else{var o,c;if(void 0!==s)for(var l=document.getElementsByTagName("script"),h=0;h<l.length;h++){var u=l[h];if(u.getAttribute("src")==i||u.getAttribute("data-webpack")==t+s){o=u;break}}o||(c=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,n.nc&&o.setAttribute("nonce",n.nc),o.setAttribute("data-webpack",t+s),o.src=i),e[i]=[a];var d=function(t,n){o.onerror=o.onload=null,clearTimeout(p);var a=e[i];if(delete e[i],o.parentNode&&o.parentNode.removeChild(o),a&&a.forEach((function(e){return e(n)})),t)return t(n)},p=setTimeout(d.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=d.bind(null,o.onerror),o.onload=d.bind(null,o.onload),c&&document.head.appendChild(o)}}}(),n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var i=t.getElementsByTagName("script");if(i.length)for(var a=i.length-1;a>-1&&(!e||!/^http(s?):/.test(e));)e=i[a--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),function(){var e={485:0};n.f.j=function(t,i){var a=n.o(e,t)?e[t]:void 0;if(0!==a)if(a)i.push(a[2]);else{var s=new Promise((function(n,i){a=e[t]=[n,i]}));i.push(a[2]=s);var r=n.p+n.u(t),o=new Error;n.l(r,(function(i){if(n.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var s=i&&("load"===i.type?"missing":i.type),r=i&&i.target&&i.target.src;o.message="Loading chunk "+t+" failed.\n("+s+": "+r+")",o.name="ChunkLoadError",o.type=s,o.request=r,a[1](o)}}),"chunk-"+t,t)}},n.O.j=function(t){return 0===e[t]};var t=function(t,i){var a,s,r=i[0],o=i[1],c=i[2],l=0;if(r.some((function(t){return 0!==e[t]}))){for(a in o)n.o(o,a)&&(n.m[a]=o[a]);if(c)var h=c(n)}for(t&&t(i);l<r.length;l++)s=r[l],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return n.O(h)},i=self.webpackChunkgame_core=self.webpackChunkgame_core||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))}(),n.O(void 0,[96,209],(function(){return n(686)})),n.O(void 0,[96,209],(function(){return n(687)})),n.O(void 0,[96,209],(function(){return n(513)})),n.O(void 0,[96,209],(function(){return n(514)})),n.O(void 0,[96,209],(function(){return n(688)}));var i=n.O(void 0,[96,209],(function(){return n(562)}));i=n.O(i)})();